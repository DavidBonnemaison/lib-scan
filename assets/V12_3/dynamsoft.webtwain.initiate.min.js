var Dynamsoft=Dynamsoft||{Lib:{},WebTwainEnv:{}};Dynamsoft.WebTwainEnv||(Dynamsoft.WebTwainEnv={}),Dynamsoft.WebTwainEnv.IfUseActiveXForIE10Plus=!1;var KISSY=function(e){var t,n=0,r={debug:10,info:20,warn:30,error:40};return(t={__BUILD_TIME:"20131209235320",Env:{host:this?this:window},Config:{debug:"",fns:{}},version:"1.41",config:function(n,r){var o,i,a,s=this,u=t.Config,l=u.fns;return t.isObject(n)?t.each(n,function(e,t){(a=l[t])?a.call(s,e):u[t]=e}):(o=l[n],r===e?i=o?o.call(s):u[n]:o?i=o.call(s,r):u[n]=r),i},log:function(){return e},getLogger:function(e){return function(e){var n,o={};for(n in r)!function(n,r){o[r]=function(n){return t.log(n,r,e)}}(0,n);return o}(e)},error:function(){},guid:function(e){return(e||"")+n++},Logger:{}}).Logger.Level={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},t}();!function(e,t){function n(){}function r(e,n){return"constructor"===e?t:n}var o="__MIX_CIRCULAR",i=this,a=!0,s=Object,u=s.create,l=!{toString:1}.propertyIsEnumerable("toString"),c="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toString,toLocaleString,valueOf".split(",");!function(e,t){for(var n in t)e[n]=t[n]}(e,{stamp:function(n,r,o){var i=n[o=o||"__~ks_stamped"];if(!i&&!r)try{i=n[o]=e.guid(o)}catch(e){i=t}return i},keys:s.keys||function(e){var t,n,r=[];for(t in e)e.hasOwnProperty(t)&&r.push(t);if(l)for(n=c.length-1;0<=n;n--)t=c[n],e.hasOwnProperty(t)&&r.push(t);return r},mix:function(n,r,i,s,u){if("object"==typeof i&&(s=i.whitelist,u=i.deep,i=i.overwrite),s&&"function"!=typeof s){var l=s;s=function(n,r){return e.inArray(n,l)?r:t}}i===t&&(i=a);var c=[],d=0;for(function n(r,i,s,u,l,c){if(!i||!r)return r;var d,h,f,g;for(i[o]=r,c.push(i),g=(f=e.keys(i)).length,d=0;d<g;d++)if((h=f[d])!==o){var p=r,m=i,_=s,v=u,y=l,I=c;if(_||!(h in p)||y){var S=p[h],b=m[h];S===b?S===t&&(p[h]=S):(v&&(b=v.call(m,h,b)),y&&b&&(e.isArray(b)||e.isPlainObject(b))?b[o]?p[h]=b[o]:(m=S&&(e.isArray(S)||e.isPlainObject(S))?S:e.isArray(b)?[]:{},p[h]=m,n(m,b,_,v,a,I)):b===t||!_&&h in p||(p[h]=b))}}return r}(n,r,i,s,u,c);r=c[d++];)delete r[o];return n},merge:function(t){var n,r={},o=(t=e.makeArray(arguments)).length;for(n=0;n<o;n++)e.mix(r,t[n]);return r},augment:function(n,o){var i,a,s=e.makeArray(arguments),u=s.length-2,l=1,c=s[u],d=s[u+1];for(s[1]=o,e.isArray(d)||(c=d,d=t,u++),"boolean"!=typeof c&&(c=t,u++);l<u;l++)(i=(a=s[l]).prototype)&&(a=e.mix({},i,!0,r)),e.mix(n.prototype,a,c,d);return n},extend:function(t,r,o,i){var a=r.prototype;return a.constructor=r,u?r=u(a):(n.prototype=a,r=new n),r.constructor=t,t.prototype=e.mix(r,t.prototype),t.superclass=a,o&&e.mix(r,o),i&&e.mix(t,i),t},namespace:function(){var t,n,r,o=e.makeArray(arguments),s=o.length,u=null,l=o[s-1]===a&&s--;for(t=0;t<s;t++)for(r=(""+o[t]).split("."),u=l?i:this,n=i[r[0]]===u?1:0;n<r.length;++n)u=u[r[n]]=u[r[n]]||{};return u}})}(KISSY),function(e,t){var n=Array.prototype,r=n.indexOf,o=n.lastIndexOf,i=n.filter,a=n.every,s=n.some,u=n.map;e.mix(e,{each:function(t,n,r){if(t){var o,i,a=0;if(r=r||null,i=void 0===(o=t&&t.length)||"function"===e.type(t))for(i=e.keys(t);a<i.length&&(o=i[a],!1!==n.call(r,t[o],o,t));a++);else for(i=t[0];a<o&&!1!==n.call(r,i,a,t);i=t[++a]);}return t},indexOf:r?function(e,t){return r.call(t,e)}:function(e,t){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},lastIndexOf:o?function(e,t){return o.call(t,e)}:function(e,t){for(var n=t.length-1;0<=n&&t[n]!==e;n--);return n},unique:function(t,n){var r=t.slice();n&&r.reverse();for(var o,i,a=0;a<r.length;){for(i=r[a];(o=e.lastIndexOf(i,r))!==a;)r.splice(o,1);a+=1}return n&&r.reverse(),r},inArray:function(t,n){return-1<e.indexOf(t,n)},filter:i?function(e,t,n){return i.call(e,t,n||this)}:function(t,n,r){var o=[];return e.each(t,function(e,t,i){n.call(r||this,e,t,i)&&o.push(e)}),o},map:u?function(e,t,n){return u.call(e,t,n||this)}:function(e,t,n){for(var r=e.length,o=Array(r),i=0;i<r;i++){var a="string"==typeof e?e.charAt(i):e[i];(a||i in e)&&(o[i]=t.call(n||this,a,i,e))}return o},reduce:function(e,t,n){var r=e.length;if("function"!=typeof t)throw new TypeError("callback is not function!");if(0===r&&2===arguments.length)throw new TypeError("arguments invalid");var o,i=0;if(3<=arguments.length)o=n;else for(;;){if(i in e){o=e[i++];break}if((i+=1)>=r)throw new TypeError}for(;i<r;)i in e&&(o=t.call(void 0,o,e[i],i,e)),i++;return o},every:a?function(e,t,n){return a.call(e,t,n||this)}:function(e,t,n){for(var r=e&&e.length||0,o=0;o<r;o++)if(o in e&&!t.call(n,e[o],o,e))return!1;return!0},some:s?function(e,t,n){return s.call(e,t,n||this)}:function(e,t,n){for(var r=e&&e.length||0,o=0;o<r;o++)if(o in e&&t.call(n,e[o],o,e))return!0;return!1},makeArray:function(t){if(null==t)return[];if(e.isArray(t))return t;var n=typeof t;if("number"!==(r=typeof t.length)||t.alert||"string"===n||"function"===n&&!("item"in t&&"number"===r))return[t];for(var r=[],o=(n=0,t.length);n<o;n++)r[n]=t[n];return r}})}(KISSY),function(e,t){function n(e){var t=typeof e;return null==e||"object"!==t&&"function"!==t}var r,o,i="",a={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},s={},u=/[\-#$\^*()+\[\]{}|\\,.?\s]/g;!function(){for(var e in a)s[a[e]]=e}(),e.mix(e,{urlEncode:function(e){return encodeURIComponent(""+e)},urlDecode:function(e){return decodeURIComponent(e.replace(/\+/g," "))},fromUnicode:function(e){return e.replace(/\\u([a-f\d]{4})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})},escapeHtml:function(t){return(t+"").replace(function(){if(r)return r;var t=i;return e.each(a,function(e){t+=e+"|"}),t=t.slice(0,-1),r=RegExp(t,"g")}(),function(e){return s[e]})},escapeRegExp:function(e){return e.replace(u,"\\$&")},unEscapeHtml:function(t){return t.replace(function(){if(o)return o;var t=i;return e.each(s,function(e){t+=e+"|"}),t+="&#(\\d{1,5});",o=RegExp(t,"g")}(),function(e,t){return a[e]||String.fromCharCode(+t)})},param:function(r,o,a,s){o=o||"&",a=a||"=",s===t&&(s=!0);var u,l,c,d,h,f=[],g=e.urlEncode;for(u in r)if(h=r[u],u=g(u),n(h))f.push(u),h!==t&&f.push(a,g(h+i)),f.push(o);else if(e.isArray(h)&&h.length)for(l=0,d=h.length;l<d;++l)n(c=h[l])&&(f.push(u,s?g("[]"):i),c!==t&&f.push(a,g(c+i)),f.push(o));return f.pop(),f.join(i)},unparam:function(n,r,o){if("string"!=typeof n||!(n=e.trim(n)))return{};o=o||"=";for(var i,a={},s=e.urlDecode,u=0,l=(n=n.split(r||"&")).length;u<l;++u){if(-1===(i=n[u].indexOf(o)))r=s(n[u]),i=t;else{r=s(n[u].substring(0,i)),i=n[u].substring(i+1);try{i=s(i)}catch(e){}e.endsWith(r,"[]")&&(r=r.substring(0,r.length-2))}r in a?e.isArray(a[r])?a[r].push(i):a[r]=[a[r],i]:a[r]=i}return a}}),e.escapeHTML=e.escapeHtml,e.unEscapeHTML=e.unEscapeHtml}(KISSY),function(e){function t(e,t,n){function r(){}var o=[].slice,i=o.call(arguments,3),a=function(){var a=o.call(arguments);return t.apply(this instanceof r?this:n||this,e?a.concat(i):i.concat(a))};return r.prototype=t.prototype,a.prototype=new r,a}e.mix(e,{noop:function(){},bind:t(0,t,null,0),rbind:t(0,t,null,1),later:function(t,n,r,o,i){n=n||0;var a,s=t,u=e.makeArray(i);return"string"==typeof t&&(s=o[t]),t=function(){s.apply(o,u)},{id:a=r?setInterval(t,n):setTimeout(t,n),interval:r,cancel:function(){this.interval?clearInterval(a):clearTimeout(a)}}},throttle:function(t,n,r){if(-1===(n=n||150))return function(){t.apply(r||this,arguments)};var o=e.now();return function(){var i=e.now();i-o>n&&(o=i,t.apply(r||this,arguments))}},buffer:function(t,n,r){function o(){o.stop(),i=e.later(t,n,0,r||this,arguments)}if(-1===(n=n||150))return function(){t.apply(r||this,arguments)};var i=null;return o.stop=function(){i&&(i.cancel(),i=0)},o}})}(KISSY),function(e,t){var n=!0,r=!1,o="__~ks_cloned",i="__~ks_compared";e.mix(e,{equals:function(r,o,a,s){return a=a||[],s=s||[],r===o?n:r===t||null===r||o===t||null===o?null==r&&null==o:r instanceof Date&&o instanceof Date?r.getTime()===o.getTime():"string"==typeof r&&"string"==typeof o||"number"==typeof r&&"number"==typeof o?r===o:"object"==typeof r&&"object"==typeof o?function(r,o,a,s){if(r[i]===o&&o[i]===r)return n;r[i]=o,o[i]=r;var u,l=function(e,n){return null!==e&&e!==t&&e[n]!==t};for(u in o)!l(r,u)&&l(o,u)&&a.push("expected has key "+u+'", but missing from actual.');for(u in r)!l(o,u)&&l(r,u)&&a.push('expected missing key "'+u+'", but present in actual.');for(u in o)u!==i&&(e.equals(r[u],o[u],a,s)||s.push('"'+u+'" was "'+(o[u]?o[u].toString():o[u])+'" in expected, but was "'+(r[u]?r[u].toString():r[u])+'" in actual.'));return e.isArray(r)&&e.isArray(o)&&r.length!==o.length&&s.push("arrays were not the same length"),delete r[i],delete o[i],0===a.length&&0===s.length}(r,o,a,s):r===o},clone:function(n,i){var a={},s=function t(n,i,a){var s,u,l,c,d=n;if(!n)return d;if(n[o])return a[n[o]].destination;if("object"==typeof n&&(c=n.constructor,e.inArray(c,[Boolean,String,Number,Date,RegExp])?d=new c(n.valueOf()):(s=e.isArray(n))?d=i?e.filter(n,i):n.concat():(u=e.isPlainObject(n))&&(d={}),n[o]=c=e.guid("c"),a[c]={destination:d,input:n}),s)for(n=0;n<d.length;n++)d[n]=t(d[n],i,a);else if(u)for(l in n)l===o||i&&i.call(n,n[l],l,n)===r||(d[l]=t(n[l],i,a));return d}(n,i,a);return e.each(a,function(e){if((e=e.input)[o])try{delete e[o]}catch(n){e[o]=t}}),a=null,s},now:Date.now||function(){return+new Date}})}(KISSY),function(e,t){var n=/^[\s\xa0]+|[\s\xa0]+$/g,r=String.prototype.trim,o=/\\?\{([^{}]+)\}/g;e.mix(e,{trim:r?function(e){return null==e?"":r.call(e)}:function(e){return null==e?"":(e+"").replace(n,"")},substitute:function(e,t,n){return"string"==typeof e&&t?e.replace(n||o,function(e,n){return"\\"===e.charAt(0)?e.slice(1):void 0===t[n]?"":t[n]}):e},ucfirst:function(e){return(e+="").charAt(0).toUpperCase()+e.substring(1)},startsWith:function(e,t){return 0===e.lastIndexOf(t,0)},endsWith:function(e,t){var n=e.length-t.length;return 0<=n&&e.indexOf(t,n)===n}})}(KISSY),function(e,t){var n={},r=Object.prototype,o=r.toString;e.mix(e,{type:function(e){return null==e?""+e:n[o.call(e)]||"object"},isNull:function(e){return null===e},isUndefined:function(e){return e===t},isEmptyObject:function(e){for(var n in e)if(n!==t)return!1;return!0},isPlainObject:function(n){if(!n||"object"!==e.type(n)||n.nodeType||n.window==n)return!1;var o,i;try{if((i=n.constructor)&&!r.hasOwnProperty.call(n,"constructor")&&!r.hasOwnProperty.call(i.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(o in n);return o===t||r.hasOwnProperty.call(n,o)}}),e.each("Boolean,Number,String,Function,Date,RegExp,Object,Array".split(","),function(t,r){n["[object "+t+"]"]=r=t.toLowerCase(),e["is"+t]=function(t){return e.type(t)===r}}),e.isArray=Array.isArray||e.isArray}(KISSY),function(e){function t(){for(var e,t=0;e=r[t++];)try{e()}catch(e){e.stack,setTimeout(function(){throw e},0)}1<t&&(r=[]),o=0}var n,r=[],o=0;if(KISSY.setImmediate=function(e){r.push(e),o||(o=1,n())},"function"==typeof setImmediate)n=function(){setImmediate(t)};else if("undefined"!=typeof process&&"function"==typeof process.nextTick)n=function(){process.nextTick(t)};else if("undefined"!=typeof MessageChannel){var i=new MessageChannel;i.port1.onmessage=function(){n=a,i.port1.onmessage=t,t()};var a=function(){i.port2.postMessage(0)};n=function(){setTimeout(t,0),a()}}else n=function(){setTimeout(t,0)}}(),function(e){function t(e,t){for(var n,r=0,o=e.length-1,i=[];0<=o;o--)"."!==(n=e[o])&&(".."===n?r++:r?r--:i[i.length]=n);if(t)for(;r--;r)i[i.length]="..";return i.reverse()}var n=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/,r=e.Path={resolve:function(){var n,r,o="",i=arguments,a=0;for(n=i.length-1;0<=n&&!a;n--)"string"==typeof(r=i[n])&&r&&(o=r+"/"+o,a="/"===r.charAt(0));return(a?"/":"")+(o=t(e.filter(o.split("/"),function(e){return!!e}),!a).join("/"))||"."},normalize:function(n){var r="/"===n.charAt(0),o="/"===n.slice(-1);return!(n=t(e.filter(n.split("/"),function(e){return!!e}),!r).join("/"))&&!r&&(n="."),n&&o&&(n+="/"),(r?"/":"")+n},join:function(){var t=e.makeArray(arguments);return r.normalize(e.filter(t,function(e){return e&&"string"==typeof e}).join("/"))},relative:function(t,n){t=r.normalize(t),n=r.normalize(n);var o,i,a=e.filter(t.split("/"),function(e){return!!e}),s=[],u=e.filter(n.split("/"),function(e){return!!e});for(i=Math.min(a.length,u.length),o=0;o<i&&a[o]===u[o];o++);for(i=o;o<a.length;)s.push(".."),o++;return(s=s.concat(u.slice(i))).join("/")},basename:function(e,t){var r;return r=(e.match(n)||[])[3]||"",t&&r&&r.slice(-1*t.length)===t&&(r=r.slice(0,-1*t.length)),r},dirname:function(e){e=(t=e.match(n)||[])[1]||"";var t=t[2]||"";return e||t?(t&&(t=t.substring(0,t.length-1)),e+t):"."},extname:function(e){return(e.match(n)||[])[4]||""}}}(KISSY),function(e,t){function n(t){t._queryMap||(t._queryMap=e.unparam(t._query))}function r(e){this._query=e||""}function o(e,t){return encodeURI(e).replace(t,function(e){return"%"+(1===(e=e.charCodeAt(0).toString(16)).length?"0"+e:e)})}function i(t){if(t instanceof i)return t.clone();var n=this;return e.mix(n,{scheme:"",userInfo:"",hostname:"",port:"",path:"",query:"",fragment:""}),t=i.getComponents(t),e.each(t,function(t,o){if(t=t||"","query"===o)n.query=new r(t);else{try{t=e.urlDecode(t)}catch(e){}n[o]=t}}),n}var a=/[#\/\?@]/g,s=/[#\?]/g,u=/[#@]/g,l=/#/g,c=RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),d=e.Path,h={scheme:1,userInfo:2,hostname:3,port:4,path:5,query:6,fragment:7};r.prototype={constructor:r,clone:function(){return new r(this.toString())},reset:function(e){return this._query=e||"",this._queryMap=null,this},count:function(){var t,r,o=0;for(r in n(this),t=this._queryMap)e.isArray(t[r])?o+=t[r].length:o++;return o},has:function(t){var r;return n(this),r=this._queryMap,t?t in r:!e.isEmptyObject(r)},get:function(e){var t;return n(this),t=this._queryMap,e?t[e]:t},keys:function(){return n(this),e.keys(this._queryMap)},set:function(t,o){var i;return n(this),i=this._queryMap,"string"==typeof t?this._queryMap[t]=o:(t instanceof r&&(t=t.get()),e.each(t,function(e,t){i[t]=e})),this},remove:function(e){return n(this),e?delete this._queryMap[e]:this._queryMap={},this},add:function(e,o){var i,a;if("string"==typeof e)n(this),a=(a=(i=this._queryMap)[e])===t?o:[].concat(a).concat(o),i[e]=a;else for(i in e instanceof r&&(e=e.get()),e)this.add(i,e[i]);return this},toString:function(r){return n(this),e.param(this._queryMap,t,t,r)}},i.prototype={constructor:i,clone:function(){var t=new i,n=this;return e.each(h,function(e,r){t[r]=n[r]}),t.query=t.query.clone(),t},resolve:function(t){"string"==typeof t&&(t=new i(t));var n,r=0,o=this.clone();return e.each("scheme,userInfo,hostname,port,path,query,fragment".split(","),function(i){"path"===i?r?o[i]=t[i]:(i=t.path)&&(r=1,e.startsWith(i,"/")||(o.hostname&&!o.path?i="/"+i:o.path&&-1!==(n=o.path.lastIndexOf("/"))&&(i=o.path.slice(0,n+1)+i)),o.path=d.normalize(i)):"query"===i?(r||t.query.toString())&&(o.query=t.query.clone(),r=1):(r||t[i])&&(o[i]=t[i],r=1)}),o},getScheme:function(){return this.scheme},setScheme:function(e){return this.scheme=e,this},getHostname:function(){return this.hostname},setHostname:function(e){return this.hostname=e,this},setUserInfo:function(e){return this.userInfo=e,this},getUserInfo:function(){return this.userInfo},setPort:function(e){return this.port=e,this},getPort:function(){return this.port},setPath:function(e){return this.path=e,this},getPath:function(){return this.path},setQuery:function(t){return"string"==typeof t&&(e.startsWith(t,"?")&&(t=t.slice(1)),t=new r(o(t,u))),this.query=t,this},getQuery:function(){return this.query},getFragment:function(){return this.fragment},setFragment:function(t){return e.startsWith(t,"#")&&(t=t.slice(1)),this.fragment=t,this},isSameOriginAs:function(e){return this.hostname.toLowerCase()===e.hostname.toLowerCase()&&this.scheme.toLowerCase()===e.scheme.toLowerCase()&&this.port.toLowerCase()===e.port.toLowerCase()},toString:function(t){var n,r,i=[];return(n=this.scheme)&&(i.push(o(n,a)),i.push(":")),(n=this.hostname)&&(i.push("//"),(r=this.userInfo)&&(i.push(o(r,a)),i.push("@")),i.push(encodeURIComponent(n)),(r=this.port)&&(i.push(":"),i.push(r))),(r=this.path)&&(n&&!e.startsWith(r,"/")&&(r="/"+r),r=d.normalize(r),i.push(o(r,s))),(t=this.query.toString.call(this.query,t))&&(i.push("?"),i.push(t)),(t=this.fragment)&&(i.push("#"),i.push(o(t,l))),i.join("")}},i.Query=r,i.getComponents=function(t){var n=(t||"").match(c)||[],r={};return e.each(h,function(e,t){r[t]=n[e]}),r},e.Uri=i}(KISSY),function(e,t){function n(e){var t=0;return parseFloat(e.replace(/\./g,function(){return 0==t++?".":""}))}function r(e,t){var r;t.trident=.1,(r=e.match(/Trident\/([\d.]*)/))&&r[1]&&(t.trident=n(r[1])),t.core="trident"}function o(e){var t,r;return(t=e.match(/MSIE ([^;]*)|Trident.*; rv(?:\s|:)?([0-9.]+)/))&&(r=t[1]||t[2])?n(r):0}function i(e){var i,a,s,l="",c="",d=[6,9],h=u&&u.createElement("div"),f=[],g={webkit:t,trident:t,gecko:t,presto:t,chrome:t,safari:t,firefox:t,ie:t,ieMode:t,opera:t,mobile:t,core:t,shell:t,phantomjs:t,os:t,ipad:t,iphone:t,ipod:t,ios:t,android:t,nodejs:t};if(h&&h.getElementsByTagName&&(h.innerHTML="\x3c!--[if IE {{version}}]><s></s><![endif]--\x3e".replace("{{version}}",""),f=h.getElementsByTagName("s")),0<f.length){for(r(e,g),a=d[0],d=d[1];a<=d;a++)if(h.innerHTML="\x3c!--[if IE {{version}}]><s></s><![endif]--\x3e".replace("{{version}}",a),0<f.length){g[c="ie"]=a;break}!g.ie&&(s=o(e))&&(g[c="ie"]=s)}else(a=e.match(/AppleWebKit\/([\d.]*)/))&&a[1]?(g[l="webkit"]=n(a[1]),(a=e.match(/OPR\/(\d+\.\d+)/))&&a[1]?g[c="opera"]=n(a[1]):(a=e.match(/Chrome\/([\d.]*)/))&&a[1]?g[c="chrome"]=n(a[1]):(a=e.match(/\/([\d.]*) Safari/))&&a[1]&&(g[c="safari"]=n(a[1])),/ Mobile\//.test(e)&&e.match(/iPad|iPod|iPhone/)?(g.mobile="apple",(a=e.match(/OS ([^\s]*)/))&&a[1]&&(g.ios=n(a[1].replace("_","."))),i="ios",(a=e.match(/iPad|iPod|iPhone/))&&a[0]&&(g[a[0].toLowerCase()]=g.ios)):/ Android/i.test(e)?(/Mobile/.test(e)&&(i=g.mobile="android"),(a=e.match(/Android ([^\s]*);/))&&a[1]&&(g.android=n(a[1]))):(a=e.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))&&(g.mobile=a[0].toLowerCase()),(a=e.match(/PhantomJS\/([^\s]*)/))&&a[1]&&(g.phantomjs=n(a[1]))):(a=e.match(/Presto\/([\d.]*)/))&&a[1]?(g[l="presto"]=n(a[1]),(a=e.match(/Opera\/([\d.]*)/))&&a[1]&&(g[c="opera"]=n(a[1]),(a=e.match(/Opera\/.* Version\/([\d.]*)/))&&a[1]&&(g[c]=n(a[1])),(a=e.match(/Opera Mini[^;]*/))&&a?g.mobile=a[0].toLowerCase():(a=e.match(/Opera Mobi[^;]*/))&&a&&(g.mobile=a[0]))):(s=o(e))?(g[c="ie"]=s,r(e,g)):(a=e.match(/Gecko/))&&(g[l="gecko"]=.1,(a=e.match(/rv:([\d.]*)/))&&a[1]&&(g[l]=n(a[1]),/Mobile|Tablet/.test(e)&&(g.mobile="firefox")),(a=e.match(/Firefox\/([\d.]*)/))&&a[1]&&(g[c="firefox"]=n(a[1])));return i||(/windows|win32/i.test(e)?i="windows":/macintosh|mac_powerpc/i.test(e)?i="macintosh":/linux/i.test(e)?i="linux":/rhino/i.test(e)&&(i="rhino")),g.os=i,g.core=g.core||l,g.shell=c,g.ieMode=g.ie&&u.documentMode||g.ie,g}var a,s,u=(l=e.Env.host).document,l=l.navigator,c=KISSY.UA=i(l&&l.userAgent||"");"object"==typeof process&&((a=process.versions)&&(s=a.node)&&(c.os=process.platform,c.nodejs=n(s)));c.getDescriptorFromUserAgent=i,a="webkit,trident,gecko,presto,chrome,safari,firefox,ie,opera".split(","),s=u&&u.documentElement;var d="";s&&(e.each(a,function(e){var t=c[e];t&&(d+=" ks-"+e+parseInt(t),d+=" ks-"+e)}),e.trim(d)&&(s.className=e.trim(s.className+d)))}(KISSY),function(e,t){var n,r,o,i,a,s,u,l,c=e.Env.host,d=e.UA,h=c.document||{},f=h.documentElement,g=!0,p=!1,m="ontouchstart"in h&&!d.phantomjs,_=d.ieMode;if(f&&(f.querySelector&&8!==_&&(p=!0),l=f.style,e.each(["","Webkit","Moz","O","ms"],function(e){var n=e?e+"Transition":"transition",r=e?e+"Transform":"transform";a===t&&n in l&&(a=e,o=n),s===t&&r in l&&(s=e,i=r)}),g="classList"in f,d=c.navigator||{},n="msPointerEnabled"in d,r="pointerEnabled"in d,i))try{h=h.createElement("p"),f.insertBefore(h,f.firstChild),h.style[i]="translate3d(1px,1px,1px)",d=(d=c.getComputedStyle(h)).getPropertyValue(i)||d[i],f.removeChild(h),u=d!==t&&0<d.length&&"none"!==d}catch(e){u=!0}e.Features={isMsPointerSupported:function(){return n},isPointerSupported:function(){return r},isTouchEventSupported:function(){return m},isTouchGestureSupported:function(){return m||r||n},isDeviceMotionSupported:function(){return!!c.DeviceMotionEvent},isHashChangeSupported:function(){return"onhashchange"in c&&(!_||_>7)},isTransitionSupported:function(){return a!==t},isTransformSupported:function(){return s!==t},isTransform3dSupported:function(){return u},isClassListSupported:function(){return g},isQuerySelectorSupported:function(){return!e.config("dom/selector")&&p},isIELessThan:function(e){return!!(_&&_<e)},getTransitionPrefix:function(){return a},getTransformPrefix:function(){return s},getTransitionProperty:function(){return o},getTransformProperty:function(){return i}}}(KISSY),(KISSY.Loader={}).Status={ERROR:-1,INIT:0,LOADING:1,LOADED:2,READY_TO_ATTACH:3,ATTACHING:4,ATTACHED:5},function(e){function t(e){if("string"==typeof e)return n(e);for(var t=[],r=0,o=e.length;r<o;r++)t[r]=n(e[r]);return t}function n(t){return"/"===t.charAt(t.length-1)&&(t+="index"),e.endsWith(t,".js")&&(t=t.slice(0,-3)),t}function r(t,n){var r=n.indexOf("!");if(-1!==r){var o=n.substring(0,r);n=n.substring(r+1);e.use(o,{sync:!0,success:function(e,r){r.alias&&(n=r.alias(t,n,o))}})}return n}var o=e.Loader,i=e.Path,a=e.Env.host,s=e.startsWith,u=o.Status,l=u.ATTACHED,c=u.READY_TO_ATTACH,d=u.LOADED,h=u.ATTACHING,f=u.ERROR,g=o.Utils={},p=a.document;e.mix(g,{docHead:function(){return p.getElementsByTagName("head")[0]||p.documentElement},normalDepModuleName:function(e,t){var n,r=0;if(!t)return t;if("string"==typeof t)return s(t,"../")||s(t,"./")?i.resolve(i.dirname(e),t):i.normalize(t);for(n=t.length;r<n;r++)t[r]=g.normalDepModuleName(e,t[r]);return t},createModulesInfo:function(t,n){e.each(n,function(e){g.createModuleInfo(t,e)})},createModuleInfo:function(t,r,i){r=n(r);var a=t.Env.mods,s=a[r];return s||(a[r]=s=new o.Module(e.mix({name:r,runtime:t},i)))},getModules:function(t,n){var r,o,i,a=[t],s=t.Env.mods;return e.each(n,function(n){(r=s[n])&&"css"===r.getType()?a.push(void 0):(o=g.unalias(t,n),e.reduce(o,function(e,t){return i=s[t],e&&i&&i.status>=h},!0)?a.push(s[o[0]].exports):a.push(null))}),a},attachModsRecursively:function(e,t){var n,r=e.length;for(n=0;n<r;n++)g.attachModRecursively(e[n],t)},checkModsLoadRecursively:function(e,t,n,r,o){n=n||[],o=o||{};var i,a=1,s=e.length,u=n.length;for(i=0;i<s;i++)a=a&&g.checkModLoadRecursively(e[i],t,n,r,o),n.length=u;return!!a},checkModLoadRecursively:function(e,t,n,r,o){var i,a=t.Env.mods[e];return e in o?o[e]:a?(i=a.status)===f?(r.push(a),o[e]=!1):i>=c?o[e]=!0:i!==d?o[e]=!1:g.checkModsLoadRecursively(a.getNormalizedRequires(),t,n,r,o)?(a.status=c,o[e]=!0):o[e]=!1:o[e]=!1},attachModRecursively:function(e,t){var n=t.Env.mods[e];n.status>=h||(n.status=h,n.cjs||g.attachModsRecursively(n.getNormalizedRequires(),t),g.attachMod(t,n))},attachMod:function(t,n){var r,o=n.factory;"function"==typeof o?(n.requires&&n.requires.length&&(r=e.bind(n.require,n)),void 0!==(o=o.apply(n,n.cjs?[t,r,n.exports,n]:g.getModules(t,n.getRequiresWithAlias())))&&(n.exports=o)):n.exports=o;n.status=l},getModNamesAsArray:function(e){return"string"==typeof e&&(e=e.replace(/\s+/g,"").split(",")),e},normalizeModNames:function(e,t,n){return g.unalias(e,g.normalizeModNamesWithAlias(e,t,n))},unalias:function(e,n){for(var r,o,i,a,s=[].concat(n),u=0,l=e.Env.mods;!u;)for(u=1,r=s.length-1;0<=r;r--)if((o=l[s[r]])&&"alias"in o){for(u=0,"string"==typeof(i=o.alias)&&(i=[i]),a=i.length-1;0<=a;a--)i[a]||i.splice(a,1);s.splice.apply(s,[r,1].concat(t(i)))}return s},normalizeModNamesWithAlias:function(e,n,o){var i,a,s=[];if(n)for(i=0,a=n.length;i<a;i++)n[i]&&s.push(r(e,t(n[i])));return o&&(s=g.normalDepModuleName(o,s)),s},registerModule:function(t,r,o,i){r=n(r);var a=t.Env.mods,s=a[r];s&&void 0!==s.factory||(g.createModuleInfo(t,r),s=a[r],e.mix(s,{name:r,status:d,factory:o}),e.mix(s,i))},getHash:function(e){var t,n=5381;for(t=e.length;-1<--t;)n=(n<<5)+n+e.charCodeAt(t);return n+""},getRequiresFromFn:function(e){var t=[];return e.toString().replace(m,"").replace(_,function(e,n){t.push(n.match(/^\s*["']([^'"\s]+)["']\s*$/)[1])}),t}});var m=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,_=/[^.'"]\s*require\s*\(([^)]+)\)/g}(KISSY),function(e){function t(e,t){return t in e?e[t]:e.runtime.Config[t]}function n(t){e.mix(this,t)}function r(t){this.exports={},this.status=o.Status.INIT,this.factory=this.name=void 0,this.cjs=1,e.mix(this,t),this.waitedCallbacks=[]}var o=e.Loader,i=e.Path,a=o.Utils;n.prototype={constructor:n,reset:function(t){e.mix(this,t)},getTag:function(){return t(this,"tag")},getName:function(){return this.name},getBase:function(){return t(this,"base")},getPrefixUriForCombo:function(){var e=this.name;return this.getBase()+(e&&!this.isIgnorePackageNameInUri()?e+"/":"")},getPackageUri:function(){return this.packageUri||(this.packageUri=new e.Uri(this.getPrefixUriForCombo())),this.packageUri},getBaseUri:function(){return t(this,"baseUri")},isDebug:function(){return t(this,"debug")},isIgnorePackageNameInUri:function(){return t(this,"ignorePackageNameInUri")},getCharset:function(){return t(this,"charset")},isCombine:function(){return t(this,"combine")},getGroup:function(){return t(this,"group")}},o.Package=n,r.prototype={kissy:1,constructor:r,use:function(e,t){return e=a.getModNamesAsArray(e),KISSY.use(a.normalDepModuleName(this.name,e),t)},resolve:function(e){return this.getFullPathUri().resolve(e)},resolveByName:function(e){return a.normalDepModuleName(this.name,e)},require:function(t){return e.require(t,this.name)},wait:function(e){this.waitedCallbacks.push(e)},notifyAll:function(){for(var e,t=this.waitedCallbacks.length,n=0;n<t;n++){e=this.waitedCallbacks[n];try{e(this)}catch(e){e.stack,setTimeout(function(){throw e},0)}}this.waitedCallbacks=[]},getType:function(){var e=this.type;return e||(this.type=e=".css"===i.extname(this.name).toLowerCase()?"css":"js"),e},getFullPathUri:function(){var t,n,r,o;return this.fullPathUri||(this.fullpath?n=new e.Uri(this.fullpath):(t=(n=this.getPackage()).getBaseUri(),o=this.getPath(),n.isIgnorePackageNameInUri()&&(r=n.name)&&(o=i.relative(r,o)),n=t.resolve(o),(t=this.getTag())&&(t+="."+this.getType(),n.query.set("t",t))),this.fullPathUri=n),this.fullPathUri},getFullPath:function(){var e;return this.fullpath||(e=this.getFullPathUri(),this.fullpath=e.toString()),this.fullpath},getPath:function(){var e;if(!(e=this.path)){e=this.name;var t="."+this.getType(),n="-min";e=i.join(i.dirname(e),i.basename(e,t)),this.getPackage().isDebug()&&(n=""),e=this.path=e+n+t}return e},getName:function(){return this.name},getPackage:function(){var t;if(!(t=this.packageInfo)){var n=this.name;t=this.runtime.config("packages");n=n+"/";var r,o="";for(r in t)e.startsWith(n,r+"/")&&r.length>o.length&&(o=r);t=this.packageInfo=t[o]||s}return t},getTag:function(){return this.tag||this.getPackage().getTag()},getCharset:function(){return this.charset||this.getPackage().getCharset()},getRequiresWithAlias:function(){var e=this.requiresWithAlias,t=this.requires;return t&&0!==t.length?(e||(this.requiresWithAlias=e=a.normalizeModNamesWithAlias(this.runtime,t,this.name)),e):t||[]},getRequiredMods:function(){var t=this.runtime;return e.map(this.getNormalizedRequires(),function(e){return a.createModuleInfo(t,e)})},getNormalizedRequires:function(){var e,t=this.normalizedRequiresStatus,n=this.status,r=this.requires;return r&&0!==r.length?(e=this.normalizedRequires)&&t===n?e:(this.normalizedRequiresStatus=n,this.normalizedRequires=a.normalizeModNames(this.runtime,r,this.name)):r||[]}},o.Module=r;var s=new n({name:"",runtime:e})}(KISSY),function(e){function t(e,t){var n=0;if(o.webkit)e.sheet&&(n=1);else if(e.sheet)try{e.sheet.cssRules&&(n=1)}catch(e){var r=e.name;e.code,"NS_ERROR_DOM_SECURITY_ERR"===r&&(n=1)}return n}function n(){for(var o in s){var i=s[o],u=i.node;t(u)&&(i.callback&&i.callback.call(u),delete s[o])}a=e.isEmptyObject(s)?0:setTimeout(n,r)}var r=30,o=e.UA,i=e.Loader.Utils,a=0,s={};i.pollCss=function(e,t){var r;(r=s[e.href]={}).node=e,r.callback=t,a||n()},i.isCssLoaded=t}(KISSY),function(e){var t,n=e.Env.host.document,r=e.Loader.Utils,o=e.Path,i={},a=e.UA;e.getScript=function(s,u,l){function c(){var e=_.readyState;e&&"loaded"!==e&&"complete"!==e||(_.onreadystatechange=_.onload=null,v(0))}var d,h,f,g,p=u,m=0;if(e.startsWith(o.extname(s).toLowerCase(),".css")&&(m=1),e.isPlainObject(p)&&(u=p.success,d=p.error,h=p.timeout,l=p.charset,f=p.attrs),(p=i[s]=i[s]||[]).push([u,d]),1<p.length)return p.node;var _=n.createElement(m?"link":"script");f&&e.each(f,function(e,t){_.setAttribute(t,e)}),l&&(_.charset=l),m?(_.href=s,_.rel="stylesheet"):(_.src=s,_.async=!0),p.node=_;var v=function(t){var n;g&&(g.cancel(),g=void 0),e.each(i[s],function(e){(n=e[t])&&n.call(_)}),delete i[s]};u="onload"in _,l=e.Config.forceCssPoll||a.webkit&&536>a.webkit;return m&&l&&u&&(u=!1),u?(_.onload=c,_.onerror=function(){_.onerror=null,v(1)}):m?r.pollCss(_,function(){v(0)}):_.onreadystatechange=c,h&&(g=e.later(function(){v(1)},1e3*h)),t||(t=r.docHead()),m?t.appendChild(_):t.insertBefore(_,t.firstChild),_}}(KISSY),function(e,t){function n(t){return"/"!==(t=t.replace(/\\/g,"/")).charAt(t.length-1)&&(t+="/"),r?t=r.resolve(t):(e.startsWith(t,"file:")||(t="file:"+t),t=new e.Uri(t)),t}var r,o,i=e.Loader,a=i.Utils,s=e.Env.host.location,u=e.Config.fns;!e.UA.nodejs&&s&&(o=s.href)&&(r=new e.Uri(o)),e.Config.loadModsFn=function(t,n){e.getScript(t.fullpath,n)},u.packages=function(r){var o,a=this.Config,s=a.packages=a.packages||{};return r?(e.each(r,function(t,r){o=t.name||r;var a=n(t.base||t.path);t.name=o,t.base=a.toString(),t.baseUri=a,t.runtime=e,delete t.path,s[o]?s[o].reset(t):s[o]=new i.Package(t)}),t):!1===r?(a.packages={},t):s},u.modules=function(t){var n=this;t&&e.each(t,function(t,r){var o=a.createModuleInfo(n,r,t);o.status===i.Status.INIT&&e.mix(o,t)})},u.base=function(e){var r=this.Config;return e?(e=n(e),r.base=e.toString(),r.baseUri=e,t):r.base}}(KISSY),function(e,t){function n(n,r,o,i,l){var c=r&&r.length,h=[],f=[];e.each(r,function(r){var g,p={timeout:l,success:function(){f.push(r),g&&a&&(g.name,d.registerModule(n,g.name,a.factory,a.config),a=t),--c||o(f,h)},error:function(){h.push(r),--c||o(f,h)},charset:i};r.combine||("css"===(g=r.mods[0]).getType()?g=t:u&&(s=g.name,e.now(),p.attrs={"data-mod-name":g.name})),e.Config.loadModsFn(r,p)})}function r(t,n){e.mix(this,{runtime:t,waitingModules:n})}function o(e,t){if(!e&&"function"==typeof t&&1<t.length){var n=d.getRequiresFromFn(t);n.length&&((e=e||{}).requires=n)}else e&&e.requires&&!e.cjs&&(e.cjs=0);return e}function i(e,t){e=e.split(/\//),t=t.split(/\//);for(var n=Math.min(e.length,t.length),r=0;r<n&&e[r]===t[r];r++);return e.slice(0,r).join("/")+"/"}var a,s,u=10>e.UA.ieMode,l=e.Loader,c=l.Status,d=l.Utils,h=d.getHash,f=c.LOADING,g=c.LOADED,p=c.READY_TO_ATTACH,m=c.ERROR,_=e.now();r.groupTag=_,r.add=function(n,r,i,l,c){if(3===c&&e.isArray(r)){var h=r;r=i,i={requires:h,cjs:1}}if("function"==typeof n||1===c)if(i=o(i=r,r=n),u){var f;for(c=(n=e.Env.host.document.getElementsByTagName("script")).length-1;0<=c;c--)if("interactive"===(h=n[c]).readyState){f=h;break}f?f=f.getAttribute("data-mod-name"):(e.now(),f=s),d.registerModule(l,f,r,i),s=null,0}else a={factory:r,config:i};else u?(s=null,0):a=t,i=o(i,r),d.registerModule(l,n,r,i)},e.augment(r,{use:function(t){var r=e.Config.timeout,o=this.runtime;t=e.keys(this.calculate(t));d.createModulesInfo(o,t),t=this.getComboUrls(t),e.each(t.css,function(t){n(o,t,function(t,n){e.each(t,function(t){e.each(t.mods,function(t){d.registerModule(o,t.name,e.noop),t.notifyAll()})}),e.each(n,function(t){e.each(t.mods,function(e){e.name,t.fullpath,e.status=m,e.notifyAll()})})},t.charset,r)}),e.each(t.js,function(t){n(o,t,function(){e.each(t,function(t){e.each(t.mods,function(e){e.factory||(e.name,t.fullpath,e.status=m),e.notifyAll()})})},t.charset,r)})},calculate:function(e,t,n){var r,o,i,a,s=this.waitingModules,u=this.runtime;n=n||{},t=t||{};for(r=0;r<e.length;r++)t[o=e[r]]||(t[o]=1,(a=(i=d.createModuleInfo(u,o)).status)>=p||(a!==g&&!s.contains(o)&&(a!==f&&(i.status=f,n[o]=1),i.wait(function(e){s.remove(e.name),s.notifyAll()}),s.add(o)),this.calculate(i.getNormalizedRequires(),t,n)));return n},getComboMods:function(t,n){for(var r,o,a,s,u,l,c,h,f,g,p={},m=this.runtime,v=0,y=t.length;v<y;++v){o=t[v],s=(o=d.createModuleInfo(m,o)).getType(),g=o.getFullPath(),h=(a=o.getPackage()).name,l=a.getCharset(),u=a.getTag(),f=a.getGroup(),c=a.getPrefixUriForCombo(),r=a.getPackageUri();var I=h;(o.canBeCombined=a.isCombine()&&e.startsWith(g,c))&&f?(a=n[I=f+"_"+l+"_"+_])?a.isSameOriginAs(r)?a.setPath(i(a.getPath(),r.getPath())):(I=h,n[h]=r):n[I]=r.clone():n[h]=r,(s=(r=p[s]=p[s]||{})[I])?1===s.tags.length&&s.tags[0]===u||s.tags.push(u):((s=r[I]=[]).charset=l,s.tags=[u]),s.push(o)}return p},getComboUrls:function(e){var t,n=(i=this.runtime.Config).comboPrefix,r=i.comboSep,o=i.comboMaxFileNum,i=i.comboMaxUrlLength,a={},s=(e=this.getComboMods(e,a),{});for(t in e)for(var u in s[t]={},e[t]){var l=[],c=[],d=e[t][u],f=(g=1<(g=d.tags).length?h(g.join("")):g[0])?"?t="+encodeURIComponent(g)+"."+t:"",g=f.length,p=(v=a[u].toString()).length,m=v+n,_=s[t][u]=[],v=m.length;_.charset=d.charset,_.mods=[];for(var y=function(){_.push({combine:1,fullpath:m+l.join(r)+f,mods:c})},I=0;I<d.length;I++){var S=d[I];_.mods.push(S);var b=S.getFullPath();S.canBeCombined?(b=b.slice(p).replace(/\?.*$/,""),l.push(b),c.push(S),(l.length>o||v+l.join(r).length+g>i)&&(l.pop(),c.pop(),y(),l=[],c=[],I--)):_.push({combine:0,fullpath:b,mods:[S]})}l.length&&y()}return s}}),l.ComboLoader=r}(KISSY),function(e,t){function n(t){e.mix(this,{fn:t,waitMods:{}})}var r=e.Loader,o=e.Env,i=r.Utils,a=e.setImmediate,s=r.ComboLoader;n.prototype={constructor:n,notifyAll:function(){var t=this.fn;t&&e.isEmptyObject(this.waitMods)&&(this.fn=null,t())},add:function(e){this.waitMods[e]=1},remove:function(e){delete this.waitMods[e]},contains:function(e){return this.waitMods[e]}},r.WaitingModules=n,e.mix(e,{add:function(t,n,r){s.add(t,n,r,e,arguments.length)},use:function(r,o){var u,l,c,d,h,f=new n(function n(){0;var r,s=[];e.now();r=i.checkModsLoadRecursively(u,e,t,s),e.now(),r?(i.attachModsRecursively(u,e),o&&(d?h():a(h))):s.length?c&&(d?c.apply(e,s):a(function(){c.apply(e,s)})):(f.fn=n,l.use(u))});return e.isPlainObject(o)&&(d=o.sync,c=o.error,o=o.success),h=function(){o.apply(e,i.getModules(e,r))},r=i.getModNamesAsArray(r),r=i.normalizeModNamesWithAlias(e,r),u=i.unalias(e,r),l=new s(e,f),d?f.notifyAll():a(function(){f.notifyAll()}),e},require:function(t,n){if(t){var r=i.unalias(e,i.normalizeModNamesWithAlias(e,[t],n));return i.attachModsRecursively(r,e),i.getModules(e,r)[1]}}}),o.mods={}}(KISSY),function(e){function t(t){var n=t.src||"";if(!n.match(u))return 0;var l,c=(t=(t=t.getAttribute("data-config"))?new Function("return "+t)():{}).comboPrefix||i,d=t.comboSep||a,h=n.indexOf(c);return-1===h?l=n.replace(s,"$1"):("/"!==(l=n.substring(0,h)).charAt(l.length-1)&&(l+="/"),c=n.substring(h+c.length).split(d),e.each(c,function(e){if(e.match(u))return l+=e.replace(s,"$1"),!1})),"tag"in t||-1!==(c=n.lastIndexOf("?"))&&(n=n.substring(c+1),t.tag=r.getHash(o+n)),t.base=t.base||l,t}var n=e.Env.host&&e.Env.host.document,r=e.Loader.Utils,o="20131209235315",i="??",a=",",s=/^(.*)(seed|kissy)(?:-min)?\.js[^/]*/i,u=/(seed|kissy)(?:-min)?\.js/i;e.config({comboPrefix:i,comboSep:a,charset:"utf-8",lang:"zh-cn",tag:o}),e.UA.nodejs?e.config({charset:"utf-8",base:__dirname.replace(/\\/g,"/").replace(/\/$/,"")+"/"}):n&&n.getElementsByTagName&&e.config(e.mix({comboMaxUrlLength:2e3,comboMaxFileNum:40},function(){var e,r,o=n.getElementsByTagName("script");for(e=o.length-1;0<=e;e--)if(r=t(o[e]))return r;return null}()))}(KISSY),KISSY.add("i18n",{alias:function(e,t){return t+"/i18n/"+e.Config.lang}}),function(e,t){function n(){if(!u){i&&!o.nodejs&&p(r,f,n),u=1;for(var t=0;t<l.length;t++)try{l[t](e)}catch(e){e.stack,setTimeout(function(){throw e},0)}}}var r=e.Env.host,o=e.UA,i=r.document,a=i&&i.documentElement,s=r.location,u=0,l=[],c=/^#?([\w-]+)$/,d=/\S/,h=!(!i||!i.addEventListener),f="load",g=h?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)},p=h?function(e,t,n){e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent("on"+t,n)};if(e.mix(e,{isWindow:function(e){return null!=e&&e==e.window},parseXML:function(e){if(e.documentElement)return e;var t;try{r.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e))}catch(e){t=void 0}return!t||!t.documentElement||t.getElementsByTagName("parsererror").length,t},globalEval:function(e){e&&d.test(e)&&(r.execScript?r.execScript(e):r.eval.call(r,e))},ready:function(t){if(u)try{t(e)}catch(e){e.stack,setTimeout(function(){throw e},0)}else l.push(t);return this},available:function(t,n){t=(t+"").match(c)[1];var r=1,o=e.later(function(){if(500<++r)o.cancel();else{var e=i.getElementById(t);e&&(n(e),o.cancel())}},40,!0)}}),s&&-1!==(s.search||"").indexOf("ks-debug")&&(e.Config.debug=!0),function(){if(i&&"complete"!==i.readyState)if(g(r,f,n),h){var e=function(){p(i,"DOMContentLoaded",e),n()};g(i,"DOMContentLoaded",e)}else{var t=function(){"complete"===i.readyState&&(p(i,"readystatechange",t),n())};g(i,"readystatechange",t);var o,s=a&&a.doScroll;try{o=null===r.frameElement}catch(e){o=!1}if(s&&o){var u=function(){try{s("left"),n()}catch(e){setTimeout(u,40)}};u()}}else n()}(),o.ie)try{i.execCommand("BackgroundImageCache",!1,!0)}catch(e){}}(KISSY),function(e){if(e.config({modules:{core:{alias:"dom,event,io,anim,base,node,json,ua,cookie".split(",")},ajax:{alias:"io"},"rich-base":{alias:"base"}}}),"undefined"!=typeof location){var t=e.startsWith(location.href,"https")?"https://s.tbcdn.cn/s/kissy/":"http://a.tbcdn.cn/s/kissy/";e.config({packages:{gallery:{base:t},mobile:{base:t}}})}}(KISSY),function(e,t,n){e({"anim/transition?":{alias:KISSY.Features.isTransitionSupported()?"anim/transition":""}}),e({anim:{requires:["anim/base","anim/timer","anim/transition?"]}}),e({"anim/base":{requires:["dom","promise"]}}),e({"anim/timer":{requires:["dom","anim/base"]}}),e({"anim/transition":{requires:["dom","event/dom","anim/base"]}}),e({attribute:{requires:["event/custom"]}}),e({base:{requires:["attribute"]}}),e({button:{requires:["node","component/control"]}}),e({color:{requires:["attribute"]}}),e({combobox:{requires:["node","component/control","menu","attribute","io"]}}),e({"component/container":{requires:["component/control","component/manager"]}}),e({"component/control":{requires:["node","base","promise","component/manager","xtemplate/runtime"]}}),e({"component/extension/align":{requires:["node"]}}),e({"component/extension/content-render":{requires:["component/extension/content-xtpl"]}}),e({"component/extension/delegate-children":{requires:["node","component/manager"]}}),e({"component/plugin/drag":{requires:["dd"]}}),e({"component/plugin/resize":{requires:["resizable"]}}),e({"date/format":{requires:["date/gregorian","i18n!date"]}}),e({"date/gregorian":{requires:["i18n!date"]}}),e({"date/picker":{requires:["node","date/gregorian","i18n!date/picker","component/control","date/format"]}}),e({"date/popup-picker":{requires:["date/picker/picker-xtpl","date/picker","component/extension/shim","component/extension/align"]}}),e({dd:{requires:["node","base"]}}),e({"dd/plugin/constrain":{requires:["node","base"]}}),e({"dd/plugin/proxy":{requires:["node","dd","base"]}}),e({"dd/plugin/scroll":{requires:["node","dd","base"]}}),e({"dom/basic":{alias:["dom/base",t.isIELessThan(9)?"dom/ie":"",t.isClassListSupported()?"":"dom/class-list"]},dom:{alias:["dom/basic",t.isQuerySelectorSupported()?"":"dom/selector"]}}),e({"dom/class-list":{requires:["dom/base"]}}),e({"dom/ie":{requires:["dom/base"]}}),e({"dom/selector":{requires:["dom/basic"]}}),e({editor:{requires:["node","html-parser","component/control"]}}),e({event:{requires:["event/dom","event/custom"]}}),e({"event/custom":{requires:["event/base"]}}),e({"event/dom":{alias:["event/dom/base",t.isTouchGestureSupported()?"event/dom/touch":"",t.isDeviceMotionSupported()?"event/dom/shake":"",t.isHashChangeSupported()?"":"event/dom/hashchange",t.isIELessThan(9)?"event/dom/ie":"",n.ie?"":"event/dom/focusin"]}}),e({"event/dom/base":{requires:["event/base","dom"]}}),e({"event/dom/focusin":{requires:["event/dom/base"]}}),e({"event/dom/hashchange":{requires:["event/dom/base","dom"]}}),e({"event/dom/ie":{requires:["event/dom/base","dom"]}}),e({"event/dom/shake":{requires:["event/dom/base"]}}),e({"event/dom/touch":{requires:["event/dom/base","dom"]}}),e({"filter-menu":{requires:["menu","component/extension/content-xtpl","component/extension/content-render"]}}),e({io:{requires:["dom","event/custom","promise","event/dom"]}}),e({kison:{requires:["base"]}}),e({menu:{requires:"node,component/container,component/extension/delegate-children,component/control,component/extension/content-render,component/extension/content-xtpl,component/extension/align,component/extension/shim".split(",")}}),e({menubutton:{requires:["node","button","component/extension/content-xtpl","component/extension/content-render","menu"]}}),e({mvc:{requires:["io","json","attribute","node"]}}),e({node:{requires:["dom","event/dom","anim"]}}),e({overlay:{requires:"component/container,component/extension/shim,component/extension/align,node,component/extension/content-xtpl,component/extension/content-render".split(",")}}),e({resizable:{requires:["node","base","dd"]}}),e({"resizable/plugin/proxy":{requires:["node","base"]}}),e({"scroll-view":{alias:t.isTouchGestureSupported()?"scroll-view/drag":"scroll-view/base"}}),e({"scroll-view/base":{requires:["node","anim","component/container","component/extension/content-render"]}}),e({"scroll-view/drag":{requires:["scroll-view/base","node","anim"]}}),e({"scroll-view/plugin/pull-to-refresh":{requires:["base"]}}),e({"scroll-view/plugin/scrollbar":{requires:["base","node","component/control"]}}),e({separator:{requires:["component/control"]}}),e({"split-button":{requires:["component/container","button","menubutton"]}}),e({stylesheet:{requires:["dom"]}}),e({swf:{requires:["dom","json","attribute"]}}),e({tabs:{requires:["component/container","toolbar","button"]}}),e({toolbar:{requires:["component/container","component/extension/delegate-children","node"]}}),e({tree:{requires:["node","component/container","component/extension/content-xtpl","component/extension/content-render","component/extension/delegate-children"]}}),e({xtemplate:{requires:["xtemplate/runtime","xtemplate/compiler"]}}),e({"xtemplate/compiler":{requires:["xtemplate/runtime"]}}),e({"xtemplate/nodejs":{requires:["xtemplate"]}}),e({"xtemplate/runtime":{requires:["path"]}})}(function(e){KISSY.config("modules",e)},KISSY.Features,KISSY.UA),function(e){e.add("ua",function(){return e.UA}),e.add("uri",function(){return e.Uri}),e.add("path",function(){return e.Path});var t=e.UA,n=e.Env.host,r=(t.nodejs&&"object"==typeof global?global:n).JSON;if(9>t.ieMode&&(r=null),r)e.add("json",function(){return e.JSON=r}),e.parseJson=function(e){return r.parse(e)};else{var o=/^[\],:{}\s]*$/,i=/(?:^|:|,)(?:\s*\[)+/g,a=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,s=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;e.parseJson=function(t){return null===t?t:"string"==typeof t&&(t=e.trim(t))&&o.test(t.replace(a,"@").replace(s,"]").replace(i,""))?new Function("return "+t)():e.error("Invalid Json: "+t)}}e.UA.nodejs&&(e.KISSY=e,module.exports=e)}(KISSY),KISSY.add("io/form-serializer",["dom"],function(e,t){function n(e){return e.replace(a,"\r\n")}var r,o=t("dom"),i=/^(?:select|textarea)/i,a=/\r?\n/g,s=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;return r={serialize:function(t,n){return e.param(r.getFormData(t),void 0,void 0,n||!1)},getFormData:function(t){var r=[],a={};return e.each(o.query(t),function(t){t=t.elements?e.makeArray(t.elements):[t],r.push.apply(r,t)}),r=e.filter(r,function(e){return e.name&&!e.disabled&&(e.checked||i.test(e.nodeName)||s.test(e.type))}),e.each(r,function(t){var r,i=o.val(t);null!==i&&(i=e.isArray(i)?e.map(i,n):n(i),(r=a[t.name])?(r&&!e.isArray(r)&&(r=a[t.name]=[r]),r.push.apply(r,e.makeArray(i))):a[t.name]=i)}),a}}}),KISSY.add("io/base",["event/custom","promise"],function(e,t){function n(t){var r,i=this;if(!(i instanceof n))return new n(t);o.call(i),t=function(t){var n=t.context;delete t.context,(t=e.mix(e.clone(d),t,{deep:!0})).context=n||t;var r,o=t.type,i=t.dataType;return n=t.uri=l.resolve(t.url),t.uri.setQuery(""),"crossDomain"in t||(t.crossDomain=!t.uri.isSameOriginAs(l)),o=t.type=o.toUpperCase(),t.hasContent=!u.test(o),t.processData&&(r=t.data)&&"string"!=typeof r&&(t.data=e.param(r,void 0,void 0,t.serializeArray)),i=t.dataType=e.trim(i||"*").split(a),!("cache"in t)&&e.inArray(i[0],["script","jsonp"])&&(t.cache=!1),t.hasContent||(t.data&&n.query.add(e.unparam(t.data)),!1===t.cache&&n.query.set("_ksTS",e.now()+"_"+e.guid())),t}(t),e.mix(i,{responseData:null,config:t||{},timeoutTimer:null,responseText:null,responseXML:null,responseHeadersString:"",responseHeaders:null,requestHeaders:{},readyState:0,state:0,statusText:null,status:0,transport:null}),o.Defer(i),n.fire("start",{ajaxConfig:t,io:i}),r=new(c[t.dataType[0]]||c["*"])(i),i.transport=r,t.contentType&&i.setRequestHeader("Content-Type",t.contentType);var s,h=t.dataType[0],f=t.timeout,g=t.context,p=t.headers,m=t.accepts;for(s in i.setRequestHeader("Accept",h&&m[h]?m[h]+("*"===h?"":", */*; q=0.01"):m["*"]),p)i.setRequestHeader(s,p[s]);if(t.beforeSend&&!1===t.beforeSend.call(g,i,t))return i;i.readyState=1,n.fire("send",{ajaxConfig:t,io:i}),t.async&&0<f&&(i.timeoutTimer=setTimeout(function(){i.abort("timeout")},1e3*f));try{i.state=1,r.send()}catch(e){2>i.state&&(e.stack,i._ioReady(-1,e.message))}return i}var r=t("event/custom"),o=t("promise"),i=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,a=/\s+/,s=function(e){return e},u=/^(?:GET|HEAD)$/,l=new e.Uri((e.Env.host.location||{}).href),c=(i=l&&i.test(l.getScheme()),{}),d={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0,serializeArray:!0,processData:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},converters:{text:{json:e.parseJson,html:s,text:s,xml:e.parseXML}},headers:{},responseType:!1,contents:{xml:/xml/,html:/html/,json:/json/,blob:/image/}};return d.converters.html=d.converters.text,e.mix(n,r.Target),e.mix(n,{isLocal:i,setupConfig:function(t){e.mix(d,t,{deep:!0})},setupTransport:function(e,t){c[e]=t},getTransport:function(e){return c[e]},getConfig:function(){return d}}),n}),KISSY.add("io/xhr-transport-base",["./base"],function(e,t){function n(e,t){try{return new(t||i).XMLHttpRequest}catch(e){}}function r(e){var t;return e.ifModified&&(t=e.uri,!1===e.cache&&(t=t.clone()).query.remove("_ksTS"),t=t.toString()),t}var o=t("./base"),i=e.Env.host,a=7<e.UA.ieMode&&i.XDomainRequest,s={proto:{}},u={},l={};o.__lastModifiedCached=u,o.__eTagCached=l,s.nativeXhr=i.ActiveXObject?function(e,t){var r;if(!c&&e&&a)r=new a;else if(!(r=!o.isLocal&&n(0,t)))e:{try{r=new(t||i).ActiveXObject("Microsoft.XMLHTTP");break e}catch(e){}r=void 0}return r}:n,s.XDomainRequest_=a;var c=s.supportCORS="withCredentials"in s.nativeXhr();return e.mix(s.proto,{sendInternal:function(){var t,n,o,i=this,s=(_=i.io).config,d=i.nativeXhr,h=s.files,f=h?"post":s.type,g=s.async,p=s.mimeType,m=_.requestHeaders||{},_=_._getUrlForSend(),v=r(s);for(o in v&&((n=u[v])&&(m["If-Modified-Since"]=n),(n=l[v])&&(m["If-None-Match"]=n)),(t=s.username)?d.open(f,_,g,t,s.password):d.open(f,_,g),!("withCredentials"in(f=s.xhrFields||{}))||g&&c||delete f.withCredentials,f)try{d[o]=f[o]}catch(e){}if(p&&d.overrideMimeType&&d.overrideMimeType(p),!1===m["X-Requested-With"]&&delete m["X-Requested-With"],void 0!==d.setRequestHeader)for(o in m)d.setRequestHeader(o,m[o]);var y=s.hasContent&&s.data||null;h&&(m={},(p=y)&&(m=e.unparam(p)),m=e.mix(m,h),y=new FormData,e.each(m,function(t,n){e.isArray(t)?e.each(t,function(e){y.append(n+(s.serializeArray?"[]":""),e)}):y.append(n,t)})),s.responseType&&(d.responseType=s.responseType),Dynamsoft&&Dynamsoft.WebTwainEnv&&Dynamsoft.WebTwainEnv.RawHttpSend&&(d.send=Dynamsoft.WebTwainEnv.RawHttpSend),d.send(y),g&&4!==d.readyState?a&&d instanceof a?(d.onload=function(){d.readyState=4,d.status=200,i._callback()},d.onerror=function(){d.readyState=4,d.status=500,i._callback()}):d.onreadystatechange=function(){i._callback()}:i._callback()},abort:function(){this._callback(0,1)},_callback:function(t,n){var i,s,c,d,h,f,g=this.nativeXhr,p=this.io,m=p.config;try{if(n||4===g.readyState)if(a&&g instanceof a?(g.onerror=e.noop,g.onload=e.noop):g.onreadystatechange=e.noop,n)4!==g.readyState&&g.abort();else{i=r(m);var _=g.status;if(a&&g instanceof a||(p.responseHeadersString=g.getAllResponseHeaders()),i&&(s=g.getResponseHeader("Last-Modified"),c=g.getResponseHeader("ETag"),s&&(u[i]=s),c&&(l[c]=c)),f=g.response,!g.responseType||"blob"!==g.responseType&&"arraybuffer"!==g.responseType){(h=g.responseXML)&&h.documentElement&&(p.responseXML=h);var v,y,I=p.responseText=g.responseText;if(m.files&&I)-1!==(v=I.indexOf("<body>"))&&(-1===(y=I.lastIndexOf("</body>"))&&(y=I.length),I=I.slice(v+6,y)),p.responseText=e.unEscapeHtml(I)}else p.responseData=f;try{d=g.statusText}catch(e){d=""}_||!o.isLocal||m.crossDomain?1223===_&&(_=204):_=p.responseText?200:404,p._ioReady(_,d)}}catch(t){t.stack,setTimeout(function(){throw t},0),g.onreadystatechange=e.noop,n||p._ioReady(-1,t)}}}),s}),KISSY.add("io/xdr-flash-transport",["./base","dom"],function(e,t){function n(e){e.config.url,this.io=e}var r,o=t("./base"),i=t("dom"),a={},s="io_swf",u=e.Env.host.document,l=!1;return e.augment(n,{send:function(){var t,n,o=this,c=o.io,d=c.config;t=(d.xdr||{}).src||e.Config.base+"io/assets/io.swf",n=1,l||(l=!0,t='<object id="'+s+'" type="application/x-shockwave-flash" data="'+t+'" width="0" height="0"><param name="movie" value="'+t+'" /><param name="FlashVars" value="yid='+n+"&uid="+1+'&host=KISSY.IO" /><param name="allowScriptAccess" value="always" /></object>',n=u.createElement("div"),i.prepend(n,u.body||u.documentElement),n.innerHTML=t),r?(o._uid=e.guid(),a[o._uid]=o,r.send(c._getUrlForSend(),{id:o._uid,uid:o._uid,method:d.type,data:d.hasContent&&d.data||{}})):setTimeout(function(){o.send()},200)},abort:function(){r.abort(this._uid)},_xdrResponse:function(e,t){var n,r,o=t.id,i=t.c,s=this.io;switch(i&&(r=i.responseText)&&(s.responseText=decodeURI(r)),e){case"success":n={status:200,statusText:"success"},delete a[o];break;case"abort":delete a[o];break;case"timeout":case"transport error":case"failure":delete a[o],n={status:"status"in i?i.status:500,statusText:i.statusText||e}}n&&s._ioReady(n.status,n.statusText)}}),o.applyTo=function(t,n,r){t=n.split(".").slice(1);var i=o;e.each(t,function(e){i=i[e]}),i.apply(null,r)},o.xdrReady=function(){r=u.getElementById(s)},o.xdrResponse=function(e,t){var n=a[t.uid];n&&n._xdrResponse(e,t)},n}),KISSY.add("io/sub-domain-transport",["event/dom","dom","./xhr-transport-base"],function(e,t){function n(e){var t=e.config;this.io=e,t.crossDomain=!1,t.url}function r(){var e=this.io.config.uri.getHostname();(e=u[e]).ready=1,o.detach(e.iframe,"load",r,this),this.send()}var o=t("event/dom"),i=t("dom"),a=t("./xhr-transport-base"),s=e.Env.host.document,u={};return e.augment(n,a.proto,{send:function(){var t,n=this.io.config,l=n.uri,c=l.getHostname();t=u[c];var d="/sub_domain_proxy.html";n.xdr&&n.xdr.subDomain&&n.xdr.subDomain.proxy&&(d=n.xdr.subDomain.proxy),t&&t.ready?!(this.nativeXhr=a.nativeXhr(0,t.iframe.contentWindow))||this.sendInternal():(t?n=t.iframe:(n=(t=u[c]={}).iframe=s.createElement("iframe"),i.css(n,{position:"absolute",left:"-9999px",top:"-9999px"}),i.prepend(n,s.body||s.documentElement),(t=new e.Uri).setScheme(l.getScheme()),t.setPort(l.getPort()),t.setHostname(c),t.setPath(d),n.src=t.toString()),o.on(n,"load",r,this))}}),n}),KISSY.add("io/xhr-transport",["./base","./xhr-transport-base","./xdr-flash-transport","./sub-domain-transport"],function(e,t){function n(t){var n=t.config,r=n.crossDomain,l=n.xdr||{},c=l.subDomain=l.subDomain||{};if(this.io=t,r&&!o.supportCORS){var d=n.uri.getHostname();if(s.domain&&e.endsWith(d,s.domain)&&!1!==c.proxy)return new a(t);if("flash"==""+l.use||!u)return new i(t)}return t=this.nativeXhr=o.nativeXhr(r),n.url,this}var r=t("./base"),o=t("./xhr-transport-base"),i=t("./xdr-flash-transport"),a=t("./sub-domain-transport"),s=e.Env.host.document,u=o.XDomainRequest_;return e.augment(n,o.proto,{send:function(){this.sendInternal()}}),r.setupTransport("*",n),r}),KISSY.add("io/script-transport",["./base"],function(e,t){function n(e){var t=e.config;return t.crossDomain?(this.io=e,t.url,this):new(r.getTransport("*"))(e)}var r=t("./base");return r.setupConfig({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{text:{script:function(t){return e.globalEval(t),t}}}}),e.augment(n,{send:function(){var t=this,n=t.io,r=n.config;t.script=e.getScript(n._getUrlForSend(),{charset:r.scriptCharset,success:function(){t._callback("success")},error:function(){t._callback("error")}})},_callback:function(e,t){var n=this.io;this.script&&(this.script=void 0,t||("error"!==e?n._ioReady(200,"success"):"error"===e&&n._ioReady(500,"script error")))},abort:function(){this._callback(0,1)}}),r.setupTransport("script",n),r}),KISSY.add("io/jsonp",["./base"],function(e,t){var n=t("./base"),r=e.Env.host;return n.setupConfig({jsonp:"callback",jsonpCallback:function(){return e.guid("jsonp")}}),n.on("start",function(t){var n=t.io,o=n.config;if("jsonp"===(t=o.dataType)[0]){delete o.contentType;var i,a=o.jsonpCallback,s="function"==typeof a?a():a,u=r[s];o.uri.query.set(o.jsonp,s),r[s]=function(t){1<arguments.length&&(t=e.makeArray(arguments)),i=[t]},n.fin(function(){if(r[s]=u,void 0===u)try{delete r[s]}catch(e){}else i&&u(i[0])}),(n=o.converters).script=n.script||{},n.script.json=function(){return i[0]},t.length=2,t[0]="script",t[1]="json"}}),n}),KISSY.add("io/form",["./base","dom","./form-serializer"],function(e,t){var n=t("./base"),r=t("dom"),o=t("./form-serializer"),i=Array.prototype.slice,a=e.Env.host.FormData;return n.on("start",function(t){var n,s;if(s=(t=t.io.config).form){n=r.get(s),s=t.data;for(var u=!1,l={},c=r.query("input",n),d=0,h=c.length;d<h;d++){var f=c[d];if("file"===f.type.toLowerCase()){if(u=!0,!a)break;var g=i.call(f.files,0);l[r.attr(f,"name")]=1<g.length?g:g[0]||null}}u&&a&&(t.files=t.files||{},e.mix(t.files,l),delete t.contentType),!u||a?(n=o.getFormData(n),t.hasContent?(n=e.param(n,void 0,void 0,t.serializeArray),t.data=s?t.data+"&"+n:n):t.uri.query.add(n)):("*"===(t=(s=t.dataType)[0])&&(t="text"),s.length=2,s[0]="iframe",s[1]=t)}}),n}),KISSY.add("io/iframe-transport",["dom","./base","event/dom"],function(e,t){function n(e){this.io=e,e.config.url}var r=t("dom"),o=t("./base"),i=t("event/dom"),a=e.Env.host.document,s=e.clone(o.getConfig().converters.text);return s.json=function(t){return e.parseJson(e.unEscapeHtml(t))},o.setupConfig({converters:{iframe:s,text:{iframe:function(e){return e}},xml:{iframe:function(e){return e}}}}),e.augment(n,{send:function(){function t(){i.on(o,"load error",y._callback,y),T.submit()}var n,o,s,u,l,c,d,h,f,g,p,m,_,v,y=this,I=y.io,S=I.config,b=S.data,T=r.get(S.form);y.attrs={target:r.attr(T,"target")||"",action:r.attr(T,"action")||"",encoding:r.attr(T,"encoding"),enctype:r.attr(T,"enctype"),method:r.attr(T,"method")},y.form=T,u=I,l=e.guid("io-iframe"),c=r.getEmptyIframeSrc(),u=u.iframe=r.create("<iframe "+(c?' src="'+c+'" ':"")+' id="'+l+'" name="'+l+'" style="position:absolute;left:-9999px;top:-9999px;"/>'),r.prepend(u,a.body||a.documentElement),o=u,r.attr(T,{target:o.id,action:I._getUrlForSend(),method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"}),b&&(s=e.unparam(b)),s&&(d=s,h=T,f=S.serializeArray,v=[],e.each(d,function(t,n){for(g=e.isArray(t),p=e.makeArray(t),m=0;m<p.length;m++)(_=a.createElement("input")).type="hidden",_.name=n+(g&&f?"[]":""),_.value=p[m],r.append(_,h),v.push(_)}),n=v),y.fields=n,6===e.UA.ie?setTimeout(t,0):t()},_callback:function(t){var n,o=this,a=o.form,s=o.io,u=(t=t.type,s.iframe);if(u)if("abort"===t&&6===e.UA.ie?setTimeout(function(){r.attr(a,o.attrs)},0):r.attr(a,o.attrs),r.remove(this.fields),i.detach(u),setTimeout(function(){r.remove(u)},30),s.iframe=null,"load"===t)try{(n=u.contentWindow.document)&&n.body&&(s.responseText=r.html(n.body),e.startsWith(s.responseText,"<?xml")&&(s.responseText=void 0)),s.responseXML=n&&n.XMLDocument?n.XMLDocument:n,n?s._ioReady(200,"success"):s._ioReady(500,"parser error")}catch(e){s._ioReady(500,"parser error")}else"error"===t&&s._ioReady(500,"error")},abort:function(){this._callback({type:"abort"})}}),o.setupTransport("iframe",n),o}),KISSY.add("io/methods",["promise","./base"],function(e,t){var n=t("promise"),r=t("./base"),o=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;e.extend(r,n,{setRequestHeader:function(e,t){return this.requestHeaders[e]=t,this},getAllResponseHeaders:function(){return 2===this.state?this.responseHeadersString:null},getResponseHeader:function(e){var t,n;e=e.toLowerCase();if(2===this.state){if(!(n=this.responseHeaders))for(n=this.responseHeaders={};t=o.exec(this.responseHeadersString);)n[t[1].toLowerCase()]=t[2];t=n[e]}return void 0===t?null:t},overrideMimeType:function(e){return this.state||(this.mimeType=e),this},abort:function(e){return e=e||"abort",this.transport&&this.transport.abort(e),this._ioReady(0,e),this},getNativeXhr:function(){var e=this.transport;return e?e.nativeXhr:null},_ioReady:function(t,n){if(2!==this.state){var o;if(this.state=2,this.readyState=4,200<=t&&300>t||304===t)if(304===t)n="not modified",o=!0;else try{(function(t){var n,r,o=t.responseText,i=t.responseXML,a=t.config,s=a.converters,u=a.contents,l=a.dataType;if("blob"!==a.responseType&&"arraybuffer"!==a.responseType||!t.responseData){for(a=t.mimeType||t.getResponseHeader("Content-Type");"*"===l[0];)l.shift();if(!l.length)for(n in u)if(u[n].test(a)){l[0]!==n&&l.unshift(n);break}if(l[0]=l[0]||"text",o||i){for(n=0;n<l.length;n++){if("text"===l[n]&&void 0!==o){r=o;break}if("xml"===l[n]&&void 0!==i){r=i;break}}if(!r){var c={text:o,xml:i};e.each(["text","xml"],function(e){var t=l[0];if(s[e]&&s[e][t]&&c[e])return l.unshift(e),r="text"===e?o:i,!1})}}for(u=l[0],a=1;a<l.length;a++){n=l[a];var d=s[u]&&s[u][n];if(!d)throw"no covert for "+u+" => "+n;r=d(r),u=n}t.responseData=r}})(this),n="success",o=!0}catch(e){e.stack,setTimeout(function(){throw e},0),n="parser error"}else 0>t&&(t=0);this.status=t,this.statusText=n;var i,a=this.defer,s=this.config;(i=this.timeoutTimer)&&(clearTimeout(i),this.timeoutTimer=0),i=o?"success":"error";var u,l=[this.responseData,n,this],c=s.context,d={ajaxConfig:s,io:this};(u=s[i])&&u.apply(c,l),(u=s.complete)&&u.apply(c,l),r.fire(i,d),r.fire("complete",d),a[o?"resolve":"reject"](l)}},_getUrlForSend:function(){var t=this.config,n=t.uri,r=e.Uri.getComponents(t.url).query||"";return n.toString.call(n,t.serializeArray)+(r?(n.query.has()?"&":"?")+r:r)}})}),KISSY.add("io","io/form-serializer,io/base,io/xhr-transport,io/script-transport,io/jsonp,io/form,io/iframe-transport,io/methods".split(","),function(e,t){function n(e,t,n,r,i){return"function"==typeof t&&(r=n,n=t,t=void 0),o({type:i||"get",url:e,data:t,success:n,dataType:r})}var r=t("io/form-serializer"),o=t("io/base");return t("io/xhr-transport"),t("io/script-transport"),t("io/jsonp"),t("io/form"),t("io/iframe-transport"),t("io/methods"),e.mix(o,{serialize:r.serialize,get:n,post:function(e,t,r,o){return"function"==typeof t&&(o=r,r=t,t=void 0),n(e,t,r,o,"post")},jsonp:function(e,t,r){return"function"==typeof t&&(r=t,t=void 0),n(e,t,r,"jsonp")},getScript:e.getScript,getJSON:function(e,t,r){return"function"==typeof t&&(r=t,t=void 0),n(e,t,r,"json")},upload:function(e,t,n,r,i){return"function"==typeof n&&(i=r,r=n,n=void 0),o({url:e,type:"post",dataType:i,form:t,data:n,success:r})}}),e.mix(e,{Ajax:o,IO:o,ajax:o,io:o,jsonp:o.jsonp}),o}),KISSY.add("dom/base/api",[],function(e){var t=e.Env.host||{},n=t.document,r=e.UA,o={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},i={isCustomDomain:function(e){e=e||t;var n=(e=i.get(e)).document.domain;return n!==(e=e.location.hostname)&&n!=="["+e+"]"},getEmptyIframeSrc:function(e){return e=e||t,e=i.get(e),r.ie&&i.isCustomDomain(e)?"javascript:void(function(){"+encodeURIComponent('document.open();document.domain="'+e.document.domain+'";document.close();')+"}())":""},NodeType:o,getWindow:function(n){if(!n)return t;if(n=i.get(n),e.isWindow(n))return n;var r=n;return r.nodeType!==o.DOCUMENT_NODE&&(r=n.ownerDocument),r.defaultView||r.parentWindow},getDocument:function(t){return t?(t=i.get(t),e.isWindow(t)?t.document:t.nodeType===o.DOCUMENT_NODE?t:t.ownerDocument):n},isDomNodeList:function(e){return e&&!e.nodeType&&e.item&&!e.setTimeout},nodeName:function(e){var t=i.get(e);e=t.nodeName.toLowerCase();return r.ie&&(t=t.scopeName)&&"HTML"!==t&&(e=t.toLowerCase()+":"+e),e},_RE_NUM_NO_PX:RegExp("^("+/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source+")(?!px)[a-z%]+$","i")};return e.mix(i,o),i}),KISSY.add("dom/base/attr",["./api"],function(e,t){function n(e){return null==e?"":e+""}function r(e,t){t=m[t]||t;var n=v[t];return n&&n.get?n.get(e,t):e[t]}var o=t("./api"),i=e.Env.host.document,a=o.NodeType,s=(i=i&&i.documentElement,o.nodeName),u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,l=/^(?:button|input|object|select|textarea)$/i,c=/^a(?:rea)?$/i,d=/:|^on/,h=/\r/g,f={},g={val:1,css:1,html:1,text:1,data:1,width:1,height:1,offset:1,scrollTop:1,scrollLeft:1},p={tabindex:{get:function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):l.test(e.nodeName)||c.test(e.nodeName)&&e.href?0:void 0}}},m={hidefocus:"hideFocus",tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},_={get:function(e,t){return o.prop(e,t)?t.toLowerCase():void 0},set:function(e,t,n){return!1===t?o.removeAttr(e,n):((t=m[n]||n)in e&&(e[t]=!0),e.setAttribute(n,n.toLowerCase())),n}},v={},y={},I={select:{get:function(e){var t,n=e.selectedIndex,r=e.options;if(0>n)return null;if("select-one"==""+e.type)return o.val(r[n]);for(e=[],n=0,t=r.length;n<t;++n)r[n].selected&&e.push(o.val(r[n]));return e},set:function(t,n){var r=e.makeArray(n);return e.each(t.options,function(t){t.selected=e.inArray(o.val(t),r)}),r.length||(t.selectedIndex=-1),r}}};return e.each(["radio","checkbox"],function(t){I[t]={get:function(e){return null===e.getAttribute("value")?"on":e.value},set:function(t,n){if(e.isArray(n))return t.checked=e.inArray(o.val(t),n),1}}}),p.style={get:function(e){return e.style.cssText}},e.mix(o,{_valHooks:I,_propFix:m,_attrHooks:p,_propHooks:v,_attrNodeHook:y,_attrFix:f,prop:function(t,n,i){var a,s,u=o.query(t);if(e.isPlainObject(n))e.each(n,function(e,t){o.prop(u,t,e)});else if(n=m[n]||n,s=v[n],void 0!==i)for(t=u.length-1;0<=t;t--)a=u[t],s&&s.set?s.set(a,i,n):a[n]=i;else if(u.length)return r(u[0],n)},hasProp:function(e,t){var n,i=o.query(e),a=i.length;for(n=0;n<a;n++)if(void 0!==r(i[n],t))return!0;return!1},removeProp:function(e,t){t=m[t]||t;var n,r,i=o.query(e);for(n=i.length-1;0<=n;n--){r=i[n];try{r[t]=void 0,delete r[t]}catch(e){}}},attr:function(t,n,r,i){var l=o.query(t),c=l[0];if(e.isPlainObject(n)){var h;i=r;for(h in n)o.attr(l,h,n[h],i)}else{if(i&&g[n])return o[n](t,r);if(n=n.toLowerCase(),i&&g[n])return o[n](t,r);if(n=f[n]||n,t=u.test(n)?_:d.test(n)?y:p[n],void 0===r){if(c&&c.nodeType===a.ELEMENT_NODE)return"form"===s(c)&&(t=y),t&&t.get?t.get(c,n):""!==(r=c.getAttribute(n))||(n=c.getAttributeNode(n))&&n.specified?null===r?void 0:r:void 0}else for(i=l.length-1;0<=i;i--)(c=l[i])&&c.nodeType===a.ELEMENT_NODE&&("form"===s(c)&&(t=y),t&&t.set?t.set(c,r,n):c.setAttribute(n,""+r))}},removeAttr:function(e,t){t=t.toLowerCase(),t=f[t]||t;var n,r,i,s=o.query(e);for(i=s.length-1;0<=i;i--)(r=s[i]).nodeType===a.ELEMENT_NODE&&(r.removeAttribute(t),u.test(t)&&(n=m[t]||t)in r)&&(r[n]=!1)},hasAttr:i&&!i.hasAttribute?function(e,t){t=t.toLowerCase();var n,r,i=o.query(e);for(n=0;n<i.length;n++)if((r=(r=i[n]).getAttributeNode(t))&&r.specified)return!0;return!1}:function(e,t){var n,r=o.query(e),i=r.length;for(n=0;n<i;n++)if(r[n].hasAttribute(t))return!0;return!1},val:function(t,r){var i,a,u,l,c;if(void 0===r){if(u=o.get(t))return(i=I[s(u)]||I[u.type])&&"get"in i&&void 0!==(a=i.get(u,"value"))?a:"string"==typeof(a=u.value)?a.replace(h,""):null==a?"":a}else for(l=(a=o.query(t)).length-1;0<=l&&1===(u=a[l]).nodeType;l--)null==(c=r)?c="":"number"==typeof c?c+="":e.isArray(c)&&(c=e.map(c,n)),(i=I[s(u)]||I[u.type])&&"set"in i&&void 0!==i.set(u,c,"value")||(u.value=c)},text:function(e,t){var n,r,i,s;if(void 0===t)return n=o.get(e),o._getText(n);for(i=(r=o.query(e)).length-1;0<=i;i--)(s=(n=r[i]).nodeType)===a.ELEMENT_NODE?(o.cleanData(n.getElementsByTagName("*")),"textContent"in n?n.textContent=t:n.innerText=t):s!==a.TEXT_NODE&&s!==a.CDATA_SECTION_NODE||(n.nodeValue=t)},_getText:function(e){return e.textContent}}),o}),KISSY.add("dom/base/class",["./api"],function(e,t){function n(t){for(var n,r=[],o=(t=(t=e.trim(t||"")).split(u)).length,i=0;i<o;i++)(n=t[i])&&r.push(n);return r}function r(e){return function(t,n){var r,o,i,s=t.classList,u=a.call(arguments,2);for(r=0,o=n.length;r<o;r++)(i=n[r])&&s[e].apply(s,[i].concat(u))}}function o(e){return function(t,r){var o=n(r),u=a.call(arguments,2);i.query(t).each(function(t){t.nodeType===s.ELEMENT_NODE&&i[e].apply(i,[t,o].concat(u))})}}var i=t("./api"),a=[].slice,s=i.NodeType,u=/[\.\s]\s*\.?/;return e.mix(i,{_hasClass:function(e,t){var n,r,o,i=e.classList;if(i.length){for(n=0,r=t.length;n<r;n++)if((o=t[n])&&!i.contains(o))return!1;return!0}return!1},_addClass:r("add"),_removeClass:r("remove"),_toggleClass:r("toggle"),hasClass:function(e,t){var r=i.get(e);return r&&r.nodeType===s.ELEMENT_NODE&&i._hasClass(r,n(t))},replaceClass:function(e,t,n){i.removeClass(e,t),i.addClass(e,n)},addClass:o("_addClass"),removeClass:o("_removeClass"),toggleClass:o("_toggleClass")}),i}),KISSY.add("dom/base/create",["./api"],function(e,t){function n(e){return(e=e&&e!==l?e.createElement(h):f)===f&&(e.innerHTML=""),e}function r(e,t){var r=n(t);return r.innerHTML="m<div>"+e+"</div>",r.lastChild}function o(e,t){if(t)if(v&&t.canHaveChildren&&"removeNode"in e){if(e.firstChild)e:{try{e.innerHTML="";break e}catch(e){}for(var n;n=e.lastChild;)o(n,e)}e.removeNode(!1)}else t.removeChild(e)}function i(e,t,n){var r=t.nodeType;if(r===c.DOCUMENT_FRAGMENT_NODE)for(t=t.childNodes,n=n.childNodes,r=0;t[r];)n[r]&&i(e,t[r],n[r]),r++;else if(r===c.ELEMENT_NODE)for(t=t.getElementsByTagName("*"),n=n.getElementsByTagName("*"),r=0;t[r];)n[r]&&e(t[r],n[r]),r++}function a(t,n){var r,o,i=e.require("event/dom");if(n.nodeType!==c.ELEMENT_NODE||u.hasData(t)){for(o in r=u.data(t))u.data(n,o,r[o]);i&&i.clone(t,n)}}function s(t){var n,r,o=null;if(t&&(t.push||t.item)&&t[0])for(o=(o=t[0].ownerDocument).createDocumentFragment(),n=0,r=(t=e.makeArray(t)).length;n<r;n++)o.appendChild(t[n]);return o}var u=t("./api"),l=e.Env.host.document,c=u.NodeType,d=e.UA.ieMode,h="div",f=l&&l.createElement(h),g=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,p=/<([\w:]+)/,m=/^\s+/,_=/\s+$/,v=!!(d&&9>d),y=v,I=/<|&#?\w+;/,S=l&&"outerHTML"in l.documentElement,b=/^<(\w+)\s*\/?>(?:<\/\1>)?$/;e.mix(u,{create:function(t,n,o,i){var a=null;if(!t)return a;if(t.nodeType)return u.clone(t);if("string"!=typeof t)return a;void 0===i&&(i=!0),i&&(t=e.trim(t));i=u._creators,o=o||l;var d,f,v,S=h;return I.test(t)?(v=b.exec(t))?a=o.createElement(v[1]):(t=t.replace(g,"<$1></$2>"),(v=p.exec(t))&&(d=v[1])&&(S=d.toLowerCase()),d=(i[S]||r)(t,o),y&&(f=t.match(m))&&d.insertBefore(o.createTextNode(f[0]),d.firstChild),y&&/\S/.test(t)&&(f=t.match(_))&&d.appendChild(o.createTextNode(f[0])),1===(f=d.childNodes).length?a=f[0].parentNode.removeChild(f[0]):!f.length||(a=s(f))):a=o.createTextNode(t),t=a,e.isPlainObject(n)&&(t.nodeType===c.ELEMENT_NODE?u.attr(t,n,!0):t.nodeType===c.DOCUMENT_FRAGMENT_NODE&&u.attr(t.childNodes,n,!0)),t},_fixCloneAttributes:function(e,t){"textarea"===u.nodeName(e)&&(t.defaultValue=e.defaultValue,t.value=e.value)},_creators:{div:r},_defaultCreator:r,html:function(e,t,r){var o,i,a=(e=u.query(e))[0],s=!1;if(!a)return null;if(void 0===t)return a.nodeType===c.ELEMENT_NODE?a.innerHTML:a.nodeType===c.DOCUMENT_FRAGMENT_NODE?((r=n(a.ownerDocument)).appendChild(a),r.innerHTML):null;if(!((t+="").match(/<(?:script|style|link)/i)||y&&t.match(m)||E[(t.match(p)||["",""])[1].toLowerCase()]))try{for(o=e.length-1;0<=o;o--)(i=e[o]).nodeType===c.ELEMENT_NODE&&(u.cleanData(i.getElementsByTagName("*")),i.innerHTML=t);s=!0}catch(e){}s||(t=u.create(t,0,a.ownerDocument,0),u.empty(e),u.append(t,e,r))},outerHtml:function(e,t,r){var o=(e=u.query(e)).length,i=e[0];if(!i)return null;if(void 0===t)return S&&i.nodeType!==u.DOCUMENT_FRAGMENT_NODE?i.outerHTML:((t=n(i.ownerDocument)).appendChild(u.clone(i,!0)),t.innerHTML);if(!(t+="").match(/<(?:script|style|link)/i)&&S)for(r=o-1;0<=r;r--)(i=e[r]).nodeType===c.ELEMENT_NODE&&(u.cleanData(i,1),i.outerHTML=t);else t=u.create(t,0,i.ownerDocument,0),u.insertBefore(t,e,r),u.remove(e)},remove:function(t,n){var r,i,a,s=u.query(t),l=e.require("event/dom");for(a=s.length-1;0<=a;a--)r=s[a],!n&&r.nodeType===c.ELEMENT_NODE&&((i=e.makeArray(r.getElementsByTagName("*"))).push(r),u.removeData(i),l&&l.detach(i)),o(r,r.parentNode)},clone:function(e,t,n,r){"object"==typeof t&&(r=t.deepWithDataAndEvent,n=t.withDataAndEvent,t=t.deep);e=u.get(e);var o,s,l=u._fixCloneAttributes;return e?(s=e.nodeType,o=e.cloneNode(t),s!==c.ELEMENT_NODE&&s!==c.DOCUMENT_FRAGMENT_NODE||(l&&s===c.ELEMENT_NODE&&l(e,o),t&&l&&i(l,e,o)),n&&(a(e,o),t&&r&&i(a,e,o)),o):null},empty:function(e){var t,n;for(n=(e=u.query(e)).length-1;0<=n;n--)t=e[n],u.remove(t.childNodes)},_nodeListToFragment:s}),u.outerHTML=u.outerHtml;var T,C=u._creators,w=u.create,E={area:"map",thead:"table",td:"tr",th:"tr",tr:"tbody",tbody:"table",tfoot:"table",caption:"table",colgroup:"table",col:"colgroup",legend:"fieldset"};for(T in E)!function(e){C[T]=function(t,n){return w("<"+e+">"+t+"</"+e+">",void 0,n)}}(E[T]);return E.option=E.optgroup=function(e,t){return w('<select multiple="multiple">'+e+"</select>",void 0,t)},u}),KISSY.add("dom/base/data",["./api"],function(e,t){var n=t("./api"),r=e.Env.host,o="_ks_data_"+e.now(),i={},a={},s={applet:1,object:1,embed:1},u=function(t,n){if(t)if(void 0!==n){if(n in t)return!0}else if(!e.isEmptyObject(t))return!0;return!1},l={hasData:function(e,t){return e==r?l.hasData(a,t):u(e[o],t)},data:function(e,t,n){if(e==r)return l.data(a,t,n);var i=e[o];if(void 0===n)return void 0!==t?i&&i[t]:i=e[o]=e[o]||{};(i=e[o]=e[o]||{})[t]=n},removeData:function(t,n){if(t==r)return l.removeData(a,n);var i=t[o];if(void 0!==n)delete i[n],e.isEmptyObject(i)&&l.removeData(t);else try{delete t[o]}catch(e){t[o]=void 0}}},c={hasData:function(e,t){var n=e[o];return!!n&&u(i[n],t)},data:function(t,n,r){if(!s[t.nodeName.toLowerCase()]){var a=t[o];if(!a){if(void 0!==n&&void 0===r)return;a=t[o]=e.guid()}if(t=i[a],void 0===r)return void 0!==n?t&&t[n]:t=i[a]=i[a]||{};(t=i[a]=i[a]||{})[n]=r}},removeData:function(t,n){var r,a=t[o];if(a)if(r=i[a],void 0!==n)delete r[n],e.isEmptyObject(r)&&c.removeData(t);else{delete i[a];try{delete t[o]}catch(e){t[o]=void 0}t.removeAttribute&&t.removeAttribute(o)}}};return e.mix(n,{__EXPANDO:o,hasData:function(e,t){for(var r=!1,o=n.query(e),i=0;i<o.length&&!(r=(r=o[i]).nodeType?c.hasData(r,t):l.hasData(r,t));i++);return r},data:function(t,r,o){var i=(t=n.query(t))[0];if(e.isPlainObject(r))for(var a in r)n.data(t,a,r[a]);else if(void 0===o){if(i)return i.nodeType?c.data(i,r):l.data(i,r)}else for(a=t.length-1;0<=a;a--)(i=t[a]).nodeType?c.data(i,r,o):l.data(i,r,o)},removeData:function(e,t){var r,o,i=n.query(e);for(o=i.length-1;0<=o;o--)(r=i[o]).nodeType?c.removeData(r,t):l.removeData(r,t)},cleanData:function(t,r){var o,i,a=n.query(t),s=e.require("event/dom");for(i=a.length-1;0<=i;i--)if((o=a[i]).nodeType){var u=r&&e.makeArray(o.getElementsByTagName("*"))||[];u.push(o),o=0;for(var d=u.length;o<d;o++)c.removeData(u[o]);s&&s.detach(u)}else l.removeData(o)}}),n}),KISSY.add("dom/base/insertion",["./api"],function(e,t){function n(t){t.src?e.getScript(t.src):(t=e.trim(t.text||t.textContent||t.innerHTML||""))&&e.globalEval(t)}function r(t,r,d,h){h&&(h=[]),t=function e(t,n){var r,o,d,h=[];for(r=0;t[r];r++)if(o=t[r],d=s(o),o.nodeType===i.DOCUMENT_FRAGMENT_NODE)h.push.apply(h,e(u(o.childNodes),n));else if("script"!==d||o.type&&!c.test(o.type)){if(o.nodeType===i.ELEMENT_NODE&&!a.test(d)){d=[];var f,g,p=o.getElementsByTagName("script");for(g=0;g<p.length;g++)(!(f=p[g]).type||c.test(f.type))&&d.push(f);l.apply(t,[r+1,0].concat(d))}h.push(o)}else o.parentNode&&o.parentNode.removeChild(o),n&&n.push(o);return h}(t=o.query(t),h),o._fixInsertionChecked&&o._fixInsertionChecked(t);var f,g,p,m=(r=o.query(r)).length;if((t.length||h&&h.length)&&m)for(t=o._nodeListToFragment(t),1<m&&(p=o.clone(t,!0),r=e.makeArray(r)),f=0;f<m;f++)g=r[f],t&&d(0<f?o.clone(p,!0):t,g),h&&h.length&&e.each(h,n)}var o=t("./api"),i=o.NodeType,a=/^(?:button|input|object|select|textarea)$/i,s=o.nodeName,u=e.makeArray,l=[].splice,c=/\/(java|ecma)script/i;return e.mix(o,{_fixInsertionChecked:null,insertBefore:function(e,t,n){r(e,t,function(e,t){t.parentNode&&t.parentNode.insertBefore(e,t)},n)},insertAfter:function(e,t,n){r(e,t,function(e,t){t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)},n)},appendTo:function(e,t,n){r(e,t,function(e,t){t.appendChild(e)},n)},prependTo:function(e,t,n){r(e,t,function(e,t){t.insertBefore(e,t.firstChild)},n)},wrapAll:function(e,t){t=o.clone(o.get(t),!0),(e=o.query(e))[0].parentNode&&o.insertBefore(t,e[0]);for(var n;(n=t.firstChild)&&1===n.nodeType;)t=n;o.appendTo(e,t)},wrap:function(t,n){t=o.query(t),n=o.get(n),e.each(t,function(e){o.wrapAll(e,n)})},wrapInner:function(t,n){t=o.query(t),n=o.get(n),e.each(t,function(e){var t=e.childNodes;t.length?o.wrapAll(t,n):e.appendChild(n)})},unwrap:function(t){t=o.query(t),e.each(t,function(e){e=e.parentNode,o.replaceWith(e,e.childNodes)})},replaceWith:function(e,t){var n=o.query(e);t=o.query(t);o.remove(t,!0),o.insertBefore(t,n),o.remove(n)}}),e.each({prepend:"prependTo",append:"appendTo",before:"insertBefore",after:"insertAfter"},function(e,t){o[t]=o[e]}),o}),KISSY.add("dom/base/offset",["./api"],function(e,t){function n(e){var t,n=e.ownerDocument.body;return e.getBoundingClientRect?(e=(t=e.getBoundingClientRect())[h],t=t[f],{left:e-=l.clientLeft||n.clientLeft||0,top:t-=l.clientTop||n.clientTop||0}):{left:0,top:0}}function r(e,t){var r,i={left:0,top:0},a=c(e),s=e;t=t||a;do{if(a==t){var u=s;r=n(u),u=c(u),r.left+=o[g](u),r.top+=o[p](u)}else r=n(s);i.left+=r.left,i.top+=r.top}while(a&&a!=t&&(s=a.frameElement)&&(a=a.parent));return i}var o=t("./api"),i=e.Env.host,a=e.UA,s=i.document,u=o.NodeType,l=s&&s.documentElement,c=o.getWindow,d=Math.max,h="left",f="top",g="scrollLeft",p="scrollTop";return e.mix(o,{offset:function(e,t,n){var i;if(void 0===t)return(e=o.get(e))&&(i=r(e,n)),i;for(i=(n=o.query(e)).length-1;0<=i;i--){e=n[i];var a=t;"static"===o.css(e,"position")&&(e.style.position="relative");var s=r(e),u={},l=void 0,c=void 0;for(c in a)l=parseFloat(o.css(e,c))||0,u[c]=l+a[c]-s[c];o.css(e,u)}},scrollIntoView:function(t,n,r,i){var a,s,l,d;if(l=o.get(t)){n&&(n=o.get(n)),n||(n=l.ownerDocument),n.nodeType===u.DOCUMENT_NODE&&(n=c(n)),e.isPlainObject(r)&&(i=r.allowHorizontalScroll,d=r.onlyScrollIfNeeded,r=r.alignWithTop),i=void 0===i||i,s=e.isWindow(n);t=o.offset(l);var g,p,m,_,v=o.outerHeight(l);a=o.outerWidth(l),s?(s=n,g=o.height(s),p=o.width(s),_={left:o.scrollLeft(s),top:o.scrollTop(s)},s=t[h]-_[h],l=t[f]-_[f],a=t[h]+a-(_[h]+p),t=t[f]+v-(_[f]+g)):(g=o.offset(n),p=n.clientHeight,m=n.clientWidth,_={left:o.scrollLeft(n),top:o.scrollTop(n)},s=t[h]-(g[h]+(parseFloat(o.css(n,"borderLeftWidth"))||0)),l=t[f]-(g[f]+(parseFloat(o.css(n,"borderTopWidth"))||0)),a=t[h]+a-(g[h]+m+(parseFloat(o.css(n,"borderRightWidth"))||0)),t=t[f]+v-(g[f]+p+(parseFloat(o.css(n,"borderBottomWidth"))||0))),d?(0>l||0<t)&&(!0===r?o.scrollTop(n,_.top+l):!1===r?o.scrollTop(n,_.top+t):0>l?o.scrollTop(n,_.top+l):o.scrollTop(n,_.top+t)):(r=void 0===r||!!r)?o.scrollTop(n,_.top+l):o.scrollTop(n,_.top+t),i&&(d?(0>s||0<a)&&(!0===r?o.scrollLeft(n,_.left+s):!1===r?o.scrollLeft(n,_.left+a):0>s?o.scrollLeft(n,_.left+s):o.scrollLeft(n,_.left+a)):void 0===r||r?o.scrollLeft(n,_.left+s):o.scrollLeft(n,_.left+a))}},docWidth:0,docHeight:0,viewportHeight:0,viewportWidth:0,scrollTop:0,scrollLeft:0}),e.each(["Left","Top"],function(e,t){var n="scroll"+e;o[n]=function(r,a){return"number"==typeof r?arguments.callee(i,r):((r=o.get(r))&&r.nodeType===u.ELEMENT_NODE?void 0!==a?r[n]=parseFloat(a):s=r[n]:(h=c(r),void 0!==a?(a=parseFloat(a),l="Left"===e?a:o.scrollLeft(h),d="Top"===e?a:o.scrollTop(h),h.scrollTo(l,d)):"number"!=typeof(s=h["page"+(t?"Y":"X")+"Offset"])&&("number"!=typeof(s=(l=h.document).documentElement[n])&&(s=l.body[n]))),s);var s,l,d,h}}),e.each(["Width","Height"],function(e){o["doc"+e]=function(t){return t=o.get(t),t=o.getDocument(t),d(t.documentElement["scroll"+e],t.body["scroll"+e],o["viewport"+e](t))},o["viewport"+e]=function(t){t=o.get(t),t=(n=c(t))["inner"+e];if(a.mobile&&t)return t;t="client"+e;var n,r=(n=n.document).body,i=n.documentElement[t];return"CSS1Compat"===n.compatMode&&i||r&&r[t]||i}}),o}),KISSY.add("dom/base/style",["./api"],function(e,t){function n(e,t){return t.toUpperCase()}function r(e){return e.replace(y,"ms-").replace(E,n)}function o(e,t,n){var o,i,a;if(3!==e.nodeType&&8!==e.nodeType&&(o=e.style)){if(t=r(t),a=T[t],t=C[t]||t,void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1))||(i=o[t]),void 0===i?"":i;if(null===n||n===I?n=I:!isNaN(Number(n))&&!v[t]&&(n+=S),a&&a.set&&(n=a.set(e,n)),void 0!==n){try{o[t]=n}catch(e){}n===I&&o.removeAttribute&&o.removeAttribute(t)}o.cssText||e.removeAttribute("style")}}function i(e){var t,n=arguments;return 0!==e.offsetWidth?t=a.apply(void 0,n):function(e,t,n){var r,o={},i=e.style;for(r in t)o[r]=i[r],i[r]=t[r];for(r in n.call(e),t)i[r]=o[r]}(e,x,function(){t=a.apply(void 0,n)}),t}function a(t,n,r){if(e.isWindow(t))return n===m?l.viewportWidth(t):l.viewportHeight(t);if(9===t.nodeType)return n===m?l.docWidth(t):l.docHeight(t);var o=n===m?["Left","Right"]:["Top","Bottom"],i=n===m?t.offsetWidth:t.offsetHeight;return 0<i?("border"!==r&&e.each(o,function(e){r||(i-=parseFloat(l.css(t,"padding"+e))||0),i="margin"===r?i+(parseFloat(l.css(t,r+e))||0):i-(parseFloat(l.css(t,"border"+e+"Width"))||0)}),i):((null===(i=l._getComputedStyle(t,n))||0>Number(i))&&(i=t.style[n]||0),i=parseFloat(i)||0,r&&e.each(o,function(e){i+=parseFloat(l.css(t,"padding"+e))||0,"padding"!==r&&(i+=parseFloat(l.css(t,"border"+e+"Width"))||0),"margin"===r&&(i+=parseFloat(l.css(t,r+e))||0)}),i)}var s,u,l=t("./api"),c=e.Env.host,d=e.UA,h=e.Features,f=l.nodeName,g=c.document,p=/^margin/,m="width",_="display"+e.now(),v={fillOpacity:1,fontWeight:1,lineHeight:1,opacity:1,orphans:1,widows:1,zIndex:1,zoom:1},y=/^-ms-/,I="",S="px",b=/\d(?!px)[a-z%]+$/i,T={},C={float:"cssFloat"},w={},E=/-([a-z])/gi,P=g&&g.documentElement.style||{};(e.each(["","Webkit","Moz","O","ms"],function(e){e=e?e+"UserSelect":"userSelect",void 0===s&&e in P&&(s=e)}),h.isTransformSupported())&&(u=C.transform=h.getTransformProperty(),C.transformOrigin=u+"Origin");h.isTransitionSupported()&&(C.transition=h.getTransitionProperty()),e.mix(l,{_camelCase:r,_cssHooks:T,_cssProps:C,_getComputedStyle:function(e,t){var n,r,o,i,a,s="";return r=e.ownerDocument,t=C[t]||t,(n=r.defaultView.getComputedStyle(e,null))&&(s=n.getPropertyValue(t)||n[t]),""===s&&!l.contains(r,e)&&(s=e.style[t]),l._RE_NUM_NO_PX.test(s)&&p.test(t)&&(r=(a=e.style).width,o=a.minWidth,i=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=o,a.maxWidth=i),s},style:function(t,n,r){var i,a=(t=l.query(t))[0];if(e.isPlainObject(n))for(i in n)for(a=t.length-1;a>=0;a--)o(t[a],i,n[i]);else{if(void 0===r)return i="",a&&(i=o(a,n,r)),i;for(a=t.length-1;a>=0;a--)o(t[a],n,r)}},css:function(t,n,i){var a,s=(t=l.query(t))[0];if(e.isPlainObject(n))for(a in n)for(s=t.length-1;s>=0;s--)o(t[s],a,n[a]);else{if(n=r(n),a=T[n],void 0===i)return i="",!s||a&&"get"in a&&void 0!==(i=a.get(s,!0))||(i=l._getComputedStyle(s,n)),void 0===i?"":i;for(s=t.length-1;s>=0;s--)o(t[s],n,i)}},show:function(e){var t,n,r;for(r=(e=l.query(e)).length-1;r>=0;r--)if((n=e[r]).style.display=l.data(n,_)||I,"none"===l.css(n,"display")){t=n.tagName.toLowerCase();var o=void 0,i=w[t],a=void 0;w[t]||(o=g.body||g.documentElement,a=g.createElement(t),l.prepend(a,o),i=l.css(a,"display"),o.removeChild(a),w[t]=i),t=i,l.data(n,_,t),n.style.display=t}},hide:function(e){var t,n;for(n=(e=l.query(e)).length-1;n>=0;n--){var r=(t=e[n]).style,o=r.display;"none"!==o&&(o&&l.data(t,_,o),r.display="none")}},toggle:function(e){var t,n;for(n=(e=l.query(e)).length-1;n>=0;n--)t=e[n],"none"===l.css(t,"display")?l.show(t):l.hide(t)},addStyleSheet:function(e,t,n){"string"==typeof e&&(n=t,t=e,e=c);var r;e=l.getDocument(e);n&&(n=n.replace("#",I))&&(r=l.get("#"+n,e)),r||(r=l.create("<style>",{id:n},e),l.get("head",e).appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(e.createTextNode(t)))},unselectable:function(t){var n,r,o,i,a=0;for(r=(t=l.query(t)).length-1;r>=0;r--)if(i=(n=t[r]).style,void 0!==s)i[s]="none";else if(d.ie)for(i=n.getElementsByTagName("*"),n.setAttribute("unselectable","on"),o=["iframe","textarea","input","select"];n=i[a++];)e.inArray(f(n),o)||n.setAttribute("unselectable","on")},innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0,width:0,height:0}),e.each([m,"height"],function(t){l["inner"+e.ucfirst(t)]=function(e){return(e=l.get(e))&&i(e,t,"padding")},l["outer"+e.ucfirst(t)]=function(e,n){var r=l.get(e);return r&&i(r,t,n?"margin":"border")},l[t]=function(e,n){var r=l.css(e,t,n);return r&&(r=parseFloat(r)),r},T[t]={get:function(e,n){var r;return n&&(r=i(e,t)+"px"),r}}});var x={position:"absolute",visibility:"hidden",display:"block"};e.each(["left","top"],function(e){T[e]={get:function(t,n){var r,o,i;if(n){if("static"===(i=l.css(t,"position")))return"auto";if((o="auto"===(r=l._getComputedStyle(t,e)))&&"relative"===i)return"0px";if(o||b.test(r)){if(i={top:0,left:0},"fixed"===l.css(t,"position"))o=t.getBoundingClientRect();else{for(r=t.offsetParent||(t.ownerDocument||g).body;r&&!D.test(r.nodeName)&&"static"===l.css(r,"position");)r=r.offsetParent;o=l.offset(t),(i=l.offset(r)).top=i.top+(parseFloat(l.css(r,"borderTopWidth"))||0),i.left=i.left+(parseFloat(l.css(r,"borderLeftWidth"))||0)}o.top=o.top-(parseFloat(l.css(t,"marginTop"))||0),o.left=o.left-(parseFloat(l.css(t,"marginLeft"))||0),r={top:o.top-i.top,left:o.left-i.left}[e]+"px"}}return r}}});var D=/^(?:body|html)$/i;return l}),KISSY.add("dom/base/selector",["./api"],function(e,t){function n(e){var t,n=this.length;for(t=0;t<n&&!1!==e(this[t],t);t++);}function r(e){if(!(e=e.substr(1)))throw Error("An invalid or illegal string was specified for selector.");return e}function o(e){return function(t){var n=d._getElementById(e,h);return n&&d._contains(t,n)?[n]:[]}}function i(e){return function(t){return t.getElementsByClassName(e)}}function a(e){return function(t){return t.getElementsByTagName(e)}}function s(t,u){var l,c,f="string"==typeof t,g=void 0!==u?s(u):(c=1)&&[h],y=g.length;if(t){if(f){if(t=E(t),c)if("body"===t)l=[h.body];else if(S.test(t)&&p)l=h.getElementsByClassName(RegExp.$1);else if(C.test(t))l=(c=d._getElementById(RegExp.$2,h))&&c.nodeName.toLowerCase()===RegExp.$1?[c]:[];else if(b.test(t))l=(c=d._getElementById(t.substr(1),h))?[c]:[];else if(T.test(t))l=h.getElementsByTagName(t);else if(!t.match(/,|\+|=|~|\[|\]|:|>|\||\$|\^|\*|\(|\)|[\w-]+\.[\w-]+|[\w-]+#[\w-]+/)&&p){var w,P,x=g;for(c=0,f=(l=t.split(/\s+/)).length;c<f;c++){var D;w=l,P=c,D="#"===(F=(D=l[c]).charAt(0))?o(r(D)):"."===F?i(r(D)):a(D),w[P]=D}for(c=0,f=l.length;c<f;c++){D=l[c];var A,F=[];for(w=0,P=x.length;w<P;w++)A=D(x[w]),F.push.apply(F,e.makeArray(A));if(!(x=F).length)break}l=x&&1<x.length?d.unique(x):x}if(!l){for(l=[],c=0;c<y;c++)I.apply(l,d._selectInternal(t,g[c]));1<l.length&&1<y&&d.unique(l)}}else if(l=t.nodeType||t.setTimeout?[t]:t.getDOMNodes?t.getDOMNodes():m(t)?t:v(t)?_(t):[t],!c)for(w=(f=l).length,l=[],c=0;c<w;c++)for(x=0;x<y;x++)if(d._contains(g[x],f[c])){l.push(f[c]);break}}else l=[];return l.each=n,l}function u(e,t){var n=e&&l(e,"class");return n&&(n=n.replace(/[\r\t\n]/g,y))&&-1<(y+n+y).indexOf(y+t+y)}function l(e,t){var n=e&&e.getAttributeNode(t);if(n&&n.specified)return n.nodeValue}function c(e,t){return"*"===t||e.nodeName.toLowerCase()===t.toLowerCase()}var d=t("./api"),h=e.Env.host.document,f=h.documentElement,g=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector,p="getElementsByClassName"in h,m=e.isArray,_=e.makeArray,v=d.isDomNodeList,y=" ",I=Array.prototype.push,S=/^\.([\w-]+)$/,b=/^#([\w-]+)$/,T=/^([\w-])+$/,C=/^([\w-]+)#([\w-]+)$/,w=/^(?:#([\w-]+))?\s*([\w-]+|\*)?\.?([\w-]+)?$/,E=e.trim;return e.mix(d,{_compareNodeOrder:function(e,t){return e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t)?-1:1:e.compareDocumentPosition?-1:1},_getElementsByTagName:function(t,n){return e.makeArray(n.querySelectorAll(t))},_getElementById:function(e,t){return t.getElementById(e)},_getSimpleAttr:l,_isTag:c,_hasSingleClass:u,_matchesInternal:function(e,t){for(var n,r=[],o=0,i=t.length;o<i;o++)n=t[o],g.call(n,e)&&r.push(n);return r},_selectInternal:function(e,t){return _(t.querySelectorAll(e))},query:s,get:function(e,t){return s(e,t)[0]||null},unique:function(){function e(e,n){return e===n?(t=!0,0):d._compareNodeOrder(e,n)}var t,n=!0;return[0,0].sort(function(){return n=!1,0}),function(r){if(t=n,r.sort(e),t)for(var o=1,i=r.length;o<i;)r[o]===r[o-1]?(r.splice(o,1),--i):o++;return r}}(),filter:function(t,n,r){var o,i,a,h;t=s(t,r),r=[];return"string"==typeof n&&(n=E(n))&&(a=w.exec(n))&&(o=a[1],i=a[2],h=a[3],o?o&&!i&&!h&&(n=function(e){return l(e,"id")===o}):n=function(e){var t=!0,n=!0;return i&&(t=c(e,i)),h&&(n=u(e,h)),n&&t}),"function"==typeof n?e.filter(t,n):d._matchesInternal(n,t)},test:function(e,t,n){return(e=s(e,n)).length&&d.filter(e,t,n).length===e.length}}),d}),KISSY.add("dom/base/traversal",["./api"],function(e,t){function n(t,n,o,s,u,l,c){if(!(t=i.get(t)))return null;if(0===n)return t;if(l||(t=t[o]),!t)return null;u=u&&i.get(u)||null,void 0===n&&(n=1);l=[];var d,h,f=e.isArray(n);for("number"==typeof n&&(d=0,h=n,n=function(){return++d===h});t&&t!==u&&(!(t.nodeType===a.ELEMENT_NODE||t.nodeType===a.TEXT_NODE&&c)||!r(t,n)||s&&!s(t)||(l.push(t),f));)t=t[o];return f?l:l[0]||null}function r(t,n){if(!n)return!0;if(e.isArray(n)){var r,o=n.length;if(!o)return!0;for(r=0;r<o;r++)if(i.test(t,n[r]))return!0}else if(i.test(t,n))return!0;return!1}function o(t,n,r,o){var s,u,l=[];if((s=t=i.get(t))&&r&&(s=t.parentNode),s){for(r=e.makeArray(s.childNodes),s=0;s<r.length;s++)u=r[s],(o||u.nodeType===a.ELEMENT_NODE)&&u!==t&&l.push(u);n&&(l=i.filter(l,n))}return l}var i=t("./api"),a=i.NodeType;return e.mix(i,{_contains:function(e,t){return!!(16&e.compareDocumentPosition(t))},closest:function(e,t,r,o){return n(e,t,"parentNode",function(e){return e.nodeType!==a.DOCUMENT_FRAGMENT_NODE},r,!0,o)},parent:function(e,t,r){return n(e,t,"parentNode",function(e){return e.nodeType!==a.DOCUMENT_FRAGMENT_NODE},r,void 0)},first:function(e,t,r){return n((e=i.get(e))&&e.firstChild,t,"nextSibling",void 0,void 0,!0,r)},last:function(e,t,r){return n((e=i.get(e))&&e.lastChild,t,"previousSibling",void 0,void 0,!0,r)},next:function(e,t,r){return n(e,t,"nextSibling",void 0,void 0,void 0,r)},prev:function(e,t,r){return n(e,t,"previousSibling",void 0,void 0,void 0,r)},siblings:function(e,t,n){return o(e,t,!0,n)},children:function(e,t){return o(e,t,void 0)},contents:function(e,t){return o(e,t,void 0,1)},contains:function(e,t){return e=i.get(e),t=i.get(t),!(!e||!t)&&i._contains(e,t)},index:function(t,n){var r,o=i.query(t),s=0;if(r=o[0],!n){if(!(o=r&&r.parentNode))return-1;for(;r=r.previousSibling;)r.nodeType===a.ELEMENT_NODE&&s++;return s}return s=i.query(n),"string"==typeof n?e.indexOf(r,s):e.indexOf(s[0],o)},equals:function(e,t){if(e=i.query(e),t=i.query(t),e.length!==t.length)return!1;for(var n=e.length;0<=n;n--)if(e[n]!==t[n])return!1;return!0}}),i}),KISSY.add("dom/base","./base/api,./base/attr,./base/class,./base/create,./base/data,./base/insertion,./base/offset,./base/style,./base/selector,./base/traversal".split(","),function(e,t){var n=t("./base/api");return t("./base/attr"),t("./base/class"),t("./base/create"),t("./base/data"),t("./base/insertion"),t("./base/offset"),t("./base/style"),t("./base/selector"),t("./base/traversal"),e.mix(e,{DOM:n,get:n.get,query:n.query}),n}),KISSY.add("event/custom/observer",["event/base"],function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}var r=t("event/base");return e.extend(n,r.Observer,{keys:["fn","context","groups"]}),n}),KISSY.add("event/custom/object",["event/base"],function(e,t){function n(t){n.superclass.constructor.call(this),e.mix(this,t)}var r=t("event/base");return e.extend(n,r.Object),n}),KISSY.add("event/custom/observable",["event/base","./observer","./object"],function(e,t){function n(){n.superclass.constructor.apply(this,arguments),this.defaultFn=null,this.defaultTargetOnly=!1,this.bubbles=!0}var r=t("event/base"),o=t("./observer"),i=t("./object"),a=r.Utils;return e.extend(n,r.Observable,{on:function(t){t=new o(t),e.Config.debug&&(t.fn||this.type),-1===this.findObserver(t)&&this.observers.push(t)},fire:function(e){e=e||{};var t,n,r,o=this.bubbles,a=this.currentTarget,s=this.type,u=this.defaultFn,l=e;if(e.type=s,l instanceof i||(l.target=a,l=new i(l)),l.currentTarget=a,e=this.notify(l),!1!==r&&void 0!==e&&(r=e),o&&!l.isPropagationStopped())for(t=(o=a.getTargets())&&o.length||0,n=0;n<t&&!l.isPropagationStopped();n++)e=o[n].fire(s,l),!1!==r&&void 0!==e&&(r=e);return u&&!l.isDefaultPrevented()&&(e=(s=l.target).getCustomEventObservable(l.type),!this.defaultTargetOnly&&!e.defaultTargetOnly||a===s)&&(r=u.call(a,l)),r},notify:function(e){var t,n,r,o=[].concat(this.observers),i=o.length;for(r=0;r<i&&!e.isImmediatePropagationStopped();r++)t=o[r].notify(e,this),!1!==n&&void 0!==t&&(n=t);return n},detach:function(e){var t,n=e.fn,r=e.context,o=this.currentTarget,i=this.observers;e=e.groups;if(i.length){e&&(t=a.getGroupsRe(e));var s,u,l,c=i.length;if(n||t){for(r=r||o,s=e=0,u=[];e<c;++e)(r!==((l=i[e]).context||o)||n&&n!==l.fn||t&&!l.groups.match(t))&&(u[s++]=l);this.observers=u}else this.reset()}}}),n}),KISSY.add("event/custom/target",["event/base","./observable"],function(e,t){var n=t("event/base"),r=t("./observable"),o=n.Utils,i=o.splitAndRun;return{isTarget:1,getCustomEventObservable:function(e,t){var n,o=this.getCustomEvents();return!(n=o&&o[e])&&t&&(n=o[e]=new r({currentTarget:this,type:e})),n},fire:function(e,t){var n,a=this,s=a.getTargets(),u=s&&s.length;t=t||{};return i(e,function(e){var i;if(o.fillGroupsForEvent(e,t),e=t.type,(i=a.getCustomEventObservable(e))||u){if(i){if(!i.hasObserver()&&!i.defaultFn&&(i.bubbles&&!u||!i.bubbles))return}else i=new r({currentTarget:a,type:e});e=i.fire(t),!1!==n&&void 0!==e&&(n=e)}}),n},publish:function(t,n){var r,o=this;return i(t,function(t){r=o.getCustomEventObservable(t,!0),e.mix(r,n)}),o},addTarget:function(t){var n=this.getTargets();return e.inArray(t,n)||n.push(t),this},removeTarget:function(t){var n=this.getTargets();return-1!==(t=e.indexOf(t,n))&&n.splice(t,1),this},getTargets:function(){return this["__~ks_bubble_targets"]||(this["__~ks_bubble_targets"]=[])},getCustomEvents:function(){return this["__~ks_custom_events"]||(this["__~ks_custom_events"]={})},on:function(e,t,n){var r=this;return o.batchForType(function(e,t,n){e=(t=o.normalizeParam(e,t,n)).type,(e=r.getCustomEventObservable(e,!0))&&e.on(t)},0,e,t,n),r},detach:function(t,n,r){var i=this;return o.batchForType(function(t,n,r){var a=o.normalizeParam(t,n,r);(t=a.type)?(t=i.getCustomEventObservable(t,!0))&&t.detach(a):(t=i.getCustomEvents(),e.each(t,function(e){e.detach(a)}))},0,t,n,r),i}}}),KISSY.add("event/custom",["./custom/target"],function(e,t){var n=t("./custom/target");return{Target:n,global:e.mix({},n)}}),KISSY.add("event/base/utils",[],function(e){function t(e){if(0>e.indexOf("."))return[e,""];var t=e.match(/([^.]+)?(\..+)?$/);e=[t[1]];return(t=t[2])?(t=t.split(".").sort(),e.push(t.join("."))):e.push(""),e}var n,r;return{splitAndRun:n=function(t,n){e.isArray(t)?e.each(t,n):-1===(t=e.trim(t)).indexOf(" ")?n(t):e.each(t.split(/\s+/),n)},normalizeParam:function(n,r,o){var i=r||{};i="function"==typeof r?{fn:r,context:o}:e.merge(i),n=(r=t(n))[0];return i.groups=r[1],i.type=n,i},batchForType:function(t,r){var o=e.makeArray(arguments),i=o[2+r];i&&"object"==typeof i?e.each(i,function(e,n){var i=[].concat(o);i.splice(0,2),i[r]=n,i[r+1]=e,t.apply(null,i)}):n(i,function(e){var n=[].concat(o);n.splice(0,2),n[r]=e,t.apply(null,n)})},fillGroupsForEvent:function(e,n){var o=t(e),i=o[1];i&&(i=r(i),n._ksGroups=i),n.type=o[0]},getGroupsRe:r=function(e){return RegExp(e.split(".").join(".*\\.")+"(?:\\.|$)")}}}),KISSY.add("event/base/object",[],function(e,t){function n(){this.timeStamp=e.now(),this.currentTarget=this.target=t}var r=function(){return!1},o=function(){return!0};return n.prototype={constructor:n,isDefaultPrevented:r,isPropagationStopped:r,isImmediatePropagationStopped:r,preventDefault:function(){this.isDefaultPrevented=o},stopPropagation:function(){this.isPropagationStopped=o},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=o,this.stopPropagation()},halt:function(e){e?this.stopImmediatePropagation():this.stopPropagation(),this.preventDefault()}},n}),KISSY.add("event/base/observer",[],function(e,t){function n(t){e.mix(this,t)}return n.prototype={constructor:n,equals:function(t){var n=this;return!!e.reduce(n.keys,function(e,r){return e&&n[r]===t[r]},1)},simpleNotify:function(e,t){var n;return n=this.fn.call(this.context||t.currentTarget,e,this.data),this.once&&t.removeObserver(this),n},notifyInternal:function(e,t){var n=this.simpleNotify(e,t);return!1===n&&e.halt(),n},notify:function(e,n){var r=e._ksGroups;return!r||this.groups&&this.groups.match(r)?this.notifyInternal(e,n):t}},n}),KISSY.add("event/base/observable",[],function(e){function t(t){this.currentTarget=null,e.mix(this,t),this.reset()}return t.prototype={constructor:t,hasObserver:function(){return!!this.observers.length},reset:function(){this.observers=[]},removeObserver:function(e){var t,n=this.observers,r=n.length;for(t=0;t<r;t++)if(n[t]===e){n.splice(t,1);break}this.checkMemory()},checkMemory:function(){},findObserver:function(e){var t,n=this.observers;for(t=n.length-1;0<=t;--t)if(e.equals(n[t]))return t;return-1}},t}),KISSY.add("event/base",["./base/utils","./base/object","./base/observer","./base/observable"],function(e,t){return{Utils:t("./base/utils"),Object:t("./base/object"),Observer:t("./base/observer"),Observable:t("./base/observable")}}),KISSY.add("promise",[],function(e){function t(e){"undefined"!=typeof console&&console.error&&console.error(e)}function n(e,t,r){if(e instanceof a)d(function(){r.call(e,e[c])});else{var i=e[c],s=e[f];s?s.push([t,r]):o(i)?n(i,t,r):t&&d(function(){t.call(e,i)})}}function r(e){if(!(this instanceof r))return new r(e);this.promise=e||new i,this.promise.defer=this}function o(e){return e&&e instanceof i}function i(e){this[c]=e,void 0===e&&(this[f]=[],this[h]=[])}function a(e){return e instanceof a?e:(i.apply(this,arguments),this[c],this)}function s(e,o,s){function u(e){c||(e instanceof i||(c=1,l.resolve(function(e){try{return o?o.call(this,e):e}catch(e){return t(e.stack||e),new a(e)}}.call(this,e))))}var l=new r,c=0;return e instanceof i?n(e,u,function(e){c||(c=1,l.resolve(function(e){try{return s?s.call(this,e):new a(e)}catch(e){return t(e.stack||e),new a(e)}}.call(this,e)))}):u(e),l.promise}function u(e){return!l(e)&&o(e)&&void 0===e[f]&&(!o(e[c])||u(e[c]))}function l(e){return o(e)&&void 0===e[f]&&e[c]instanceof a}var c="__promise_value",d=e.setImmediate,h="__promise_progress_listeners",f="__promise_pendings";return r.prototype={constructor:r,resolve:function(t){var r,o=this.promise;return(r=o[f])?(o[c]=t,r=[].concat(r),o[f]=void 0,o[h]=void 0,e.each(r,function(e){n(o,e[0],e[1])}),t):null},reject:function(e){return this.resolve(new a(e))},notify:function(t){e.each(this.promise[h],function(e){d(function(){e(t)})})}},i.prototype={constructor:i,then:function(e,t,n){return n&&this.progress(n),s(this,e,t)},progress:function(e){return this[h]&&this[h].push(e),this},fail:function(e){return s(this,0,e)},fin:function(e){return s(this,function(t){return e(t,!0)},function(t){return e(t,!1)})},done:function(e,t){(e||t?this.then(e,t):this).fail(function(e){e.stack,setTimeout(function(){throw e},0)})},isResolved:function(){return u(this)},isRejected:function(){return l(this)}},e.extend(a,i),KISSY.Defer=r,KISSY.Promise=i,i.Defer=r,e.mix(i,{when:s,isPromise:o,isResolved:u,isRejected:l,all:function(e){var t=e.length;if(!t)return null;for(var n=new r,o=0;o<e.length;o++)!function(r,o){s(r,function(r){e[o]=r,0==--t&&n.resolve(e)},function(e){n.reject(e)})}(e[o],o);return n.promise},async:function(e){return function(){function t(e,t){var i;try{i=o[e](t)}catch(e){return new a(e)}return i.done?i.value:s(i.value,n,r)}function n(e){return t("next",e)}function r(e){return t("throw",e)}var o=e.apply(this,arguments);return n()}}}),i}),KISSY.add("event/dom/base/utils",["dom"],function(e,t){var n=t("dom"),r="ksEventTargetId_"+e.now(),o=e.Env.host.document;return{simpleAdd:o&&o.addEventListener?function(e,t,n,r){e.addEventListener&&e.addEventListener(t,n,!!r)}:function(e,t,n){e.attachEvent&&e.attachEvent("on"+t,n)},simpleRemove:o&&o.removeEventListener?function(e,t,n,r){e.removeEventListener&&e.removeEventListener(t,n,!!r)}:function(e,t,n){e.detachEvent&&e.detachEvent("on"+t,n)},data:function(e,t){return n.data(e,r,t)},removeData:function(e){return n.removeData(e,r)}}}),KISSY.add("event/dom/base/special",[],function(){return{}}),KISSY.add("event/dom/base/observer",["event/base","./special"],function(e,t){function n(e){n.superclass.constructor.call(this,e)}var r=t("event/base"),o=t("./special");return e.extend(n,r.Observer,{keys:"fn,filter,data,context,originalType,groups,last".split(","),notifyInternal:function(e,t){var n,r,i,a=e.type;return(i=this.originalType)?e.type=i:i=a,(n=o[i])&&n.handle?(n=n.handle(e,this,t))&&0<n.length&&(r=n[0]):r=this.simpleNotify(e,t),!1===r&&e.halt(),e.type=a,r}}),n}),KISSY.add("event/dom/base/object",["event/base"],function(e,t){function n(){return s}function r(){return u}function o(t){var i=t.type;o.superclass.constructor.call(this),this.originalEvent=t;var s=r;"defaultPrevented"in t?s=t.defaultPrevented?n:r:"getPreventDefault"in t?s=t.getPreventDefault()?n:r:"returnValue"in t&&(s=t.returnValue===u?n:r),this.isDefaultPrevented=s;var d,h=[],f=l.concat();for(e.each(c,function(e){i.match(e.reg)&&(f=f.concat(e.props),e.fix&&h.push(e.fix))}),s=f.length;s;)this[d=f[--s]]=t[d];for(this.target||(this.target=t.srcElement||a),3===this.target.nodeType&&(this.target=this.target.parentNode),s=h.length;s;)(d=h[--s])(this,t)}var i=t("event/base"),a=e.Env.host.document,s=!0,u=!1,l="altKey,bubbles,cancelable,ctrlKey,currentTarget,eventPhase,metaKey,shiftKey,target,timeStamp,view,type".split(","),c=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(e,t){null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),void 0===e.metaKey&&(e.metaKey=e.ctrlKey)}},{reg:/^touch/,props:["touches","changedTouches","targetTouches"]},{reg:/^gesturechange$/i,props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(e,t){var n,r,o,i=t.wheelDelta,a=t.axis,s=t.wheelDeltaY,u=t.wheelDeltaX,l=t.detail;i&&(o=i/120),l&&(o=-(0==l%3?l/3:l)),void 0!==a&&(a===e.HORIZONTAL_AXIS?(r=0,n=-1*o):a===e.VERTICAL_AXIS&&(n=0,r=o)),void 0!==s&&(r=s/120),void 0!==u&&(n=-1*u/120),!n&&!r&&(r=o),void 0!==n&&(e.deltaX=n),void 0!==r&&(e.deltaY=r),void 0!==o&&(e.delta=o)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,props:"buttons,clientX,clientY,button,offsetX,relatedTarget,which,fromElement,toElement,offsetY,pageX,pageY,screenX,screenY".split(","),fix:function(e,t){var n,r,o=e.target,i=t.button;return null==e.pageX&&null!=t.clientX&&(r=(n=o.ownerDocument||a).documentElement,n=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||n&&n.scrollLeft||0)-(r&&r.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||n&&n.scrollTop||0)-(r&&r.clientTop||n&&n.clientTop||0)),!e.which&&void 0!==i&&(e.which=1&i?1:2&i?3:4&i?2:0),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===o?e.toElement:e.fromElement),e}}];return e.extend(o,i.Object,{constructor:o,preventDefault:function(){var e=this.originalEvent;e.preventDefault?e.preventDefault():e.returnValue=u,o.superclass.preventDefault.call(this)},stopPropagation:function(){var e=this.originalEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=s,o.superclass.stopPropagation.call(this)}}),o}),KISSY.add("event/dom/base/observable","event/base,dom,./special,./utils,./observer,./object".split(","),function(e,t){function n(t){e.mix(this,t),this.reset()}var r=t("event/base"),o=t("dom"),i=t("./special"),a=t("./utils"),s=t("./observer"),u=t("./object"),l=r.Utils;return e.extend(n,r.Observable,{setup:function(){var e=this.type,t=i[e]||{},n=this.currentTarget,r=a.data(n).handle;(!t.setup||!1===t.setup.call(n,e))&&a.simpleAdd(n,e,r)},constructor:n,reset:function(){n.superclass.reset.call(this),this.lastCount=this.delegateCount=0},notify:function(e){var t,n,r,i,a=e.target,s=e.type,u=this.currentTarget,l=this.observers,c=[],d=this.delegateCount||0;if(d&&a.nodeType)for(;a!==u;){if(!0!==a.disabled||"click"!==s){var h,f,g,p={};for(r=[],n=0;n<d;n++)void 0===(h=p[f=(g=(i=l[n]).filter)+""])&&(h=p[f]=o.test(a,g)),h&&r.push(i);r.length&&c.push({currentTarget:a,currentTargetObservers:r})}a=a.parentNode||u}for(d<l.length&&c.push({currentTarget:u,currentTargetObservers:l.slice(d)}),n=0,a=c.length;!e.isPropagationStopped()&&n<a;++n)for(r=(s=c[n]).currentTargetObservers,s=s.currentTarget,e.currentTarget=s,s=0;!e.isImmediatePropagationStopped()&&s<r.length;s++)u=(u=r[s]).notify(e,this),!1!==t&&void 0!==u&&(t=u);return t},fire:function(t,r){t=t||{};var a,s,l=""+this.type;a=!1!==(g=i[l]||{}).bubbles;var c=this.currentTarget;if(!(g.fire&&!1===g.fire.call(c,r)||(t instanceof u||(s=t,t=new u({currentTarget:c,type:l,target:c}),e.mix(t,s)),g.preFire&&!1===g.preFire.call(c,t,r)))){s=c;var d,h=o.getWindow(s),f=h.document,g=[],p="on"+l,m=0;do{g.push(s),s=s.parentNode||s.ownerDocument||s===f&&h}while(!r&&s&&a);s=g[m];do{t.currentTarget=s,(a=n.getDomEventObservable(s,l))&&void 0!==(a=a.notify(t))&&!1!==d&&(d=a),s[p]&&!1===s[p].call(s)&&t.preventDefault(),s=g[++m]}while(!r&&s&&!t.isPropagationStopped());if(!r&&!t.isDefaultPrevented()){try{c[l]&&!e.isWindow(c)&&(n.triggeredEvent=l,c[l]())}catch(e){}n.triggeredEvent=""}return d}},on:function(t){var n=this.observers,r=i[this.type]||{};t=t instanceof s?t:new s(t);e.Config.debug&&(t.fn||this.type),-1===this.findObserver(t)&&(t.filter?(n.splice(this.delegateCount,0,t),this.delegateCount++):t.last?(n.push(t),this.lastCount++):n.splice(n.length-this.lastCount,0,t),r.add&&r.add.call(this.currentTarget,t))},detach:function(e){var t,n=i[this.type]||{},r="filter"in e,o=e.filter,a=e.context,s=e.fn,u=this.currentTarget,c=this.observers;e=e.groups;if(c.length){e&&(t=l.getGroupsRe(e));var d,h,f,g=c.length;if(s||r||t){for(a=a||u,d=e=0,h=[];e<g;++e)a!==((f=c[e]).context||u)||s&&s!==f.fn||r&&(o&&o!==f.filter||!o&&!f.filter)||t&&!f.groups.match(t)?h[d++]=f:(f.filter&&this.delegateCount&&this.delegateCount--,f.last&&this.lastCount&&this.lastCount--,n.remove&&n.remove.call(u,f));this.observers=h}else this.reset();this.checkMemory()}},checkMemory:function(){var t,n,r=this.type,o=i[r]||{},s=this.currentTarget,u=a.data(s);u&&(t=u.observables,this.hasObserver()||(n=u.handle,(!o.tearDown||!1===o.tearDown.call(s,r))&&a.simpleRemove(s,r,n),delete t[r]),e.isEmptyObject(t)&&(u.handle=null,a.removeData(s)))}}),n.triggeredEvent="",n.getDomEventObservable=function(e,t){var n,r=a.data(e);return r&&(n=r.observables),n?n[t]:null},n.getDomEventObservablesHolder=function(e,t){var n=a.data(e);return!n&&t&&a.data(e,n={}),n},n}),KISSY.add("event/dom/base/dom-event","event/base,./utils,dom,./special,./observable,./object".split(","),function(e,t){function n(e,t){var n,r=u[t]||{};return!e.originalType&&(n=r.typeFix)&&(e.originalType=t,t=n),t}function r(t,r,o){var i,a,s;r=n(o=e.merge(o),r);i=l.getDomEventObservablesHolder(t,1),(s=i.handle)||((s=i.handle=function(e){var t=e.type,n=s.currentTarget;if(l.triggeredEvent!==t&&void 0!==KISSY&&(t=l.getDomEventObservable(n,t)))return e.currentTarget=n,e=new c(e),t.notify(e)}).currentTarget=t),(a=i.observables)||(a=i.observables={}),(i=a[r])||(i=a[r]=new l({type:r,currentTarget:t})).setup(),i.on(o),t=null}function o(t,r,o){r=n(o=e.merge(o),r);var i=((t=l.getDomEventObservablesHolder(t))||{}).observables;if(t&&i)if(r)(r=i[r])&&r.detach(o);else for(r in i)i[r].detach(o)}var i=t("event/base"),a=t("./utils"),s=t("dom"),u=t("./special"),l=t("./observable"),c=t("./object"),d=i.Utils,h={on:function(e,t,n,o){return e=s.query(e),d.batchForType(function(e,t,n,o){for(t=(n=d.normalizeParam(t,n,o)).type,o=e.length-1;o>=0;o--)r(e[o],t,n)},1,e,t,n,o),e},detach:function(e,t,n,r){return e=s.query(e),d.batchForType(function(e,t,n,r){var i,a;for(t=(n=d.normalizeParam(t,n,r)).type,r=e.length-1;r>=0;r--)if(o(i=e[r],t,n),n.deep&&i.getElementsByTagName)for(i=(a=i.getElementsByTagName("*")).length-1;i>=0;i--)o(a[i],t,n)},1,e,t,n,r),e},delegate:function(e,t,n,r,o){return h.on(e,t,{fn:r,context:o,filter:n})},undelegate:function(e,t,n,r,o){return h.detach(e,t,{fn:r,context:o,filter:n})},fire:function(e,t,n,r){var o;return(n=n||{}).synthetic=1,d.splitAndRun(t,function(t){var i,a,c;for(d.fillGroupsForEvent(t,n),t=n.type,(a=u[t])&&a.typeFix&&(t=a.typeFix),a=(e=s.query(e)).length-1;a>=0;a--)i=e[a],c=l.getDomEventObservable(i,t),!r&&!c&&(c=new l({type:t,currentTarget:i})),c&&(i=c.fire(n,r),!1!==o&&void 0!==i&&(o=i))}),o},fireHandler:function(e,t,n){return h.fire(e,t,n,1)},clone:function(t,n){var o;if(o=l.getDomEventObservablesHolder(t)){var i=a.data(t);i&&i===a.data(n)&&a.removeData(n),e.each(o.observables,function(t,o){e.each(t.observers,function(e){r(n,o,e)})})}}};return h}),KISSY.add("event/dom/base/key-codes",[],function(e){var t=e.UA,n={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=n.F1&&t<=n.F12)return!1;switch(t){case n.ALT:case n.CAPS_LOCK:case n.CONTEXT_MENU:case n.CTRL:case n.DOWN:case n.END:case n.ESC:case n.HOME:case n.INSERT:case n.LEFT:case n.MAC_FF_META:case n.META:case n.NUMLOCK:case n.NUM_CENTER:case n.PAGE_DOWN:case n.PAGE_UP:case n.PAUSE:case n.PRINT_SCREEN:case n.RIGHT:case n.SHIFT:case n.UP:case n.WIN_KEY:case n.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=n.ZERO&&e<=n.NINE||e>=n.NUM_ZERO&&e<=n.NUM_MULTIPLY||e>=n.A&&e<=n.Z||t.webkit&&0===e)return!0;switch(e){case n.SPACE:case n.QUESTION_MARK:case n.NUM_PLUS:case n.NUM_MINUS:case n.NUM_PERIOD:case n.NUM_DIVISION:case n.SEMICOLON:case n.DASH:case n.EQUALS:case n.COMMA:case n.PERIOD:case n.SLASH:case n.APOSTROPHE:case n.SINGLE_QUOTE:case n.OPEN_SQUARE_BRACKET:case n.BACKSLASH:case n.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};return n}),KISSY.add("event/dom/base/gesture",[],function(){return{start:"mousedown",move:"mousemove",end:"mouseup",tap:"click",singleTap:"click",doubleTap:"dblclick"}}),KISSY.add("event/dom/base/special-events",["./dom-event","./special"],function(e,t){var n=t("./dom-event"),r=t("./special");return e.mix(r,{mousewheel:{typeFix:e.UA.gecko?"DOMMouseScroll":"mousewheel"},load:{bubbles:!1},click:{fire:function(e){if(!e&&"checkbox"==""+this.type&&this.click&&"input"===this.nodeName.toLowerCase())return this.click(),!1}},focus:{bubbles:!1,preFire:function(e,t){if(!t)return n.fire(this,"focusin")},fire:function(e){if(!e&&this.ownerDocument&&this!==this.ownerDocument.activeElement&&this.focus)return this.focus(),!1}},blur:{bubbles:!1,preFire:function(e,t){if(!t)return n.fire(this,"focusout")},fire:function(e){if(!e&&this.ownerDocument&&this===this.ownerDocument.activeElement&&this.blur)return this.blur(),!1}}})}),KISSY.add("event/dom/base/mouseenter",["dom","./special"],function(e,t){var n=t("dom"),r=t("./special");e.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(e){r[e.name]={typeFix:e.fix,handle:function(e,t,r){var o=e.currentTarget,i=e.relatedTarget;if(!i||i!==o&&!n.contains(o,i))return[t.simpleNotify(e,r)]}}})}),KISSY.add("event/dom/base/valuechange",["dom","./dom-event","./special"],function(e,t){function n(e){if(u.hasData(e,g)){var t=u.data(e,g);clearTimeout(t),u.removeData(e,g)}}function r(e){n(e.target)}function o(e){var t=e.value,n=u.data(e,f);t!==n&&(l.fireHandler(e,d,{prevVal:n,newVal:t}),u.data(e,f,t))}function i(e){var t,n=e.target;"focus"===e.type&&u.data(n,f,n.value),t=n,u.hasData(t,g)||u.data(t,g,setTimeout(function e(){o(t),u.data(t,g,setTimeout(e,p))},p))}function a(e){o(e.target)}function s(e){u.removeData(e,f),n(e),l.detach(e,"blur",r),l.detach(e,"webkitspeechchange",a),l.detach(e,"mousedown keyup keydown focus",i)}var u=t("dom"),l=t("./dom-event"),c=t("./special"),d="valuechange",h=u.nodeName,f="event/valuechange/history",g="event/valuechange/poll",p=50;return c[d]={setup:function(){var e=h(this);"input"!==e&&"textarea"!==e||(s(this),l.on(this,"blur",r),l.on(this,"webkitspeechchange",a),l.on(this,"mousedown keyup keydown focus",i))},tearDown:function(){s(this)}},l}),KISSY.add("event/dom/base","./base/dom-event,./base/object,./base/key-codes,./base/gesture,./base/special-events,./base/mouseenter,./base/valuechange".split(","),function(e,t){var n=t("./base/dom-event"),r=t("./base/object"),o=t("./base/key-codes"),i=t("./base/gesture"),a=t("./base/special-events");return t("./base/mouseenter"),t("./base/valuechange"),e.merge({add:n.on,remove:n.detach,KeyCode:o,Gesture:i,Special:a,Object:r},n)}),KISSY.add("event/dom/shake",["event/dom/base"],function(e,t){function n(e){e=(a=e.accelerationIncludingGravity).x;var t,n=a.y,a=a.z;void 0!==r&&((t=d(h(e-r),h(n-o),h(a-i)))>u&&g(),t>l&&(c=1)),r=e,o=n,i=a}var r,o,i,a=t("event/dom/base"),s=a.Special,u=5,l=20,c=0,d=Math.max,h=Math.abs,f=e.Env.host,g=e.buffer(function(){c&&(a.fireHandler(f,"shake",{accelerationIncludingGravity:{x:r,y:o,z:i}}),r=void 0,c=0)},250);s.shake={setup:function(){this===f&&f.addEventListener("devicemotion",n,!1)},tearDown:function(){this===f&&(g.stop(),r=void 0,c=0,f.removeEventListener("devicemotion",n,!1))}}}),KISSY.add("event/dom/focusin",["event/dom/base"],function(e,t){var n=t("event/dom/base"),r=n.Special;return e.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(t){function o(e){return n.fire(e.target,t.name)}var i=e.guid("attaches_"+e.now()+"_");r[t.name]={setup:function(){var e=this.ownerDocument||this;i in e||(e[i]=0),e[i]+=1,1===e[i]&&e.addEventListener(t.fix,o,!0)},tearDown:function(){var e=this.ownerDocument||this;e[i]-=1,0===e[i]&&e.removeEventListener(t.fix,o,!0)}}}),n}),KISSY.add("node/base",["dom","event/dom"],function(e,t){function n(t,o,i){if(!(this instanceof n))return new n(t,o,i);if(!t)return this;if("string"==typeof t){if((t=r.create(t,o,i)).nodeType===s.DOCUMENT_FRAGMENT_NODE)return u.apply(this,l(t.childNodes)),this}else if(e.isArray(t)||c(t))return u.apply(this,l(t)),this;return this[0]=t,this.length=1,this}var r=t("dom"),o=t("event/dom"),i=Array.prototype,a=i.slice,s=r.NodeType,u=i.push,l=e.makeArray,c=r.isDomNodeList;return n.prototype={constructor:n,isNodeList:!0,length:0,item:function(e){return"number"==typeof e?e>=this.length?null:new n(this[e]):new n(e)},add:function(e,t,r){return"number"==typeof t&&(r=t,t=void 0),e=n.all(e,t).getDOMNodes(),t=new n(this),void 0===r?u.apply(t,e):((r=[r,0]).push.apply(r,e),i.splice.apply(t,r)),t},slice:function(){return new n(a.apply(this,arguments))},getDOMNodes:function(){return a.call(this)},each:function(t,r){var o=this;return e.each(o,function(e,i){return e=new n(e),t.call(r||e,e,i,o)}),o},getDOMNode:function(){return this[0]},end:function(){return this.__parent||this},filter:function(e){return new n(r.filter(this,e))},all:function(e){return(e=0<this.length?n.all(e,this):new n).__parent=this,e},one:function(e){return(e=(e=this.all(e)).length?e.slice(0,1):null)&&(e.__parent=this),e}},e.mix(n,{all:function(t,o){return"string"==typeof t&&(t=e.trim(t))&&3<=t.length&&e.startsWith(t,"<")&&e.endsWith(t,">")?(o&&(o.getDOMNode&&(o=o[0]),o=o.ownerDocument||o),new n(t,void 0,o)):new n(r.query(t,o))},one:function(e,t){var r=n.all(e,t);return r.length?r.slice(0,1):null}}),n.NodeType=s,n.KeyCode=o.KeyCode,n.Gesture=o.Gesture,n.REPLACE_HISTORY=o.REPLACE_HISTORY,n}),KISSY.add("node/attach",["dom","event/dom","./base"],function(e,t){function n(e,t,n){return n.unshift(t),void 0===(e=r[e].apply(r,n))?t:e}var r=t("dom"),o=t("event/dom"),i=t("./base"),a=i.prototype,s=e.makeArray;i.KeyCode=o.KeyCode,e.each("nodeName,isCustomDomain,getEmptyIframeSrc,equals,contains,index,scrollTop,scrollLeft,height,width,innerHeight,innerWidth,outerHeight,outerWidth,addStyleSheet,appendTo,prependTo,insertBefore,before,after,insertAfter,test,hasClass,addClass,removeClass,replaceClass,toggleClass,removeAttr,hasAttr,hasProp,scrollIntoView,remove,empty,removeData,hasData,unselectable,wrap,wrapAll,replaceWith,wrapInner,unwrap".split(","),function(e){a[e]=function(){var t=s(arguments);return n(e,this,t)}}),e.each("getWindow,getDocument,filter,first,last,parent,closest,next,prev,clone,siblings,contents,children".split(","),function(e){a[e]=function(){var t=s(arguments);return t.unshift(this),void 0===(t=r[e].apply(r,t))?this:null===t?null:new i(t)}}),e.each({attr:1,text:0,css:1,style:1,val:0,prop:1,offset:0,html:0,outerHTML:0,outerHtml:0,data:1},function(t,o){a[o]=function(){var i;return void 0!==(i=s(arguments))[t]||e.isObject(i[0])?i=n(o,this,i):(i.unshift(this),i=r[o].apply(r,i)),i}}),e.each(["on","detach","delegate","undelegate"],function(e){a[e]=function(){var t=s(arguments);return t.unshift(this),o[e].apply(o,t),this}}),e.each(["fire","fireHandler"],function(e){a[e]=function(){var t=s(arguments);return t.unshift(this),o[e].apply(o,t)}})}),KISSY.add("node/override",["dom","./base","./attach"],function(e,t){var n=t("dom"),r=t("./base");t("./attach");var o=r.prototype;e.each(["append","prepend","before","after"],function(e){o[e]=function(t){return"string"==typeof t&&(t=n.create(t)),t&&n[e](t,this),this}}),e.each(["wrap","wrapAll","replaceWith","wrapInner"],function(e){var t=o[e];o[e]=function(e){return"string"==typeof e&&(e=r.all(e,this[0].ownerDocument)),t.call(this,e)}})}),KISSY.add("node/anim",["./base","dom","anim"],function(e,t){function n(e,t,n){var r=[],o={};for(n=n||0;n<t;n++)r.push.apply(r,a[n]);for(n=0;n<r.length;n++)o[r[n]]=e;return o}var r=t("./base"),o=t("dom"),i=t("anim"),a=[["height","margin-top","margin-bottom","padding-top","padding-bottom"],["width","margin-left","margin-right","padding-left","padding-right"],["opacity"]];e.augment(r,{animate:function(){var t=e.makeArray(arguments);return e.each(this,function(n){var r=e.clone(t),o=r[0];o.to?(o.node=n,new i(o).run()):i.apply(void 0,[n].concat(r)).run()}),this},stop:function(t,n,r){return e.each(this,function(e){i.stop(e,t,n,r)}),this},pause:function(t,n){return e.each(this,function(e){i.pause(e,n)}),this},resume:function(t,n){return e.each(this,function(e){i.resume(e,n)}),this},isRunning:function(){for(var e=0;e<this.length;e++)if(i.isRunning(this[e]))return!0;return!1},isPaused:function(){for(var e=0;e<this.length;e++)if(i.isPaused(this[e]))return!0;return!1}}),e.each({show:n("show",3),hide:n("hide",3),toggle:n("toggle",3),fadeIn:n("show",3,2),fadeOut:n("hide",3,2),fadeToggle:n("toggle",3,2),slideDown:n("show",1),slideUp:n("hide",1),slideToggle:n("toggle",1)},function(t,n){r.prototype[n]=function(r,a,s){return o[n]&&!r?o[n](this):e.each(this,function(e){new i(e,t,r,s,a).run()}),this}})}),KISSY.add("node",["node/base","node/attach","node/override","node/anim"],function(e,t){var n=t("node/base");return t("node/attach"),t("node/override"),t("node/anim"),e.mix(e,{Node:n,NodeList:n,one:n.one,all:n.all}),n}),KISSY.add("anim",["anim/base","anim/timer","anim/transition?"],function(e,t){function n(t,n,r,a,u){return t.node?u=t:("string"==typeof n?(n=e.unparam(""+n,";",":"),e.each(n,function(t,r){var o=e.trim(r);o&&(n[o]=e.trim(t)),(!o||o!==r)&&delete n[r]})):n=e.clone(n),e.isPlainObject(r)?u=e.clone(r):(u={complete:u},r&&(u.duration=r),a&&(u.easing=a)),u.node=t,u.to=n),(u=e.merge(s,u,{useTransition:e.config("anim/useTransition")})).useTransition&&i?new i(u):new o(u)}var r=t("anim/base"),o=t("anim/timer"),i=t("anim/transition?"),a=r.Utils,s={duration:1,easing:"linear"};return e.each(["pause","resume"],function(e){n[e]=function(t,n){return null===n||"string"==typeof n||!1===n?a.pauseOrResumeQueue(t,n,e):a.pauseOrResumeQueue(t,void 0,e)}}),n.isRunning=a.isElRunning,n.isPaused=a.isElPaused,n.stop=a.stopEl,n.Easing=o.Easing,e.Anim=n,n.Q=r.Q,n}),KISSY.add("anim/base/queue",["dom"],function(e,t){function n(e,t,n){t=t||a;var r,s=o.data(e,i);return!s&&!n&&o.data(e,i,s={}),s&&(!(r=s[t])&&!n&&(r=s[t]=[])),r}var r,o=t("dom"),i=e.guid("ks-queue-"+e.now()+"-"),a=e.guid("ks-queue-"+e.now()+"-");return r={queueCollectionKey:i,queue:function(e,t,r){return(e=n(e,t)).push(r),e},remove:function(t,o,i){var a=n(t,o,1);return a&&(-1<(i=e.indexOf(i,a))&&a.splice(i,1)),a&&!a.length&&r.clearQueue(t,o),a},clearQueues:function(e){o.removeData(e,i)},clearQueue:function(t,n){n=n||a;var r=o.data(t,i);r&&delete r[n],e.isEmptyObject(r)&&o.removeData(t,i)},dequeue:function(e,t){var o=n(e,t,1);return o&&(o.shift(),o.length||r.clearQueue(e,t)),o}}}),KISSY.add("anim/base/utils",["./queue","dom"],function(e,t){var n=t("./queue"),r=t("dom"),o=e.guid("ks-anim-unqueued-"+e.now()+"-"),i=e.guid("ks-anim-paused-"+e.now()+"-");return{saveRunningAnim:function(t){var n=t.node,i=r.data(n,o);i||r.data(n,o,i={}),i[e.stamp(t)]=t},removeRunningAnim:function(t){var n=t.node,i=r.data(n,o);i&&(delete i[e.stamp(t)],e.isEmptyObject(i)&&r.removeData(n,o))},isAnimPaused:function(t){var n=r.data(t.node,i);return n?!!n[e.stamp(t)]:0},removePausedAnim:function(t){var n=t.node,o=r.data(n,i);o&&(delete o[e.stamp(t)],e.isEmptyObject(o)&&r.removeData(n,i))},savePausedAnim:function(t){var n=t.node,o=r.data(n,i);o||r.data(n,i,o={}),o[e.stamp(t)]=t},isAnimRunning:function(t){var n=r.data(t.node,o);return n?!!n[e.stamp(t)]:0},isElPaused:function(t){return(t=r.data(t,i))&&!e.isEmptyObject(t)},isElRunning:function(t){return(t=r.data(t,o))&&!e.isEmptyObject(t)},pauseOrResumeQueue:function(t,n,a){t=r.data(t,"resume"===a?i:o),t=e.merge(t),e.each(t,function(e){void 0!==n&&e.config.queue!==n||e[a]()})},stopEl:function(t,i,a,s){a&&(void 0===s?n.clearQueues(t):!1!==s&&n.clearQueue(t,s)),t=r.data(t,o),t=e.merge(t),e.each(t,function(e){(void 0===s||e.config.queue===s)&&e.stop(i)})}}}),KISSY.add("anim/base",["dom","./base/utils","./base/queue","promise"],function(e,t){function n(t){n.superclass.constructor.call(this),a.Defer(this),this.config=t;var o=t.node;e.isPlainObject(o)||(o=r.get(t.node)),this.node=this.el=o,this._backupProps={},this._propsData={}}var r=t("dom"),o=t("./base/utils"),i=t("./base/queue"),a=t("promise"),s=r.NodeType,u=e.noop,l={toggle:1,hide:1,show:1};return e.extend(n,a,{on:function(e,t){return"complete"===e?this.then(t):"end"===e?this.fin(t):"step"!==e||this.progress(t),this},prepareFx:u,runInternal:function(){var t,n,i,a=this,u=a.config,c=a.node,d=a._backupProps,h=a._propsData,f=u.to,g=u.delay||0,p=u.duration;if((o.saveRunningAnim(a),e.each(f,function(t,n){e.isPlainObject(t)||(t={value:t}),h[n]=e.mix({delay:g,easing:u.easing,frame:u.frame,duration:p},t)}),c.nodeType===s.ELEMENT_NODE)&&((f.width||f.height)&&(f=c.style,e.mix(d,{overflow:f.overflow,"overflow-x":f.overflowX,"overflow-y":f.overflowY}),f.overflow="hidden","inline"===r.css(c,"display")&&"none"===r.css(c,"float")&&(10>e.UA.ieMode?f.zoom=1:f.display="inline-block")),i="none"===r.css(c,"display"),e.each(h,function(e,o){if(t=e.value,l[t]){if("hide"===t&&i||"show"===t&&!i)return a.stop(!0),n=!1;d[o]=r.style(c,o),"toggle"===t?t=i?"show":"hide":"hide"===t?(e.value=0,d.display="none"):(e.value=r.css(c,o),r.css(c,o,0),r.show(c))}}),!1===n))return;a.startTime=e.now(),e.isEmptyObject(h)?(a.__totalTime=1e3*p,a.__waitTimeout=setTimeout(function(){a.stop(!0)},a.__totalTime)):(a.prepareFx(),a.doStart())},isRunning:function(){return o.isAnimRunning(this)},isPaused:function(){return o.isAnimPaused(this)},pause:function(){return this.isRunning()&&(this._runTime=e.now()-this.startTime,this.__totalTime-=this._runTime,o.removeRunningAnim(this),o.savePausedAnim(this),this.__waitTimeout?clearTimeout(this.__waitTimeout):this.doStop()),this},doStop:u,doStart:u,resume:function(){var t=this;return t.isPaused()&&(t.startTime=e.now()-t._runTime,o.removePausedAnim(t),o.saveRunningAnim(t),t.__waitTimeout?t.__waitTimeout=setTimeout(function(){t.stop(!0)},t.__totalTime):(t.beforeResume(),t.doStart())),t},beforeResume:u,run:function(){var e;return!1===(e=this.config.queue)?this.runInternal():1===(e=i.queue(this.node,e,this)).length&&this.runInternal(),this},stop:function(t){var n=this.node,a=this.config.queue;if(this.isResolved()||this.isRejected())return this;if(this.__waitTimeout&&(clearTimeout(this.__waitTimeout),this.__waitTimeout=0),!this.isRunning()&&!this.isPaused())return!1!==a&&i.remove(n,a,this),this;this.doStop(t),o.removeRunningAnim(this),o.removePausedAnim(this);var s=this.defer;if(t){var u;t=this.config.complete;e.isEmptyObject(u=this._backupProps)||r.css(this.node,u),t&&t.call(this),s.resolve([this])}else s.reject([this]);return!1!==a&&(n=i.dequeue(n,a))&&n[0]&&n[0].runInternal(),this}}),n.Utils=o,n.Q=i,n}),KISSY.add("anim/timer/easing",[],function(){function e(e){return e}function t(e,t,n,r){var o=3*e-3*n+1,i=3*n-6*e,a=3*e,s=3*t-3*r+1,c=3*r-6*t,d=3*t;return function(e){e:{for(var t,n,r=e,h=0;8>h;h++){if(l(n=((o*r+i)*r+a)*r-e)<u){e=r;break e}if(l(t=(3*o*r+2*i)*r+a)<u)break;r-=n/t}for(t=1,h=0,r=e;t>h&&!(l(n=((o*r+i)*r+a)*r-e)<u);)0<n?t=r:h=r,r=(t+h)/2;e=r}return((s*e+c)*e+d)*e}}var n=Math.PI,r=Math.pow,o=Math.sin,i=parseFloat,a=/^cubic-bezier\(([^,]+),([^,]+),([^,]+),([^,]+)\)$/i,s={swing:function(e){return-Math.cos(e*n)/2+.5},easeNone:e,linear:e,easeIn:function(e){return e*e},ease:t(.25,.1,.25,1),"ease-in":t(.42,0,1,1),"ease-out":t(0,0,.58,1),"ease-in-out":t(.42,0,.58,1),"ease-out-in":t(0,.42,1,.58),toFn:function(n){var r;return(r=n.match(a))?t(i(r[1]),i(r[2]),i(r[3]),i(r[4])):s[n]||e},easeOut:function(e){return(2-e)*e},easeBoth:function(e){return 1>(e*=2)?.5*e*e:.5*(1- --e*(e-2))},easeInStrong:function(e){return e*e*e*e},easeOutStrong:function(e){return 1- --e*e*e*e},easeBothStrong:function(e){return 1>(e*=2)?.5*e*e*e*e:.5*(2-(e-=2)*e*e*e)},elasticIn:function(e){return 0===e||1===e?e:-r(2,10*(e-=1))*o(2*(e-.075)*n/.3)},elasticOut:function(e){return 0===e||1===e?e:r(2,-10*e)*o(2*(e-.075)*n/.3)+1},elasticBoth:function(e){return 0===e||2==(e*=2)?e:1>e?-.5*r(2,10*(e-=1))*o(2*(e-.1125)*n/.45):.5*r(2,-10*(e-=1))*o(2*(e-.1125)*n/.45)+1},backIn:function(e){return 1===e&&(e-=.001),e*e*(2.70158*e-1.70158)},backOut:function(e){return(e-=1)*e*(2.70158*e+1.70158)+1},backBoth:function(e){var t,n=1+(t=2.5949095);return 1>(e*=2)?.5*e*e*(n*e-t):.5*((e-=2)*e*(n*e+t)+2)},bounceIn:function(e){return 1-s.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceBoth:function(e){return.5>e?.5*s.bounceIn(2*e):.5*s.bounceOut(2*e-1)+.5}},u=1e-6,l=Math.abs;return s}),KISSY.add("anim/timer/manager",[],function(e){var t,n,r=e.stamp;return t=function(e){return setTimeout(e,15)},n=function(e){clearTimeout(e)},{runnings:{},timer:null,start:function(e){var t=r(e);this.runnings[t]||(this.runnings[t]=e,this.startTimer())},stop:function(e){this.notRun(e)},notRun:function(t){delete this.runnings[r(t)],e.isEmptyObject(this.runnings)&&this.stopTimer()},pause:function(e){this.notRun(e)},resume:function(e){this.start(e)},startTimer:function(){var e=this;e.timer||(e.timer=t(function n(){e.runFrames()?e.stopTimer():e.timer=t(n)}))},stopTimer:function(){var e=this.timer;e&&(n(e),this.timer=0)},runFrames:function(){var e,t,n=this.runnings;for(e in n)n[e].frame();for(e in n){t=0;break}return void 0===t}}}),KISSY.add("anim/timer/fx",["dom"],function(e,t){function n(t){e.mix(this,t),this.pos=0,this.unit=this.unit||""}var r=t("dom");return n.prototype={isCustomFx:0,constructor:n,load:function(t){e.mix(this,t),this.pos=0,this.unit=this.unit||""},frame:function(t){if(1!==this.pos){var n=this.anim,o=this.prop,i=n.node,a=this.from,s=this.propData,u=this.to;if(void 0===t){var l=e.now();t=s.duration,t=0>=(l=l-n.startTime-s.delay)?0:l>=t?1:s.easing(l/t)}this.pos=t,a===u||0===t||(this.val=t=this.interpolate(a,u,this.pos),s.frame?s.frame.call(this,n,this):this.isCustomFx||(void 0===t?(this.pos=1,t=u):t+=this.unit,this.val=t,"attr"===this.type?r.attr(i,o,t,1):r.css(i,o,t)))}},interpolate:function(e,t,n){if("number"==typeof e&&"number"==typeof t)return Math.round(1e5*(e+(t-e)*n))/1e5},cur:function(){var e,t,n=this.prop,o=this.anim.node;return this.isCustomFx?o[n]||0:((e=this.type)||(e=this.type=o.style&&null!=o.style[n]||null==r.attr(o,n,void 0,1)?"css":"attr"),n="attr"===e?r.attr(o,n,void 0,1):r.css(o,n),isNaN(t=parseFloat(n))?n&&"auto"!==n?n:0:t)}},n.Factories={},n.FxTypes={},n.getFx=function(e){var t,r,o=n;return(t=e.fxType)?o=n.FxTypes[t]:!e.isCustomFx&&(r=n.Factories[e.prop])&&(o=r),new o(e)},n}),KISSY.add("anim/timer/short-hand",[],function(){return{background:[],border:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],borderBottom:["borderBottomWidth"],borderLeft:["borderLeftWidth"],borderTop:["borderTopWidth"],borderRight:["borderRightWidth"],font:["fontSize","fontWeight"],margin:["marginBottom","marginLeft","marginRight","marginTop"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"]}}),KISSY.add("anim/timer/color",["./fx","./short-hand"],function(e,t){function n(e){var t;if(t=(e=e+"").match(l))return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])];if(t=e.match(c))return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseInt(t[4])];if(t=e.match(d)){for(e=1;e<t.length;e++)2>t[e].length&&(t[e]+=t[e]);return[parseInt(t[1],a),parseInt(t[2],a),parseInt(t[3],a)]}return u[e=e.toLowerCase()]?u[e]:[255,255,255]}function r(){r.superclass.constructor.apply(this,arguments)}var o=t("./fx"),i=t("./short-hand"),a=16,s=Math.floor,u={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]},l=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,c=/^rgba\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+),\s*([0-9]+)\)$/i,d=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i;return i.background.push("backgroundColor"),i.borderColor=["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],i.border.push("borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"),i.borderBottom.push("borderBottomColor"),i.borderLeft.push("borderLeftColor"),i.borderRight.push("borderRightColor"),i.borderTop.push("borderTopColor"),e.extend(r,o,{load:function(){r.superclass.load.apply(this,arguments),this.from&&(this.from=n(this.from)),this.to&&(this.to=n(this.to))},interpolate:function(e,t,n){var o=r.superclass.interpolate;return 3===e.length&&3===t.length?"rgb("+[s(o(e[0],t[0],n)),s(o(e[1],t[1],n)),s(o(e[2],t[2],n))].join(", ")+")":4===e.length||4===t.length?"rgba("+[s(o(e[0],t[0],n)),s(o(e[1],t[1],n)),s(o(e[2],t[2],n)),s(o(e[3]||1,t[3]||1,n))].join(", ")+")":void 0}}),e.each("backgroundColor,borderBottomColor,borderLeftColor,borderRightColor,borderTopColor,color,outlineColor".split(","),function(e){o.Factories[e]=r}),o.FxTypes.color=r}),KISSY.add("anim/timer/transform",["dom","./fx"],function(e,t){function n(e){return Math.round(1e5*parseFloat(e))/1e5}function r(t){t=t.split(")");for(var r,o,i=e.trim,a=-1,s=t.length-1,u={translateX:0,translateY:0,rotate:0,skewX:0,skewY:0,scaleX:1,scaleY:1};++a<s;)switch(o=i((r=t[a].split("("))[0]),r=r[1],o){case"translateX":case"translateY":case"scaleX":case"scaleY":u[o]=n(r);break;case"rotate":case"skewX":case"skewY":var l=n(r);e.endsWith(r,"deg")||(l=180*l/Math.PI),u[o]=l;break;case"translate":case"translate3d":r=r.split(","),u.translateX=n(r[0]),u.translateY=n(r[1]||0);break;case"scale":r=r.split(","),u.scaleX=n(r[0]),u.scaleY=n(r[1]||r[0]);break;case"matrix":return c=(c=t=r).split(/,/),s=a=i=void 0,o=(t=e.map(c,function(e){return n(e)}))[0],u=t[1],r=t[2],o*(l=t[3])-u*r?(s=(o*r+u*l)/(o*l-r*u),a=(o*l-u*r)/(i=Math.sqrt(o*o+u*u)),o*l<u*r&&(s=-s,i=-i)):i=a=s=0,{translateX:n(t[4]),translateY:n(t[5]),rotate:n(180*Math.atan2(u,o)/Math.PI),skewX:n(180*Math.atan(s)/Math.PI),skewY:0,scaleX:n(i),scaleY:n(a)}}var c;return u}function o(){o.superclass.constructor.apply(this,arguments)}var i=t("dom"),a=t("./fx"),s=e.Features.isTransform3dSupported()?"translate3d({translateX}px,{translateY}px,0)":"translate({translateX}px,{translateY}px)";return e.extend(o,a,{load:function(){o.superclass.load.apply(this,arguments),this.from=(this.from=i.style(this.anim.node,"transform")||this.from)&&"none"!==this.from?r(this.from):{translateX:0,translateY:0,rotate:0,skewX:0,skewY:0,scaleX:1,scaleY:1},this.to=this.to?r(this.to):{translateX:0,translateY:0,rotate:0,skewX:0,skewY:0,scaleX:1,scaleY:1}},interpolate:function(t,n,r){var i=o.superclass.interpolate,a={};return a.translateX=i(t.translateX,n.translateX,r),a.translateY=i(t.translateY,n.translateY,r),a.rotate=i(t.rotate,n.rotate,r),a.skewX=i(t.skewX,n.skewX,r),a.skewY=i(t.skewY,n.skewY,r),a.scaleX=i(t.scaleX,n.scaleX,r),a.scaleY=i(t.scaleY,n.scaleY,r),e.substitute(s+" rotate({rotate}deg) skewX({skewX}deg) skewY({skewY}deg) scale({scaleX},{scaleY})",a)}}),a.Factories.transform=o}),KISSY.add("anim/timer","dom,./base,./timer/easing,./timer/manager,./timer/fx,./timer/short-hand,./timer/color,./timer/transform".split(","),function(e,t){function n(){var t;n.superclass.constructor.apply(this,arguments),e.each(t=this.to,function(e,n){var r=l(n);n!==r&&(t[r]=t[n],delete t[n])})}var r=t("dom"),o=t("./base"),i=t("./timer/easing"),a=t("./timer/manager"),s=t("./timer/fx"),u=t("./timer/short-hand");t("./timer/color"),t("./timer/transform");var l=r._camelCase,c=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;return e.extend(n,o,{prepareFx:function(){var t=this.node,n=this._propsData;e.each(n,function(e){e.duration=1e3*e.duration,e.delay=1e3*e.delay,"string"==typeof e.easing&&(e.easing=i.toFn(e.easing))}),e.each(u,function(o,i){var a,s,u=n[i];u&&(s=u.value,a={},e.each(o,function(e){a[e]=r.css(t,e)}),r.css(t,i,s),e.each(a,function(o,i){i in n||(n[i]=e.merge(u,{value:r.css(t,i)})),r.css(t,i,o)}),delete n[i])});var o,a,l,d,h,f,g,p,m=0;for(o in e.isPlainObject(t)&&(m=1),n){if(l=(a=n[o]).value,f={isCustomFx:m,prop:o,anim:this,fxType:a.fxType,type:a.type,propData:a},d=l,h=(g=s.getFx(f)).cur(),p="",l=(l+="").match(c)){if(d=parseFloat(l[2]),(p=l[3])&&"px"!==p&&h){var _=0,v=d;do{++v,r.css(t,o,v+p),_=g.cur()}while(0===_);h*=v/_,r.css(t,o,h+p)}l[1]&&(d=("-="===l[1]?-1:1)*d+h)}f.from=h,f.to=d,f.unit=p,g.load(f),a.fx=g}},frame:function(){var t,n,r=1,o=this._propsData;for(t in o){if((n=(n=o[t]).fx).frame(),this.isRejected()||this.isResolved())return;r&=1===n.pos}o=e.now(),t=1e3*this.config.duration,o=Math.max(0,this.startTime+t-o),this.defer.notify([this,1-(o/t||0),o]),r&&this.stop(r)},doStop:function(e){var t,n=this._propsData;if(a.stop(this),e)for(t in n)(e=(e=n[t]).fx)&&e.frame(1)},doStart:function(){a.start(this)}}),n.Easing=i,n.Fx=s,n}),KISSY.add("anim/transition",["dom","event/dom","./base"],function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}var r=t("dom"),o=t("event/dom"),i=t("./base"),a=e.Features,s=a.getTransitionPrefix(),u=/([A-Z]|^ms)/g,l=s?s.toLowerCase()+"TransitionEnd":"transitionend",c=a.getTransitionProperty();return e.extend(n,i,{doStart:function(){var t,n,i,s=this,d=s.node,h=d.style,f=s._propsData,g=h[c],p={};(t=f.transform)&&(delete f.transform,f[a.getTransformProperty().replace(u,"-$1").toLowerCase()]=t),e.each(f,function(e,t){var n=e.value,o=r.css(d,t);"number"==typeof n&&(o=parseFloat(o)),o===n&&setTimeout(function(){s._onTransitionEnd({originalEvent:{propertyName:t}})},0),p[t]=n}),-1!==g.indexOf("none")?g="":g&&(g+=","),h[c]=g+(n=f,i="",e.each(n,function(e,t){i&&(i+=","),i+=t+" "+e.duration+"s "+e.easing+" "+e.delay+"s"}),i),o.on(d,l,s._onTransitionEnd,s),r.css(d,p)},beforeResume:function(){var t=this._propsData,n=e.merge(t),r=this._runTime/1e3;e.each(n,function(e,n){var o=r;e.delay>=o?e.delay-=o:(o-=e.delay,e.delay=0,e.duration>=o?e.duration-=o:delete t[n])})},_onTransitionEnd:function(t){t=t.originalEvent;var n=1,r=this._propsData;r[t.propertyName]&&(r[t.propertyName].pos=1,e.each(r,function(e){if(1!==e.pos)return n=0,!1}),n&&this.stop(!0))},doStop:function(t){var n=this.node,i=n.style,a=this._propsData,s=[],u={};o.detach(n,l,this._onTransitionEnd,this),e.each(a,function(e,o){t||(u[o]=r.css(n,o)),s.push(o)}),a=e.trim(i[c].replace(RegExp("(^|,)\\s*(?:"+s.join("|")+")\\s+[^,]+","gi"),"$1")).replace(/^,|,,|,$/g,"")||"none",i[c]=a,r.css(n,u)}}),n}),KISSY.add("base",["attribute"],function(e,t){function n(e,t){return function(n){return function(){t?n.apply(this,arguments):this.callSuper.apply(this,arguments);var r=arguments.callee.__owner__.__extensions__||[];t&&r.reverse();var o,i=arguments;if(o=r&&r.length)for(var a=0;a<o;a++){var s=r[a]&&(e?r[a].prototype[e]:r[a]);s&&s.apply(this,i||[])}t?this.callSuper.apply(this,arguments):n.apply(this,arguments)}}}function r(e){var t=this.__hooks__,n=this.prototype;if(this.__extensions__.length&&t)for(var r in t)n.hasOwnProperty(r)&&!e.hasOwnProperty(r)||(e[r]=e[r]||l);return d.call(this,e)}function o(e){e.target===this&&this[u+e.type.slice(5).slice(0,-6)].call(this,e.newVal,e)}function i(e){var t,n=this.get("plugins");if(t=n.length)for(var r=0;r<t;r++)n[r][e]&&n[r][e](this)}var a=t("attribute"),s=e.ucfirst,u="_onSet",l=e.noop,c=a.extend({constructor:function(){this.callSuper.apply(this,arguments);var t,n,r,o=this.get("listeners");for(t in o)this.on(t,o[t]);this.initializer(),r=this.get("plugins"),e.each(r,function(e,t){"function"==typeof e&&(n=e,r[t]=new n)}),i.call(this,"pluginInitializer"),this.bindInternal(),this.syncInternal()},initializer:l,__getHook:n,__callPluginsMethod:i,bindInternal:function(){var e,t=this.getAttrs();for(e in t)this[u+s(e)]&&this.on("after"+s(e)+"Change",o)},syncInternal:function(){var e,t=[];e=this.constructor;for(var n=this.getAttrs();e;)t.push(e),e=e.superclass&&e.superclass.constructor;for(t.reverse(),e=0;e<t.length;e++){var r,o=t[e].ATTRS||{};for(r in o){var i,a;if(r in n)(a=this[u+s(r)])&&0!==n[r].sync&&void 0!==(i=this.get(r))&&a.call(this,i)}}},plug:function(e){return"function"==typeof e&&(e=new e),e.pluginInitializer&&e.pluginInitializer(this),this.get("plugins").push(e),this},unplug:function(t){var n=[],r=this,o="string"==typeof t;return e.each(r.get("plugins"),function(e){var i=0;t&&(o?(e.get&&e.get("pluginId")||e.pluginId)!==t&&(n.push(e),i=1):e!==t&&(n.push(e),i=1)),i||e.pluginDestructor(r)}),r.setInternal("plugins",n),r},getPlugin:function(t){var n=null;return e.each(this.get("plugins"),function(e){if((e.get&&e.get("pluginId")||e.pluginId)===t)return n=e,!1}),n},destructor:e.noop,destroy:function(){this.get("destroyed")||(i.call(this,"pluginDestructor"),this.destructor(),this.set("destroyed",!0),this.fire("destroy"),this.detach())}});e.mix(c,{__hooks__:{initializer:n(),destructor:n("__destructor",!0)},ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}},extend:function t(n,o,i){if(e.isArray(n)||(i=o,o=n,n=[]),i=i||{},o=o||{},(o=a.extend.call(this,o,i)).__extensions__=n,r.call(o,{}),n.length){var s={},u={};e.each(n.concat(o),function(t){if(t){e.each(t.ATTRS,function(t,n){var r=s[n]=s[n]||{};e.mix(r,t)});var n;t=t.prototype;for(n in t)t.hasOwnProperty(n)&&(u[n]=t[n])}}),o.ATTRS=s,u.constructor=o,e.augment(o,u)}return o.extend=i.extend||t,o.addMembers=r,o}});var d=c.addMembers;return e.Base=c}),KISSY.add("attribute",["event/custom"],function(e,t,n,r){function o(e,t){return"string"==typeof t?e[t]:t}function i(e){return e.__attrVals||(e.__attrVals={})}function a(t,n,r,o,i,a,s,u){return s=s||r,t.fire(n+e.ucfirst(r)+"Change",e.mix({attrName:s,subAttrName:a,prevVal:o,newVal:i},u))}function s(e,t,n){var r=e[t];return!n&&!r&&(e[t]=r={}),r||{}}function u(e,t){for(var n=0,r=t.length;void 0!==e&&n<r;n++)e=e[t[n]];return e}function l(e){var t;return-1!==e.indexOf(".")&&(e=(t=e.split(".")).shift()),{path:t,name:e}}function c(t,n,r){var o=r;if(n){t=o=void 0===t?{}:e.clone(t);var i=n.length-1;if(0<=i){for(var a=0;a<i;a++)t=t[n[a]];void 0!==t&&(t[n[a]]=r)}}return o}function d(t,n,r,o,i){var a,d,f,g=n;n=(a=l(n)).name;a=a.path,f=t.get(n);var p=n,m=s(t,"__defaultBeforeFns");if(m[p]||(m[p]=1,p="before"+e.ucfirst(p)+"Change",t.publish(p,{defaultFn:h})),a&&(d=u(f,a)),o.force||!(!a&&f===r||a&&d===r)){if(r=c(f,a,r),r=e.mix({attrName:n,subAttrName:g,prevVal:f,newVal:r,_opts:o,_attrs:i,target:t},o.data),o.silent){if(I===h.call(t,r))return I}else if(I===t.fire("before"+e.ucfirst(n)+"Change",r))return I;return t}}function h(e){if(e.target===this){var t=e.newVal,n=e.prevVal,r=e.attrName,o=e.subAttrName,s=e._attrs;e=e._opts;if((t=this.setInternal(r,t))===I)return t;e.silent||(a(this,"after",r,n,t=i(this)[r],o,null,e.data),s?s.push({prevVal:n,newVal:t,attrName:r,subAttrName:o}):a(this,"","*",[n],[t],[o],[r],e.data))}}function f(e){var t=this.constructor;for(this.userConfig=e;t;){var n=t.ATTRS;if(n){var r=void 0;for(r in n)this.addAttr(r,n[r],!1)}t=t.superclass?t.superclass.constructor:null}if(e)for(var o in e)this.setInternal(o,e[o])}function g(t,n){var r,o=n.__hooks__||{};for(r in o)r in t&&(t[r]=o[r](t[r]));e.each(t,function(e,r){if("function"==typeof e){var o=0;if(e.__owner__){var i=e.__owner__;delete e.__owner__,delete e.__name__;o=e.__wrapped__=1;var a=v(e);a.__owner__=i,a.__name__=r,i.prototype[r]=a}else e.__wrapped__&&(o=1);o&&(t[r]=e=v(e)),e.__owner__=n,e.__name__=r}})}function p(t){g(t,this),e.mix(this.prototype,t)}function m(e,t){var n=e.getAttrs(),r=s(n,t,1),i=r.valueFn;return i&&(i=o(e,i))&&(void 0!==(i=i.call(e))&&(r.value=i),delete r.valueFn,n[t]=r),r.value}function _(e,t,n,r){var i;if(t=(i=l(t)).name,(i=i.path)&&(n=c(e.get(t),i,n)),(i=s(e.getAttrs(),t).validator)&&(i=o(e,i))&&void 0!==(e=i.call(e,n,t,r))&&!0!==e)return e}t=t("event/custom"),r.exports=f;var v=e.bind,y={},I=!1;f.extend=function t(n,r){n=n||{};var o,i=(r=r||{}).__hooks__;(o=this.__hooks__)&&(i=r.__hooks__=r.__hooks__||{},e.mix(i,o,!1)),o=n.hasOwnProperty("constructor")?n.constructor:function(){this.callSuper.apply(this,arguments)},n.constructor=o,o.__hooks__=i,g(n,o);var a=r.inheritedStatics;return(i=this.inheritedStatics)&&(a=r.inheritedStatics=r.inheritedStatics||{},e.mix(a,i,!1)),e.extend(o,this,n,r),a&&e.mix(o,a),o.extend=r.extend||t,o.addMembers=p,o},e.augment(f,t.Target,{INVALID:y,callSuper:function(){var e,t,n=arguments;"function"==typeof this&&this.__name__?(e=this,t=n[0],n=Array.prototype.slice.call(n,1)):((e=arguments.callee.caller).__wrapped__&&(e=e.caller),t=this);var r=e.__name__;if(r)return(e=e.__owner__.superclass[r])?e.apply(t,n||[]):void 0},getAttrs:function(){return this.__attrs||(this.__attrs={})},getAttrVals:function(){var e,t={},n=this.getAttrs();for(e in n)t[e]=this.get(e);return t},addAttr:function(t,n,r){var o,i=this.getAttrs();n=e.clone(n);return(o=i[t])?e.mix(o,n,r):i[t]=n,this},addAttrs:function(t,n){var r=this;return e.each(t,function(e,t){r.addAttr(t,e)}),n&&r.set(n),r},hasAttr:function(e){return this.getAttrs().hasOwnProperty(e)},removeAttr:function(e){var t=i(this),n=this.getAttrs();return this.hasAttr(e)&&(delete n[e],delete t[e]),this},set:function(t,n,r){var o;if(e.isPlainObject(t)){r=n||{},n=Object(t);var i=[],s=[];for(t in n)void 0!==(o=_(this,t,n[t],n))&&s.push(o);if(s.length)return r.error&&r.error(s),I;for(t in n)d(this,t,n[t],r,i);var u=[],l=[],c=[],h=[];return e.each(i,function(e){l.push(e.prevVal),c.push(e.newVal),u.push(e.attrName),h.push(e.subAttrName)}),u.length&&a(this,"","*",l,c,h,u,r.data),this}return r=r||{},void 0!==(o=_(this,t,n))?(r.error&&r.error(o),I):d(this,t,n,r)},setInternal:function(e,t){var n,r=s(this.getAttrs(),e).setter;if(r&&(r=o(this,r))&&(n=r.call(this,t,e)),n===y)return I;void 0!==n&&(t=n),i(this)[e]=t},get:function(e){var t,n,r,a=i(this);return-1!==e.indexOf(".")&&(e=(t=e.split(".")).shift()),n=s(this.getAttrs(),e,1).getter,r=e in a?a[e]:m(this,e),n&&(n=o(this,n))&&(r=n.call(this,r,e)),!(e in a)&&void 0!==r&&(a[e]=r),t&&(r=u(r,t)),r},reset:function(e,t){if("string"==typeof e)return this.hasAttr(e)?this.set(e,m(this,e),t):this;t=e;var n=this.getAttrs(),r={};for(e in n)r[e]=m(this,e);return this.set(r,t),this}})}),KISSY.add("overlay/extension/loading",["node"],function(e,t){function n(){}var r=t("node");return n.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=new r('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>').appendTo(this.$el)),this._loadingExtEl.show()},unloading:function(){var e=this._loadingExtEl;e&&e.hide()}},n}),KISSY.add("overlay/extension/mask",["node"],function(e,t){function n(){}function r(e){var t=this.get("maskNode");if(e=e.newVal){var n=Number(this.$el.css("z-index"));isNaN(n)||t.css("z-index",n)}!function(e,t,n,r){var o,i,a,s,c=e.effect||u;if(i=n,a=(o=r).get("maskNode"),s=o.view.getBaseCssClasses("mask-hidden"),i?a.removeClass(s):a.addClass(s),c!==u){r=e.duration,e=e.easing;var d=n?1:0;t.stop(1,1),t.css("display",n?u:"block"),t[c+l[c][d]](r,function(){t.css("display","")},e)}}(this.get("mask"),t,e,this)}var o=e.UA,i=t("node"),a=6===o.ie,s=i.all;n.ATTRS={mask:{value:!1},maskNode:{}};var u="none",l={fade:["Out","In"],slide:["Up","Down"]};return n.prototype={__renderUI:function(){var e,t,n;this.get("mask")&&this.set("maskNode",(e=this,t=this.get("visible")?"":this.view.getBaseCssClasses("mask-hidden"),n=e.view.getBaseCssClasses("mask"),(n=s('<div  style="width:'+(a?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(a?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(a?"absolute":"fixed")+';" class="'+n+" "+t+'">'+(a?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':"")+"</div>").prependTo("body")).unselectable(),n.on("mousedown",function(e){e.preventDefault()}),n))},__bindUI:function(){var e,t;(t=this.get("mask"))&&(e=this.get("maskNode"),t.closeOnClick&&e.on(i.Gesture.tap,this.close,this),this.on("afterVisibleChange",r))},__destructor:function(){var e;(e=this.get("maskNode"))&&e.remove()}},n}),KISSY.add("overlay/close-xtpl",[],function(){return function(e){var t,n=this,r=(t=this.config.utils).runBlockCommand,o=t.renderOutput,i=t.getProperty,a=t.runInlineCommand,s=t.getPropertyOrRunCommand;t="";var u={},l=[];i=i(n,e,"closable",0,1);return l.push(i),u.params=l,u.fn=function(e){var t;t='\n<a href="javascript:void(\'close\')"\n   id="ks-overlay-close-';var r=s(n,e,{},"id",0,3);t+=o(r,!0),t+='"\n   class="';r={};var i=[];return i.push("close"),r.params=i,r=a(n,e,r,"getBaseCssClasses",4),t+=o(r,!0),t+="\"\n   role='button'>\n    <span class=\"",r={},(i=[]).push("close-x"),r.params=i,e=a(n,e,r,"getBaseCssClasses",6),(t+=o(e,!0))+'">close</span>\n</a>\n'},(t+=r(n,e,u,"if",1))+"\n"}}),KISSY.add("overlay/overlay-xtpl",["overlay/close-xtpl","component/extension/content-xtpl"],function(e,t,n,r){return function(e){var n,o;n=this.config.utils,void 0!==r&&r.kissy&&(o=r);var i=n.renderOutput,a=n.runInlineCommand;n="";var s={},u=[];return u.push("overlay/close-xtpl"),s.params=u,o&&(t("overlay/close-xtpl"),s.params[0]=o.resolveByName(s.params[0])),n+=i(s=a(this,e,s,"include",1),!1),n+="\n",s={},(u=[]).push("component/extension/content-xtpl"),s.params=u,o&&(t("component/extension/content-xtpl"),s.params[0]=o.resolveByName(s.params[0])),n+i(e=a(this,e,s,"include",2),!1)}}),KISSY.add("overlay/overlay-render",["component/container","./overlay-xtpl","component/extension/content-render"],function(e,t){var n=t("component/container"),r=t("./overlay-xtpl"),o=t("component/extension/content-render");return n.getDefaultRender().extend([o],{createDom:function(){this.fillChildrenElsBySelectors({closeBtn:"#ks-overlay-close-{id}"})}},{ATTRS:{contentTpl:{value:r}},HTML_PARSER:{closeBtn:function(e){return e.one("."+this.getBaseCssClass("close"))}}})}),KISSY.add("overlay/extension/overlay-effect",[],function(e){function t(t,n,o){var i=t.$el,a=t.get("effect"),s=a.effect||"none",u=a.target;"none"!==s||u?u?function(t,n,r){t.__effectGhost&&t.__effectGhost.stop(1,1);var o,i,a=t.$el,s=(u=e.all)((d=t.get("effect")).target),u=d.duration,l=(s=e.mix(s.offset(),{width:s.width(),height:s.height()}),e.mix(a.offset(),{width:a.width(),height:a.height()})),c=((i=(o=t).$el.clone(!0)).css({visibility:"visible",overflow:"hidden"}).addClass(o.get("prefixCls")+"overlay-ghost"),o.__afterCreateEffectGhost(i)),d=d.easing;c.insertAfter(a),n?(n=s,s=l):n=l,a.css("visibility","hidden"),c.css(n),t.__effectGhost=c,c.animate(s,{duration:u,easing:d,complete:function(){t.__effectGhost=null,c.remove(),a.css("visibility",""),r()}})}(t,n,o):(t=a.duration,a=a.easing,u=n?1:0,i.stop(1,1),i.css({visibility:"visible",display:n?"none":"block"}),i[s+r[s][u]](t,function(){i.css({display:"block",visibility:""}),o()},a)):o()}function n(){}var r={fade:["Out","In"],slide:["Up","Down"]};return n.ATTRS={effect:{value:{effect:"",target:null,duration:.5,easing:"easeOut"},setter:function(e){var t=e.effect;"string"==typeof t&&!r[t]&&(e.effect="")}}},n.prototype={__afterCreateEffectGhost:function(e){return e},_onSetVisible:function(e){var n=this;t(n,e,function(){n.fire(e?"show":"hide")})}},n}),KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./overlay-render,./extension/overlay-effect".split(","),function(e,t){var n=t("component/container"),r=t("component/extension/shim"),o=t("component/extension/align"),i=t("./extension/loading"),a=t("./extension/mask"),s=t("./overlay-render"),u=t("./extension/overlay-effect"),l={hide:"hide",destroy:"destroy"};return n.extend([r,i,o,a,u],{bindUI:function(){var e=this,t=e.get("closeBtn");t&&t.on("click",function(t){e.close(),t.preventDefault()})},close:function(){return this[l[this.get("closeAction")]||"hide"](),this}},{ATTRS:{contentEl:{},closable:{value:!1,view:1},closeBtn:{view:1},closeAction:{value:"hide"},focusable:{value:!1},allowTextSelection:{value:!0},handleMouseEvents:{value:!1},visible:{value:!1},xrender:{value:s}},xclass:"overlay"})}),KISSY.add("overlay/dialog-xtpl",["overlay/close-xtpl"],function(e,t,n,r){return function(e){var n,o,i=this;n=this.config.utils,void 0!==r&&r.kissy&&(o=r);var a=n.runBlockCommand,s=n.renderOutput,u=n.getProperty,l=n.runInlineCommand,c=n.getPropertyOrRunCommand;n="";var d={},h=[];return h.push("overlay/close-xtpl"),d.params=h,o&&(t("overlay/close-xtpl"),d.params[0]=o.resolveByName(d.params[0])),o=l(i,e,d,"include",1),n+=s(o,!1),n+='\n<div id="ks-content-',o=c(i,e,{},"id",0,2),n+=s(o,!0),n+='"\n     class="',o={},(d=[]).push("content"),o.params=d,o=l(i,e,o,"getBaseCssClasses",3),n+=s(o,!0),n+='">\n    <div class="',o={},(d=[]).push("header"),o.params=d,o=l(i,e,o,"getBaseCssClasses",4),n+=s(o,!0),n+='"\n         style="\n',o={},d=[],h=u(i,e,"headerStyle",0,6),d.push(h),o.params=d,o.fn=function(e){var t;t=" \n ";var n=c(i,e,{},"xindex",0,7);return t+=s(n,!0),t+=":",e=c(i,e,{},".",0,7),(t+=s(e,!0))+";\n"},n+=a(i,e,o,"each",6),n+='\n"\n         id="ks-stdmod-header-',o=c(i,e,{},"id",0,10),n+=s(o,!0),n+='">',o=c(i,e,{},"headerContent",0,10),n+=s(o,!1),n+='</div>\n\n    <div class="',o={},(d=[]).push("body"),o.params=d,o=l(i,e,o,"getBaseCssClasses",12),n+=s(o,!0),n+='"\n         style="\n',o={},d=[],h=u(i,e,"bodyStyle",0,14),d.push(h),o.params=d,o.fn=function(e){var t;t=" \n ";var n=c(i,e,{},"xindex",0,15);return t+=s(n,!0),t+=":",e=c(i,e,{},".",0,15),(t+=s(e,!0))+";\n"},n+=a(i,e,o,"each",14),n+='\n"\n         id="ks-stdmod-body-',o=c(i,e,{},"id",0,18),n+=s(o,!0),n+='">',o=c(i,e,{},"bodyContent",0,18),n+=s(o,!1),n+='</div>\n\n    <div class="',o={},(d=[]).push("footer"),o.params=d,l=l(i,e,o,"getBaseCssClasses",20),n+=s(l,!0),n+='"\n         style="\n',l={},o=[],u=u(i,e,"footerStyle",0,22),o.push(u),l.params=o,l.fn=function(e){var t;t=" \n ";var n=c(i,e,{},"xindex",0,23);return t+=s(n,!0),t+=":",e=c(i,e,{},".",0,23),(t+=s(e,!0))+";\n"},n+=a(i,e,l,"each",22),n+='\n"\n         id="ks-stdmod-footer-',a=c(i,e,{},"id",0,26),n+=s(a,!0),n+='">',e=c(i,e,{},"footerContent",0,26),(n+=s(e,!1))+'</div>\n</div>\n<div tabindex="0"></div>'}}),KISSY.add("overlay/dialog-render",["./overlay-render","./dialog-xtpl"],function(e,t){var n=t("./overlay-render"),r=t("./dialog-xtpl");return n.extend({beforeCreateDom:function(t){e.mix(t.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.control.get("id")})},createDom:function(){this.fillChildrenElsBySelectors({header:"#ks-stdmod-header-{id}",body:"#ks-stdmod-body-{id}",footer:"#ks-stdmod-footer-{id}"})},getChildrenContainerEl:function(){return this.control.get("body")},_onSetBodyStyle:function(e){this.control.get("body").css(e)},_onSetHeaderStyle:function(e){this.control.get("header").css(e)},_onSetFooterStyle:function(e){this.control.get("footer").css(e)},_onSetBodyContent:function(e){this.control.get("body").html(e)},_onSetHeaderContent:function(e){this.control.get("header").html(e)},_onSetFooterContent:function(e){this.control.get("footer").html(e)}},{ATTRS:{contentTpl:{value:r}},HTML_PARSER:{header:function(e){return e.one("."+this.getBaseCssClass("header"))},body:function(e){return e.one("."+this.getBaseCssClass("body"))},footer:function(e){return e.one("."+this.getBaseCssClass("footer"))},headerContent:function(e){return e.one("."+this.getBaseCssClass("header")).html()},bodyContent:function(e){return e.one("."+this.getBaseCssClass("body")).html()},footerContent:function(e){return(e=e.one("."+this.getBaseCssClass("footer")))&&e.html()}}})}),KISSY.add("overlay/dialog",["./control","./dialog-render","node"],function(e,t){var n=t("./control"),r=t("./dialog-render"),o=t("node"),i=(n=n.extend({__afterCreateEffectGhost:function(e){var t=this.get("body");return e.all("."+this.get("prefixCls")+"stdmod-body").css({height:t.height(),width:t.width()}).html(""),e},handleKeyDownInternal:function(e){if(this.get("escapeToClose")&&e.keyCode===o.KeyCode.ESC)("select"!==e.target.nodeName.toLowerCase()||e.target.disabled)&&(this.close(),e.halt());else e:if(e.keyCode===i){var t=this.$el,n=o.all(e.target),r=t.last();if(n.equals(t)&&e.shiftKey)r[0].focus(),e.halt();else if(n.equals(r)&&!e.shiftKey)this.focus(),e.halt();else if(n.equals(t)||t.contains(n))break e;e.halt()}},_onSetVisible:function(e,t){var n=this.el;if(e)this.__lastActive=n.ownerDocument.activeElement,this.focus(),n.setAttribute("aria-hidden","false");else{n.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(e){}}this.callSuper(e,t)}},{ATTRS:{header:{view:1},body:{view:1},footer:{view:1},bodyStyle:{value:{},view:1},footerStyle:{value:{},view:1},headerStyle:{value:{},view:1},headerContent:{value:"",view:1},bodyContent:{value:"",view:1},footerContent:{value:"",view:1},closable:{value:!0},xrender:{value:r},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),o.KeyCode.TAB);return n}),KISSY.add("overlay/popup",["./control"],function(e,t){return t("./control").extend({initializer:function(){var e=this;e.get("trigger")&&("mouse"===e.get("triggerType")?(e._bindTriggerMouse(),e.on("afterRenderUI",function(){e._bindContainerMouse()})):e._bindTriggerClick())},_bindTriggerMouse:function(){var t,n=this,r=n.get("trigger");n.__mouseEnterPopup=function(r){n._clearHiddenTimer(),t=e.later(function(){n._showing(r),t=void 0},1e3*n.get("mouseDelay"))},r.on("mouseenter",n.__mouseEnterPopup),n._mouseLeavePopup=function(){t&&(t.cancel(),t=void 0),n._setHiddenTimer()},r.on("mouseleave",n._mouseLeavePopup)},_bindContainerMouse:function(){this.$el.on("mouseleave",this._setHiddenTimer,this).on("mouseenter",this._clearHiddenTimer,this)},_setHiddenTimer:function(){var t=this;t._hiddenTimer=e.later(function(){t._hiding()},1e3*t.get("mouseDelay"))},_clearHiddenTimer:function(){this._hiddenTimer&&(this._hiddenTimer.cancel(),this._hiddenTimer=void 0)},_bindTriggerClick:function(){var e=this;e.__clickPopup=function(t){t.preventDefault(),e.get("toggle")?e[e.get("visible")?"_hiding":"_showing"](t):e._showing(t)},e.get("trigger").on("click",e.__clickPopup)},_showing:function(t){this.set("currentTrigger",e.one(t.target)),this.show()},_hiding:function(){this.set("currentTrigger",void 0),this.hide()},destructor:function(){var e=this.$el,t=this.get("trigger");t&&(this.__clickPopup&&t.detach("click",this.__clickPopup),this.__mouseEnterPopup&&t.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&t.detach("mouseleave",this._mouseLeavePopup)),e.detach("mouseleave",this._setHiddenTimer,this).detach("mouseenter",this._clearHiddenTimer,this)}},{ATTRS:{trigger:{setter:function(t){return e.all(t)}},triggerType:{value:"click"},currentTrigger:{},mouseDelay:{value:.1},toggle:{value:!1}},xclass:"popup"})}),KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(e,t){var n=t("overlay/control"),r=t("overlay/dialog"),o=t("overlay/popup");return n.Dialog=r,e.Dialog=r,n.Popup=o,e.Overlay=n}),KISSY.add("component/container/render",["component/control","component/manager"],function(e,t){var n=t("component/control"),r=t("component/manager");return n.getDefaultRender().extend([],{decorateDom:function(){var t=this,n=t.getChildrenContainerEl(),o=t.control,i=o.get("defaultChildCfg"),a=i.prefixCls,s=i.xclass,u=[];n.children().each(function(n){var o=t.getComponentConstructorByNode(a,n)||s&&r.getConstructorByXClass(s);o&&u.push(new o(e.merge(i,{srcNode:n})))}),o.set("children",u)},getChildrenContainerEl:function(){return this.$el}},{name:"ContainerRender"})}),KISSY.add("component/container",["component/control","./container/render"],function(e,t){function n(e){if(e.target===this){var t=e.component,n=this.get("children");e=e.index;n.splice(e,0,t),(t=(n=this.get("children"))[e]).setInternal("parent",this),this.get("rendered")&&this.renderChild(e),this.fire("afterAddChild",{component:t,index:e})}}function r(e){if(e.target===this){var t,n,r=e.component,o=e.destroy,i=this.get("children");-1!==(e=e.index)&&i.splice(e,1),r.setInternal("parent",null),o?r.destroy&&r.destroy():r.get&&(n=r.el)&&(t=n.parentNode)&&t.removeChild(n),this.fire("afterRemoveChild",{component:r,index:e})}}var o=t("component/control"),i=t("./container/render");return o.extend({isContainer:!0,initializer:function(){var e=this.get("prefixCls"),t=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:n}),this.publish("beforeRemoveChild",{defaultFn:r}),t.prefixCls=t.prefixCls||e},createDom:function(){this.createChildren()},renderUI:function(){this.renderChildren()},renderChildren:function(){var e,t=this.get("children");for(e=0;e<t.length;e++)this.renderChild(e)},createChildren:function(){var e,t=this.get("children");for(e=0;e<t.length;e++)this.createChild(e)},addChild:function(e,t){var n=this.get("children");void 0===t&&(t=n.length),this.fire("beforeAddChild",{component:e,index:t})},renderChild:function(e){var t=this.get("children");this.createChild(e).render(),this.fire("afterRenderChild",{component:t[e],index:e})},createChild:function(e){var t,n,r,o;return t=this.get("children")[e],n=(r=(o=this.view.getChildrenContainerEl())[0]).children[e]||null,t.get("rendered")?(o=t.el).parentNode!==r&&r.insertBefore(o,n):(n?t.set("elBefore",n):t.set("render",o),t.create()),this.fire("afterCreateChild",{component:t,index:e}),t},removeChild:function(t,n){void 0===n&&(n=!0),this.fire("beforeRemoveChild",{component:t,index:e.indexOf(t,this.get("children")),destroy:n})},removeChildren:function(e){var t,n=[].concat(this.get("children"));for(t=0;t<n.length;t++)this.removeChild(n[t],e);return this},getChildAt:function(e){return this.get("children")[e]||null},destructor:function(){var e,t=this.get("children");for(e=0;e<t.length;e++)t[e].destroy&&t[e].destroy()}},{ATTRS:{children:{value:[],getter:function(t){var n,r,o=null;for(n=0;n<t.length;n++)(r=t[n]).isControl||(o=o||this.get("defaultChildCfg"),e.mix(r,o,!1),t[n]=this.createComponent(r));return t},setter:function(e){var t,n;for(t=0;t<e.length;t++)(n=e[t]).isControl&&n.setInternal("parent",this)}},defaultChildCfg:{value:{}},xrender:{value:i}},name:"container"})}),KISSY.add("component/control/process",["base","promise"],function(e,t){function n(e){e.fire("beforeSyncUI"),e.syncUI(),e.__callPluginsMethod("pluginSyncUI"),e.fire("afterSyncUI")}var r=t("base"),o=t("promise").Defer,i=r.prototype.__getHook,a=e.noop,s=r.extend({bindInternal:a,syncInternal:a,initializer:function(){this._renderedDefer=new o},renderUI:a,syncUI:a,bindUI:a,onRendered:function(e){return this._renderedDefer.promise.then(e)},create:function(){return this.get("created")||(this.fire("beforeCreateDom"),this.createInternal(),this.__callPluginsMethod("pluginCreateDom"),this.fire("afterCreateDom"),this.setInternal("created",!0)),this},createInternal:function(){this.createDom()},render:function(){return this.get("rendered")||(this.create(),this.fire("beforeRenderUI"),this.renderUI(),this.__callPluginsMethod("pluginRenderUI"),this.fire("afterRenderUI"),this.fire("beforeBindUI"),s.superclass.bindInternal.call(this),this.bindUI(),this.__callPluginsMethod("pluginBindUI"),this.fire("afterBindUI"),s.superclass.syncInternal.call(this),n(this),this.setInternal("rendered",!0)),this},sync:function(){n(this)},plug:function(e){var t=this.get("plugins");return this.callSuper(e),e=t[t.length-1],this.get("rendered")?(e.pluginCreateDom&&e.pluginCreateDom(this),e.pluginRenderUI&&e.pluginCreateDom(this),e.pluginBindUI&&e.pluginBindUI(this),e.pluginSyncUI&&e.pluginSyncUI(this)):this.get("created")&&e.pluginCreateDom&&e.pluginCreateDom(this),this}},{__hooks__:{createDom:i("__createDom"),renderUI:i("__renderUI"),bindUI:i("__bindUI"),syncUI:i("__syncUI")},name:"ComponentProcess",ATTRS:{rendered:{value:!1,setter:function(e){e&&this._renderedDefer.resolve(this)}},created:{value:!1}}});return s}),KISSY.add("component/control/render-xtpl",[],function(){return function(e){var t,n=this,r=(t=this.config.utils).runBlockCommand,o=t.renderOutput,i=t.getProperty,a=t.runInlineCommand,s=t.getPropertyOrRunCommand;t='<div id="';var u=s(n,e,{},"id",0,1);t+=o(u,!0),t+='"\n class="';u={};var l=[];return l.push(""),u.params=l,a=a(n,e,u,"getBaseCssClasses",2),t+=o(a,!0),t+="\n",a={},u=[],l=i(n,e,"elCls",0,3),u.push(l),a.params=u,a.fn=function(e){var t;return t="\n ",e=s(n,e,{},".",0,4),(t+=o(e,!0))+"  \n"},t+=r(n,e,a,"each",3),t+='\n"\n\n',a={},u=[],l=i(n,e,"elAttrs",0,8),u.push(l),a.params=u,a.fn=function(e){var t;t=" \n ";var r=s(n,e,{},"xindex",0,9);return t+=o(r,!0),t+='="',e=s(n,e,{},".",0,9),(t+=o(e,!0))+'"\n'},t+=r(n,e,a,"each",8),t+='\n\nstyle="\n',a={},u=[],i=i(n,e,"elStyle",0,13),u.push(i),a.params=u,a.fn=function(e){var t;t=" \n ";var r=s(n,e,{},"xindex",0,14);return t+=o(r,!0),t+=":",e=s(n,e,{},".",0,14),(t+=o(e,!0))+";\n"},(t+=r(n,e,a,"each",13))+'\n">'}}),KISSY.add("component/control/render",["node","xtemplate/runtime","./process","./render-xtpl","component/manager"],function(e,t){function n(e){return"number"==typeof e&&(e+="px"),e}function r(e){return e||(e=[""]),"string"==typeof e&&(e=e.split(/\s+/)),e}function o(e,t,n){var r="",o=0,i=n.length;for(t=e+t;o<i;o++)r+=" "+t+(e=(e=n[o])?"-"+e:e);return r}function i(e){e.target===this.control&&this[f+e.type.slice(5).slice(0,-6)].call(this,e.newVal,e)}function a(e,t){return this.config.view.getBaseCssClasses(t.params[0])}function s(e,t){return this.config.view.getBaseCssClass(t.params[0])}var u=t("node"),l=t("xtemplate/runtime"),c=t("./process"),d=t("./render-xtpl"),h=t("component/manager"),f="_onSet",g=e.trim,p=u.all,m=e.UA,_=e.Env.host.document;return c.extend({isRender:!0,createInternal:function(){var e=this.control.get("srcNode");e?this.decorateDom(e):this.callSuper()},beforeCreateDom:function(e){var t,r,o,i,a=this.control,s=a.get("elAttrs"),u=a.get("elCls");t=a.getAttrs(),i=a.get("elStyle");var l=a.get("elCls");for(r in t)(o=t[r]).view&&(e[r]=a.get(r));t=e.width,r=e.height,o=e.visible,e=e.zIndex,t&&(i.width=n(t)),r&&(i.height=n(r)),e&&(i["z-index"]=e),o||l.push(this.getBaseCssClasses("hidden")),(i=a.get("disabled"))&&(u.push(this.getBaseCssClasses("disabled")),s["aria-disabled"]="true"),a.get("highlighted")&&u.push(this.getBaseCssClasses("hover")),a.get("focusable")&&(9>m.ieMode&&(s.hideFocus="true"),s.tabindex=i?"-1":"0")},createDom:function(){this.beforeCreateDom(this.renderData={},this.childrenElSelectors={},this.renderCommands={getBaseCssClasses:a,getBaseCssClass:s});var e,t=this.control;e=this.renderTpl(d)+this.renderTpl(this.get("contentTpl"))+"</div>",t.setInternal("el",this.$el=p(e)),this.el=this.$el[0],this.fillChildrenElsBySelectors()},decorateDom:function(t){var n=this.control;t.attr("id")||t.attr("id",n.get("id"));var r,o,i=this.constructor.HTML_PARSER;for(r in i)"function"==typeof(o=i[r])?void 0!==(o=o.call(this,t))&&n.setInternal(r,o):"string"==typeof o?n.setInternal(r,t.one(o)):e.isArray(o)&&o[0]&&n.setInternal(r,t.all(o[0]));n.setInternal("el",this.$el=t),this.el=t[0]},renderUI:function(){var e=this.control,t=this.$el;if(!e.get("srcNode")){var n=e.get("render");(e=e.get("elBefore"))?t.insertBefore(e,void 0):n?t.appendTo(n,void 0):t.appendTo(_.body,void 0)}},bindUI:function(){var t,n,r=this.control,o=r.getAttrs();for(t in o){n=o[t];var a=e.ucfirst(t),s=this[f+a];n.view&&s&&r.on("after"+a+"Change",i,this)}},destructor:function(){this.$el&&this.$el.remove()},$:function(e){return this.$el.all(e)},fillChildrenElsBySelectors:function(t){var n,r,o=this.$el,i=this.control;t=t||this.childrenElSelectors;for(n in t)"function"==typeof(r=t[n])?i.setInternal(n,r(o)):i.setInternal(n,this.$(e.substitute(r,this.renderData))),delete t[n]},renderTpl:function(e,t,n){return t=t||this.renderData,n=n||this.renderCommands,new(this.get("xtemplate"))(e,{control:this.control,view:this,commands:n}).render(t)},getComponentConstructorByNode:function(e,t){var n=t[0].className;return n?(n=n.replace(RegExp("\\b"+e,"ig"),""),h.getConstructorByXClass(n)):null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;for(var e,t=this.control.constructor,n=[];t&&!t.prototype.hasOwnProperty("isControl");)(e=t.xclass)&&n.push(e),t=t.superclass&&t.superclass.constructor;return this.componentCssClasses=n},getBaseCssClasses:function(e){e=r(e);var t=this.getComponentCssClasses(),n=0,i=this.get("control"),a="",s=t.length;for(i=i.get("prefixCls");n<s;n++)a+=o(i,t[n],e);return g(a)},getBaseCssClass:function(e){return g(o(this.control.get("prefixCls"),this.getComponentCssClasses()[0],r(e)))},getKeyEventTarget:function(){return this.$el},_onSetWidth:function(e){this.$el.width(e)},_onSetHeight:function(e){this.$el.height(e)},_onSetContent:function(e){var t=this.$el;t.html(e),this.get("allowTextSelection")||t.unselectable()},_onSetVisible:function(e){var t=this.$el,n=this.getBaseCssClasses("hidden");e?t.removeClass(n):t.addClass(n)},_onSetHighlighted:function(e){var t=this.getBaseCssClasses("hover");this.$el[e?"addClass":"removeClass"](t)},_onSetDisabled:function(e){var t=this.control,n=this.getBaseCssClasses("disabled");this.$el[e?"addClass":"removeClass"](n).attr("aria-disabled",e),t.get("focusable")&&this.getKeyEventTarget().attr("tabindex",e?-1:0)},_onSetActive:function(e){var t=this.getBaseCssClasses("active");this.$el[e?"addClass":"removeClass"](t).attr("aria-pressed",!!e)},_onSetFocused:function(e){var t=this.$el,n=this.getBaseCssClasses("focused");t[e?"addClass":"removeClass"](n)},_onSetZIndex:function(e){this.$el.css("z-index",e)}},{__hooks__:{decorateDom:c.prototype.__getHook("__decorateDom"),beforeCreateDom:c.prototype.__getHook("__beforeCreateDom")},extend:function t(n,r,o){var i,a={};return(i=c.extend.apply(this,arguments)).HTML_PARSER=i.HTML_PARSER||{},e.isArray(n)&&(e.each(n.concat(i),function(t){t&&e.each(t.HTML_PARSER,function(e,t){a[t]=e})}),i.HTML_PARSER=a),e.mix(i.HTML_PARSER,this.HTML_PARSER,!1),i.extend=t,i},ATTRS:{control:{setter:function(e){this.control=e}},xtemplate:{value:l},contentTpl:{value:function(e){return e.get("content")||""}}},HTML_PARSER:{id:function(e){return(e=e[0].id)?e:void 0},content:function(e){return e.html()},disabled:function(e){return e.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})}),KISSY.add("component/control",["node","./control/process","component/manager","./control/render"],function(e,t){function n(){var e,t=this;do{e=t.ATTRS,t=t.superclass}while(!e||!e.xrender);return e.xrender.value}var r=t("node"),o=t("./control/process"),i=t("component/manager"),a=t("./control/render"),s=e.UA.ieMode,u=e.Features,l=r.Gesture,c=u.isTouchGestureSupported(),d=u.isTouchEventSupported();return(a=o.extend({isControl:!0,createDom:function(){var e=this.get("xrender"),t=this.get("view"),n=this.get("id");t?t.set("control",this):this.set("view",this.view=t=new e({control:this})),t.create(),e=t.getKeyEventTarget(),this.get("allowTextSelection")||e.unselectable(),i.addComponent(n,this)},renderUI:function(){this.view.render()},bindUI:function(){var e=this.view.getKeyEventTarget();this.get("focusable")&&e.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this),this.get("handleMouseEvents")&&(e=this.$el,d||e.on("mouseenter",this.handleMouseEnter,this).on("mouseleave",this.handleMouseLeave,this).on("contextmenu",this.handleContextMenu,this),e.on(l.start,this.handleMouseDown,this).on(l.end,this.handleMouseUp,this).on(l.tap,this.handleClick,this),l.cancel&&e.on(l.cancel,this.handleMouseUp,this),9>s&&e.on("dblclick",this.handleDblClick,this))},sync:function(){this.fire("beforeSyncUI"),this.syncUI(),this.view.sync(),this.__callPluginsMethod("pluginSyncUI"),this.fire("afterSyncUI")},createComponent:function(e,t){return i.createComponent(e,t||this)},_onSetFocused:function(e){var t=this.view.getKeyEventTarget()[0];e?t.focus():t.ownerDocument.activeElement===t&&t.ownerDocument.body.focus()},_onSetX:function(e){this.$el.offset({left:e})},_onSetY:function(e){this.$el.offset({top:e})},_onSetVisible:function(e){this.fire(e?"show":"hide")},show:function(){return this.render(),this.set("visible",!0),this},hide:function(){return this.set("visible",!1),this},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},move:function(e,t){this.set({x:e,y:t})},handleDblClick:function(e){this.get("disabled")||this.handleDblClickInternal(e)},handleDblClickInternal:function(e){this.handleClickInternal(e)},handleMouseEnter:function(e){this.get("disabled")||this.handleMouseEnterInternal(e)},handleMouseEnterInternal:function(e){this.set("highlighted",!!e)},handleMouseLeave:function(e){this.get("disabled")||this.handleMouseLeaveInternal(e)},handleMouseLeaveInternal:function(e){this.set("active",!1),this.set("highlighted",!e)},handleMouseDown:function(e){this.get("disabled")||this.handleMouseDownInternal(e)},handleMouseDownInternal:function(e){var t;(1===e.which||c)&&(this.get("activeable")&&this.set("active",!0),this.get("focusable")&&this.focus(),this.get("allowTextSelection")||"input"!==(t=(t=e.target.nodeName)&&t.toLowerCase())&&"textarea"!==t&&e.preventDefault())},handleMouseUp:function(e){this.get("disabled")||this.handleMouseUpInternal(e)},handleMouseUpInternal:function(e){this.get("active")&&(1===e.which||c)&&this.set("active",!1)},handleContextMenu:function(e){this.get("disabled")||this.handleContextMenuInternal(e)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},handleFocusInternal:function(){this.focus(),this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur(),this.fire("blur")},handleKeydown:function(e){if(!this.get("disabled")&&this.handleKeyDownInternal(e))return e.halt(),!0},handleKeyDownInternal:function(e){if(e.keyCode===r.KeyCode.ENTER)return this.handleClickInternal(e)},handleClick:function(e){this.get("disabled")||this.handleClickInternal(e)},handleClickInternal:function(){this.get("focusable")&&this.focus()},destructor:function(){i.removeComponent(this.get("id")),this.view?this.view.destroy():this.get("srcNode")&&this.get("srcNode").remove()}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return e.guid("ks-component")}},content:{view:1,value:""},width:{view:1},height:{view:1},elCls:{view:1,value:[],setter:function(e){return"string"==typeof e&&(e=e.split(/\s+/)),e||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(e){this.$el=e,this.el=e[0]}},x:{},y:{},xy:{setter:function(t){var n=e.makeArray(t);return n.length&&(void 0!==n[0]&&this.set("x",n[0]),void 0!==n[1]&&this.set("y",n[1])),t},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:!0,view:1},srcNode:{setter:function(e){return r.all(e)}},handleMouseEvents:{value:!0},focusable:{value:!0,view:1},allowTextSelection:{value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},prefixCls:{view:1,value:e.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(e,t){(t=this.get("parent"))&&this.removeTarget(t),e&&this.addTarget(e)}},disabled:{view:1,value:!1},xrender:{value:a},view:{setter:function(e){this.view=e}}}})).getDefaultRender=n,a.extend=function t(r,a,s){var u,l=e.makeArray(arguments),c=l[l.length-1];return(u=c.xclass)&&(c.name=u),l=o.extend.apply(this,l),u&&i.setConstructorByXClass(u,l),l.extend=t,l.getDefaultRender=n,l},a}),KISSY.add("component/manager",[],function(){var e,t=0,n={},r={};return e={__instances:r,addComponent:function(e,t){r[e]=t},removeComponent:function(e){delete r[e]},getComponent:function(e){return r[e]},createComponent:function(t,n){var r;return t&&(!t.isControl&&n&&(t.prefixCls||(t.prefixCls=n.get("prefixCls")),!t.xclass&&t.prefixXClass)&&(t.xclass=t.prefixXClass,t.xtype&&(t.xclass+="-"+t.xtype)),!t.isControl&&(r=t.xclass)&&(t=new(e.getConstructorByXClass(r))(t)),t.isControl&&n&&t.setInternal("parent",n)),t},getConstructorByXClass:function(e){e=e.split(/\s+/);var t,r,o,i=-1,a=null;for(r=0;r<e.length;r++)(o=n[e[r]])&&(t=o.priority)>i&&(i=t,a=o.constructor);return a},setConstructorByXClass:function(e,r){n[e]={constructor:r,priority:t++}}}}),KISSY.add("xtemplate/runtime/scope",[],function(e){function t(e,t){this.data=e||{},this.affix=t,this.root=this}return t.prototype={isScope:1,setParent:function(e){this.parent=e,this.root=e.root},getParent:function(){return this.parent},getRoot:function(){return this.root},set:function(e,t){this.affix||(this.affix={}),this.affix[e]=t},setData:function(e){this.data=e},getData:function(){return this.data},mix:function(t){this.affix||(this.affix={}),e.mix(this.affix,t)},has:function(e){var t=this.data,n=this.affix;return!!(n&&e in n)||"object"==typeof t&&e in t},get:function(e){var t=this.data,n=this.affix;return n&&e in n?n[e]:"object"==typeof t&&e in t?t[e]:void 0},resolve:function(e,t){"."===e&&(e="this");var n,r,o,i,a,s=e.split("."),u=this;if("root"===s[0])s.shift(),u=u.root;else if(t)for(;u&&t--;)u=u.parent;var l=0;for(n=s.length;u;){for(a=1,o=u,r=0;r<n;r++)if("this"===(i=s[r]))l=1;else if(o===u){if(!u.has(i)){a=0;break}o=u.get(i)}else{if("object"!=typeof o||!(i in o)){a=0;break}o=o[i]}if(a)return o&&o.isScope&&(o=o.data),"function"==typeof o&&(o=o.call(this.data)),[o];if(l)break;u=u.parent}return!1}},t}),KISSY.add("xtemplate/runtime/commands",["path","./scope"],function(e,t){var n,r=t("path"),o=t("./scope");return n={each:function(t,n){var r,i,a,s=(l=n.params)[0],u=l[2]||"xindex",l=l[1],c="";if(s)if(i=new o,e.isArray(s)){r=s.length;for(var d=0;d<r;d++)i.data=s[d],(a=i.affix={xcount:r})[u]=d,l&&(a[l]=s[d]),i.setParent(t),c+=n.fn(i)}else for(r in s)i.data=s[r],(a=i.affix={})[u]=r,l&&(a[l]=s[r]),i.setParent(t),c+=n.fn(i);else n.inverse&&(c=n.inverse(t));return c},with:function(e,t){var n=t.params[0],r="";return n?((n=new o(n)).setParent(e),r=t.fn(n)):t.inverse&&(r=t.inverse(e)),r},if:function(e,t){var n="";return t.params[0]?t.fn&&(n=t.fn(e)):t.inverse&&(n=t.inverse(e)),n},set:function(e,t){return e.mix(t.hash),""},include:function(t,n){var i=n.params;if(!i||1!==i.length)return"";if(n.hash){var a=new o(n.hash);a.setParent(t),t=a}if(a=this.config.name,"."===(i=i[0]).charAt(0)){if("unspecified"===a)return"";i=r.resolve(a,"../",i)}return a=this.config.loader.call(this,i),(n=e.merge(this.config)).name=i,n.commands=this.config.commands,n.macros=this.config.macros,this.invokeEngine(a,t,n)},macro:function(t,n){var r=(a=n.params)[0],i=a.slice(1),a=this.config.macros;if(!n.fn){var s={};return(r=a[r])||name,e.each(r.paramNames,function(e,t){s[e]=i[t]}),a=new o(s),r.fn.call(this,a)}return a[r]||(a[r]={paramNames:i,fn:n.fn}),""},parse:function(e,t){return n.include.call(this,new o,t)}}}),KISSY.add("xtemplate/runtime",["./runtime/commands","./runtime/scope"],function(e,t){function n(e){}function r(e,t){for(var n=t.split("."),r=e,o=n.length,i=0;i<o&&(r=r[n[i]]);i++);return r}function o(e,t,n,o,i,a){var s,u=r(e.config.commands,o);if(u){try{s=u.call(e,t,n)}catch(e){e.message}return{find:!0,value:s}}return{find:!1}}function i(t,r,o,i,a){var s;t=t.config.silent?n:e.error;return!1===(r=r.resolve(o,i))?t('can not find property: "'+o+'" at line '+a,"warn"):s=r[0],s}function a(t,n){this.tpl=t,(n=e.merge(d,n)).commands=e.merge(n.commands,s),n.utils=c,n.macros=n.macros||{},this.config=n}var s=t("./runtime/commands"),u=t("./runtime/scope"),l=e.escapeHtml,c={runBlockCommand:function(t,o,i,a,s){var u,l,c=(u=t.config).silent?n:e.error,d=r(u=u.commands,a);if(!d){if(i.params||i.hash)return"";var h=o.resolve(a);!1===h?(c('can not find property: "'+a+'" at line '+s),h=""):h=h[0],d=u.if,e.isArray(h)?d=u.each:"object"==typeof h&&(d=u.with),i.params=[h]}try{l=d.call(t,o,i)}catch(e){e.message}return l},renderOutput:function(e,t){return void 0===e&&(e=""),t&&e?l(e):e},getProperty:function(e,t,n,r,o){return i(e,t,n,r,o)},runInlineCommand:function(e,t,n,r,i){var a="";return(e=o(e,t,n,r)).find&&(a=e.value),a},getPropertyOrRunCommand:function(e,t,n,r,a,s){var u,l=n.hash||n.params;return(n=o(e,t,n,r)).find?u=n.value:l||(u=i(e,t,r,a,s)),u}},d={silent:!0,name:"unspecified",loader:function(t){var n=e.require(t);return n}};return e.mix(a,{commands:s,utils:c,addCommand:function(e,t){s[e]=t},removeCommand:function(e){delete s[e]}}),a.prototype={constructor:a,invokeEngine:function(e,t,n){return new this.constructor(e,n).render(t,!0)},removeCommand:function(e){delete this.config.commands[e]},addCommand:function(e,t){this.config.commands[e]=t},render:function(t){var n=t;return n&&n.isScope||(n=new u(t)),this.tpl(n,e)}},a.Scope=u,a}),KISSY.add("component/extension/shim",[],function(e){function t(){}var n='<iframe style="position: absolute;border: none;width: '+((e=6===e.UA.ie)?"expression(this.parentNode.clientWidth)":"100%")+";top: 0;opacity: 0;filter: alpha(opacity=0);left: 0;z-index: -1;height: "+(e?"expression(this.parentNode.clientHeight)":"100%")+';"/>';return t.ATTRS={shim:{value:e}},t.prototype.__createDom=function(){this.get("shim")&&this.get("el").prepend(n)},t}),KISSY.add("component/extension/align",["node"],function(e,t){function n(e){var t=e.ownerDocument.body,n=f(e).css("position");if("fixed"!==n&&"absolute"!==n)return"html"===e.nodeName.toLowerCase()?null:e.parentNode;for(e=e.parentNode;e&&e!==t;e=e.parentNode)if("static"!==(n=f(e).css("position")))return e;return null}function r(e){var t,r,o,i={left:0,right:1/0,top:0,bottom:1/0};for(o=e.ownerDocument,r=f(o).getWindow(),t=o.body,o=o.documentElement;e=n(e);)if((!g.ie||0!==e.clientWidth)&&e!==t&&e!==o&&"visible"!==f(e).css("overflow")){var a=f(e).offset();a.left+=e.clientLeft,a.top+=e.clientTop,i.top=Math.max(i.top,a.top),i.right=Math.min(i.right,a.left+e.clientWidth),i.bottom=Math.min(i.bottom,a.top+e.clientHeight),i.left=Math.max(i.left,a.left)}return o=r.scrollLeft(),e=r.scrollTop(),i.left=Math.max(i.left,o),i.top=Math.max(i.top,e),t=r.width(),r=r.height(),i.right=Math.min(i.right,o+t),i.bottom=Math.min(i.bottom,e+r),0<=i.top&&0<=i.left&&i.bottom>i.top&&i.right>i.left?i:null}function o(e,t,n,r){var o,i;return o=e.left,i=e.top,t=u(t,n[0]),{left:o-(e=[(e=u(e,n[1])).left-t.left,e.top-t.top])[0]+ +r[0],top:i-e[1]+ +r[1]}}function i(t,n,r){var o=[];return e.each(t,function(e){o.push(e.replace(n,function(e){return r[e]}))}),o}function a(){}function s(t){var n,r;return n=t[0],e.isWindow(n)?(n={left:(t=f(n).getWindow()).scrollLeft(),top:t.scrollTop()},r=t.width(),t=t.height()):(n=t.offset(),r=t.outerWidth(),t=t.outerHeight()),n.width=r,n.height=t,n}function u(e,t){var n,r,o=t.charAt(0),i=t.charAt(1),a=e.width,s=e.height;return n=e.left,r=e.top,"c"===o?r+=s/2:"b"===o&&(r+=s),"c"===i?n+=a/2:"r"===i&&(n+=a),{left:n,top:r}}function l(e){e.target===this&&e.newVal&&this._onSetAlign(this.get("align"))}function c(){this.get("visible")&&this._onSetAlign(this.get("align"))}var d=t("node"),h=e.Env.host,f=d.all,g=e.UA;return a.__getOffsetParent=n,a.__getVisibleRectForElement=r,a.ATTRS={align:{value:{}}},a.prototype={__bindUI:function(){this.on("beforeVisibleChange",l,this),this.$el.getWindow().on("resize",c,this)},_onSetAlign:function(e){e&&e.points&&this.align(e.node,e.points,e.offset,e.overflow)},align:function(t,n,a,u){t=d.one(t||h),a=a&&[].concat(a)||[0,0],u=u||{};var l=this.$el,c=0,f=r(l[0]),g=s(l),p=s(t),m=(t=o(g,p,n,a),e.merge(g,t));return f&&(u.adjustX||u.adjustY)&&((t.left<f.left||t.left+g.width>f.right)&&(c=1,n=i(n,/[lr]/gi,{l:"r",r:"l"}),a[0]=-a[0]),(t.top<f.top||t.top+g.height>f.bottom)&&(c=1,n=i(n,/[tb]/gi,{t:"b",b:"t"}),a[1]=-a[1]),c&&(t=o(g,p,n,a),e.mix(m,t)),n=u.adjustX&&(t.left<f.left||t.left+g.width>f.right),u=u.adjustY&&(t.top<f.top||t.top+g.height>f.bottom),(n||u)&&(t=e.clone(t),m={width:g.width,height:g.height},n&&t.left<f.left&&(t.left=f.left),n&&t.left+m.width>f.right&&(t.left=Math.max(f.right-m.width,f.left)),u&&t.top<f.top&&(t.top=f.top),u&&t.top+m.height>f.bottom&&(t.top=Math.max(f.bottom-m.height,f.top)),m=e.mix(t,m))),this.set({x:m.left,y:m.top},{force:1}),m.width!==g.width&&this.set("width",l.width()+m.width-g.width),m.height!==g.height&&this.set("height",l.height()+m.height-g.height),this},center:function(e){return this.set("align",{node:e,points:["cc","cc"],offset:[0,0]}),this},__destructor:function(){this.$el&&this.$el.getWindow().detach("resize",c,this)}},a}),KISSY.add("component/extension/content-xtpl",[],function(){return function(e){var t,n=(t=this.config.utils).renderOutput,r=t.runInlineCommand,o=t.getPropertyOrRunCommand;t='<div id="ks-content-',t+=n(i=o(this,e,{},"id",0,1),!0),t+='"\n           class="';var i={},a=[];return a.push("content"),i.params=a,t+=n(r=r(this,e,i,"getBaseCssClasses",2),!0),t+='">',(t+=n(e=o(this,e,{},"content",0,2),!1))+"</div>"}}),KISSY.add("component/extension/content-render",["component/extension/content-xtpl"],function(e,t){function n(e){var t=e.control,n=t.get("contentEl");e.$contentEl=t.$contentEl=n,e.contentEl=t.contentEl=n[0]}function r(){}var o=t("component/extension/content-xtpl");return r.prototype={__beforeCreateDom:function(t,n){e.mix(n,{contentEl:"#ks-content-{id}"})},__createDom:function(){n(this)},__decorateDom:function(){n(this)},getChildrenContainerEl:function(){return this.control.get("contentEl")},_onSetContent:function(e){var t=this.control,n=t.$contentEl;n.html(e),t.get("allowTextSelection")||n.unselectable()}},e.mix(r,{ATTRS:{contentTpl:{value:o}},HTML_PARSER:{content:function(e){return e.one("."+this.getBaseCssClass("content")).html()},contentEl:function(e){return e.one("."+this.getBaseCssClass("content"))}}}),r}),KISSY.add("dd/ddm",["node","base"],function(e,t){function n(t){var n,r;t.touches&&1<t.touches.length?T._end():((n=this.__activeToDrag)?n._move(t):(r=this.get("activeDrag"))&&(r._move(t),this.__needDropCheck&&function(t,n,r){var u=t.get("validDrops"),l=r.get("mode"),c=0,d=0,h=o(r.get("node")),f=a(h);e.each(u,function(e){var t;if(!e.get("disabled")&&(t=e.getNodeFromTarget(n,r.get("dragNode")[0],r.get("node")[0])))if("point"===l)i(o(t),r.mousePos)&&(t=a(o(t)),c?t<d&&(c=e,d=t):(c=e,d=t));else if("intersect"===l)(t=a(s(h,o(t))))>d&&(d=t,c=e);else if("strict"===l&&(t=a(s(h,o(t))))===f)return c=e,!1}),(u=t.get("activeDrop"))&&u!==c&&(u._handleOut(n),r._handleOut(n));t.setInternal("activeDrop",c),c&&(u!==c?c._handleEnter(n):c._handleOver(n))}(this,t,r)),(n=n||r)&&n.get("preventDefaultOnMove")&&t.preventDefault())}function r(e){var t=e.get("activeDrag").get("activeHandler"),n="auto";t&&(n=t.css("cursor")),"auto"===n&&(n=e.get("dragCursor")),e._shim.css({cursor:n,display:"block"}),_&&b.call(e)}function o(e){var t=e.offset();return e.__ddCachedWidth||e[0],{left:t.left,right:t.left+(e.__ddCachedWidth||e.outerWidth()),top:t.top,bottom:t.top+(e.__ddCachedHeight||e.outerHeight())}}function i(e,t){return e.left<=t.left&&e.right>=t.left&&e.top<=t.top&&e.bottom>=t.top}function a(e){return e.top>=e.bottom||e.left>=e.right?0:(e.right-e.left)*(e.bottom-e.top)}function s(e,t){var n=Math.max(e.top,t.top),r=Math.min(e.right,t.right),o=Math.min(e.bottom,t.bottom);return{left:Math.max(e.left,t.left),right:r,top:n,bottom:o}}function u(e){e&&(e.__ddCachedWidth=e.outerWidth(),e.__ddCachedHeight=e.outerHeight())}var l=t("node"),c=t("base"),d=e.UA,h=l.all,f=e.Env.host,g=f.document,p=h(g),m=h(f),_=6===d.ie,v=(l=l.Gesture).move,y=l.end,I=(c=c.extend({__activeToDrag:0,_regDrop:function(e){this.get("drops").push(e)},_unRegDrop:function(t){var n=this.get("drops");-1!==(t=e.indexOf(t,n))&&n.splice(t,1)},_regToDrag:function(e){this.__activeToDrag=e,p.on(y,this._end,this),p.on(v,I,this),g.body.setCapture&&g.body.setCapture()},_start:function(){var t,n,r=this.__activeToDrag;r&&(this.setInternal("activeDrag",r),this.__activeToDrag=0,r.get("shim")&&S(this),this.__needDropCheck=0,r.get("groups")&&(n=(t=this).get("drops"),t.setInternal("validDrops",[]),n.length&&e.each(n,function(e){e._active()}),this.get("validDrops").length&&(u(r.get("node")),this.__needDropCheck=1)))},_addValidDrop:function(e){this.get("validDrops").push(e)},_end:function(t){var n,r,o=this.__activeToDrag,i=this.get("activeDrag"),a=this.get("activeDrop");t&&(o&&o._move(t),i&&i._move(t)),p.detach(v,I,this),p.detach(y,this._end,this),g.body.releaseCapture&&g.body.releaseCapture(),o&&(o._end(t),this.__activeToDrag=0),this._shim&&this._shim.hide(),i&&(i._end(t),r=(n=this).get("drops"),n.setInternal("validDrops",[]),r.length&&e.each(r,function(e){e._deActive()}),a&&a._end(t),this.setInternal("activeDrag",null),this.setInternal("activeDrop",null))}},{ATTRS:{dragCursor:{value:"move"},clickPixelThresh:{value:3},bufferTime:{value:1},activeDrag:{},activeDrop:{},drops:{value:[]},validDrops:{value:[]}}}),d.ie?e.throttle(n,30):n),S=function(e){e._shim=h('<div style="background-color:red;position:'+(_?"absolute":"fixed")+";left:0;width:100%;height:100%;top:0;cursor:"+T.get("dragCursor")+';z-index:999999;"></div>').prependTo(g.body||g.documentElement).css("opacity",0),S=r,_&&m.on("resize scroll",b,e),r(e)},b=e.throttle(function(){var e;(e=this.get("activeDrag"))&&e.get("shim")&&this._shim.css({width:p.width(),height:p.height()})},30),T=new c;return T.inRegion=i,T.region=o,T.area=a,T.cacheWH=u,T.PREFIX_CLS="ks-dd-",T}),KISSY.add("dd/draggable",["node","./ddm","base"],function(e,t){function n(){return!1}var r,o=t("node"),i=t("./ddm"),a=t("base"),s=o.all,u=e.each,l=e.Features,c=e.UA.ie,d=i.PREFIX_CLS,h=e.Env.host.document,f=function(e){var t=e.target;this._checkDragStartValid(e)&&this._checkHandler(t)&&this._prepare(e)};return a.extend({initializer:function(){this.addTarget(i),this._allowMove=this.get("move")},_onSetNode:function(e){this.setInternal("dragNode",e),this.bindDragEvent()},bindDragEvent:function(){this.get("node").on(o.Gesture.start,f,this).on("dragstart",this._fixDragStart)},detachDragEvent:function(e){(e=this).get("node").detach(o.Gesture.start,f,e).detach("dragstart",e._fixDragStart)},_bufferTimer:null,_onSetDisabledChange:function(e){this.get("dragNode")[e?"addClass":"removeClass"](d+"-disabled")},_fixDragStart:function(e){e.preventDefault()},_checkHandler:function(e){var t=this,n=t.get("handlers"),r=0;return u(n,function(n){if(n[0]===e||n.contains(e))return r=1,t.setInternal("activeHandler",n),!1}),r},_checkDragStartValid:function(e){return this.get("primaryButtonOnly")&&1!==e.which||this.get("disabled")?0:1},_prepare:function(e){if(e){var t=this;c&&(r=h.body.onselectstart,h.body.onselectstart=n),t.get("halt")&&e.stopPropagation(),l.isTouchEventSupported()||e.preventDefault();var o=e.pageX,a=e.pageY;if(t.setInternal("startMousePos",t.mousePos={left:o,top:a}),t._allowMove){var s=t.get("node").offset();t.setInternal("startNodePos",s),t.setInternal("deltaPos",{left:o-s.left,top:a-s.top})}i._regToDrag(t),(o=t.get("bufferTime"))&&(t._bufferTimer=setTimeout(function(){t._start(e)},1e3*o))}},_clearBufferTimer:function(){this._bufferTimer&&(clearTimeout(this._bufferTimer),this._bufferTimer=0)},_move:function(e){var t=e.pageX,n=e.pageY;if(!this.get("dragging")){var r=this.get("startMousePos"),o=0,i=this.get("clickPixelThresh");if((Math.abs(t-r.left)>=i||Math.abs(n-r.top)>=i)&&(this._start(e),o=1),!o)return}this.mousePos={left:t,top:n},e={drag:this,left:t,top:n,pageX:t,pageY:n,domEvent:e},(r=this._allowMove)&&(t-=(o=this.get("deltaPos")).left,n-=o.top,e.left=t,e.top=n,this.setInternal("actualPos",{left:t,top:n}),this.fire("dragalign",e)),n=1,!1===this.fire("drag",e)&&(n=0),n&&r&&this.get("node").offset(this.get("actualPos"))},stopDrag:function(){i._end()},_end:function(e){var t;e=e||{};this._clearBufferTimer(),c&&(h.body.onselectstart=r),this.get("dragging")&&(this.get("node").removeClass(d+"drag-over"),(t=i.get("activeDrop"))?this.fire("dragdrophit",{drag:this,drop:t}):this.fire("dragdropmiss",{drag:this}),this.setInternal("dragging",0),this.fire("dragend",{drag:this,pageX:e.pageX,pageY:e.pageY}))},_handleOut:function(){this.get("node").removeClass(d+"drag-over"),this.fire("dragexit",{drag:this,drop:i.get("activeDrop")})},_handleEnter:function(e){this.get("node").addClass(d+"drag-over"),this.fire("dragenter",e)},_handleOver:function(e){this.fire("dragover",e)},_start:function(e){this._clearBufferTimer(),this.setInternal("dragging",1),this.setInternal("dragStartMousePos",{left:e.pageX,top:e.pageY}),i._start(),this.fire("dragstart",{drag:this,pageX:e.pageX,pageY:e.pageY})},destructor:function(){this.detachDragEvent(),this.detach()}},{name:"Draggable",ATTRS:{node:{setter:function(e){if(!(e instanceof o))return s(e)}},clickPixelThresh:{valueFn:function(){return i.get("clickPixelThresh")}},bufferTime:{valueFn:function(){return i.get("bufferTime")}},dragNode:{},shim:{value:!1},handlers:{value:[],getter:function(e){var t=this;return e.length||(e[0]=t.get("node")),u(e,function(n,r){"function"==typeof n&&(n=n.call(t)),"string"==typeof n&&(n=t.get("node").one(n)),n.nodeType&&(n=s(n)),e[r]=n}),t.setInternal("handlers",e),e}},activeHandler:{},dragging:{value:!1,setter:function(e){this.get("dragNode")[e?"addClass":"removeClass"](d+"dragging")}},mode:{value:"point"},disabled:{value:!1},move:{value:!1},primaryButtonOnly:{value:!0},halt:{value:!0},groups:{value:!0},startMousePos:{},dragStartMousePos:{},startNodePos:{},deltaPos:{},actualPos:{},preventDefaultOnMove:{value:!0}},inheritedStatics:{DropMode:{POINT:"point",INTERSECT:"intersect",STRICT:"strict"}}})}),KISSY.add("dd/draggable-delegate",["node","./ddm","./draggable"],function(e,t){var n=t("node"),r=t("./ddm"),o=t("./draggable"),i=r.PREFIX_CLS,a=n.all,s=function(e){var t,n;if(this._checkDragStartValid(e)){t=this.get("handlers");var r=a(e.target);(t=t.length?this._getHandler(r):r)&&(n=this._getNode(t)),n&&(this.setInternal("activeHandler",t),this.setInternal("node",n),this.setInternal("dragNode",n),this._prepare(e))}};return o.extend({_onSetNode:function(){},_onSetContainer:function(){this.bindDragEvent()},_onSetDisabledChange:function(e){this.get("container")[e?"addClass":"removeClass"](i+"-disabled")},bindDragEvent:function(){this.get("container").on(n.Gesture.start,s,this).on("dragstart",this._fixDragStart)},detachDragEvent:function(){this.get("container").detach(n.Gesture.start,s,this).detach("dragstart",this._fixDragStart)},_getHandler:function(e){for(var t=this.get("container"),n=this.get("handlers");e&&e[0]!==t[0];){for(var r=0;r<n.length;r++)if(e.test(n[r]))return e;e=e.parent()}return null},_getNode:function(e){return e.closest(this.get("selector"),this.get("container"))}},{ATTRS:{container:{setter:function(e){return a(e)}},selector:{},handlers:{value:[],getter:0}}})}),KISSY.add("dd/droppable",["node","./ddm","base"],function(e,t){var n=t("node"),r=t("./ddm"),o=t("base"),i=r.PREFIX_CLS;return o.extend({initializer:function(){this.addTarget(r),r._regDrop(this)},getNodeFromTarget:function(e,t,n){var r=(e=this.get("node"))[0];return r===t||r===n?null:e},_active:function(){var e=r.get("activeDrag"),t=this.get("node"),n=this.get("groups");e:if(!0===(e=e.get("groups")))n=1;else{for(var o in n)if(e[o]){n=1;break e}n=0}n?(r._addValidDrop(this),t&&(t.addClass(i+"drop-active-valid"),r.cacheWH(t))):t&&t.addClass(i+"drop-active-invalid")},_deActive:function(){var e=this.get("node");e&&e.removeClass(i+"drop-active-valid").removeClass(i+"drop-active-invalid")},__getCustomEvt:function(t){return e.mix({drag:r.get("activeDrag"),drop:this},t)},_handleOut:function(){var e=this.__getCustomEvt();this.get("node").removeClass(i+"drop-over"),this.fire("dropexit",e)},_handleEnter:function(e){(e=this.__getCustomEvt(e)).drag._handleEnter(e),this.get("node").addClass(i+"drop-over"),this.fire("dropenter",e)},_handleOver:function(e){(e=this.__getCustomEvt(e)).drag._handleOver(e),this.fire("dropover",e)},_end:function(){var e=this.__getCustomEvt();this.get("node").removeClass(i+"drop-over"),this.fire("drophit",e)},destructor:function(){r._unRegDrop(this)}},{name:"Droppable",ATTRS:{node:{setter:function(e){if(e)return n.one(e)}},groups:{value:{}},disabled:{}}})}),KISSY.add("dd/droppable-delegate",["node","./ddm","./droppable"],function(e,t){function n(){var e=this.get("container"),t=[],n=this.get("selector");e.all(n).each(function(e){o.cacheWH(e),t.push(e)}),this.__allNodes=t}var r=t("node"),o=t("./ddm"),i=t("./droppable").extend({initializer:function(){o.on("dragstart",n,this)},getNodeFromTarget:function(t,n,r){var i={left:t.pageX,top:t.pageY},a=(t=this.__allNodes,0),s=Number.MAX_VALUE;return t&&e.each(t,function(e){var t=e[0];t===r||t===n||(t=o.region(e),o.inRegion(t,i)&&((t=o.area(t))<s&&(s=t,a=e)))}),a&&(this.setInternal("lastNode",this.get("node")),this.setInternal("node",a)),a},_handleOut:function(){this.callSuper(),this.setInternal("node",0),this.setInternal("lastNode",0)},_handleOver:function(e){var t=this.get("node"),n=i.superclass._handleOut,r=this.callSuper,o=i.superclass._handleEnter,a=this.get("lastNode");a[0]!==t[0]?(this.setInternal("node",a),n.apply(this,arguments),this.setInternal("node",t),o.call(this,e)):r.call(this,e)},_end:function(e){this.callSuper(e),this.setInternal("node",0)}},{ATTRS:{lastNode:{},selector:{},container:{setter:function(e){return r.one(e)}}}});return i}),KISSY.add("dd",["dd/ddm","dd/draggable","dd/draggable-delegate","dd/droppable-delegate","dd/droppable"],function(e,t){var n=t("dd/ddm"),r=t("dd/draggable"),o=t("dd/draggable-delegate"),i=t("dd/droppable-delegate");n={Draggable:r,DDM:n,Droppable:t("dd/droppable"),DroppableDelegate:i,DraggableDelegate:o};return KISSY.DD=n}),KISSY.add("event",["event/dom","event/custom"],function(e,t){var n=t("event/dom"),r=t("event/custom");return(n=e.Event=e.merge(n,{DomEvent:n,CustomEvent:r})).global=r.global,e.EventTarget=n.Target=r.Target,n}),KISSY.add("xtemplate",["xtemplate/runtime","xtemplate/compiler"],function(e,t){function n(t,r){if(r=e.merge(a,r),"string"==typeof t){var s,u=t,l=r;l.cache&&(s=i[u])||(s=o.compileToFn(u,l),l.cache&&(i[u]=s)),t=s}n.superclass.constructor.call(this,t,r)}var r=t("xtemplate/runtime"),o=t("xtemplate/compiler"),i=n.cache={},a={cache:!0};return e.extend(n,r,{},{compiler:o,Scope:r.Scope,RunTime:r,addCommand:r.addCommand,removeCommand:r.removeCommand}),n}),KISSY.add("xtemplate/compiler/parser",[],function(e,t){var n={},r=KISSY,o=function(e){this.rules=[],r.mix(this,e),this.resetInput(this.input)};o.prototype={constructor:function(e){this.rules=[],r.mix(this,e),this.resetInput(this.input)},resetInput:function(e){r.mix(this,{input:e,matched:"",stateStack:[o.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},genShortId:function(e){(e+="__gen")in this||(this[e]=-1);e=this[e]+=1;var t="";do{t=String.fromCharCode(97+e%26)+t,e=Math.floor(e/26)-1}while(0<=e);return t},getCurrentRules:function(){var e=this.stateStack[this.stateStack.length-1],t=[];e=this.mapState(e);return r.each(this.rules,function(n){var i=n.state||n[3];i?r.inArray(e,i)&&t.push(n):e===o.STATIC.INITIAL&&t.push(n)}),t},pushState:function(e){this.stateStack.push(e)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var e=o.STATIC.DEBUG_CONTEXT_LIMIT,t=this.matched,n=this.match,r=this.input;return(t=((t=t.slice(0,t.length-n.length)).length>e?"...":"")+t.slice(-e).replace(/\n/," "))+(n=(n=n+r).slice(0,e)+(n.length>e?"...":""))+"\n"+Array(t.length+1).join("-")+"^"},mapSymbol:function(e){var t=this.symbolMap;return t?t[e]||(t[e]=this.genShortId("symbol")):e},mapReverseSymbol:function(e){var t,n=this.symbolMap,r=this.reverseSymbolMap;if(!r&&n)for(t in r=this.reverseSymbolMap={},n)r[n[t]]=t;return r?r[e]:e},mapState:function(e){var t=this.stateMap;return t?t[e]||(t[e]=this.genShortId("state")):e},lex:function(){var e,n,i,a=this.input,s=this.getCurrentRules();if(this.match=this.text="",!a)return this.mapSymbol(o.STATIC.END_TAG);for(e=0;e<s.length;e++){var u=(n=s[e]).token||n[0];if(i=n.action||n[2]||t,n=a.match(n.regexp||n[1]))return(e=n[0].match(/\n.*/g))&&(this.lineNumber+=e.length),r.mix(this,{firstLine:this.lastLine,lastLine:this.lineNumber+1,firstColumn:this.lastColumn,lastColumn:e?e[e.length-1].length-1:this.lastColumn+n[0].length}),e=this.match=n[0],this.matches=n,this.text=e,this.matched+=e,i=(i=i&&i.call(this))===t?u:this.mapSymbol(i),this.input=a=a.slice(e.length),i||this.lex()}return this.lineNumber,this.showDebugInfo(),t}},o.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};var i=new o({rules:[[0,/^[\s\S]*?(?={{)/,function(){var e,t=this.text,n=0;return(e=t.match(/\\+$/))&&(n=e[0].length),n%2?(this.pushState("et"),t=t.slice(0,-1)):this.pushState("t"),this.text=t=t.replace(/\\+$/g,function(e){return Array(e.length/2+1).join("\\")}),"CONTENT"}],["b",/^[\s\S]+/,0],["b",/^[\s\S]{2,}?(?:(?={{)|$)/,function(){this.popState()},["et"]],["c",/^{{(?:#|@|\^)/,0,["t"]],["d",/^{{\//,0,["t"]],["e",/^{{\s*else\s*}}/,function(){this.popState()},["t"]],[0,/^{{![\s\S]*?}}/,function(){this.popState()},["t"]],["b",/^{{%([\s\S]*?)%}}/,function(){this.text=this.matches[1]||"",this.popState()},["t"]],["f",/^{{{?/,0,["t"]],["g",/^\s+/,0,["t"]],["h",/^}}}?/,function(){this.popState()},["t"]],["i",/^\(/,0,["t"]],["j",/^\)/,0,["t"]],["k",/^\|\|/,0,["t"]],["l",/^&&/,0,["t"]],["m",/^===/,0,["t"]],["n",/^!==/,0,["t"]],["o",/^>=/,0,["t"]],["p",/^<=/,0,["t"]],["q",/^>/,0,["t"]],["r",/^</,0,["t"]],["s",/^\+/,0,["t"]],["t",/^-/,0,["t"]],["u",/^\*/,0,["t"]],["v",/^\//,0,["t"]],["w",/^%/,0,["t"]],["x",/^!/,0,["t"]],["y",/^"(\\[\s\S]|[^\\"])*"/,function(){this.text=this.text.slice(1,-1).replace(/\\"/g,'"')},["t"]],["y",/^'(\\[\s\S]|[^\\'])*'/,function(){this.text=this.text.slice(1,-1).replace(/\\'/g,"'")},["t"]],["z",/^true/,0,["t"]],["z",/^false/,0,["t"]],["aa",/^\d+(?:\.\d+)?(?:e-?\d+)?/i,0,["t"]],["ab",/^=/,0,["t"]],["ac",/^\.(?=})/,0,["t"]],["ac",/^\.\./,function(){this.pushState("ws")},["t"]],["ad",/^\//,function(){this.popState()},["ws"]],["ad",/^\./,0,["t"]],["ae",/^\[/,0,["t"]],["af",/^\]/,0,["t"]],["ac",/^[a-zA-Z0-9_$]+/,0,["t"]],["ag",/^./,0,["t"]]]});return n.lexer=i,i.symbolMap={$EOF:"a",CONTENT:"b",OPEN_BLOCK:"c",OPEN_CLOSE_BLOCK:"d",INVERSE:"e",OPEN_TPL:"f",SPACE:"g",CLOSE:"h",LPAREN:"i",RPAREN:"j",OR:"k",AND:"l",LOGIC_EQUALS:"m",LOGIC_NOT_EQUALS:"n",GE:"o",LE:"p",GT:"q",LT:"r",PLUS:"s",MINUS:"t",MULTIPLY:"u",DIVIDE:"v",MODULUS:"w",NOT:"x",STRING:"y",BOOLEAN:"z",NUMBER:"aa",EQUALS:"ab",ID:"ac",SEP:"ad",REF_START:"ae",REF_END:"af",INVALID:"ag",$START:"ah",program:"ai",statements:"aj",statement:"ak",openBlock:"al",closeBlock:"am",tpl:"an",inBlockTpl:"ao",path:"ap",inTpl:"aq",Expression:"ar",params:"as",hash:"at",param:"au",ConditionalOrExpression:"av",ConditionalAndExpression:"aw",EqualityExpression:"ax",RelationalExpression:"ay",AdditiveExpression:"az",MultiplicativeExpression:"ba",UnaryExpression:"bb",PrimaryExpression:"bc",hashSegments:"bd",hashSegment:"be",pathSegments:"bf"},n.productions=[["ah",["ai"]],["ai",["aj","e","aj"],function(){return new this.yy.ProgramNode(this.lexer.lineNumber,this.$1,this.$3)}],["ai",["aj"],function(){return new this.yy.ProgramNode(this.lexer.lineNumber,this.$1)}],["aj",["ak"],function(){return[this.$1]}],["aj",["aj","ak"],function(){this.$1.push(this.$2)}],["ak",["al","ai","am"],function(){return new this.yy.BlockNode(this.lexer.lineNumber,this.$1,this.$2,this.$3)}],["ak",["an"]],["ak",["b"],function(){return new this.yy.ContentNode(this.lexer.lineNumber,this.$1)}],["ao",["ap"],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1)}],["ao",["aq"]],["al",["c","ao","h"],function(){return"^"===this.$1.charAt(this.$1.length-1)&&(this.$2.isInverted=1),this.$2}],["am",["d","ap","h"],function(){return this.$2}],["an",["f","aq","h"],function(){return 3===this.$1.length&&(this.$2.escaped=!1),this.$2}],["an",["f","ar","h"],function(){var e=new this.yy.TplExpressionNode(this.lexer.lineNumber,this.$2);return 3===this.$1.length&&(e.escaped=!1),e}],["aq",["ap","g","as","g","at"],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1,this.$3,this.$5)}],["aq",["ap","g","as"],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1,this.$3)}],["aq",["ap","g","at"],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1,null,this.$3)}],["as",["as","g","au"],function(){this.$1.push(this.$3)}],["as",["au"],function(){return[this.$1]}],["au",["ar"]],["ar",["av"]],["av",["aw"]],["av",["av","k","aw"],function(){return new this.yy.ConditionalOrExpression(this.$1,this.$3)}],["aw",["ax"]],["aw",["aw","l","ax"],function(){return new this.yy.ConditionalAndExpression(this.$1,this.$3)}],["ax",["ay"]],["ax",["ax","m","ay"],function(){return new this.yy.EqualityExpression(this.$1,"===",this.$3)}],["ax",["ax","n","ay"],function(){return new this.yy.EqualityExpression(this.$1,"!==",this.$3)}],["ay",["az"]],["ay",["ay","r","az"],function(){return new this.yy.RelationalExpression(this.$1,"<",this.$3)}],["ay",["ay","q","az"],function(){return new this.yy.RelationalExpression(this.$1,">",this.$3)}],["ay",["ay","p","az"],function(){return new this.yy.RelationalExpression(this.$1,"<=",this.$3)}],["ay",["ay","o","az"],function(){return new this.yy.RelationalExpression(this.$1,">=",this.$3)}],["az",["ba"]],["az",["az","s","ba"],function(){return new this.yy.AdditiveExpression(this.$1,"+",this.$3)}],["az",["az","t","ba"],function(){return new this.yy.AdditiveExpression(this.$1,"-",this.$3)}],["ba",["bb"]],["ba",["ba","u","bb"],function(){return new this.yy.MultiplicativeExpression(this.$1,"*",this.$3)}],["ba",["ba","v","bb"],function(){return new this.yy.MultiplicativeExpression(this.$1,"/",this.$3)}],["ba",["ba","w","bb"],function(){return new this.yy.MultiplicativeExpression(this.$1,"%",this.$3)}],["bb",["x","bb"],function(){return new this.yy.UnaryExpression(this.$1,this.$2)}],["bb",["t","bb"],function(){return new this.yy.UnaryExpression(this.$1,this.$2)}],["bb",["bc"]],["bc",["y"],function(){return new this.yy.StringNode(this.lexer.lineNumber,this.$1)}],["bc",["aa"],function(){return new this.yy.NumberNode(this.lexer.lineNumber,this.$1)}],["bc",["z"],function(){return new this.yy.BooleanNode(this.lexer.lineNumber,this.$1)}],["bc",["ap"]],["bc",["i","ar","j"],function(){return this.$2}],["at",["bd"],function(){return new this.yy.HashNode(this.lexer.lineNumber,this.$1)}],["bd",["bd","g","be"],function(){this.$1.push(this.$3)}],["bd",["be"],function(){return[this.$1]}],["be",["ac","ab","ar"],function(){return[this.$1,this.$3]}],["ap",["bf"],function(){return new this.yy.IdNode(this.lexer.lineNumber,this.$1)}],["bf",["bf","ad","ac"],function(){this.$1.push(this.$3)}],["bf",["bf","ae","ar","af"],function(){this.$1.push(this.$3)}],["bf",["bf","ad","aa"],function(){this.$1.push(this.$3)}],["bf",["ac"],function(){return[this.$1]}]],n.table={gotos:{0:{ai:4,aj:5,ak:6,al:7,an:8},2:{ao:10,aq:11,ap:12,bf:13},3:{aq:20,ar:21,av:22,aw:23,ax:24,ay:25,az:26,ba:27,bb:28,bc:29,ap:30,bf:13},5:{ak:32,al:7,an:8},7:{ai:33,aj:5,ak:6,al:7,an:8},14:{ar:38,av:22,aw:23,ax:24,ay:25,az:26,ba:27,bb:28,bc:29,ap:39,bf:13},15:{bb:40,bc:29,ap:39,bf:13},16:{bb:41,bc:29,ap:39,bf:13},31:{aj:57,ak:6,al:7,an:8},33:{am:59},35:{as:61,au:62,ar:63,av:22,aw:23,ax:24,ay:25,az:26,ba:27,bb:28,bc:29,at:64,bd:65,be:66,ap:39,bf:13},37:{ar:69,av:22,aw:23,ax:24,ay:25,az:26,ba:27,bb:28,bc:29,ap:39,bf:13},44:{aw:71,ax:24,ay:25,az:26,ba:27,bb:28,bc:29,ap:39,bf:13},45:{ax:72,ay:25,az:26,ba:27,bb:28,bc:29,ap:39,bf:13},46:{ay:73,az:26,ba:27,bb:28,bc:29,ap:39,bf:13},47:{ay:74,az:26,ba:27,bb:28,bc:29,ap:39,bf:13},48:{az:75,ba:27,bb:28,bc:29,ap:39,bf:13},49:{az:76,ba:27,bb:28,bc:29,ap:39,bf:13},50:{az:77,ba:27,bb:28,bc:29,ap:39,bf:13},51:{az:78,ba:27,bb:28,bc:29,ap:39,bf:13},52:{ba:79,bb:28,bc:29,ap:39,bf:13},53:{ba:80,bb:28,bc:29,ap:39,bf:13},54:{bb:81,bc:29,ap:39,bf:13},55:{bb:82,bc:29,ap:39,bf:13},56:{bb:83,bc:29,ap:39,bf:13},57:{ak:32,al:7,an:8},58:{ap:84,bf:13},85:{ar:90,av:22,aw:23,ax:24,ay:25,az:26,ba:27,bb:28,bc:29,ap:39,bf:13},86:{au:91,ar:63,av:22,aw:23,ax:24,ay:25,az:26,ba:27,bb:28,bc:29,at:92,bd:65,be:66,ap:39,bf:13},87:{be:94}},action:{0:{b:[1,t,1],c:[1,t,2],f:[1,t,3]},1:{a:[2,7],e:[2,7],c:[2,7],f:[2,7],b:[2,7],d:[2,7]},2:{ac:[1,t,9]},3:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},4:{a:[0]},5:{a:[2,2],d:[2,2],b:[1,t,1],c:[1,t,2],e:[1,t,31],f:[1,t,3]},6:{a:[2,3],e:[2,3],c:[2,3],f:[2,3],b:[2,3],d:[2,3]},7:{b:[1,t,1],c:[1,t,2],f:[1,t,3]},8:{a:[2,6],e:[2,6],c:[2,6],f:[2,6],b:[2,6],d:[2,6]},9:{h:[2,56],g:[2,56],ad:[2,56],ae:[2,56],k:[2,56],l:[2,56],m:[2,56],n:[2,56],o:[2,56],p:[2,56],q:[2,56],r:[2,56],s:[2,56],t:[2,56],u:[2,56],v:[2,56],w:[2,56],j:[2,56],af:[2,56]},10:{h:[1,t,34]},11:{h:[2,9]},12:{h:[2,8],g:[1,t,35]},13:{h:[2,52],g:[2,52],k:[2,52],l:[2,52],m:[2,52],n:[2,52],o:[2,52],p:[2,52],q:[2,52],r:[2,52],s:[2,52],t:[2,52],u:[2,52],v:[2,52],w:[2,52],j:[2,52],af:[2,52],ad:[1,t,36],ae:[1,t,37]},14:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},15:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},16:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},17:{h:[2,43],k:[2,43],l:[2,43],m:[2,43],n:[2,43],o:[2,43],p:[2,43],q:[2,43],r:[2,43],s:[2,43],t:[2,43],u:[2,43],v:[2,43],w:[2,43],j:[2,43],g:[2,43],af:[2,43]},18:{h:[2,45],k:[2,45],l:[2,45],m:[2,45],n:[2,45],o:[2,45],p:[2,45],q:[2,45],r:[2,45],s:[2,45],t:[2,45],u:[2,45],v:[2,45],w:[2,45],j:[2,45],g:[2,45],af:[2,45]},19:{h:[2,44],k:[2,44],l:[2,44],m:[2,44],n:[2,44],o:[2,44],p:[2,44],q:[2,44],r:[2,44],s:[2,44],t:[2,44],u:[2,44],v:[2,44],w:[2,44],j:[2,44],g:[2,44],af:[2,44]},20:{h:[1,t,42]},21:{h:[1,t,43]},22:{h:[2,20],j:[2,20],g:[2,20],af:[2,20],k:[1,t,44]},23:{h:[2,21],k:[2,21],j:[2,21],g:[2,21],af:[2,21],l:[1,t,45]},24:{h:[2,23],k:[2,23],l:[2,23],j:[2,23],g:[2,23],af:[2,23],m:[1,t,46],n:[1,t,47]},25:{h:[2,25],k:[2,25],l:[2,25],m:[2,25],n:[2,25],j:[2,25],g:[2,25],af:[2,25],o:[1,t,48],p:[1,t,49],q:[1,t,50],r:[1,t,51]},26:{h:[2,28],k:[2,28],l:[2,28],m:[2,28],n:[2,28],o:[2,28],p:[2,28],q:[2,28],r:[2,28],j:[2,28],g:[2,28],af:[2,28],s:[1,t,52],t:[1,t,53]},27:{h:[2,33],k:[2,33],l:[2,33],m:[2,33],n:[2,33],o:[2,33],p:[2,33],q:[2,33],r:[2,33],s:[2,33],t:[2,33],j:[2,33],g:[2,33],af:[2,33],u:[1,t,54],v:[1,t,55],w:[1,t,56]},28:{h:[2,36],k:[2,36],l:[2,36],m:[2,36],n:[2,36],o:[2,36],p:[2,36],q:[2,36],r:[2,36],s:[2,36],t:[2,36],u:[2,36],v:[2,36],w:[2,36],j:[2,36],g:[2,36],af:[2,36]},29:{h:[2,42],k:[2,42],l:[2,42],m:[2,42],n:[2,42],o:[2,42],p:[2,42],q:[2,42],r:[2,42],s:[2,42],t:[2,42],u:[2,42],v:[2,42],w:[2,42],j:[2,42],g:[2,42],af:[2,42]},30:{h:[2,46],k:[2,46],l:[2,46],m:[2,46],n:[2,46],o:[2,46],p:[2,46],q:[2,46],r:[2,46],s:[2,46],t:[2,46],u:[2,46],v:[2,46],w:[2,46],g:[1,t,35]},31:{b:[1,t,1],c:[1,t,2],f:[1,t,3]},32:{a:[2,4],e:[2,4],c:[2,4],f:[2,4],b:[2,4],d:[2,4]},33:{d:[1,t,58]},34:{c:[2,10],f:[2,10],b:[2,10]},35:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,60]},36:{aa:[1,t,67],ac:[1,t,68]},37:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},38:{j:[1,t,70]},39:{j:[2,46],k:[2,46],l:[2,46],m:[2,46],n:[2,46],o:[2,46],p:[2,46],q:[2,46],r:[2,46],s:[2,46],t:[2,46],u:[2,46],v:[2,46],w:[2,46],h:[2,46],g:[2,46],af:[2,46]},40:{h:[2,41],k:[2,41],l:[2,41],m:[2,41],n:[2,41],o:[2,41],p:[2,41],q:[2,41],r:[2,41],s:[2,41],t:[2,41],u:[2,41],v:[2,41],w:[2,41],j:[2,41],g:[2,41],af:[2,41]},41:{h:[2,40],k:[2,40],l:[2,40],m:[2,40],n:[2,40],o:[2,40],p:[2,40],q:[2,40],r:[2,40],s:[2,40],t:[2,40],u:[2,40],v:[2,40],w:[2,40],j:[2,40],g:[2,40],af:[2,40]},42:{a:[2,12],e:[2,12],c:[2,12],f:[2,12],b:[2,12],d:[2,12]},43:{a:[2,13],e:[2,13],c:[2,13],f:[2,13],b:[2,13],d:[2,13]},44:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},45:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},46:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},47:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},48:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},49:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},50:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},51:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},52:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},53:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},54:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},55:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},56:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},57:{a:[2,1],d:[2,1],b:[1,t,1],c:[1,t,2],f:[1,t,3]},58:{ac:[1,t,9]},59:{a:[2,5],e:[2,5],c:[2,5],f:[2,5],b:[2,5],d:[2,5]},60:{h:[2,56],g:[2,56],k:[2,56],l:[2,56],m:[2,56],n:[2,56],o:[2,56],p:[2,56],q:[2,56],r:[2,56],s:[2,56],t:[2,56],u:[2,56],v:[2,56],w:[2,56],ad:[2,56],ae:[2,56],ab:[1,t,85]},61:{h:[2,15],g:[1,t,86]},62:{h:[2,18],g:[2,18]},63:{h:[2,19],g:[2,19]},64:{h:[2,16]},65:{h:[2,48],g:[1,t,87]},66:{h:[2,50],g:[2,50]},67:{h:[2,55],g:[2,55],ad:[2,55],ae:[2,55],k:[2,55],l:[2,55],m:[2,55],n:[2,55],o:[2,55],p:[2,55],q:[2,55],r:[2,55],s:[2,55],t:[2,55],u:[2,55],v:[2,55],w:[2,55],j:[2,55],af:[2,55]},68:{h:[2,53],g:[2,53],ad:[2,53],ae:[2,53],k:[2,53],l:[2,53],m:[2,53],n:[2,53],o:[2,53],p:[2,53],q:[2,53],r:[2,53],s:[2,53],t:[2,53],u:[2,53],v:[2,53],w:[2,53],j:[2,53],af:[2,53]},69:{af:[1,t,88]},70:{h:[2,47],k:[2,47],l:[2,47],m:[2,47],n:[2,47],o:[2,47],p:[2,47],q:[2,47],r:[2,47],s:[2,47],t:[2,47],u:[2,47],v:[2,47],w:[2,47],j:[2,47],g:[2,47],af:[2,47]},71:{h:[2,22],k:[2,22],j:[2,22],g:[2,22],af:[2,22],l:[1,t,45]},72:{h:[2,24],k:[2,24],l:[2,24],j:[2,24],g:[2,24],af:[2,24],m:[1,t,46],n:[1,t,47]},73:{h:[2,26],k:[2,26],l:[2,26],m:[2,26],n:[2,26],j:[2,26],g:[2,26],af:[2,26],o:[1,t,48],p:[1,t,49],q:[1,t,50],r:[1,t,51]},74:{h:[2,27],k:[2,27],l:[2,27],m:[2,27],n:[2,27],j:[2,27],g:[2,27],af:[2,27],o:[1,t,48],p:[1,t,49],q:[1,t,50],r:[1,t,51]},75:{h:[2,32],k:[2,32],l:[2,32],m:[2,32],n:[2,32],o:[2,32],p:[2,32],q:[2,32],r:[2,32],j:[2,32],g:[2,32],af:[2,32],s:[1,t,52],t:[1,t,53]},76:{h:[2,31],k:[2,31],l:[2,31],m:[2,31],n:[2,31],o:[2,31],p:[2,31],q:[2,31],r:[2,31],j:[2,31],g:[2,31],af:[2,31],s:[1,t,52],t:[1,t,53]},77:{h:[2,30],k:[2,30],l:[2,30],m:[2,30],n:[2,30],o:[2,30],p:[2,30],q:[2,30],r:[2,30],j:[2,30],g:[2,30],af:[2,30],s:[1,t,52],t:[1,t,53]},78:{h:[2,29],k:[2,29],l:[2,29],m:[2,29],n:[2,29],o:[2,29],p:[2,29],q:[2,29],r:[2,29],j:[2,29],g:[2,29],af:[2,29],s:[1,t,52],t:[1,t,53]},79:{h:[2,34],k:[2,34],l:[2,34],m:[2,34],n:[2,34],o:[2,34],p:[2,34],q:[2,34],r:[2,34],s:[2,34],t:[2,34],j:[2,34],g:[2,34],af:[2,34],u:[1,t,54],v:[1,t,55],w:[1,t,56]},80:{h:[2,35],k:[2,35],l:[2,35],m:[2,35],n:[2,35],o:[2,35],p:[2,35],q:[2,35],r:[2,35],s:[2,35],t:[2,35],j:[2,35],g:[2,35],af:[2,35],u:[1,t,54],v:[1,t,55],w:[1,t,56]},81:{h:[2,37],k:[2,37],l:[2,37],m:[2,37],n:[2,37],o:[2,37],p:[2,37],q:[2,37],r:[2,37],s:[2,37],t:[2,37],u:[2,37],v:[2,37],w:[2,37],j:[2,37],g:[2,37],af:[2,37]},82:{h:[2,38],k:[2,38],l:[2,38],m:[2,38],n:[2,38],o:[2,38],p:[2,38],q:[2,38],r:[2,38],s:[2,38],t:[2,38],u:[2,38],v:[2,38],w:[2,38],j:[2,38],g:[2,38],af:[2,38]},83:{h:[2,39],k:[2,39],l:[2,39],m:[2,39],n:[2,39],o:[2,39],p:[2,39],q:[2,39],r:[2,39],s:[2,39],t:[2,39],u:[2,39],v:[2,39],w:[2,39],j:[2,39],g:[2,39],af:[2,39]},84:{h:[1,t,89]},85:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,9]},86:{i:[1,t,14],t:[1,t,15],x:[1,t,16],y:[1,t,17],z:[1,t,18],aa:[1,t,19],ac:[1,t,60]},87:{ac:[1,t,93]},88:{h:[2,54],g:[2,54],ad:[2,54],ae:[2,54],k:[2,54],l:[2,54],m:[2,54],n:[2,54],o:[2,54],p:[2,54],q:[2,54],r:[2,54],s:[2,54],t:[2,54],u:[2,54],v:[2,54],w:[2,54],j:[2,54],af:[2,54]},89:{a:[2,11],e:[2,11],c:[2,11],f:[2,11],b:[2,11],d:[2,11]},90:{h:[2,51],g:[2,51]},91:{h:[2,17],g:[2,17]},92:{h:[2,14]},93:{ab:[1,t,85]},94:{h:[2,49],g:[2,49]}}},n.parse=function(e){var n,r,o,i=this.lexer,a=(s=this.table).gotos,s=s.action,u=this.productions,l=[null],c=[0];for(i.resetInput(e);;){if(n=c[c.length-1],r||(r=i.lex()),!r)return!1;if(!(o=s[n]&&s[n][r])){if(e=[],s[n])for(var d in s[n])e.push(this.lexer.mapReverseSymbol(d));return i="Syntax error at line "+i.lineNumber+":\n"+i.showDebugInfo()+"\nexpect "+e.join(", "),!1}switch(o[0]){case 1:c.push(r),l.push(i.text),c.push(o[2]),r=null;break;case 2:n=(p=u[o[1]]).symbol||p[0],o=p.action||p[2];var h,f=(p.rhs||p[1]).length,g=0,p=l[l.length-f];for(h=t,this.$$=p;g<f;g++)this["$"+(f-g)]=l[l.length-1-g];o&&(h=o.call(this)),p=h!==t?h:this.$$,f&&(c=c.slice(0,-2*f),l=l.slice(0,-1*f)),c.push(n),l.push(p),c.push(a[c[c.length-2]][c[c.length-1]]);break;case 0:return p}}return t},n}),KISSY.add("xtemplate/compiler/ast",[],function(e){var t={ProgramNode:function(e,t,n){this.lineNumber=e,this.statements=t,this.inverse=n}};return t.ProgramNode.prototype.type="program",t.BlockNode=function(t,n,r,o){o=o.parts,e.equals(n.path.parts,o)||(o="Syntax error at line "+t+":\nexpect {{/"+n.path.parts+"}} not {{/"+o+"}}"),this.lineNumber=t,this.tpl=n,this.program=r},t.BlockNode.prototype.type="block",t.TplNode=function(e,t,n,r){this.lineNumber=e,this.path=t,this.params=n,this.hash=r,this.escaped=!0,this.isInverted=!1},t.TplNode.prototype.type="tpl",t.TplExpressionNode=function(e,t){this.lineNumber=e,this.expression=t,this.escaped=!0},t.TplExpressionNode.prototype.type="tplExpression",t.ContentNode=function(e,t){this.lineNumber=e,this.value=t},t.ContentNode.prototype.type="content",t.UnaryExpression=function(e,t){this.value=t,this.unaryType=e},t.UnaryExpression.prototype.type="unaryExpression",t.MultiplicativeExpression=function(e,t,n){this.op1=e,this.opType=t,this.op2=n},t.MultiplicativeExpression.prototype.type="multiplicativeExpression",t.AdditiveExpression=function(e,t,n){this.op1=e,this.opType=t,this.op2=n},t.AdditiveExpression.prototype.type="additiveExpression",t.RelationalExpression=function(e,t,n){this.op1=e,this.opType=t,this.op2=n},t.RelationalExpression.prototype.type="relationalExpression",t.EqualityExpression=function(e,t,n){this.op1=e,this.opType=t,this.op2=n},t.EqualityExpression.prototype.type="equalityExpression",t.ConditionalAndExpression=function(e,t){this.op1=e,this.op2=t},t.ConditionalAndExpression.prototype.type="conditionalAndExpression",t.ConditionalOrExpression=function(e,t){this.op1=e,this.op2=t},t.ConditionalOrExpression.prototype.type="conditionalOrExpression",t.StringNode=function(e,t){this.lineNumber=e,this.value=t},t.StringNode.prototype.type="string",t.NumberNode=function(e,t){this.lineNumber=e,this.value=t},t.NumberNode.prototype.type="number",t.BooleanNode=function(e,t){this.lineNumber=e,this.value=t},t.BooleanNode.prototype.type="boolean",t.HashNode=function(t,n){var r={};this.lineNumber=t,e.each(n,function(e){r[e[0]]=e[1]}),this.value=r},t.HashNode.prototype.type="hash",t.IdNode=function(t,n){var r=[],o=0;this.lineNumber=t,e.each(n,function(e){".."===e?o++:r.push(e)}),this.parts=r,this.string=r.join("."),this.depth=o},t.IdNode.prototype.type="id",t}),KISSY.add("xtemplate/compiler",["xtemplate/runtime","./compiler/parser","./compiler/ast"],function(e,t){function n(e,t){var n;return(e=t?(n=!1,e.replace(n?u:l,function(e){return e.length%2&&(e="\\"+e),e})):e.replace(/\\/g,"\\\\").replace(/'/g,"\\'")).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")}function r(e,t){c.apply(e,t)}function o(e){return e[e.length-1]}var i=t("xtemplate/runtime"),a=t("./compiler/parser");a.yy=t("./compiler/ast");var s,u=/\\*"/g,l=/\\*'/g,c=[].push,d=0,h=0,f={genFunction:function(e,t){var n=[];if(t||n.push("function(scope) {"),n.push('var buffer = ""'+(t?",":";")),t){n.push("config = this.config,engine = this,moduleWrap, utils = config.utils;"),n.push('if (typeof module !== "undefined" && module.kissy) {moduleWrap = module;}');var o,a="",s=i.utils;for(o in s)a+=o+"Util = utils."+o+",";a&&n.push("var "+a.slice(0,a.length-1)+";")}if(e)for(a=0,o=e.length;a<o;a++)r(n,this[e[a].type](e[a]));return n.push("return buffer;"),t?{params:["scope","S","undefined"],source:n}:(n.push("}"),n)},genIdOrInlineCommand:function(t,n){var o,i=[],a=t.depth,s=t.parts,u="id"+d++;if(0===a){var l=n&&this.genConfig(n);l&&(o=l[0],r(i,l[1]))}return s=this.getIdStringFromIdParts(i,s),a||e.startsWith(s,"this.")?i.push("var "+u+' = getPropertyUtil(engine,scope,"'+s+'",'+a+","+t.lineNumber+");"):o?("include"===s&&i.push('if(moduleWrap) {require("'+n.params[0].value+'");'+o+".params[0] = moduleWrap.resolveByName("+o+".params[0]);}"),i.push("var "+u+" = runInlineCommandUtil(engine,scope,"+o+',"'+s+'",'+t.lineNumber+");")):i.push("var "+u+" = getPropertyOrRunCommandUtil(engine,scope,"+(o||"{}")+',"'+s+'",'+a+","+t.lineNumber+");"),[u,i]},genOpExpression:function(e,t){var n,i,a=[],s=this[e.op1.type](e.op1),u=this[e.op2.type](e.op2);return n=s[0],i=u[0],n&&i?(r(a,s[1]),r(a,u[1]),a.push(n+t+i),["",a]):n||i?n&&!i?(r(a,s[1]),r(a,u[1].slice(0,-1)),a.push(n+t+"("+o(u[1])+")"),["",a]):!n&&i?(r(a,s[1].slice(0,-1)),r(a,u[1]),a.push("("+o(s[1])+")"+t+i),["",a]):void 0:(r(a,s[1].slice(0,-1)),r(a,u[1].slice(0,-1)),a.push("("+o(s[1])+")"+t+"("+o(u[1])+")"),["",a])},genConfig:function(t){var n,i,a=[],s=this;if(t){if(i=t.params,t=t.hash,(i||t)&&(n="config"+d++,a.push("var "+n+" = {};")),i){var u="params"+d++;a.push("var "+u+" = [];"),e.each(i,function(e){(e=s[e.type](e))[0]?(r(a,e[1]),a.push(u+".push("+e[0]+");")):(r(a,e[1].slice(0,-1)),a.push(u+".push("+o(e[1])+");"))}),a.push(n+".params="+u+";")}if(t){var l="hash"+d++;a.push("var "+l+" = {};"),e.each(t.value,function(e,t){var n=s[e.type](e);n[0]?(r(a,n[1]),a.push(l+'["'+t+'"] = '+n[0]+";")):(r(a,n[1].slice(0,-1)),a.push(l+'["'+t+'"] = '+o(n[1])+";"))}),a.push(n+".hash="+l+";")}}return[n,a]},conditionalOrExpression:function(e){return this.genOpExpression(e,"||")},conditionalAndExpression:function(e){return this.genOpExpression(e,"&&")},relationalExpression:function(e){return this.genOpExpression(e,e.opType)},equalityExpression:function(e){return this.genOpExpression(e,e.opType)},additiveExpression:function(e){return this.genOpExpression(e,e.opType)},multiplicativeExpression:function(e){return this.genOpExpression(e,e.opType)},unaryExpression:function(e){var t,n=[],r=e.unaryType;e=this[e.value.type](e.value);return c.apply(n,e[1]),(t=e[0])?n.push(t+"="+r+t+";"):n[n.length-1]=""+r+o(n),[t,n]},string:function(e){return["",["'"+n(e.value,!0)+"'"]]},number:function(e){return["",[e.value]]},boolean:function(e){return["",[e.value]]},id:function(e){var t=[],n=e.depth,r=e.parts,o="id"+d++;r=this.getIdStringFromIdParts(t,r);return t.push("var "+o+' = getPropertyUtil(engine,scope,"'+r+'",'+n+","+e.lineNumber+");"),[o,t]},block:function(t){var n=t.program,o=[],i=t.tpl,a=this.genConfig(i),s=(t=a[0],i.path),u=s.string;if(r(o,a[1]),t||(t=e.guid("config"),o.push("var "+t+" = {};")),o.push(t+".fn="+this.genFunction(n.statements).join("\n")+";"),n.inverse&&(n=this.genFunction(n.inverse).join("\n"),o.push(t+".inverse="+n+";")),i.isInverted&&(n="inverse"+d++,o.push("var "+n+"="+t+".fn;"),o.push(t+".fn = "+t+".inverse;"),o.push(t+".inverse = "+n+";")),!i.hash&&!i.params)for(i=s.parts,n=0;n<i.length;n++)if("string"!=typeof i[n]){u=this.getIdStringFromIdParts(o,i);break}return o.push("buffer += runBlockCommandUtil(engine, scope, "+t+', "'+u+'", '+s.lineNumber+");"),o},content:function(e){return["buffer += '"+n(e.value,!1)+"';"]},tpl:function(e){var t=[],n=this.genIdOrInlineCommand(e.path,e);return r(t,n[1]),t.push("buffer += renderOutputUtil("+n[0]+","+e.escaped+");"),t},tplExpression:function(e){var t,n=[],i=e.escaped;return t=e.expression,(t="id"===(e=e.expression.type)?this.genIdOrInlineCommand(t):this[e](t))[0]?(r(n,t[1]),t=t[0]):(r(n,t[1].slice(0,-1)),t=o(t[1])),n.push("buffer += renderOutputUtil("+t+","+i+");"),n},getIdStringFromIdParts:function(e,t){var n,o,i,a="",s=!0;for(n=0;n<t.length;n++)s||(a+="."),(i=(o=t[n]).type)?(o=this[i](o))[0]&&(r(e,o[1]),a+='"+'+o[0]+'+"',s=!0):(a+=o,s=!1);return a}};return s={parse:function(e){return a.parse(e)},compileToStr:function(e){return"function("+(e=this.compile(e)).params.join(",")+"){\n"+e.source.join("\n")+"}"},compile:function(e){return e=this.parse(e),d=0,f.genFunction(e.statements,!0)},compileToFn:function(e,t){var n=s.compile(e),r="sourceURL="+((t=t||{}).name?t.name:"xtemplate"+h++)+".js";return Function.apply(null,[].concat(n.params).concat(n.source.join("\n")+"\n//@ "+r+"\n//# "+r))}}}),KISSY.add("event/dom/touch/handle-map",[],function(){return{}}),KISSY.add("event/dom/touch/single-touch",[],function(e){function t(){}return t.prototype={constructor:t,requiredTouchCount:1,onTouchStart:function(e){if(e.touches.length!==this.requiredTouchCount)return!1;e=this.lastTouches=e.touches,this.lastXY={pageX:e[0].pageX,pageY:e[0].pageY}},onTouchMove:e.noop,onTouchEnd:e.noop},t}),KISSY.add("event/dom/touch/tap",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(e){e.preventDefault()}function r(){r.superclass.constructor.apply(this,arguments)}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./single-touch"),s=i.Object;return e.extend(r,a,{onTouchMove:function(e){var t=this.lastXY;if(!(e=e.changedTouches[0])||5<Math.abs(e.pageX-t.pageX)||5<Math.abs(e.pageY-t.pageY))return!1},onTouchEnd:function(t){var r=t.changedTouches[0],o=t.target,a=new s({type:"tap",target:o,currentTarget:o});e.mix(a,{pageX:r.pageX,pageY:r.pageY,originalEvent:t.originalEvent,which:1,touch:r}),i.fire(o,"tap",a),a.isDefaultPrevented()&&i.on(o,"click",{fn:n,once:1})}}),o.tap={handle:new r},r}),KISSY.add("event/dom/touch/swipe",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(e,t,n){var r=t.changedTouches[0],o=r.pageX-e.startX,a=r.pageY-e.startY,c=Math.abs(o),d=Math.abs(a);if(n){if(e.isVertical&&e.isHorizontal){if(5>Math.max(c,d))return;d>c?e.isHorizontal=0:e.isVertical=0}}else e.isVertical&&d<l&&(e.isVertical=0),e.isHorizontal&&c<l&&(e.isHorizontal=0);if(e.isHorizontal)o=0>o?"left":"right";else{if(!e.isVertical)return!1;o=0>a?"up":"down",c=d}i.fire(t.target,n?u:s,{originalEvent:t.originalEvent,pageX:r.pageX,pageY:r.pageY,which:1,touch:r,direction:o,distance:c,duration:(t.timeStamp-e.startTime)/1e3})}function r(){}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./single-touch"),s="swipe",u="swiping",l=50;return e.extend(r,a,{onTouchStart:function(e){if(!1===r.superclass.onTouchStart.apply(this,arguments))return!1;var t=e.touches[0];this.startTime=e.timeStamp,this.isVertical=this.isHorizontal=1,this.startX=t.pageX,this.startY=t.pageY,-1!==e.type.indexOf("mouse")&&e.preventDefault()},onTouchMove:function(e){var t=(r=e.changedTouches[0]).pageY-this.startY,r=Math.abs(r.pageX-this.startX);t=Math.abs(t);return!(1e3<e.timeStamp-this.startTime)&&(this.isVertical&&35<r&&(this.isVertical=0),this.isHorizontal&&35<t&&(this.isHorizontal=0),n(this,e,1))},onTouchEnd:function(e){return!1!==this.onTouchMove(e)&&n(this,e,0)}}),o[s]=o[u]={handle:new r},r}),KISSY.add("event/dom/touch/double-tap",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(){}var r=t("./handle-map"),o=t("event/dom/base"),i=t("./single-touch");return e.extend(n,i,{onTouchStart:function(e){if(!1===n.superclass.onTouchStart.apply(this,arguments))return!1;this.startTime=e.timeStamp,this.singleTapTimer&&(clearTimeout(this.singleTapTimer),this.singleTapTimer=0)},onTouchMove:function(){return!1},onTouchEnd:function(e){var t=this.lastEndTime,n=e.timeStamp,r=e.target,i=e.changedTouches[0],a=n-this.startTime;if(this.lastEndTime=n,t&&300>(a=n-t))return this.lastEndTime=0,void o.fire(r,"doubleTap",{touch:i,duration:a/1e3});300<(a=n-this.startTime)?o.fire(r,"singleTap",{touch:i,pageX:i.pageX,which:1,pageY:i.pageY,duration:a/1e3}):this.singleTapTimer=setTimeout(function(){o.fire(r,"singleTap",{touch:i,pageX:i.pageX,which:1,pageY:i.pageY,duration:a/1e3})},300)}}),r.singleTap=r.doubleTap={handle:new n},n}),KISSY.add("event/dom/touch/multi-touch",["dom"],function(e,t){function n(){}var r=t("dom");return n.prototype={constructor:n,requiredTouchCount:2,onTouchStart:function(e){var t=this.requiredTouchCount,n=e.touches.length;n===t?this.start():n>t&&this.end(e)},onTouchEnd:function(e){this.end(e)},start:function(){this.isTracking||(this.isTracking=!0,this.isStarted=!1)},fireEnd:e.noop,getCommonTarget:function(e){var t;if((e=(t=e.touches)[0].target)===(t=t[1].target)||r.contains(e,t))return e;for(;;){if(r.contains(t,e))return t;t=t.parentNode}},end:function(e){this.isTracking&&(this.isTracking=!1,this.isStarted&&(this.isStarted=!1,this.fireEnd(e)))}},n}),KISSY.add("event/dom/touch/pinch",["./handle-map","event/dom/base","./multi-touch"],function(e,t){function n(){}function r(e){2===e.touches.length&&e.preventDefault()}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./multi-touch");return e.extend(n,a,{onTouchMove:function(t){if(this.isTracking){var n=t.touches;if(0<n[0].pageX&&0<n[0].pageY&&0<n[1].pageX&&0<n[1].pageY){var r,o=n[0],a=n[1];r=o.pageX-a.pageX,o=o.pageY-a.pageY,r=Math.sqrt(r*r+o*o),this.lastTouches=n,this.isStarted?i.fire(this.target,"pinch",e.mix(t,{distance:r,scale:r/this.startDistance})):(this.isStarted=!0,this.startDistance=r,n=this.target=this.getCommonTarget(t),i.fire(n,"pinchStart",e.mix(t,{distance:r,scale:1})))}}},fireEnd:function(t){i.fire(this.target,"pinchEnd",e.mix(t,{touches:this.lastTouches}))}}),a=new n,o.pinchStart=o.pinchEnd={handle:a},o.pinch={handle:a,setup:function(){i.on(this,"touchmove",r)},tearDown:function(){i.detach(this,"touchmove",r)}},n}),KISSY.add("event/dom/touch/tap-hold",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(){}var r=t("./handle-map"),o=t("event/dom/base"),i=t("./single-touch");return e.extend(n,i,{onTouchStart:function(t){if(!1===n.superclass.onTouchStart.call(this,t))return!1;this.timer=setTimeout(function(){var n=t.touches[0];o.fire(t.target,"tapHold",{touch:n,pageX:n.pageX,pageY:n.pageY,which:1,duration:(e.now()-t.timeStamp)/1e3})},1e3)},onTouchMove:function(){return clearTimeout(this.timer),!1},onTouchEnd:function(){clearTimeout(this.timer)}}),r.tapHold={handle:new n},n}),KISSY.add("event/dom/touch/rotate",["./handle-map","event/dom/base","./multi-touch"],function(e,t){function n(){}function r(e){2===e.touches.length&&e.preventDefault()}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./multi-touch"),s=180/Math.PI;return e.extend(n,a,{onTouchMove:function(t){if(this.isTracking){var n=t.touches,r=n[0],o=n[1],a=this.lastAngle;r=Math.atan2(o.pageY-r.pageY,o.pageX-r.pageX)*s;if(void 0!==a){o=Math.abs(r-a);var u=(r+360)%360,l=(r-360)%360;Math.abs(u-a)<o?r=u:Math.abs(l-a)<o&&(r=l)}this.lastTouches=n,this.lastAngle=r,this.isStarted?i.fire(this.target,"rotate",e.mix(t,{angle:r,rotation:r-this.startAngle})):(this.isStarted=!0,this.startAngle=r,this.target=this.getCommonTarget(t),i.fire(this.target,"rotateStart",e.mix(t,{angle:r,rotation:0})))}},end:function(){this.lastAngle=void 0,n.superclass.end.apply(this,arguments)},fireEnd:function(t){i.fire(this.target,"rotateEnd",e.mix(t,{touches:this.lastTouches}))}}),a=new n,o.rotateEnd=o.rotateStart={handle:a},o.rotate={handle:a,setup:function(){i.on(this,"touchmove",r)},tearDown:function(){i.detach(this,"touchmove",r)}},n}),KISSY.add("event/dom/touch/handle","dom,./handle-map,event/dom/base,./tap,./swipe,./double-tap,./pinch,./tap-hold,./rotate".split(","),function(e,t){function n(t){return e.startsWith(t,"touch")}function r(t){return e.startsWith(t,"mouse")}function o(t){return e.startsWith(t,"MSPointer")||e.startsWith(t,"pointer")}function i(e){this.doc=e,this.eventHandle={},this.init(),this.touches=[],this.inTouch=0}var a=t("dom"),s=t("./handle-map"),u=t("event/dom/base");t("./tap"),t("./swipe"),t("./double-tap"),t("./pinch"),t("./tap-hold"),t("./rotate");var l,c,d,h=e.guid("touch-handle"),f=e.Features;return f.isTouchEventSupported()?e.UA.ios?(d="touchend touchcancel",l="touchstart",c="touchmove"):(d="touchend touchcancel mouseup",l="touchstart mousedown",c="touchmove mousemove"):f.isPointerSupported()?(l="pointerdown",c="pointermove",d="pointerup pointercancel"):f.isMsPointerSupported()?(l="MSPointerDown",c="MSPointerMove",d="MSPointerUp MSPointerCancel"):(l="mousedown",c="mousemove",d="mouseup"),i.prototype={constructor:i,lastTouches:[],firstTouch:null,init:function(){var e=this.doc;u.on(e,l,this.onTouchStart,this),o(c)||u.on(e,c,this.onTouchMove,this),u.on(e,d,this.onTouchEnd,this)},addTouch:function(e){e.identifier=e.pointerId,this.touches.push(e)},removeTouch:function(e){for(var t=0,n=e.pointerId,r=this.touches,o=r.length;t<o;t++)if((e=r[t]).pointerId===n){r.splice(t,1);break}},updateTouch:function(e){for(var t=0,n=e.pointerId,r=this.touches,o=r.length;t<o;t++)r[t].pointerId===n&&(r[t]=e)},isPrimaryTouch:function(e){return this.firstTouch===e.identifier},setPrimaryTouch:function(e){null===this.firstTouch&&(this.firstTouch=e.identifier)},removePrimaryTouch:function(e){this.isPrimaryTouch(e)&&(this.firstTouch=null)},dupMouse:function(e){var t=this.lastTouches;e=e.changedTouches[0];if(this.isPrimaryTouch(e)){var n={x:e.clientX,y:e.clientY};t.push(n),setTimeout(function(){var e=t.indexOf(n);e>-1&&t.splice(e,1)},2500)}},isEventSimulatedFromTouch:function(e){for(var t,n=this.lastTouches,r=e.clientX,o=(e=e.clientY,0),i=n.length;o<i&&(t=n[o]);o++){var a=Math.abs(r-t.x),s=Math.abs(e-t.y);if(a<=25&&s<=25)return!0}return 0},normalize:function(e){var t,r=e.type;return n(r)?(1===(t="touchend"===r||"touchcancel"===r?e.changedTouches:e.touches).length&&(e.which=1,e.pageX=t[0].pageX,e.pageY=t[0].pageY),e):(t=this.touches,r=!r.match(/(up|cancel)$/i),e.touches=r?t:[],e.targetTouches=r?t:[],e.changedTouches=t,e)},onTouchStart:function(e){var t,i;i=e.type;var a=this.eventHandle;if(n(i))this.setPrimaryTouch(e.changedTouches[0]),this.dupMouse(e);else if(r(i)){if(this.isEventSimulatedFromTouch(e))return;this.touches=[e.originalEvent]}else{if(!o(i))throw Error("unrecognized touch event: "+e.type);this.addTouch(e.originalEvent),1===this.touches.length&&u.on(this.doc,c,this.onTouchMove,this)}for(t in a)(i=a[t].handle).isActive=1;this.callEventHandle("onTouchStart",e)},onTouchMove:function(e){var t=e.type;if(r(t)){if(this.isEventSimulatedFromTouch(t))return;this.touches=[e.originalEvent]}else if(o(t))this.updateTouch(e.originalEvent);else if(!n(t))throw Error("unrecognized touch event: "+e.type);this.callEventHandle("onTouchMove",e)},onTouchEnd:function(t){var i=this,a=t.type;r(a)&&i.isEventSimulatedFromTouch(t)||(i.callEventHandle("onTouchEnd",t),n(a)?(i.dupMouse(t),e.makeArray(t.changedTouches).forEach(function(e){i.removePrimaryTouch(e)})):r(a)?i.touches=[]:o(a)&&(i.removeTouch(t.originalEvent),i.touches.length||u.detach(i.doc,c,i.onTouchMove,i)))},callEventHandle:function(e,t){var n,r,o=this.eventHandle;if((t=this.normalize(t)).changedTouches.length){for(n in o)(r=o[n].handle).processed||(r.processed=1,r.isActive&&r[e]&&!1===r[e](t)&&(r.isActive=0));for(n in o)(r=o[n].handle).processed=0}},addEventHandle:function(e){var t=this.eventHandle,n=s[e].handle;t[e]?t[e].count++:t[e]={count:1,handle:n}},removeEventHandle:function(e){var t=this.eventHandle;t[e]&&(t[e].count--,t[e].count||delete t[e])},destroy:function(){var e=this.doc;u.detach(e,l,this.onTouchStart,this),u.detach(e,c,this.onTouchMove,this),u.detach(e,d,this.onTouchEnd,this)}},{addDocumentHandle:function(e,t){var n=a.getDocument(e),r=a.data(n,h);r||a.data(n,h,r=new i(n)),t&&r.addEventHandle(t)},removeDocumentHandle:function(t,n){var r=a.getDocument(t),o=a.data(r,h);o&&(n&&o.removeEventHandle(n),e.isEmptyObject(o.eventHandle)&&(o.destroy(),a.removeData(r,h)))}}}),KISSY.add("event/dom/touch",["event/dom/base","./touch/handle-map","./touch/handle"],function(e,t){function n(e){u.addDocumentHandle(this,e),s[e].setup.apply(this,arguments)}function r(e){u.removeDocumentHandle(this,e),s[e].tearDown.apply(this,arguments)}function o(e){u.addDocumentHandle(this,e)}function i(e){u.removeDocumentHandle(this,e)}var a=t("event/dom/base"),s=t("./touch/handle-map"),u=t("./touch/handle"),l=(p=a.Gesture).start="KSPointerDown",c=p.move="KSPointerMove",d=p.end="KSPointerUp";p.tap="tap",p.doubleTap="doubleTap",s[l]={handle:{isActive:1,onTouchStart:function(e){a.fire(e.target,l,e)}}},s[c]={handle:{isActive:1,onTouchMove:function(e){a.fire(e.target,c,e)}}},s[d]={handle:{isActive:1,onTouchEnd:function(e){a.fire(e.target,d,e)}}};var h,f,g,p=a.Special;for(f in s)h={},g=s[f],h.setup=g.setup?n:o,h.tearDown=g.tearDown?r:i,g.add&&(h.add=g.add),g.remove&&(h.remove=g.remove),p[f]=h}),KISSY.add("cookie",[],function(e){function t(e){return"string"==typeof e&&""!==e}var n=e.Env.host.document,r=encodeURIComponent,o=e.urlDecode;return e.Cookie={get:function(e){var r,i;return t(e)&&(i=(""+n.cookie).match(RegExp("(?:^| )"+e+"(?:(?:=([^;]*))|;|$)")))&&(r=i[1]?o(i[1]):""),r},set:function(e,o,i,a,s,u){o=""+r(o);var l=i;"number"==typeof l&&(l=new Date).setTime(l.getTime()+864e5*i),l instanceof Date&&(o+="; expires="+l.toUTCString()),t(a)&&(o+="; domain="+a),t(s)&&(o+="; path="+s),u&&(o+="; secure"),n.cookie=e+"="+o},remove:function(e,t,n,r){this.set(e,"",-1,t,n,r)}},e.Cookie}),KISSY.add("json/quote",[],function(e){var t={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t",'"':'\\"'},n={},r=/["\b\f\n\r\t\x00-\x1f]/g,o=/\\b|\\f|\\n|\\r|\\t|\\"|\\u[0-9a-zA-Z]{4}/g;return e.each(t,function(e,t){n[t]=e}),n["\\/"]="/",{quote:function(e){return'"'+e.replace(r,function(e){var n;return(n=t[e])||(n="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)),n})+'"'},unQuote:function(e){return e.slice(1,e.length-1).replace(o,function(e){var t;return(t=n[e])||(t=String.fromCharCode(parseInt(e.slice(2),16))),t})}}}),KISSY.add("json/stringify",["./quote"],function(e,t){function n(e){return 10>e?"0"+e:e}var r=t("./quote");return function(t,o,i){var a,s,u="";return o&&("function"==typeof o?s=o:e.isArray(o)&&(a=o)),"number"==typeof i?(i=Math.min(10,i),u=Array(i+1).join(" ")):"string"==typeof i&&(u=i.slice(0,10)),function t(o,i,a,s,u,l,c){switch((d=i[o])&&"object"==typeof d&&("function"==typeof d.toJSON?d=d.toJSON(o):d instanceof Date?d=isFinite(d.valueOf())?d.getUTCFullYear()+"-"+n(d.getUTCMonth()+1)+"-"+n(d.getUTCDate())+"T"+n(d.getUTCHours())+":"+n(d.getUTCMinutes())+":"+n(d.getUTCSeconds())+"Z":null:(d instanceof String||d instanceof Number||d instanceof Boolean)&&(d=d.valueOf())),void 0!==a&&(d=a.call(i,o,d)),typeof d){case"number":return isFinite(d)?""+d:"null";case"string":return r.quote(d);case"boolean":return""+d;case"object":if(d)if(e.isArray(d)){o=d,i=c,c+=u;for(var d=[],h=o.length,f=0;f<h;){var g=t(""+f,o,a,s,u,l,c);d[d.length]=void 0===g?"null":g,++f}a=d.length?u?"[\n"+c+(a=d.join("\n,"+c))+"\n"+i+"]":"["+d.join(",")+"]":"[]"}else{var p;for(o=d,i=c,c+=u,g=[],f=0,h=(d=void 0!==s?s:e.keys(o)).length;f<h;f++){var m=t(p=d[f],o,a,s,u,l,c);void 0!==m&&(p=r.quote(p),p+=":",u&&(p+=" "),p+=m,g[g.length]=p)}a=g.length?u?"{\n"+c+(a=g.join(",\n"+c))+"\n"+i+"}":"{"+g.join(",")+"}":"{}"}else a="null";return a}}("",{"":t},s,a,u,[],"")}}),KISSY.add("json/parser",[],function(e,t){var n={},r=KISSY,o=function(e){this.rules=[],r.mix(this,e),this.resetInput(this.input)};o.prototype={constructor:function(e){this.rules=[],r.mix(this,e),this.resetInput(this.input)},resetInput:function(e){r.mix(this,{input:e,matched:"",stateStack:[o.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var e=this.stateStack[this.stateStack.length-1],t=[];e=this.mapState(e);return r.each(this.rules,function(n){var i=n.state||n[3];i?r.inArray(e,i)&&t.push(n):e==o.STATIC.INITIAL&&t.push(n)}),t},pushState:function(e){this.stateStack.push(e)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var e=o.STATIC.DEBUG_CONTEXT_LIMIT,t=this.matched,n=this.match,r=this.input;return(t=((t=t.slice(0,t.length-n.length)).length>e?"...":"")+t.slice(-e).replace(/\n/," "))+(n=(n=n+r).slice(0,e)+(n.length>e?"...":""))+"\n"+Array(t.length+1).join("-")+"^"},mapSymbol:function(e){var t=this.symbolMap;return t?t[e]||(t[e]=++this.symbolId):e},mapReverseSymbol:function(e){var t,n=this.symbolMap,r=this.reverseSymbolMap;if(!r&&n)for(t in r=this.reverseSymbolMap={},n)r[n[t]]=t;return r?r[e]:e},mapState:function(e){var t=this.stateMap;return t?t[e]||(t[e]=++this.stateId):e},lex:function(){var e,n,i,a=this.input,s=this.getCurrentRules();if(this.match=this.text="",!a)return this.mapSymbol(o.STATIC.END_TAG);for(e=0;e<s.length;e++){var u=(n=s[e]).token||n[0];if(i=n.action||n[2]||t,n=a.match(n.regexp||n[1]))return(e=n[0].match(/\n.*/g))&&(this.lineNumber+=e.length),r.mix(this,{firstLine:this.lastLine,lastLine:this.lineNumber+1,firstColumn:this.lastColumn,lastColumn:e?e[e.length-1].length-1:this.lastColumn+n[0].length}),e=this.match=n[0],this.matches=n,this.text=e,this.matched+=e,i=(i=i&&i.call(this))===t?u:this.mapSymbol(i),this.input=a=a.slice(e.length),i||this.lex()}return this.lineNumber,this.showDebugInfo(),t}},o.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};var i=new o({rules:[[2,/^"(\\"|\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\u[0-9a-zA-Z]{4}|[^\\"\x00-\x1f])*"/,0],[0,/^[\t\r\n\x20]/,0],[3,/^,/,0],[4,/^:/,0],[5,/^\[/,0],[6,/^\]/,0],[7,/^\{/,0],[8,/^\}/,0],[9,/^-?\d+(?:\.\d+)?(?:e-?\d+)?/i,0],[10,/^true|false/,0],[11,/^null/,0],[12,/^./,0]]});return n.lexer=i,i.symbolMap={$EOF:1,STRING:2,COMMA:3,COLON:4,LEFT_BRACKET:5,RIGHT_BRACKET:6,LEFT_BRACE:7,RIGHT_BRACE:8,NUMBER:9,BOOLEAN:10,NULL:11,INVALID:12,$START:13,json:14,value:15,object:16,array:17,elementList:18,member:19,memberList:20},n.productions=[[13,[14]],[14,[15],function(){return this.$1}],[15,[2],function(){return this.yy.unQuote(this.$1)}],[15,[9],function(){return parseFloat(this.$1)}],[15,[16],function(){return this.$1}],[15,[17],function(){return this.$1}],[15,[10],function(){return"true"===this.$1}],[15,[11],function(){return null}],[18,[15],function(){return[this.$1]}],[18,[18,3,15],function(){return this.$1[this.$1.length]=this.$3,this.$1}],[17,[5,6],function(){return[]}],[17,[5,18,6],function(){return this.$2}],[19,[2,4,15],function(){return{key:this.yy.unQuote(this.$1),value:this.$3}}],[20,[19],function(){var e={};return e[this.$1.key]=this.$1.value,e}],[20,[20,3,19],function(){return this.$1[this.$3.key]=this.$3.value,this.$1}],[16,[7,8],function(){return{}}],[16,[7,20,8],function(){return this.$2}]],n.table={gotos:{0:{14:7,15:8,16:9,17:10},2:{15:12,16:9,17:10,18:13},3:{19:16,20:17},18:{15:23,16:9,17:10},20:{15:24,16:9,17:10},21:{19:25}},action:{0:{2:[1,0,1],5:[1,0,2],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},1:{1:[2,2,0],3:[2,2,0],6:[2,2,0],8:[2,2,0]},2:{2:[1,0,1],5:[1,0,2],6:[1,0,11],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},3:{2:[1,0,14],8:[1,0,15]},4:{1:[2,3,0],3:[2,3,0],6:[2,3,0],8:[2,3,0]},5:{1:[2,6,0],3:[2,6,0],6:[2,6,0],8:[2,6,0]},6:{1:[2,7,0],3:[2,7,0],6:[2,7,0],8:[2,7,0]},7:{1:[0,0,0]},8:{1:[2,1,0]},9:{1:[2,4,0],3:[2,4,0],6:[2,4,0],8:[2,4,0]},10:{1:[2,5,0],3:[2,5,0],6:[2,5,0],8:[2,5,0]},11:{1:[2,10,0],3:[2,10,0],6:[2,10,0],8:[2,10,0]},12:{3:[2,8,0],6:[2,8,0]},13:{3:[1,0,18],6:[1,0,19]},14:{4:[1,0,20]},15:{1:[2,15,0],3:[2,15,0],6:[2,15,0],8:[2,15,0]},16:{3:[2,13,0],8:[2,13,0]},17:{3:[1,0,21],8:[1,0,22]},18:{2:[1,0,1],5:[1,0,2],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},19:{1:[2,11,0],3:[2,11,0],6:[2,11,0],8:[2,11,0]},20:{2:[1,0,1],5:[1,0,2],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},21:{2:[1,0,14]},22:{1:[2,16,0],3:[2,16,0],6:[2,16,0],8:[2,16,0]},23:{3:[2,9,0],6:[2,9,0]},24:{3:[2,12,0],8:[2,12,0]},25:{3:[2,14,0],8:[2,14,0]}}},n.parse=function(e){var n,o,i,a=this,s=a.lexer,u=(l=a.table).gotos,l=l.action,c=a.productions,d=[null],h=[0];for(s.resetInput(e);;){if(n=h[h.length-1],o||(o=s.lex()),!o)return!1;if(!(i=l[n]&&l[n][o])){var f=[];return l[n]&&r.each(l[n],function(e,t){f.push(a.lexer.mapReverseSymbol(t))}),e="Syntax error at line "+s.lineNumber+":\n"+s.showDebugInfo()+"\nexpect "+f.join(", "),!1}switch(i[0]){case 1:h.push(o),d.push(s.text),h.push(i[2]),o=null;break;case 2:n=(m=c[i[1]]).symbol||m[0],i=m.action||m[2];var g=(m.rhs||m[1]).length,p=0,m=d[d.length-g];for(a.$$=m,m=t;p<g;p++)a["$"+(g-p)]=d[d.length-1-p];i&&(m=i.call(a)),m=m!==t?m:a.$$,g&&(h=h.slice(0,-2*g),d=d.slice(0,-1*g)),h.push(n),d.push(m),h.push(u[h[h.length-2]][h[h.length-1]]);break;case 0:return m}}return t},n}),KISSY.add("json/parse",["./parser","./quote"],function(e,t){var n=t("./parser"),r=t("./quote");return n.yy={unQuote:r.unQuote},function(t,r){var o=n.parse(""+t);return r?function t(n,r,o){var i,a,s,u=n[r];if("object"==typeof u)if(e.isArray(u)){i=0,a=u.length;for(var l=[];i<a;)void 0!==(s=t(u,""+i,o))&&(l[l.length]=s);u=l}else for(i=0,a=(l=e.keys(u)).length;i<a;i++){var c=l[i];void 0===(s=t(u,c,o))?delete u[c]:u[c]=s}return o.call(n,r,u)}({"":o},"",r):o}}),KISSY.add("json",["./json/stringify","./json/parse"],function(e,t){var n=t("./json/stringify"),r=t("./json/parse");return e.JSON={stringify:n,parse:r}}),KISSY.add("dom/class-list",["dom/base"],function(e,t){var n=t("dom/base"),r=/[\n\t\r]/g;return e.mix(n,{_hasClass:function(e,t){var n,o,i=e.className;if(i){for(i=(" "+i+" ").replace(r," "),o=0,n=t.length;o<n;o++)if(0>i.indexOf(" "+t[o]+" "))return!1;return!0}return!1},_addClass:function(t,n){var o,i,a=t.className,s=n.length;if(a){for(o=(" "+a+" ").replace(r," "),i=0;i<s;i++)0>o.indexOf(" "+n[i]+" ")&&(a+=" "+n[i]);a=e.trim(a)}else a=n.join(" ");t.className=a},_removeClass:function(t,n){var o,i,a=t.className,s=n.length;if(a&&s){for(a=(" "+a+" ").replace(r," "),o=0;o<s;o++)for(i=" "+n[o]+" ";0<=a.indexOf(i);)a=a.replace(i," ");t.className=e.trim(a)}},_toggleClass:function(e,t,n){var r,o,i,a=[],s=[],u=t.length;for(r=0;r<u;r++)o=t[r],"remove"===(i=(i=this._hasClass(e,[o]))?!0!==n&&"remove":!1!==n&&"add")?a.push(o):"add"===i&&s.push(o);s.length&&this._addClass(e,s),a.length&&this._removeClass(e,a)}})}),KISSY.add("dom/selector/parser",[],function(e,t){var n={},r=KISSY,o=function(e){this.rules=[],r.mix(this,e),this.resetInput(this.input)};o.prototype={constructor:function(e){this.rules=[],r.mix(this,e),this.resetInput(this.input)},resetInput:function(e){r.mix(this,{input:e,matched:"",stateStack:[o.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var e=this.stateStack[this.stateStack.length-1],t=[];e=this.mapState(e);return r.each(this.rules,function(n){var i=n.state||n[3];i?r.inArray(e,i)&&t.push(n):e===o.STATIC.INITIAL&&t.push(n)}),t},pushState:function(e){this.stateStack.push(e)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var e=o.STATIC.DEBUG_CONTEXT_LIMIT,t=this.matched,n=this.match,r=this.input;return(t=((t=t.slice(0,t.length-n.length)).length>e?"...":"")+t.slice(-e).replace(/\n/," "))+(n=(n=n+r).slice(0,e)+(n.length>e?"...":""))+"\n"+Array(t.length+1).join("-")+"^"},mapSymbol:function(e){var t=this.symbolMap;return t?t[e]||(t[e]=++this.symbolId):e},mapReverseSymbol:function(e){var t,n=this.symbolMap,r=this.reverseSymbolMap;if(!r&&n)for(t in r=this.reverseSymbolMap={},n)r[n[t]]=t;return r?r[e]:e},mapState:function(e){var t=this.stateMap;return t?t[e]||(t[e]=++this.stateId):e},lex:function(){var e,n,i,a=this.input,s=this.getCurrentRules();if(this.match=this.text="",!a)return this.mapSymbol(o.STATIC.END_TAG);for(e=0;e<s.length;e++){var u=(n=s[e]).token||n[0];if(i=n.action||n[2]||t,n=a.match(n.regexp||n[1]))return(e=n[0].match(/\n.*/g))&&(this.lineNumber+=e.length),r.mix(this,{firstLine:this.lastLine,lastLine:this.lineNumber+1,firstColumn:this.lastColumn,lastColumn:e?e[e.length-1].length-1:this.lastColumn+n[0].length}),e=this.match=n[0],this.matches=n,this.text=e,this.matched+=e,i=(i=i&&i.call(this))===t?u:this.mapSymbol(i),this.input=a=a.slice(e.length),i||this.lex()}return this.lineNumber,this.showDebugInfo(),t}},o.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};var i=new o({rules:[[2,/^\[(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[3,/^(?:[\t\r\n\f\x20]*)\]/,function(){this.text=KISSY.trim(this.text)}],[4,/^(?:[\t\r\n\f\x20]*)~=(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[5,/^(?:[\t\r\n\f\x20]*)\|=(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[6,/^(?:[\t\r\n\f\x20]*)\^=(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[7,/^(?:[\t\r\n\f\x20]*)\$=(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[8,/^(?:[\t\r\n\f\x20]*)\*=(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[9,/^(?:[\t\r\n\f\x20]*)\=(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[10,/^(?:(?:[\w]|[^\x00-\xa0]|(?:\\[^\n\r\f0-9a-f]))(?:[\w\d-]|[^\x00-\xa0]|(?:\\[^\n\r\f0-9a-f]))*)\(/,function(){this.text=KISSY.trim(this.text).slice(0,-1),this.pushState("fn")}],[11,/^[^\)]*/,function(){this.popState()},["fn"]],[12,/^(?:[\t\r\n\f\x20]*)\)/,function(){this.text=KISSY.trim(this.text)}],[13,/^:not\((?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[14,/^(?:(?:[\w]|[^\x00-\xa0]|(?:\\[^\n\r\f0-9a-f]))(?:[\w\d-]|[^\x00-\xa0]|(?:\\[^\n\r\f0-9a-f]))*)/,function(){this.text=this.yy.unEscape(this.text)}],[15,/^"(\\"|[^"])*"/,function(){this.text=this.yy.unEscapeStr(this.text)}],[15,/^'(\\'|[^'])*'/,function(){this.text=this.yy.unEscapeStr(this.text)}],[16,/^#(?:(?:[\w\d-]|[^\x00-\xa0]|(?:\\[^\n\r\f0-9a-f]))+)/,function(){this.text=this.yy.unEscape(this.text.slice(1))}],[17,/^\.(?:(?:[\w]|[^\x00-\xa0]|(?:\\[^\n\r\f0-9a-f]))(?:[\w\d-]|[^\x00-\xa0]|(?:\\[^\n\r\f0-9a-f]))*)/,function(){this.text=this.yy.unEscape(this.text.slice(1))}],[18,/^(?:[\t\r\n\f\x20]*),(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[19,/^::?/,0],[20,/^(?:[\t\r\n\f\x20]*)\+(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[21,/^(?:[\t\r\n\f\x20]*)>(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[22,/^(?:[\t\r\n\f\x20]*)~(?:[\t\r\n\f\x20]*)/,function(){this.text=KISSY.trim(this.text)}],[23,/^\*/,0],[24,/^(?:[\t\r\n\f\x20]+)/,0],[25,/^./,0]]});return n.lexer=i,i.symbolMap={$EOF:1,LEFT_BRACKET:2,RIGHT_BRACKET:3,INCLUDES:4,DASH_MATCH:5,PREFIX_MATCH:6,SUFFIX_MATCH:7,SUBSTRING_MATCH:8,ALL_MATCH:9,FUNCTION:10,PARAMETER:11,RIGHT_PARENTHESES:12,NOT:13,IDENT:14,STRING:15,HASH:16,CLASS:17,COMMA:18,COLON:19,PLUS:20,GREATER:21,TILDE:22,UNIVERSAL:23,S:24,INVALID:25,$START:26,selectors_group:27,selector:28,simple_selector_sequence:29,combinator:30,type_selector:31,id_selector:32,class_selector:33,attrib_match:34,attrib:35,attrib_val:36,pseudo:37,negation:38,negation_arg:39,suffix_selector:40,suffix_selectors:41},n.productions=[[26,[27]],[27,[28],function(){return[this.$1]}],[27,[27,18,28],function(){this.$1.push(this.$3)}],[28,[29]],[28,[28,30,29],function(){return this.$1.nextCombinator=this.$3.prevCombinator=this.$2,this.$3.order=(this.$1.order=this.$1.order||0)+1,this.$3.prev=this.$1,this.$1.next=this.$3}],[30,[20]],[30,[21]],[30,[22]],[30,[24],function(){return" "}],[31,[14],function(){return{t:"tag",value:this.$1}}],[31,[23],function(){return{t:"tag",value:this.$1}}],[32,[16],function(){return{t:"id",value:this.$1}}],[33,[17],function(){return{t:"cls",value:this.$1}}],[34,[6]],[34,[7]],[34,[8]],[34,[9]],[34,[4]],[34,[5]],[35,[2,14,3],function(){return{t:"attrib",value:{ident:this.$2}}}],[36,[14]],[36,[15]],[35,[2,14,34,36,3],function(){return{t:"attrib",value:{ident:this.$2,match:this.$3,value:this.$4}}}],[37,[19,10,11,12],function(){return{t:"pseudo",value:{fn:this.$2.toLowerCase(),param:this.$3}}}],[37,[19,14],function(){return{t:"pseudo",value:{ident:this.$2.toLowerCase()}}}],[38,[13,39,12],function(){return{t:"pseudo",value:{fn:"not",param:this.$2}}}],[39,[31]],[39,[32]],[39,[33]],[39,[35]],[39,[37]],[40,[32]],[40,[33]],[40,[35]],[40,[37]],[40,[38]],[41,[40],function(){return[this.$1]}],[41,[41,40],function(){this.$1.push(this.$2)}],[29,[31]],[29,[41],function(){return{suffix:this.$1}}],[29,[31,41],function(){return{t:"tag",value:this.$1.value,suffix:this.$2}}]],n.table={gotos:{0:{27:8,28:9,29:10,31:11,32:12,33:13,35:14,37:15,38:16,40:17,41:18},2:{31:20,32:21,33:22,35:23,37:24,39:25},9:{30:33},11:{32:12,33:13,35:14,37:15,38:16,40:17,41:34},18:{32:12,33:13,35:14,37:15,38:16,40:35},19:{34:43},28:{28:46,29:10,31:11,32:12,33:13,35:14,37:15,38:16,40:17,41:18},33:{29:47,31:11,32:12,33:13,35:14,37:15,38:16,40:17,41:18},34:{32:12,33:13,35:14,37:15,38:16,40:35},43:{36:50},46:{30:33}},action:{0:{2:[1,0,1],13:[1,0,2],14:[1,0,3],16:[1,0,4],17:[1,0,5],19:[1,0,6],23:[1,0,7]},1:{14:[1,0,19]},2:{2:[1,0,1],14:[1,0,3],16:[1,0,4],17:[1,0,5],19:[1,0,6],23:[1,0,7]},3:{1:[2,9,0],2:[2,9,0],12:[2,9,0],13:[2,9,0],16:[2,9,0],17:[2,9,0],18:[2,9,0],19:[2,9,0],20:[2,9,0],21:[2,9,0],22:[2,9,0],24:[2,9,0]},4:{1:[2,11,0],2:[2,11,0],12:[2,11,0],13:[2,11,0],16:[2,11,0],17:[2,11,0],18:[2,11,0],19:[2,11,0],20:[2,11,0],21:[2,11,0],22:[2,11,0],24:[2,11,0]},5:{1:[2,12,0],2:[2,12,0],12:[2,12,0],13:[2,12,0],16:[2,12,0],17:[2,12,0],18:[2,12,0],19:[2,12,0],20:[2,12,0],21:[2,12,0],22:[2,12,0],24:[2,12,0]},6:{10:[1,0,26],14:[1,0,27]},7:{1:[2,10,0],2:[2,10,0],12:[2,10,0],13:[2,10,0],16:[2,10,0],17:[2,10,0],18:[2,10,0],19:[2,10,0],20:[2,10,0],21:[2,10,0],22:[2,10,0],24:[2,10,0]},8:{1:[0,0,0],18:[1,0,28]},9:{1:[2,1,0],18:[2,1,0],20:[1,0,29],21:[1,0,30],22:[1,0,31],24:[1,0,32]},10:{1:[2,3,0],18:[2,3,0],20:[2,3,0],21:[2,3,0],22:[2,3,0],24:[2,3,0]},11:{1:[2,38,0],2:[1,0,1],13:[1,0,2],16:[1,0,4],17:[1,0,5],18:[2,38,0],19:[1,0,6],20:[2,38,0],21:[2,38,0],22:[2,38,0],24:[2,38,0]},12:{1:[2,31,0],2:[2,31,0],13:[2,31,0],16:[2,31,0],17:[2,31,0],18:[2,31,0],19:[2,31,0],20:[2,31,0],21:[2,31,0],22:[2,31,0],24:[2,31,0]},13:{1:[2,32,0],2:[2,32,0],13:[2,32,0],16:[2,32,0],17:[2,32,0],18:[2,32,0],19:[2,32,0],20:[2,32,0],21:[2,32,0],22:[2,32,0],24:[2,32,0]},14:{1:[2,33,0],2:[2,33,0],13:[2,33,0],16:[2,33,0],17:[2,33,0],18:[2,33,0],19:[2,33,0],20:[2,33,0],21:[2,33,0],22:[2,33,0],24:[2,33,0]},15:{1:[2,34,0],2:[2,34,0],13:[2,34,0],16:[2,34,0],17:[2,34,0],18:[2,34,0],19:[2,34,0],20:[2,34,0],21:[2,34,0],22:[2,34,0],24:[2,34,0]},16:{1:[2,35,0],2:[2,35,0],13:[2,35,0],16:[2,35,0],17:[2,35,0],18:[2,35,0],19:[2,35,0],20:[2,35,0],21:[2,35,0],22:[2,35,0],24:[2,35,0]},17:{1:[2,36,0],2:[2,36,0],13:[2,36,0],16:[2,36,0],17:[2,36,0],18:[2,36,0],19:[2,36,0],20:[2,36,0],21:[2,36,0],22:[2,36,0],24:[2,36,0]},18:{1:[2,39,0],2:[1,0,1],13:[1,0,2],16:[1,0,4],17:[1,0,5],18:[2,39,0],19:[1,0,6],20:[2,39,0],21:[2,39,0],22:[2,39,0],24:[2,39,0]},19:{3:[1,0,36],4:[1,0,37],5:[1,0,38],6:[1,0,39],7:[1,0,40],8:[1,0,41],9:[1,0,42]},20:{12:[2,26,0]},21:{12:[2,27,0]},22:{12:[2,28,0]},23:{12:[2,29,0]},24:{12:[2,30,0]},25:{12:[1,0,44]},26:{11:[1,0,45]},27:{1:[2,24,0],2:[2,24,0],12:[2,24,0],13:[2,24,0],16:[2,24,0],17:[2,24,0],18:[2,24,0],19:[2,24,0],20:[2,24,0],21:[2,24,0],22:[2,24,0],24:[2,24,0]},28:{2:[1,0,1],13:[1,0,2],14:[1,0,3],16:[1,0,4],17:[1,0,5],19:[1,0,6],23:[1,0,7]},29:{2:[2,5,0],13:[2,5,0],14:[2,5,0],16:[2,5,0],17:[2,5,0],19:[2,5,0],23:[2,5,0]},30:{2:[2,6,0],13:[2,6,0],14:[2,6,0],16:[2,6,0],17:[2,6,0],19:[2,6,0],23:[2,6,0]},31:{2:[2,7,0],13:[2,7,0],14:[2,7,0],16:[2,7,0],17:[2,7,0],19:[2,7,0],23:[2,7,0]},32:{2:[2,8,0],13:[2,8,0],14:[2,8,0],16:[2,8,0],17:[2,8,0],19:[2,8,0],23:[2,8,0]},33:{2:[1,0,1],13:[1,0,2],14:[1,0,3],16:[1,0,4],17:[1,0,5],19:[1,0,6],23:[1,0,7]},34:{1:[2,40,0],2:[1,0,1],13:[1,0,2],16:[1,0,4],17:[1,0,5],18:[2,40,0],19:[1,0,6],20:[2,40,0],21:[2,40,0],22:[2,40,0],24:[2,40,0]},35:{1:[2,37,0],2:[2,37,0],13:[2,37,0],16:[2,37,0],17:[2,37,0],18:[2,37,0],19:[2,37,0],20:[2,37,0],21:[2,37,0],22:[2,37,0],24:[2,37,0]},36:{1:[2,19,0],2:[2,19,0],12:[2,19,0],13:[2,19,0],16:[2,19,0],17:[2,19,0],18:[2,19,0],19:[2,19,0],20:[2,19,0],21:[2,19,0],22:[2,19,0],24:[2,19,0]},37:{14:[2,17,0],15:[2,17,0]},38:{14:[2,18,0],15:[2,18,0]},39:{14:[2,13,0],15:[2,13,0]},40:{14:[2,14,0],15:[2,14,0]},41:{14:[2,15,0],15:[2,15,0]},42:{14:[2,16,0],15:[2,16,0]},43:{14:[1,0,48],15:[1,0,49]},44:{1:[2,25,0],2:[2,25,0],13:[2,25,0],16:[2,25,0],17:[2,25,0],18:[2,25,0],19:[2,25,0],20:[2,25,0],21:[2,25,0],22:[2,25,0],24:[2,25,0]},45:{12:[1,0,51]},46:{1:[2,2,0],18:[2,2,0],20:[1,0,29],21:[1,0,30],22:[1,0,31],24:[1,0,32]},47:{1:[2,4,0],18:[2,4,0],20:[2,4,0],21:[2,4,0],22:[2,4,0],24:[2,4,0]},48:{3:[2,20,0]},49:{3:[2,21,0]},50:{3:[1,0,52]},51:{1:[2,23,0],2:[2,23,0],12:[2,23,0],13:[2,23,0],16:[2,23,0],17:[2,23,0],18:[2,23,0],19:[2,23,0],20:[2,23,0],21:[2,23,0],22:[2,23,0],24:[2,23,0]},52:{1:[2,22,0],2:[2,22,0],12:[2,22,0],13:[2,22,0],16:[2,22,0],17:[2,22,0],18:[2,22,0],19:[2,22,0],20:[2,22,0],21:[2,22,0],22:[2,22,0],24:[2,22,0]}}},n.parse=function(e){var n,o,i,a=this,s=a.lexer,u=(l=a.table).gotos,l=l.action,c=a.productions,d=[null],h=[0];for(s.resetInput(e);;){if(n=h[h.length-1],o||(o=s.lex()),!o)return!1;if(!(i=l[n]&&l[n][o])){var f=[];return l[n]&&r.each(l[n],function(e,t){f.push(a.lexer.mapReverseSymbol(t))}),e="Syntax error at line "+s.lineNumber+":\n"+s.showDebugInfo()+"\nexpect "+f.join(", "),!1}switch(i[0]){case 1:h.push(o),d.push(s.text),h.push(i[2]),o=null;break;case 2:n=(_=c[i[1]]).symbol||_[0],i=_.action||_[2];var g,p=(_.rhs||_[1]).length,m=0,_=d[d.length-p];for(g=t,a.$$=_;m<p;m++)a["$"+(p-m)]=d[d.length-1-m];i&&(g=i.call(a)),_=g!==t?g:a.$$,p&&(h=h.slice(0,-2*p),d=d.slice(0,-1*p)),h.push(n),d.push(_),h.push(u[h[h.length-2]][h[h.length-1]]);break;case 0:return _}}return t},n}),KISSY.add("dom/selector",["./selector/parser","dom/basic"],function(e,t){function n(e){return e.replace(b,T)}function r(e,t){do{e=e[t]}while(e&&1!==e.nodeType);return e}function o(e){var t=0,n=0;return"number"==typeof e?n=e:"odd"===e?(t=2,n=1):"even"===e?(t=2,n=0):(e=e.replace(/\s/g,"").match(S))&&(e[1]?(t=parseInt(e[2]),isNaN(t)&&(t="-"===e[2]?-1:1)):t=0,n=parseInt(e[3])||0),{a:t,b:n}}function i(e,t,n,r){if(0===t){if(e===n)return r}else if(0<=(e-n)/t&&0==(e-n)%t&&r)return 1}function a(e,t){return h._selectInternal(e,null,t)}function s(e,t){if(!t)return!0;if(!e||9===e.nodeType)return!1;var n,r,o=1,i=t.suffix;if("tag"===t.t&&(o&=P.tag(e,t.value)),o&&i)for(n=i.length,r=0;o&&r<n;r++){var a=i[r],s=a.t;P[s]&&(o&=P[s](e,a.value))}return o}function u(e,t){var n;return c?(n=e.getAttribute(g))||e.setAttribute(g,n=+new Date+"_"+ ++m):(n=e[g])||(n=e[g]=+new Date+"_"+ ++m),(n=n+"_"+(t.order||0))in _?_[n]:(_[n]=function(e,t){var n=function(e,t){var n,o=1,i=e,a=t;do{if(!(o&=s(e,t))){if((n=x[t.nextCombinator]).immediate)break;return{el:e&&r(e,n.dir),match:t}}if(!(t=t&&t.prev))return!0;if(e=r(e,(n=x[t.nextCombinator]).dir),!n.immediate)return{el:e,match:t}}while(e);return{el:r(i,x[a.nextCombinator].dir),match:a}}(e,t);if(!0===n)return!0;for(e=n.el,t=n.match;e;){if(u(e,t))return!0;e=r(e,x[t.nextCombinator].dir)}return!1}(e,t),_[n])}function l(e,t,n){p[e]||(p[e]=d.parse(e));var o,i,a=0,l=(e=p[e]).length,g=[];for(n&&(t=t||n[0].ownerDocument),o=t&&t.ownerDocument||f,c=!!(i=(t=t||o)&&(t.ownerDocument||t).documentElement)&&"html"!==i.nodeName.toLowerCase();a<l;a++){_={};var m,y,I,S=(i=e[a]).suffix,b=n;if(I=null,!b){if(S&&!c)for(m=0,y=S.length;m<y;m++){if("id"===(T=S[m]).t){I=T.value;break}}if(I)if(m=!t.getElementById,y=h._contains(o,t),!(S=m?y?o.getElementById(I):null:t.getElementById(I))&&m||S&&v(S,"id")!==I){for(y=(m=h._getElementsByTagName("*",t)).length,T=0;T<y;T++)if(S=m[T],v(S,"id")===I){b=[S];break}T===y&&(b=[])}else y&&S&&t!==o&&(S=h._contains(t,S)?S:null),b=S?[S]:[];else b=h._getElementsByTagName(i.value||"*",t)}if(I=0,S=b.length)for(;I<S;I++){e:{y=m=b[I];var T=void 0,C=i;do{if(!s(y,C)){y=null;break e}if(!(C=C.prev)){y=!0;break e}y=r(y,(T=x[C.nextCombinator]).dir)}while(y&&T.immediate);y=y?{el:y,match:C}:null}!0===y?g.push(m):y&&u(y.el,y.match)&&g.push(m)}}return 1<l&&(g=h.unique(g)),g}var c,d=t("./selector/parser"),h=t("dom/basic"),f=e.Env.host.document,g="_ks_data_selector_id_",p={},m=0,_={},v=function(e,t){return c?h._getSimpleAttr(e,t):h.attr(e,t)},y=h._hasSingleClass,I=h._isTag,S=/^(([+-]?(?:\d+)?)?n)?([+-]?\d+)?$/,b=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,T=function(e,t){var n="0x"+t-65536;return isNaN(n)?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};d.lexer.yy={unEscape:n,unEscapeStr:function(e){return this.unEscape(e.slice(1,-1))}};var C={"nth-child":function(e,t){var n=(r=o(t)).a,r=r.b;if(0===n&&0===r)return 0;var a=0;if(s=e.parentNode)for(var s,u,l=0,c=(s=s.childNodes).length;l<c;l++)if(1===(u=s[l]).nodeType&&void 0!==(u=i(++a,n,r,u===e)))return u;return 0},"nth-last-child":function(e,t){var n=(r=o(t)).a,r=r.b;if(0===n&&0===r)return 0;var a=0;if(s=e.parentNode)for(var s,u,l=(s=s.childNodes).length-1;0<=l;l--)if(1===(u=s[l]).nodeType&&void 0!==(u=i(++a,n,r,u===e)))return u;return 0},"nth-of-type":function(e,t){var n=(r=o(t)).a,r=r.b;if(0===n&&0===r)return 0;var a=0;if(u=e.parentNode)for(var s,u=u.childNodes,l=e.tagName,c=0,d=u.length;c<d;c++)if((s=u[c]).tagName===l&&void 0!==(s=i(++a,n,r,s===e)))return s;return 0},"nth-last-of-type":function(e,t){var n=(r=o(t)).a,r=r.b;if(0===n&&0===r)return 0;var a=0;if(u=e.parentNode)for(var s,u=u.childNodes,l=e.tagName,c=u.length-1;0<=c;c--)if((s=u[c]).tagName===l&&void 0!==(s=i(++a,n,r,s===e)))return s;return 0},lang:function(e,t){var r;t=n(t.toLowerCase());do{if(r=c?e.getAttribute("xml:lang")||e.getAttribute("lang"):e.lang)return(r=r.toLowerCase())===t||0===r.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1},not:function(e,t){return!P[t.t](e,t.value)}},w={empty:function(e){for(var t,n=0,r=(e=e.childNodes).length-1;n<r;n++)if(1===(t=(t=e[n]).nodeType)||3===t||4===t||5===t)return 0;return 1},root:function(e){return e.ownerDocument&&e===e.ownerDocument.documentElement},"first-child":function(e){return C["nth-child"](e,1)},"last-child":function(e){return C["nth-last-child"](e,1)},"first-of-type":function(e){return C["nth-of-type"](e,1)},"last-of-type":function(e){return C["nth-last-of-type"](e,1)},"only-child":function(e){return w["first-child"](e)&&w["last-child"](e)},"only-of-type":function(e){return w["first-of-type"](e)&&w["last-of-type"](e)},focus:function(e){var t=e.ownerDocument;return t&&e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!(!e.type&&!(e.href||0<=e.tabIndex))},target:function(e){var t=location.hash;return t&&t.slice(1)===v(e,"id")},enabled:function(e){return!e.disabled},disabled:function(e){return e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&e.checked||"option"===t&&e.selected}},E={"~=":function(e,t){return!t||-1<t.indexOf(" ")?0:-1!==(" "+e+" ").indexOf(" "+t+" ")},"|=":function(e,t){return-1!==(" "+e).indexOf(" "+t+"-")},"^=":function(t,n){return n&&e.startsWith(t,n)},"$=":function(t,n){return n&&e.endsWith(t,n)},"*=":function(e,t){return t&&-1!==e.indexOf(t)},"=":function(e,t){return e===t}},P={tag:I,cls:y,id:function(e,t){return v(e,"id")===t},attrib:function(e,t){var n=t.ident;c||(n=n.toLowerCase());n=v(e,n);var r=t.match;if(!r&&void 0!==n)return 1;if(r){if(void 0===n)return 0;if(r=E[r])return r(n+"",t.value+"")}return 0},pseudo:function(e,t){var n,r;if(r=t.fn){if(!(n=C[r]))throw new SyntaxError("Syntax error: not support pseudo: "+r);return n(e,t.param)}if(n=t.ident){if(!w[n])throw new SyntaxError("Syntax error: not support pseudo: "+n);return w[n](e)}return 0}},x={">":{dir:"parentNode",immediate:1}," ":{dir:"parentNode"},"+":{dir:"previousSibling",immediate:1},"~":{dir:"previousSibling"}};return"sourceIndex"in f.documentElement&&(h._compareNodeOrder=function(e,t){return e.sourceIndex-t.sourceIndex}),h._matchesInternal=a,h._selectInternal=l,{parse:function(e){return d.parse(e)},select:l,matches:a}}),KISSY.add("dom/ie/create",["dom/base"],function(e,t){var n=t("dom/base");n._fixCloneAttributes=function(e,t){t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e);var r=t.nodeName.toLowerCase(),o=e.childNodes;if("object"!==r||t.childNodes.length)"input"!==r||"checkbox"!==e.type&&"radio"!==e.type?"option"===r?t.selected=e.defaultSelected:"input"!==r&&"textarea"!==r||(t.defaultValue=e.defaultValue,t.value=e.value):(e.checked&&(t.defaultChecked=t.checked=e.checked),t.value!==e.value&&(t.value=e.value));else for(r=0;r<o.length;r++)t.appendChild(o[r].cloneNode(!0));t.removeAttribute(n.__EXPANDO)};var r=n._creators,o=n._defaultCreator,i=/<tbody/i;8>e.UA.ieMode&&(r.table=function(t,r){var a=o(t,r);if(i.test(t))return a;var s=a.firstChild,u=e.makeArray(s.childNodes);return e.each(u,function(e){"tbody"===n.nodeName(e)&&!e.childNodes.length&&s.removeChild(e)}),a})}),KISSY.add("dom/ie/insertion",["dom/base"],function(e,t){var n=t("dom/base");8>e.UA.ieMode&&(n._fixInsertionChecked=function e(t){for(var r=0;r<t.length;r++){if((o=t[r]).nodeType===n.NodeType.DOCUMENT_FRAGMENT_NODE)e(o.childNodes);else if("input"===n.nodeName(o))"checkbox"!==o.type&&"radio"!==o.type||(o.defaultChecked=o.checked);else if(o.nodeType===n.NodeType.ELEMENT_NODE)for(var o=o.getElementsByTagName("input"),i=0;i<o.length;i++)e(o[i])}})}),KISSY.add("dom/ie/style",["dom/base"],function(e,t){var n=t("dom/base"),r=n._cssProps,o=e.UA,i=(i=e.Env.host.document)&&i.documentElement,a=/^(top|right|bottom|left)$/,s=n._cssHooks,u=/opacity\s*=\s*([^)]*)/,l=/alpha\([^)]*\)/i;r.float="styleFloat",s.backgroundPosition={get:function(e,t){return t?e.currentStyle.backgroundPositionX+" "+e.currentStyle.backgroundPositionY:e.style.backgroundPosition}};try{null==i.style.opacity&&(s.opacity={get:function(e,t){return u.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100+"":t?"1":""},set:function(t,n){n=parseFloat(n);var r=t.style,o=t.currentStyle,i=isNaN(n)?"":"alpha(opacity="+100*n+")",a=e.trim(o&&o.filter||r.filter||"");r.zoom=1,(1<=n||!i)&&!e.trim(a.replace(l,""))&&(r.removeAttribute("filter"),!i||o&&!o.filter)||(r.filter=l.test(a)?a.replace(l,i):a+(a?", ":"")+i)}})}catch(e){}o=8===o.ie;var c={};c.thin=o?"1px":"2px",c.medium=o?"3px":"4px",c.thick=o?"5px":"6px",e.each(["","Top","Left","Right","Bottom"],function(e){var t="border"+e+"Width",n="border"+e+"Style";s[t]={get:function(e,r){var o=r?e.currentStyle:0,i=o&&""+o[t]||void 0;return i&&0>i.indexOf("px")&&(i=c[i]&&"none"!==o[n]?c[i]:0),i}}}),n._getComputedStyle=function(e,t){t=r[t]||t;var o=e.currentStyle&&e.currentStyle[t];if(n._RE_NUM_NO_PX.test(o)&&!a.test(t)){var i=e.style,s=i.left,u=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,i.left="fontSize"===t?"1em":o||0,o=i.pixelLeft+"px",i.left=s,e.runtimeStyle.left=u}return""===o?"auto":o}}),KISSY.add("dom/ie/traversal",["dom/base"],function(e,t){var n=t("dom/base");n._contains=function(e,t){return e.nodeType===n.NodeType.DOCUMENT_NODE&&(e=e.documentElement),e===(t=t.parentNode)||!(!t||t.nodeType!==n.NodeType.ELEMENT_NODE)&&(e.contains&&e.contains(t))};var r,o=document.createElement("div");o.appendChild(document.createComment("")),r=o.getElementsByTagName("*").length?function(e,t){var n=t.getElementsByTagName(e),r="*"===e;if(r||"number"!=typeof n.length){for(var o,i=[],a=0;o=n[a++];)(!r||1===o.nodeType)&&i.push(o);return i}return n}:function(e,t){return t.getElementsByTagName(e)},n._getElementsByTagName=r;var i=n._getSimpleAttr;n._getElementById=function(e,t){var n=t.getElementById(e);if(n&&i(n,"id")!==e)for(var o=r("*",t),a=0,s=o.length;a<s;a++)if(i(o[a],"id")===e)return o[a];return n}}),KISSY.add("dom/ie/transform",["dom/base"],function(e,t){function n(e){return[[e[0],e[2],e[4]],[e[1],e[3],e[5]],[0,0,1]]}function r(e,t){var n;if(2<arguments.length){var o=e;for(n=1;n<arguments.length;n++)o=r(o,arguments[n]);return o}o=[];var i=e.length,a=t.length,s=t[0].length;for(n=0;n<i;n++)for(var u=0;u<s;u++){for(var l=0,c=0;c<a;c++)l+=e[n][c]*t[c][u];var d=n,h=u;(c=o)[d]||(c[d]=[]),c[d][h]=l}return o}function o(e){return-1<e.indexOf("deg")?parseInt(e,10)*(2*Math.PI/360):parseFloat(e)}var i=/progid:DXImageTransform.Microsoft.Matrix\(([^)]*)\)/;t("dom/base")._cssHooks.transform={get:function(e,t){if(!(n=e[t?"currentStyle":"style"])||!i.test(n.filter))return t?"none":"";var n,r=0,o=0,a=(n=RegExp.$1.split(","))[4]&&n[4].split("="),s=n[5]&&n[5].split("=");return a&&"dx"===a[0].toLowerCase()&&(r=parseFloat(a[1])),s&&"dy"===s[0].toLowerCase()&&(o=parseFloat(s[1])),"matrix("+(n=[n[0].split("=")[1],n[2].split("=")[1],n[1].split("=")[1],n[3].split("=")[1],r,o]).join(",")+")"},set:function(t,a){var s,u,l=t.style,c=t.currentStyle,d={width:t.clientWidth,height:t.clientHeight};u=d.width/2;var h=d.height/2;1===(v=((v=t.style.transformOrigin)||"50% 50%").split(/\s+/)).length&&(v[1]=v[0]);for(var f=0;f<v.length;f++){var g=parseFloat(v[f]);v[f]=e.endsWith(v[f],"%")?g*d[f?"height":"width"]/100:g}if(d=v,l.zoom=1,a){s=a.split(")");for(var p,m,_,v=e.trim,y=(f=-1,g=s.length-1,n([1,0,0,1,0,0]));++f<g;){switch(m=v((p=s[f].split("("))[0]),p=p[1],_=[1,0,0,1,0,0],m){case"translateX":_[4]=parseInt(p,10);break;case"translateY":_[5]=parseInt(p,10);break;case"translate":p=p.split(","),_[4]=parseInt(p[0],10),_[5]=parseInt(p[1]||0,10);break;case"rotate":p=o(p),_[0]=Math.cos(p),_[1]=Math.sin(p),_[2]=-Math.sin(p),_[3]=Math.cos(p);break;case"scaleX":_[0]=+p;break;case"scaleY":_[3]=+p;break;case"scale":p=p.split(","),_[0]=+p[0],_[3]=1<p.length?+p[1]:+p[0];break;case"skewX":_[2]=Math.tan(o(p));break;case"skewY":_[1]=Math.tan(o(p));break;case"skew":p=p.split(","),_[2]=Math.tan(o(p[0])),1<p.length&&(_[1]=Math.tan(o(p[1])));break;case"matrix":p=p.split(","),_[0]=+p[0],_[1]=+p[1],_[2]=+p[2],_[3]=+p[3],_[4]=parseInt(p[4],10),_[5]=parseInt(p[5],10)}y=r(y,n(_))}a=y,(s=r([[1,0,s=d[0]],[0,1,d=d[1]],[0,0,1]],a,[[1,0,-s],[0,1,-d],[0,0,1]],[[u],[h],[1]])).x=s[0][0],s.y=s[1][0],u=["progid:DXImageTransform.Microsoft.Matrix(M11="+a[0][0],"M12="+a[0][1],"M21="+a[1][0],"M22="+a[1][1],"Dx="+a[0][2],"Dy="+a[1][2],'SizingMethod="auto expand"'].join()+")"}else u="";h=c&&c.filter||l.filter||"",(u||e.trim(h.replace(i,""))||(l.removeAttribute("filter"),u&&(!c||c.filter)))&&(l.filter=i.test(h)?h.replace(i,u):h+(h?", ":"")+u,u?(c=t.offsetHeight/2,l.marginLeft=s.x-t.offsetWidth/2+"px",l.marginTop=s.y-c+"px"):l.marginLeft=l.marginTop=0)}}}),KISSY.add("dom/ie/input-selection",["dom/base"],function(e,t){function n(e,t){var n=0,o=0,a=e.ownerDocument.selection.createRange(),s=r(e);return s.inRange(a)&&(s.setEndPoint("EndToStart",a),n=i(e,s).length,t&&(o=n+i(e,a).length)),[n,o]}function r(e){if("textarea"===e.type){var t=e.document.body.createTextRange();return t.moveToElementText(e),t}return e.createTextRange()}function o(e,t,n){var r=Math.min(t,n),o=Math.max(t,n);return r===o?0:"textarea"===e.type?(e=e.value.substring(r,o).replace(/\r\n/g,"\n").length,t>n&&(e=-e),e):n-t}function i(e,t){if("textarea"===e.type){var n=t.text,r=t.duplicate();return 0===r.compareEndPoints("StartToEnd",r)?n:(r.moveEnd("character",-1),r.text===n&&(n+="\r\n"),n)}return t.text}var a=t("dom/base")._propHooks;a.selectionStart={set:function(e,t){var i=e.ownerDocument.selection.createRange();if(r(e).inRange(i)){var a=n(e,1)[1],s=o(e,t,a);i.collapse(!1),i.moveStart("character",-s),t>a&&i.collapse(!0),i.select()}},get:function(e){return n(e)[0]}},a.selectionEnd={set:function(e,t){var i=e.ownerDocument.selection.createRange();if(r(e).inRange(i)){var a=n(e)[0],s=o(e,a,t);i.collapse(!0),i.moveEnd("character",s),a>t&&i.collapse(!1),i.select()}},get:function(e){return n(e,1)[1]}}}),KISSY.add("dom/ie/attr",["dom/base"],function(e,t){var n=t("dom/base"),r=n._attrHooks,o=n._attrNodeHook,i=n.NodeType,a=n._valHooks,s=n._propFix;return 8>e.UA.ieMode&&(r.style.set=function(e,t){e.style.cssText=t},e.mix(o,{get:function(e,t){var n=e.getAttributeNode(t);return n&&(n.specified||n.nodeValue)?n.nodeValue:void 0},set:function(e,t,n){var r,o=e.getAttributeNode(n);if(o)o.nodeValue=t;else try{(r=e.ownerDocument.createAttribute(n)).value=t,e.setAttributeNode(r)}catch(r){return e.setAttribute(n,t,0)}}}),e.mix(n._attrFix,s),r.tabIndex=r.tabindex,e.each("href,src,width,height,colSpan,rowSpan".split(","),function(e){r[e]={get:function(t){return null===(t=t.getAttribute(e,2))?void 0:t}}}),a.button=r.value=o,r.placeholder={get:function(e,t){return e[t]||o.get(e,t)}},a.option={get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}}),(r.href=r.href||{}).set=function(e,t,n){for(var r,o=e.childNodes,a=(s=o.length)>0,s=s-1;s>=0;s--)o[s].nodeType!==i.TEXT_NODE&&(a=0);a&&((r=e.ownerDocument.createElement("b")).style.display="none",e.appendChild(r)),e.setAttribute(n,""+t),r&&e.removeChild(r)},n._getText=function e(t){var r="",o=t.nodeType;if(o===n.NodeType.ELEMENT_NODE)for(t=t.firstChild;t;t=t.nextSibling)r+=e(t);else o!==i.TEXT_NODE&&o!==i.CDATA_SECTION_NODE||(r+=t.nodeValue);return r},n}),KISSY.add("dom/ie","./ie/create,./ie/insertion,./ie/style,./ie/traversal,./ie/transform,./ie/input-selection,./ie/attr".split(","),function(e,t){return t("./ie/create"),t("./ie/insertion"),t("./ie/style"),t("./ie/traversal"),t("./ie/transform"),t("./ie/input-selection"),t("./ie/attr")}),KISSY.add("event/dom/shake",["event/dom/base"],function(e,t){function n(e){e=(a=e.accelerationIncludingGravity).x;var t,n=a.y,a=a.z;void 0!==r&&((t=d(h(e-r),h(n-o),h(a-i)))>u&&g(),t>l&&(c=1)),r=e,o=n,i=a}var r,o,i,a=t("event/dom/base"),s=a.Special,u=5,l=20,c=0,d=Math.max,h=Math.abs,f=e.Env.host,g=e.buffer(function(){c&&(a.fireHandler(f,"shake",{accelerationIncludingGravity:{x:r,y:o,z:i}}),r=void 0,c=0)},250);s.shake={setup:function(){this===f&&f.addEventListener("devicemotion",n,!1)},tearDown:function(){this===f&&(g.stop(),r=void 0,c=0,f.removeEventListener("devicemotion",n,!1))}}}),KISSY.add("event/dom/ie/change",["event/dom/base","dom"],function(e,t){function n(e){return"checkbox"===(e=e.type)||"radio"===e}function r(e){"checked"===e.originalEvent.propertyName&&(this.__changed=1)}function o(e){this.__changed&&(this.__changed=0,s.fire(this,"change",e))}function i(e){e=e.target,l.test(e.nodeName)&&!e.__changeHandler&&(e.__changeHandler=1,s.on(e,"change",{fn:a,last:1}))}function a(e){var t;e.isPropagationStopped()||n(this)||(t=this.parentNode)&&s.fire(t,"change",e)}var s=t("event/dom/base"),u=t("dom"),l=/^(?:textarea|input|select)$/i;s.Special.change={setup:function(){if(l.test(this.nodeName)){if(!n(this))return!1;s.on(this,"propertychange",r),s.on(this,"click",o)}else s.on(this,"beforeactivate",i)},tearDown:function(){if(l.test(this.nodeName)){if(!n(this))return!1;s.remove(this,"propertychange",r),s.remove(this,"click",o)}else s.remove(this,"beforeactivate",i),e.each(u.query("textarea,input,select",this),function(e){e.__changeHandler&&(e.__changeHandler=0,s.remove(e,"change",{fn:a,last:1}))})}}}),KISSY.add("event/dom/ie/submit",["event/dom/base","dom"],function(e,t){function n(e){e=e.target;var t=a(e);(e="input"===t||"button"===t?e.form:null)&&!e.__submitFix&&(e.__submitFix=1,o.on(e,"submit",{fn:r,last:1}))}function r(e){this.parentNode&&!e.isPropagationStopped()&&!e.synthetic&&o.fire(this.parentNode,"submit",e)}var o=t("event/dom/base"),i=t("dom"),a=i.nodeName;o.Special.submit={setup:function(){if("form"===a(this))return!1;o.on(this,"click keypress",n)},tearDown:function(){if("form"===a(this))return!1;o.remove(this,"click keypress",n),e.each(i.query("form",this),function(e){e.__submitFix&&(e.__submitFix=0,o.remove(e,"submit",{fn:r,last:1}))})}}}),KISSY.add("event/dom/ie",["./ie/change","./ie/submit"],function(e,t){t("./ie/change"),t("./ie/submit")}),KISSY.add("event/dom/hashchange",["event/dom/base","dom"],function(e,t){var n=t("event/dom/base"),r=t("dom"),o=e.UA,i=n.Special,a=e.Env.host,s=a.document,u=o.ieMode,l="__replace_history_"+e.now();o=u||o.ie;n.REPLACE_HISTORY=l;var c,d,h,f="<html><head><title>"+(s&&s.title||"")+" - {hash}</title>{head}</head><body>{hash}</body></html>",g=function(){return"#"+new e.Uri(location.href).getFragment()},p=function(){var t,n=g();(t=e.endsWith(n,l))&&(n=n.slice(0,-l.length),location.hash=n),n!==d&&(d=n,m(n,t)),c=setTimeout(p,50)},m=o&&8>o?function(t,n){var o=e.substitute(f,{hash:e.escapeHtml(t),head:r.isCustomDomain()?'<script>document.domain = "'+s.domain+'";<\/script>':""}),i=h.contentWindow.document;try{n?i.open("text/html","replace"):i.open(),i.write(o),i.close()}catch(e){}}:function(){n.fireHandler(a,"hashchange")},_=function(){c||p()},v=function(){c&&clearTimeout(c),c=0};o&&8>o&&(_=function(){if(!h){var t=r.getEmptyIframeSrc();h=r.create("<iframe "+(t?'src="'+t+'"':"")+' style="display: none" height="0" width="0" tabindex="-1" title="empty"/>'),r.prepend(h,s.documentElement),n.add(h,"load",function(){n.remove(h,"load"),m(g()),n.add(h,"load",o),p()}),s.onpropertychange=function(){try{"title"===event.propertyName&&(h.contentWindow.document.title=s.title+" - "+g())}catch(e){}};var o=function(){var t=e.trim(h.contentWindow.document.body.innerText);t!==g()&&(d=location.hash=t),n.fireHandler(a,"hashchange")}}},v=function(){c&&clearTimeout(c),c=0,n.detach(h),r.remove(h),h=0}),i.hashchange={setup:function(){this===a&&(d=g(),_())},tearDown:function(){this===a&&v()}}}),KISSY.add("event/dom/focusin",["event/dom/base"],function(e,t){var n=t("event/dom/base"),r=n.Special;return e.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(t){function o(e){return n.fire(e.target,t.name)}var i=e.guid("attaches_"+e.now()+"_");r[t.name]={setup:function(){var e=this.ownerDocument||this;i in e||(e[i]=0),e[i]+=1,1===e[i]&&e.addEventListener(t.fix,o,!0)},tearDown:function(){var e=this.ownerDocument||this;e[i]-=1,0===e[i]&&e.removeEventListener(t.fix,o,!0)}}}),n}),KISSY.add("event/dom/touch/handle-map",[],function(){return{}}),KISSY.add("event/dom/touch/single-touch",[],function(e){function t(){}return t.prototype={constructor:t,requiredTouchCount:1,onTouchStart:function(e){if(e.touches.length!==this.requiredTouchCount)return!1;e=this.lastTouches=e.touches,this.lastXY={pageX:e[0].pageX,pageY:e[0].pageY}},onTouchMove:e.noop,onTouchEnd:e.noop},t}),KISSY.add("event/dom/touch/tap",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(e){e.preventDefault()}function r(){r.superclass.constructor.apply(this,arguments)}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./single-touch"),s=i.Object;return e.extend(r,a,{onTouchMove:function(e){var t=this.lastXY;if(!(e=e.changedTouches[0])||5<Math.abs(e.pageX-t.pageX)||5<Math.abs(e.pageY-t.pageY))return!1},onTouchEnd:function(t){var r=t.changedTouches[0],o=t.target,a=new s({type:"tap",target:o,currentTarget:o});e.mix(a,{pageX:r.pageX,pageY:r.pageY,originalEvent:t.originalEvent,which:1,touch:r}),i.fire(o,"tap",a),a.isDefaultPrevented()&&i.on(o,"click",{fn:n,once:1})}}),o.tap={handle:new r},r}),KISSY.add("event/dom/touch/swipe",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(e,t,n){var r=t.changedTouches[0],o=r.pageX-e.startX,a=r.pageY-e.startY,c=Math.abs(o),d=Math.abs(a);if(n){if(e.isVertical&&e.isHorizontal){if(5>Math.max(c,d))return;d>c?e.isHorizontal=0:e.isVertical=0}}else e.isVertical&&d<l&&(e.isVertical=0),e.isHorizontal&&c<l&&(e.isHorizontal=0);if(e.isHorizontal)o=0>o?"left":"right";else{if(!e.isVertical)return!1;o=0>a?"up":"down",c=d}i.fire(t.target,n?u:s,{originalEvent:t.originalEvent,pageX:r.pageX,pageY:r.pageY,which:1,touch:r,direction:o,distance:c,duration:(t.timeStamp-e.startTime)/1e3})}function r(){}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./single-touch"),s="swipe",u="swiping",l=50;return e.extend(r,a,{onTouchStart:function(e){if(!1===r.superclass.onTouchStart.apply(this,arguments))return!1;var t=e.touches[0];this.startTime=e.timeStamp,this.isVertical=this.isHorizontal=1,this.startX=t.pageX,this.startY=t.pageY,-1!==e.type.indexOf("mouse")&&e.preventDefault()},onTouchMove:function(e){var t=(r=e.changedTouches[0]).pageY-this.startY,r=Math.abs(r.pageX-this.startX);t=Math.abs(t);return!(1e3<e.timeStamp-this.startTime)&&(this.isVertical&&35<r&&(this.isVertical=0),this.isHorizontal&&35<t&&(this.isHorizontal=0),n(this,e,1))},onTouchEnd:function(e){return!1!==this.onTouchMove(e)&&n(this,e,0)}}),o[s]=o[u]={handle:new r},r}),KISSY.add("event/dom/touch/double-tap",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(){}var r=t("./handle-map"),o=t("event/dom/base"),i=t("./single-touch");return e.extend(n,i,{onTouchStart:function(e){if(!1===n.superclass.onTouchStart.apply(this,arguments))return!1;this.startTime=e.timeStamp,this.singleTapTimer&&(clearTimeout(this.singleTapTimer),this.singleTapTimer=0)},onTouchMove:function(){return!1},onTouchEnd:function(e){var t=this.lastEndTime,n=e.timeStamp,r=e.target,i=e.changedTouches[0],a=n-this.startTime;if(this.lastEndTime=n,t&&300>(a=n-t))return this.lastEndTime=0,void o.fire(r,"doubleTap",{touch:i,duration:a/1e3});300<(a=n-this.startTime)?o.fire(r,"singleTap",{touch:i,pageX:i.pageX,which:1,pageY:i.pageY,duration:a/1e3}):this.singleTapTimer=setTimeout(function(){o.fire(r,"singleTap",{touch:i,pageX:i.pageX,which:1,pageY:i.pageY,duration:a/1e3})},300)}}),r.singleTap=r.doubleTap={handle:new n},n}),KISSY.add("event/dom/touch/multi-touch",["dom"],function(e,t){function n(){}var r=t("dom");return n.prototype={constructor:n,requiredTouchCount:2,onTouchStart:function(e){var t=this.requiredTouchCount,n=e.touches.length;n===t?this.start():n>t&&this.end(e)},onTouchEnd:function(e){this.end(e)},start:function(){this.isTracking||(this.isTracking=!0,this.isStarted=!1)},fireEnd:e.noop,getCommonTarget:function(e){var t;if((e=(t=e.touches)[0].target)===(t=t[1].target)||r.contains(e,t))return e;for(;;){if(r.contains(t,e))return t;t=t.parentNode}},end:function(e){this.isTracking&&(this.isTracking=!1,this.isStarted&&(this.isStarted=!1,this.fireEnd(e)))}},n}),KISSY.add("event/dom/touch/pinch",["./handle-map","event/dom/base","./multi-touch"],function(e,t){function n(){}function r(e){2===e.touches.length&&e.preventDefault()}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./multi-touch");return e.extend(n,a,{onTouchMove:function(t){if(this.isTracking){var n=t.touches;if(0<n[0].pageX&&0<n[0].pageY&&0<n[1].pageX&&0<n[1].pageY){var r,o=n[0],a=n[1];r=o.pageX-a.pageX,o=o.pageY-a.pageY,r=Math.sqrt(r*r+o*o),this.lastTouches=n,this.isStarted?i.fire(this.target,"pinch",e.mix(t,{distance:r,scale:r/this.startDistance})):(this.isStarted=!0,this.startDistance=r,n=this.target=this.getCommonTarget(t),i.fire(n,"pinchStart",e.mix(t,{distance:r,scale:1})))}}},fireEnd:function(t){i.fire(this.target,"pinchEnd",e.mix(t,{touches:this.lastTouches}))}}),a=new n,o.pinchStart=o.pinchEnd={handle:a},o.pinch={handle:a,setup:function(){i.on(this,"touchmove",r)},tearDown:function(){i.detach(this,"touchmove",r)}},n}),KISSY.add("event/dom/touch/tap-hold",["./handle-map","event/dom/base","./single-touch"],function(e,t){function n(){}var r=t("./handle-map"),o=t("event/dom/base"),i=t("./single-touch");return e.extend(n,i,{onTouchStart:function(t){if(!1===n.superclass.onTouchStart.call(this,t))return!1;this.timer=setTimeout(function(){var n=t.touches[0];o.fire(t.target,"tapHold",{touch:n,pageX:n.pageX,pageY:n.pageY,which:1,duration:(e.now()-t.timeStamp)/1e3})},1e3)},onTouchMove:function(){return clearTimeout(this.timer),!1},onTouchEnd:function(){clearTimeout(this.timer)}}),r.tapHold={handle:new n},n}),KISSY.add("event/dom/touch/rotate",["./handle-map","event/dom/base","./multi-touch"],function(e,t){function n(){}function r(e){2===e.touches.length&&e.preventDefault()}var o=t("./handle-map"),i=t("event/dom/base"),a=t("./multi-touch"),s=180/Math.PI;return e.extend(n,a,{onTouchMove:function(t){if(this.isTracking){var n=t.touches,r=n[0],o=n[1],a=this.lastAngle;r=Math.atan2(o.pageY-r.pageY,o.pageX-r.pageX)*s;if(void 0!==a){o=Math.abs(r-a);var u=(r+360)%360,l=(r-360)%360;Math.abs(u-a)<o?r=u:Math.abs(l-a)<o&&(r=l)}this.lastTouches=n,this.lastAngle=r,this.isStarted?i.fire(this.target,"rotate",e.mix(t,{angle:r,rotation:r-this.startAngle})):(this.isStarted=!0,this.startAngle=r,this.target=this.getCommonTarget(t),i.fire(this.target,"rotateStart",e.mix(t,{angle:r,rotation:0})))}},end:function(){this.lastAngle=void 0,n.superclass.end.apply(this,arguments)},fireEnd:function(t){i.fire(this.target,"rotateEnd",e.mix(t,{touches:this.lastTouches}))}}),a=new n,o.rotateEnd=o.rotateStart={handle:a},o.rotate={handle:a,setup:function(){i.on(this,"touchmove",r)},tearDown:function(){i.detach(this,"touchmove",r)}},n}),KISSY.add("event/dom/touch/handle","dom,./handle-map,event/dom/base,./tap,./swipe,./double-tap,./pinch,./tap-hold,./rotate".split(","),function(e,t){function n(t){return e.startsWith(t,"touch")}function r(t){return e.startsWith(t,"mouse")}function o(t){return e.startsWith(t,"MSPointer")||e.startsWith(t,"pointer")}function i(e){this.doc=e,this.eventHandle={},this.init(),this.touches=[],this.inTouch=0}var a=t("dom"),s=t("./handle-map"),u=t("event/dom/base");t("./tap"),t("./swipe"),t("./double-tap"),t("./pinch"),t("./tap-hold"),t("./rotate");var l,c,d,h=e.guid("touch-handle"),f=e.Features;return f.isTouchEventSupported()?e.UA.ios?(d="touchend touchcancel",l="touchstart",c="touchmove"):(d="touchend touchcancel mouseup",l="touchstart mousedown",c="touchmove mousemove"):f.isPointerSupported()?(l="pointerdown",c="pointermove",d="pointerup pointercancel"):f.isMsPointerSupported()?(l="MSPointerDown",c="MSPointerMove",d="MSPointerUp MSPointerCancel"):(l="mousedown",c="mousemove",d="mouseup"),i.prototype={constructor:i,lastTouches:[],firstTouch:null,init:function(){var e=this.doc;u.on(e,l,this.onTouchStart,this),o(c)||u.on(e,c,this.onTouchMove,this),u.on(e,d,this.onTouchEnd,this)},addTouch:function(e){e.identifier=e.pointerId,this.touches.push(e)},removeTouch:function(e){for(var t=0,n=e.pointerId,r=this.touches,o=r.length;t<o;t++)if((e=r[t]).pointerId===n){r.splice(t,1);break}},updateTouch:function(e){for(var t=0,n=e.pointerId,r=this.touches,o=r.length;t<o;t++)r[t].pointerId===n&&(r[t]=e)},isPrimaryTouch:function(e){return this.firstTouch===e.identifier},setPrimaryTouch:function(e){null===this.firstTouch&&(this.firstTouch=e.identifier)},removePrimaryTouch:function(e){this.isPrimaryTouch(e)&&(this.firstTouch=null)},dupMouse:function(e){var t=this.lastTouches;e=e.changedTouches[0];if(this.isPrimaryTouch(e)){var n={x:e.clientX,y:e.clientY};t.push(n),setTimeout(function(){var e=t.indexOf(n);e>-1&&t.splice(e,1)},2500)}},isEventSimulatedFromTouch:function(e){for(var t,n=this.lastTouches,r=e.clientX,o=(e=e.clientY,0),i=n.length;o<i&&(t=n[o]);o++){var a=Math.abs(r-t.x),s=Math.abs(e-t.y);if(a<=25&&s<=25)return!0}return 0},normalize:function(e){var t,r=e.type;return n(r)?(1===(t="touchend"===r||"touchcancel"===r?e.changedTouches:e.touches).length&&(e.which=1,e.pageX=t[0].pageX,e.pageY=t[0].pageY),e):(t=this.touches,r=!r.match(/(up|cancel)$/i),e.touches=r?t:[],e.targetTouches=r?t:[],e.changedTouches=t,e)},onTouchStart:function(e){var t,i;i=e.type;var a=this.eventHandle;if(n(i))this.setPrimaryTouch(e.changedTouches[0]),this.dupMouse(e);else if(r(i)){if(this.isEventSimulatedFromTouch(e))return;this.touches=[e.originalEvent]}else{if(!o(i))throw Error("unrecognized touch event: "+e.type);this.addTouch(e.originalEvent),1===this.touches.length&&u.on(this.doc,c,this.onTouchMove,this)}for(t in a)(i=a[t].handle).isActive=1;this.callEventHandle("onTouchStart",e)},onTouchMove:function(e){var t=e.type;if(r(t)){if(this.isEventSimulatedFromTouch(t))return;this.touches=[e.originalEvent]}else if(o(t))this.updateTouch(e.originalEvent);else if(!n(t))throw Error("unrecognized touch event: "+e.type);this.callEventHandle("onTouchMove",e)},onTouchEnd:function(t){var i=this,a=t.type;r(a)&&i.isEventSimulatedFromTouch(t)||(i.callEventHandle("onTouchEnd",t),n(a)?(i.dupMouse(t),e.makeArray(t.changedTouches).forEach(function(e){i.removePrimaryTouch(e)})):r(a)?i.touches=[]:o(a)&&(i.removeTouch(t.originalEvent),i.touches.length||u.detach(i.doc,c,i.onTouchMove,i)))},callEventHandle:function(e,t){var n,r,o=this.eventHandle;if((t=this.normalize(t)).changedTouches.length){for(n in o)(r=o[n].handle).processed||(r.processed=1,r.isActive&&r[e]&&!1===r[e](t)&&(r.isActive=0));for(n in o)(r=o[n].handle).processed=0}},addEventHandle:function(e){var t=this.eventHandle,n=s[e].handle;t[e]?t[e].count++:t[e]={count:1,handle:n}},removeEventHandle:function(e){var t=this.eventHandle;t[e]&&(t[e].count--,t[e].count||delete t[e])},destroy:function(){var e=this.doc;u.detach(e,l,this.onTouchStart,this),u.detach(e,c,this.onTouchMove,this),u.detach(e,d,this.onTouchEnd,this)}},{addDocumentHandle:function(e,t){var n=a.getDocument(e),r=a.data(n,h);r||a.data(n,h,r=new i(n)),t&&r.addEventHandle(t)},removeDocumentHandle:function(t,n){var r=a.getDocument(t),o=a.data(r,h);o&&(n&&o.removeEventHandle(n),e.isEmptyObject(o.eventHandle)&&(o.destroy(),a.removeData(r,h)))}}}),KISSY.add("event/dom/touch",["event/dom/base","./touch/handle-map","./touch/handle"],function(e,t){function n(e){u.addDocumentHandle(this,e),s[e].setup.apply(this,arguments)}function r(e){u.removeDocumentHandle(this,e),s[e].tearDown.apply(this,arguments)}function o(e){u.addDocumentHandle(this,e)}function i(e){u.removeDocumentHandle(this,e)}var a=t("event/dom/base"),s=t("./touch/handle-map"),u=t("./touch/handle"),l=(p=a.Gesture).start="KSPointerDown",c=p.move="KSPointerMove",d=p.end="KSPointerUp";p.tap="tap",p.doubleTap="doubleTap",s[l]={handle:{isActive:1,onTouchStart:function(e){a.fire(e.target,l,e)}}},s[c]={handle:{isActive:1,onTouchMove:function(e){a.fire(e.target,c,e)}}},s[d]={handle:{isActive:1,onTouchEnd:function(e){a.fire(e.target,d,e)}}};var h,f,g,p=a.Special;for(f in s)h={},g=s[f],h.setup=g.setup?n:o,h.tearDown=g.tearDown?r:i,g.add&&(h.add=g.add),g.remove&&(h.remove=g.remove),p[f]=h}),KISSY.add("kg/bio/1.2/type/ajax",["base","json","io"],function(e,t){var n="[bio-ajax]: ",r=t("base"),o=t("json"),i=t("io"),a=r.extend({constructor:function(e){a.superclass.constructor.call(this,e),this._setWithCredentials()},uploadToServer:function(e){return this.get("blockSize")>0&&e.size>0?this._chunkedUpload(e):this._fullUpload(e)},_fullUpload:function(t){var n=this,r=n.get("ajaxConfig"),o=!0;sFun=function(e){var t="";e&&(e&&KISSY.isArray(e)&&e.length>1?t=e[0]:KISSY.isString(e)&&(t=e)),t=n._processResponse(t),n.fire(a.event.SUCCESS,t)},fFun=function(e,r,i){var a,s;o=!1,e&&KISSY.isArray(e)&&e.length>2?(a=e[1],s=e[2]):(a=r,s=i),n._errorHandler(s,a,t)},n._setFormData(),t.size>0&&n._addFileData(t),e.mix(r,{data:n.get("formData"),url:n.get("action"),beforeSend:function(e,t,r){e.getNativeXhr().upload.addEventListener("progress",function(e){n.fire(a.event.PROGRESS,{loaded:e.loaded,total:e.total})},!1)}}),r.async||e.mix(r,{success:sFun,error:fFun});var s=new i(r);return r.async?(s.then(sFun,fFun),n.set("ajax",s),!0):(n.set("ajax",!1),o)},_chunkedUpload:function(t){var n=this,r=n.get("ajaxConfig"),o=function(e){var t="";e&&(e&&KISSY.isArray(e)&&e.length>1?t=e[0]:KISSY.isString(e)&&(t=e)),t=n._processResponse(t),n.fire(a.event.SUCCESS,t)},s=function(e,r,o){var i,a;e&&KISSY.isArray(e)&&e.length>2?(i=e[1],a=e[2]):(i=r,a=o),n._errorHandler(a,i,t)};e.mix(r,{url:n.get("action")});var u=t.size,l=0,c=n.get("blockSize")||u,d=t.slice||t.webkitSlice||t.mozSlice;!function h(f){var g=d.call(t,l,l+c,t.type),p=g.size;n._setContentRange(l,p,u),n._setFormData(),f&&n.set("data",[]),g.name=t.name,n._addFileData(g),e.mix(r,{data:n.get("formData")});var m=new i(r);m.then(function(e){l=n._getUploadedBytes(m)||l+p,n.fire(a.event.PROGRESS,{loaded:l,total:u}),l<u?h(!1):o(e)},s)}(!0)},abort:function(){var t=this.get("ajax");return e.isObject(t)?(t.abort(),this.set("ajax",!1),this):(e.log(n+"abort(), the value of io invalid!"),this)},_setWithCredentials:function(){this.get("CORS");var t=this.get("ajaxConfig");return e.mix(t,{xhrFields:{withCredentials:!1}}),t},_setFormData:function(){var t=this.get("data"),r=new FormData;try{e.each(t,function(e,t){r.append(t,e)}),this.set("formData",r)}catch(t){e.log(n+"something error when reset FormData.")}},setRequestHeader:function(e,t){var n=this.get("ajaxConfig");return n.headers[e]=t,this.set("ajaxConfig",n),t},_addFileData:function(t){if(!e.isObject(t))return e.log(n+"_addFileData(), file parameter invalid!"),!1;var r=this.get("formData"),o=t.name,i=t.remoteFilename;return i||(i="RemoteFile"),r.append(i,t,o),this.set("formData",r),r},_errorHandler:function(e,t,n){var r=a.status.ERROR,o={status:r,msg:t,response:!1};e&&(o.httpStatus=e.status,o.response=e.responseText),this.fire(r,o)},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),r=n&&n.length>1&&parseInt(n[1],10);return r&&r+1},_setContentRange:function(e,t,n){var r="bytes "+e+"-"+(e+t-1)+"/"+n;return this.get("ajaxConfig").headers["Content-Range"]=r,r},_processResponse:function(t){var n,r,i,s=!1,u=a.status.SUCCESS,l=a.event.ERROR;if(e.log("Response from server: "+t),e.isUndefined(t)||""===t)n={status:u,msg:!1,json:!1,response:""};else if(e.isString(t)){try{for(r=0;r<t.length&&!(r>10);r++){if("{"==(i=t[r])){s=!0;break}if(" "!=i&&"\r"!=i&&"\n"!=i&&"\t"!=i)break}if(s){var c=o.parse(t);n=1==c.status?{status:u,msg:!1,json:c,response:t}:{status:l,msg:!1,json:c,response:t}}}catch(t){s=!1,e.log(t)}if(!s){var d=new String(t);n=""==(d=d.replace(/( |\t|\r|\n)/g,""))?{status:u,msg:!1,json:!1,response:t}:{status:l,msg:!1,json:!1,response:t}}}else n={status:u,msg:!1,json:!1,response:""};return n}},{ATTRS:{action:{value:""},data:{value:{}},bChunkedSendData:{value:!0},blockSize:{value:0},ajaxConfig:{value:{type:"post",processData:!1,cache:!1,dataType:"text",async:!0,contentType:!1,headers:{"X-Requested-With":!1}}},ajax:{value:""},formData:{value:""},CORS:{value:!1}}});return e.mix(a,{event:{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"},status:{SUCCESS:"success",ERROR:"error"}}),a}),KISSY.add("kg/bio/1.2/base",["base","./type/ajax"],function(e,t){var n=t("base"),r=t("./type/ajax"),o=e.Env.host.FormData;try{o&&!0}catch(e){}if(!o)return e.log("[bio]: the browser does not support ajax."),{};var i=n.extend({constructor:function(e){i.superclass.constructor.call(this,e),this._init()},upload:function(t){if(!e.isObject(t))return e.log('[bio]: upload() the parameter "file" invalid!'),!1;var n=this.get("uploadType");return t.size?(t.name||(t.name=t.fileName||""),t.id||(t.id=e.guid("file-")),t.size&&(t.textSize=this._convertByteSize(t.size))):t.size=0,n.uploadToServer(t)},abort:function(){return this.get("uploadType").abort(),!0},setRequestHeader:function(e,t){this.get("uploadType").setRequestHeader(e,t)},_convertByteSize:function(e){var t=-1;do{e/=1024,t++}while(e>99&&t<4);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]},_init:function(){var e=this,t={action:e.get("action"),data:e.get("data"),CORS:e.get("CORS")},n=new r(t),o=n.get("ajaxConfig");return o&&(o.dataType=e.get("dataType"),o.async=e.get("async")),n.on(r.event.SUCCESS,e._uploadCompleteHandler,e),n.on(r.event.ERROR,e._uploadCompleteHandler,e),n.on(r.event.PROGRESS,e._uploadProgressHandler,e),e.set("uploadType",n),n},_uploadProgressHandler:function(e){this.fire(i.event.PROGRESS,e)},_uploadCompleteHandler:function(t){var n=t.status,r=t.msg,o=this.get("file");e.mix(t,{file:o}),"success"===n?this.fire(i.event.SUCCESS,t):(!1===r||("abort"===r?e.mix(t,{canceled:!0}):"timeout"===r&&e.mix(t,{timeout:!0})),this.fire(i.event.ERROR,t))}},{ATTRS:{action:{value:""},timeout:{value:0},CORS:{value:!1},async:{value:!0},dataType:{value:"text"},fileStatus:{value:""},uploadType:{value:{}},data:{value:{}}}},"bio");return e.mix(i,{event:{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}}),i}),KISSY.add("kg/bio/1.2/index",function(e,t){return t},{requires:["./base"]});var EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},EnumDWT_Cap={CAP_NONE:0,CAP_XFERCOUNT:1,ICAP_COMPRESSION:256,ICAP_PIXELTYPE:257,ICAP_UNITS:258,ICAP_XFERMECH:259,CAP_AUTHOR:4096,CAP_CAPTION:4097,CAP_FEEDERENABLED:4098,CAP_FEEDERLOADED:4099,CAP_TIMEDATE:4100,CAP_SUPPORTEDCAPS:4101,CAP_EXTENDEDCAPS:4102,CAP_AUTOFEED:4103,CAP_CLEARPAGE:4104,CAP_FEEDPAGE:4105,CAP_REWINDPAGE:4106,CAP_INDICATORS:4107,CAP_SUPPORTEDCAPSEXT:4108,CAP_PAPERDETECTABLE:4109,CAP_UICONTROLLABLE:4110,CAP_DEVICEONLINE:4111,CAP_AUTOSCAN:4112,CAP_THUMBNAILSENABLED:4113,CAP_DUPLEX:4114,CAP_DUPLEXENABLED:4115,CAP_ENABLEDSUIONLY:4116,CAP_CUSTOMDSDATA:4117,CAP_ENDORSER:4118,CAP_ALARMS:4120,CAP_ALARMVOLUME:4121,CAP_AUTOMATICCAPTURE:4122,CAP_TIMEBEFOREFIRSTCAPTURE:4123,CAP_TIMEBETWEENCAPTURES:4124,CAP_CLEARBUFFERS:4125,CAP_MAXBATCHBUFFERS:4126,CAP_DEVICETIMEDATE:4127,CAP_POWERSUPPLY:4128,CAP_CAMERAPREVIEWUI:4129,CAP_SERIALNUMBER:4132,CAP_PRINTER:4134,CAP_PRINTERENABLED:4135,CAP_PRINTERINDEX:4136,CAP_PRINTERMODE:4137,CAP_PRINTERSTRING:4138,CAP_PRINTERSUFFIX:4139,CAP_LANGUAGE:4140,CAP_FEEDERALIGNMENT:4141,CAP_FEEDERORDER:4142,CAP_REACQUIREALLOWED:4144,CAP_BATTERYMINUTES:4146,CAP_BATTERYPERCENTAGE:4147,CAP_CAMERASIDE:4148,CAP_SEGMENTED:4149,CAP_CAMERAENABLED:4150,CAP_CAMERAORDER:4151,CAP_MICRENABLED:4152,CAP_FEEDERPREP:4153,CAP_FEEDERPOCKET:4154,CAP_AUTOMATICSENSEMEDIUM:4155,CAP_CUSTOMINTERFACEGUID:4156,ICAP_AUTOBRIGHT:4352,ICAP_BRIGHTNESS:4353,ICAP_CONTRAST:4355,ICAP_CUSTHALFTONE:4356,ICAP_EXPOSURETIME:4357,ICAP_FILTER:4358,ICAP_FLASHUSED:4359,ICAP_GAMMA:4360,ICAP_HALFTONES:4361,ICAP_HIGHLIGHT:4362,ICAP_IMAGEFILEFORMAT:4364,ICAP_LAMPSTATE:4365,ICAP_LIGHTSOURCE:4366,ICAP_ORIENTATION:4368,ICAP_PHYSICALWIDTH:4369,ICAP_PHYSICALHEIGHT:4370,ICAP_SHADOW:4371,ICAP_FRAMES:4372,ICAP_XNATIVERESOLUTION:4374,ICAP_YNATIVERESOLUTION:4375,ICAP_XRESOLUTION:4376,ICAP_YRESOLUTION:4377,ICAP_MAXFRAMES:4378,ICAP_TILES:4379,ICAP_BITORDER:4380,ICAP_CCITTKFACTOR:4381,ICAP_LIGHTPATH:4382,ICAP_PIXELFLAVOR:4383,ICAP_PLANARCHUNKY:4384,ICAP_ROTATION:4385,ICAP_SUPPORTEDSIZES:4386,ICAP_THRESHOLD:4387,ICAP_XSCALING:4388,ICAP_YSCALING:4389,ICAP_BITORDERCODES:4390,ICAP_PIXELFLAVORCODES:4391,ICAP_JPEGPIXELTYPE:4392,ICAP_TIMEFILL:4394,ICAP_BITDEPTH:4395,ICAP_BITDEPTHREDUCTION:4396,ICAP_UNDEFINEDIMAGESIZE:4397,ICAP_EXTIMAGEINFO:4399,ICAP_MINIMUMHEIGHT:4400,ICAP_MINIMUMWIDTH:4401,ICAP_AUTODISCARDBLANKPAGES:4404,ICAP_FLIPROTATION:4406,ICAP_BARCODEDETECTIONENABLED:4407,ICAP_SUPPORTEDBARCODETYPES:4408,ICAP_BARCODEMAXSEARCHPRIORITIES:4409,ICAP_BARCODESEARCHPRIORITIES:4410,ICAP_BARCODESEARCHMODE:4411,ICAP_BARCODEMAXRETRIES:4412,ICAP_BARCODETIMEOUT:4413,ICAP_ZOOMFACTOR:4414,ICAP_PATCHCODEDETECTIONENABLED:4415,ICAP_SUPPORTEDPATCHCODETYPES:4416,ICAP_PATCHCODEMAXSEARCHPRIORITIES:4417,ICAP_PATCHCODESEARCHPRIORITIES:4418,ICAP_PATCHCODESEARCHMODE:4419,ICAP_PATCHCODEMAXRETRIES:4420,ICAP_PATCHCODETIMEOUT:4421,ICAP_FLASHUSED2:4422,ICAP_IMAGEFILTER:4423,ICAP_NOISEFILTER:4424,ICAP_OVERSCAN:4425,ICAP_AUTOMATICBORDERDETECTION:4432,ICAP_AUTOMATICDESKEW:4433,ICAP_AUTOMATICROTATE:4434,ICAP_JPEGQUALITY:4435,ICAP_FEEDERTYPE:4436,ICAP_ICCPROFILE:4437,ICAP_AUTOSIZE:4438,ICAP_AUTOMATICCROPUSESFRAME:4439,ICAP_AUTOMATICLENGTHDETECTION:4440,ICAP_AUTOMATICCOLORENABLED:4441,ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE:4442,ICAP_COLORMANAGEMENTENABLED:4443,ICAP_IMAGEMERGE:4444,ICAP_IMAGEMERGEHEIGHTTHRESHOLD:4445,ICAP_SUPPORTEDEXTIMAGEINFO:4446},EnumDWT_CapType={TWON_NONE:0,TWON_ARRAY:3,TWON_ENUMERATION:4,TWON_ONEVALUE:5,TWON_RANGE:6},EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},EnumDWT_ImageType={IT_BMP:0,IT_JPG:1,IT_TIF:2,IT_PNG:3,IT_PDF:4,IT_ALL:5},EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5},EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},EnumDWT_CapValueType={TWTY_INT8:0,TWTY_INT16:1,TWTY_INT32:2,TWTY_UINT8:3,TWTY_UINT16:4,TWTY_int:5,TWTY_BOOL:6,TWTY_FIX32:7,TWTY_FRAME:8,TWTY_STR32:9,TWTY_STR64:10,TWTY_STR128:11,TWTY_STR255:12},EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},EnumDWT_CapLanguage={TWLG_DAN:0,TWLG_DUT:1,TWLG_ENG:2,TWLG_FCF:3,TWLG_FIN:4,TWLG_FRN:5,TWLG_GER:6,TWLG_ICE:7,TWLG_ITN:8,TWLG_NOR:9,TWLG_POR:10,TWLG_SPA:11,TWLG_SWE:12,TWLG_USA:13,TWLG_USERLOCALE:-1,TWLG_AFRIKAANS:14,TWLG_ALBANIA:15,TWLG_ARABIC:16,TWLG_ARABIC_ALGERIA:17,TWLG_ARABIC_BAHRAIN:18,TWLG_ARABIC_EGYPT:19,TWLG_ARABIC_IRAQ:20,TWLG_ARABIC_JORDAN:21,TWLG_ARABIC_KUWAIT:22,TWLG_ARABIC_LEBANON:23,TWLG_ARABIC_LIBYA:24,TWLG_ARABIC_MOROCCO:25,TWLG_ARABIC_OMAN:26,TWLG_ARABIC_QATAR:27,TWLG_ARABIC_SAUDIARABIA:28,TWLG_ARABIC_SYRIA:29,TWLG_ARABIC_TUNISIA:30,TWLG_ARABIC_UAE:31,TWLG_ARABIC_YEMEN:32,TWLG_BASQUE:33,TWLG_BYELORUSSIAN:34,TWLG_BULGARIAN:35,TWLG_CATALAN:36,TWLG_CHINESE:37,TWLG_CHINESE_HONGKONG:38,TWLG_CHINESE_PRC:39,TWLG_CHINESE_SINGAPORE:40,TWLG_CHINESE_SIMPLIFIED:41,TWLG_CHINESE_TAIWAN:42,TWLG_CHINESE_TRADITIONAL:43,TWLG_CROATIA:44,TWLG_CZECH:45,TWLG_DANISH:0,TWLG_DUTCH:1,TWLG_DUTCH_BELGIAN:46,TWLG_ENGLISH:2,TWLG_ENGLISH_AUSTRALIAN:47,TWLG_ENGLISH_CANADIAN:48,TWLG_ENGLISH_IRELAND:49,TWLG_ENGLISH_NEWZEALAND:50,TWLG_ENGLISH_SOUTHAFRICA:51,TWLG_ENGLISH_UK:52,TWLG_ENGLISH_USA:13,TWLG_ESTONIAN:53,TWLG_FAEROESE:54,TWLG_FARSI:55,TWLG_FINNISH:4,TWLG_FRENCH:5,TWLG_FRENCH_BELGIAN:56,TWLG_FRENCH_CANADIAN:3,TWLG_FRENCH_LUXEMBOURG:57,TWLG_FRENCH_SWISS:58,TWLG_GERMAN:6,TWLG_GERMAN_AUSTRIAN:59,TWLG_GERMAN_LUXEMBOURG:60,TWLG_GERMAN_LIECHTENSTEIN:61,TWLG_GERMAN_SWISS:62,TWLG_GREEK:63,TWLG_HEBREW:64,TWLG_HUNGARIAN:65,TWLG_ICELANDIC:7,TWLG_INDONESIAN:66,TWLG_ITALIAN:8,TWLG_ITALIAN_SWISS:67,TWLG_JAPANESE:68,TWLG_KOREAN:69,TWLG_KOREAN_JOHAB:70,TWLG_LATVIAN:71,TWLG_LITHUANIAN:72,TWLG_NORWEGIAN:9,TWLG_NORWEGIAN_BOKMAL:73,TWLG_NORWEGIAN_NYNORSK:74,TWLG_POLISH:75,TWLG_PORTUGUESE:10,TWLG_PORTUGUESE_BRAZIL:76,TWLG_ROMANIAN:77,TWLG_RUSSIAN:78,TWLG_SERBIAN_LATIN:79,TWLG_SLOVAK:80,TWLG_SLOVENIAN:81,TWLG_SPANISH:11,TWLG_SPANISH_MEXICAN:82,TWLG_SPANISH_MODERN:83,TWLG_SWEDISH:12,TWLG_THAI:84,TWLG_TURKISH:85,TWLG_UKRANIAN:86,TWLG_ASSAMESE:87,TWLG_BENGALI:88,TWLG_BIHARI:89,TWLG_BODO:90,TWLG_DOGRI:91,TWLG_GUJARATI:92,TWLG_HARYANVI:93,TWLG_HINDI:94,TWLG_KANNADA:95,TWLG_KASHMIRI:96,TWLG_MALAYALAM:97,TWLG_MARATHI:98,TWLG_MARWARI:99,TWLG_MEGHALAYAN:100,TWLG_MIZO:101,TWLG_NAGA:102,TWLG_ORISSI:103,TWLG_PUNJABI:104,TWLG_PUSHTU:105,TWLG_SERBIAN_CYRILLIC:106,TWLG_SIKKIMI:107,TWLG_SWEDISH_FINLAND:108,TWLG_TAMIL:109,TWLG_TELUGU:110,TWLG_TRIPURI:111,TWLG_URDU:112,TWLG_VIETNAMESE:113},EnumDWT_CapSupportedSizes={TWSS_NONE:0,TWSS_A4LETTER:1,TWSS_B5LETTER:2,TWSS_USLETTER:3,TWSS_USLEGAL:4,TWSS_A5:5,TWSS_B4:6,TWSS_B6:7,TWSS_USLEDGER:9,TWSS_USEXECUTIVE:10,TWSS_A3:11,TWSS_B3:12,TWSS_A6:13,TWSS_C4:14,TWSS_C5:15,TWSS_C6:16,TWSS_4A0:17,TWSS_2A0:18,TWSS_A0:19,TWSS_A1:20,TWSS_A2:21,TWSS_A4:1,TWSS_A7:22,TWSS_A8:23,TWSS_A9:24,TWSS_A10:25,TWSS_ISOB0:26,TWSS_ISOB1:27,TWSS_ISOB2:28,TWSS_ISOB3:12,TWSS_ISOB4:6,TWSS_ISOB5:29,TWSS_ISOB6:7,TWSS_ISOB7:30,TWSS_ISOB8:31,TWSS_ISOB9:32,TWSS_ISOB10:33,TWSS_JISB0:34,TWSS_JISB1:35,TWSS_JISB2:36,TWSS_JISB3:37,TWSS_JISB4:38,TWSS_JISB5:2,TWSS_JISB6:39,TWSS_JISB7:40,TWSS_JISB8:41,TWSS_JISB9:42,TWSS_JISB10:43,TWSS_C0:44,TWSS_C1:45,TWSS_C2:46,TWSS_C3:47,TWSS_C7:48,TWSS_C8:49,TWSS_C9:50,TWSS_C10:51,TWSS_USSTATEMENT:52,TWSS_BUSINESSCARD:53,TWSS_MAXSIZE:54},EnumDWT_CapFeederAlignment={TWFA_NONE:0,TWFA_LEFT:1,TWFA_CENTER:2,TWFA_RIGHT:3},EnumDWT_CapFeederOrder={TWFO_FIRSTPAGEFIRST:0,TWFO_LASTPAGEFIRST:1},EnumDWT_CapPrinter={TWPR_IMPRINTERTOPBEFORE:0,TWPR_IMPRINTERTOPAFTER:1,TWPR_IMPRINTERBOTTOMBEFORE:2,TWPR_IMPRINTERBOTTOMAFTER:3,TWPR_ENDORSERTOPBEFORE:4,TWPR_ENDORSERTOPAFTER:5,TWPR_ENDORSERBOTTOMBEFORE:6,TWPR_ENDORSERBOTTOMAFTER:7},EnumDWT_CapPrinterMode={TWPM_SINGLESTRING:0,TWPM_MULTISTRING:1,TWPM_COMPOUNDSTRING:2},EnumDWT_CapBitdepthReduction={TWBR_THRESHOLD:0,TWBR_HALFTONE:1,TWBR_CUSTHALFTONE:2,TWBR_DIFFUSION:3},EnumDWT_CapBitOrder={TWBO_LSBFIRST:0,TWBO_MSBFIRST:1},EnumDWT_CapFilterType={TWFT_RED:0,TWFT_GREEN:1,TWFT_BLUE:2,TWFT_NONE:3,TWFT_WHITE:4,TWFT_CYAN:5,TWFT_MAGENTA:6,TWFT_YELLOW:7,TWFT_BLACK:8},EnumDWT_CapFlash={TWFL_NONE:0,TWFL_OFF:1,TWFL_ON:2,TWFL_AUTO:3,TWFL_REDEYE:4},EnumDWT_CapFlipRotation={TWFR_BOOK:0,TWFR_FANFOLD:1},EnumDWT_CapImageFilter={TWIF_NONE:0,TWIF_AUTO:1,TWIF_LOWPASS:2,TWIF_BANDPASS:3,TWIF_HIGHPASS:4,TWIF_TEXT:3,TWIF_FINELINE:4},EnumDWT_CapLightPath={TWLP_REFLECTIVE:0,TWLP_TRANSMISSIVE:1},EnumDWT_CapLightSource={TWLS_RED:0,TWLS_GREEN:1,TWLS_BLUE:2,TWLS_NONE:3,TWLS_WHITE:4,TWLS_UV:5,TWLS_IR:6},EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},EnumDWT_CapNoiseFilter={TWNF_NONE:0,TWNF_AUTO:1,TWNF_LONEPIXEL:2,TWNF_MAJORITYRULE:3},EnumDWT_CapORientation={TWOR_ROT0:0,TWOR_ROT90:1,TWOR_ROT180:2,TWOR_ROT270:3,TWOR_PORTRAIT:0,TWOR_LANDSCAPE:3,TWOR_AUTO:4,TWOR_AUTOTEXT:5,TWOR_AUTOPICTURE:6},EnumDWT_CapOverscan={TWOV_NONE:0,TWOV_AUTO:1,TWOV_TOPBOTTOM:2,TWOV_LEFTRIGHT:3,TWOV_ALL:4},EnumDWT_CapPixelFlavor={TWPF_CHOCOLATE:0,TWPF_VANILLA:1},EnumDWT_CapPlanarChunky={TWPC_CHUNKY:0,TWPC_PLANAR:1},EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3},EnumDWT_FitWindowType={enumFitWindow:0,enumFitWindowHeight:1,enumFitWindowWidth:2},EnumDWT_PlatformType={enumWindow:0,enumMac:1,enumLinux:2},EnumDWT_UploadDataFormat={Binary:0,Base64:1},EnumDWT_MouseShape={Default:0,Hand:1,Crosshair:2,Zoom:3},OnWebTwainNotFoundOnWindowsCallback=OnWebTwainNotFoundOnWindowsCallback||!1,OnWebTwainNotFoundOnMacCallback=OnWebTwainNotFoundOnMacCallback||!1,OnWebTwainNotFoundOnLinuxCallback=OnWebTwainNotFoundOnLinuxCallback||!1,OnWebTwainOldPluginNotAllowedCallback=OnWebTwainOldPluginNotAllowedCallback||!1,OnWebTwainNeedUpgradeCallback=OnWebTwainNeedUpgradeCallback||!1,OnWebTwainPreExecuteCallback=OnWebTwainPreExecuteCallback||!1,OnWebTwainPostExecuteCallback=OnWebTwainPostExecuteCallback||!1,Dynamsoft_ChangeConfig=Dynamsoft_ChangeConfig||!1,Dynamsoft_OnLoad=Dynamsoft_OnLoad||!1,Dynamsoft_OnNotReady=Dynamsoft_OnNotReady||!1,Dynamsoft_OnReady=Dynamsoft_OnReady||!1;function Dynamsoft__OnclickCloseInstallEx(e){var t=Dynamsoft.Lib.install._dlgInstall;if(t){if(t.open&&t.close(),Dynamsoft.Lib.install._dlgFromImageEditor)KISSY.one(".D_ImageUIEditor")[0].parentNode.removeChild(t);else document.body.removeChild(t);Dynamsoft.Lib.install._dlgInstall=!1}var n=Dynamsoft.Lib.get(Dynamsoft.Lib.install._divDWTNonInstallContainerID);if(n&&n.parentNode.removeChild(n),e&&Dynamsoft.Lib.isString(e))Dynamsoft.Lib.show(e);else{var r,o;if(o=Dynamsoft.WebTwainEnv.Containers)for(r=0;r<o.length;r++)Dynamsoft.Lib.show(o[r].ContainerId);if(o=Dynamsoft.WebTwainEnv.DynamicContainers)for(r=0;r<o.length;r++)Dynamsoft.Lib.show(o[r]);o=null}""!=Dynamsoft.Lib.install._divDWTemessageContainer&&Dynamsoft.Lib.show(Dynamsoft.Lib.install._divDWTemessageContainer)}Dynamsoft.Lib||(Dynamsoft.Lib={}),Dynamsoft.Lib.mix=function(e,t){for(var n in t)e[n]=t[n]},function(e){var t=window,n={},r=Object.prototype.toString;e.mix(e,{isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return isNaN(e)},type:function(e){return null==e?String(e):n[r.call(e)]||"object"},each:function(e,n,r){for(var o=e&&e.length||0,i=0;i<o;++i)n.call(r||t,e[i],i,e)}}),e.each(["String","Function","Object","Array","Boolean","Number"],function(t,r){n["[object "+t+"]"]=r=t.toLowerCase(),e["is"+t]=function(t){return e.type(t)===r}}),e.isArray=Array.isArray||e.isArray}(Dynamsoft.Lib),function(e){var t={},n={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]};t.base64={UTF16ToUTF8:function(e){for(var t=[],n=e.length,r=0;r<n;r++){var o=e.charCodeAt(r);if(o>0&&o<=127)t.push(e.charAt(r));else if(o>=128&&o<=2047){var i=192|o>>6&31,a=128|63&o;t.push(String.fromCharCode(i),String.fromCharCode(a))}else if(o>=2048&&o<=65535){i=224|o>>12&15,a=128|o>>6&63;var s=128|63&o;t.push(String.fromCharCode(i),String.fromCharCode(a),String.fromCharCode(s))}}return t.join("")},UTF8ToUTF16:function(e){var t=[],n=e.length,r=0;for(r=0;r<n;r++){var o=e.charCodeAt(r);if(0==(o>>7&255))t.push(e.charAt(r));else if(6==(o>>5&255)){var i=(31&o)<<6|63&(a=e.charCodeAt(++r));t.push(String.fromCharCode(i))}else if(14==(o>>4&255)){var a;i=(255&(o<<4|(a=e.charCodeAt(++r))>>2&15))<<8|((3&a)<<6|63&e.charCodeAt(++r));t.push(String.fromCharCode(i))}}return t.join("")},encode:function(e){for(var t,r,o,i=this.UTF16ToUTF8(e),a=[],s=0,u=i.length;s<u;){if(t=255&i.charCodeAt(s++),s==u){a.push(n.encodeChars.charAt(t>>2)),a.push(n.encodeChars.charAt((3&t)<<4)),a.push("==");break}if(r=i.charCodeAt(s++),s==u){a.push(n.encodeChars.charAt(t>>2)),a.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),a.push(n.encodeChars.charAt((15&r)<<2)),a.push("=");break}o=i.charCodeAt(s++),a.push(n.encodeChars.charAt(t>>2)),a.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),a.push(n.encodeChars.charAt((15&r)<<2|(192&o)>>6)),a.push(n.encodeChars.charAt(63&o))}return a.join("")},encodeArray:function(e){for(var t,r,o,i=[],a=0,s=e.length;a<s;){if(t=255&e[a++],a==s){i.push(n.encodeChars.charAt(t>>2)),i.push(n.encodeChars.charAt((3&t)<<4)),i.push("==");break}if(r=255&e[a++],a==s){i.push(n.encodeChars.charAt(t>>2)),i.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(n.encodeChars.charAt((15&r)<<2)),i.push("=");break}o=255&e[a++],i.push(n.encodeChars.charAt(t>>2)),i.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(n.encodeChars.charAt((15&r)<<2|(192&o)>>6)),i.push(n.encodeChars.charAt(63&o))}return i.join("")},decode:function(e){for(var t,r,o,i,a=[],s=0,u=e.length;s<u;){do{t=n.decodeChars[255&e.charCodeAt(s++)]}while(s<u&&-1==t);if(-1==t)break;do{r=n.decodeChars[255&e.charCodeAt(s++)]}while(s<u&&-1==r);if(-1==r)break;a.push(String.fromCharCode(t<<2|(48&r)>>4));do{if(61==(o=255&e.charCodeAt(s++)))return this.UTF8ToUTF16(a.join(""));o=n.decodeChars[o]}while(s<u&&-1==o);if(-1==o)break;a.push(String.fromCharCode((15&r)<<4|(60&o)>>2));do{if(61==(i=255&e.charCodeAt(s++)))return this.UTF8ToUTF16(a.join(""));i=n.decodeChars[i]}while(s<u&&-1==i);if(-1==i)break;a.push(String.fromCharCode((3&o)<<6|i))}return this.UTF8ToUTF16(a.join(""))}},t.utf8={fromUTF16:function(e){for(var t,n=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r))>=1&&t<=127?n.push(e.charAt(r)):t>2047?(n.push(String.fromCharCode(224|t>>12&15)),n.push(String.fromCharCode(128|t>>6&63)),n.push(String.fromCharCode(128|t>>0&63))):(n.push(String.fromCharCode(192|t>>6&31)),n.push(String.fromCharCode(128|t>>0&63))),r++;return n.join("")},toUTF16:function(e){for(var t,n,r,o=[],i=0,a=e.length;i<a;)switch((t=e.charCodeAt(i++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o.push(e.charAt(i-1));break;case 12:case 13:n=e.charCodeAt(i++),o.push(String.fromCharCode((31&t)<<6|63&n));break;case 14:n=e.charCodeAt(i++),r=e.charCodeAt(i++),o.push(String.fromCharCode((15&t)<<12|(63&n)<<6|(63&r)<<0))}return o.join("")}},e.mix(e,t)}(Dynamsoft.Lib),function(e){var t=Dynamsoft.WebTwainEnv;Dynamsoft.WebTwainEnv={ServerVersionInfo:"12,3,0,0",ActiveXVersion:"12,1,0,0",PluginVersion:"11,1,0,0",Containers:!1,ContainerMap:{},DynamicContainers:[],DynamicDWTMap:{},ProductKey:"",Trial:!0,ResourcesPath:"Resources",Debug:!1,AutoLoad:!0,OnWebTwainReady:!1,UseDefaultInstallUI:!0,OnWebTwainNotFound:!1,OnWebTwainOldPluginNotAllowed:!1,OnWebTwainNeedUpgrade:!1,OnWebTwainNeedUpgradeWebJavascript:!1,IfUseActiveXForIE10Plus:!0},e.mix(Dynamsoft.WebTwainEnv,t),Dynamsoft.WebTwainEnv.RegisterEvent=function(t,n){return"OnWebTwainReady"!==t&&Dynamsoft.WebTwainEnv.UseDefaultInstallUI||!e.isFunction(n)||(Dynamsoft.WebTwainEnv[t]=n),!0}}(Dynamsoft.Lib),function(DL){var TRUE=!0,FALSE=!1,ua=navigator.userAgent.toLowerCase(),_platform=navigator.platform.toLowerCase(),_protocol=document.location.protocol,_host=location.hostname,_path=location.pathname,_ssl="https:"===_protocol?TRUE:FALSE,_bMac="mac68k"==_platform||"macppc"==_platform||"macintosh"==_platform||"macintel"==_platform||"iphone"==_platform,_bLinux=_platform.indexOf("linux")>=0,_bWin="win32"==_platform||"win64"==_platform||"windows"==_platform||!_bMac&&!_bLinux,_nMSIE=ua.indexOf("msie"),_nTrident=ua.indexOf("trident"),_nEdge=ua.indexOf("edge"),_nRV=ua.indexOf("rv:"),_isX64="win64"==_platform||ua.indexOf("WOW64")>=0||ua.indexOf("x86_64")>=0||ua.indexOf("win64")>=0||ua.indexOf("x64")>=0,_nSafari,_bSafari,_nFirefox=ua.indexOf("firefox"),_bFirefox=-1!=_nFirefox,_bEdge=_bWin&&!_bFirefox&&-1!=_nEdge,_indexOfChrome=ua.indexOf("chrome"),_bChrome=-1!=_indexOfChrome,_bIE=_bWin&&!_bFirefox&&!_bEdge&&!_bChrome&&(-1!=_nMSIE||-1!=_nTrident||-1!=_nRV),_strChromeVersion="",_strFirefoxVersion="",_strIEVersion="",_bHTML5Edition=FALSE,_bPluginEdition=FALSE,_bActiveXEdition=FALSE,_bFileSystem="https:"!==_protocol&&"http:"!==_protocol,_pathType=0,_html5ip="127.0.0.1",_ret,_tmp,_regexp;if(_tmp=ua.match(/version\/([\d.]+).*safari/),_tmp?(_nSafari=_tmp[1],_bSafari=!0):(_nSafari=0,_bSafari=!1),_bChrome||_bFirefox||_bEdge?(_bChrome?(_tmp=ua.slice(_indexOfChrome+7),_tmp=_tmp.slice(0,_tmp.indexOf(" ")),_strChromeVersion=_tmp,_tmp=_tmp.slice(0,_tmp.indexOf(".")),_tmp>=27?_bHTML5Edition=TRUE:_bPluginEdition=TRUE):_bFirefox&&(_tmp=ua.slice(_nFirefox+8),_tmp=_tmp.slice(0,_tmp.indexOf(" ")),_strFirefoxVersion=_tmp,_tmp=_tmp.slice(0,_tmp.indexOf(".")),_tmp>=27?_bHTML5Edition=TRUE:_bPluginEdition=TRUE),_bEdge&&(_tmp=ua.slice(_nEdge+5),_strIEVersion=parseFloat(_tmp),_bHTML5Edition=TRUE)):_bIE?(-1!=_nMSIE?(_tmp=ua.slice(_nMSIE+4),_tmp=_tmp.slice(0,_tmp.indexOf(";")),_strIEVersion=_tmp):-1!=_nRV?(_tmp=ua.slice(_nRV+3),_tmp=_tmp.slice(0,_tmp.indexOf(";")),_tmp=_tmp.slice(0,_tmp.indexOf(")")),_strIEVersion=_tmp):-1!=_nTrident&&(_tmp=ua.slice(_nTrident+7),_tmp=_tmp.slice(0,_tmp.indexOf(";")),_strIEVersion=_tmp),""===_strIEVersion||_strIEVersion>8?_strIEVersion>=10&&0==Dynamsoft.WebTwainEnv.IfUseActiveXForIE10Plus?_bHTML5Edition=TRUE:_bPluginEdition=TRUE:_bActiveXEdition=TRUE):_bSafari?(_tmp=_nSafari,_tmp=_tmp.slice(0,_tmp.indexOf(".")),_tmp>=7?_bHTML5Edition=TRUE:_bPluginEdition=TRUE):_bPluginEdition=TRUE,""===_host?_bWin&&_path.lastIndexOf("\\")>1?_path=_path.substring(1,_path.lastIndexOf("\\")).replace(/%20/g," "):(_pathType=1,_path=_path.substring(1,_path.lastIndexOf("/")).replace(/%20/g," ")):(_pathType=1,_path=_path.substring(0,_path.lastIndexOf("/"))),!_bFileSystem){var oldPath=Dynamsoft.WebTwainEnv.ResourcesPath;void 0===oldPath||""==oldPath?Dynamsoft.WebTwainEnv.ResourcesPath=[_path,"/"].join(""):oldPath.length>0&&"/"!=oldPath[0]&&oldPath.indexOf("//")<0&&""!=_path&&(Dynamsoft.WebTwainEnv.ResourcesPath=[_path,"/",oldPath].join(""))}_ret={product:{name:"Dynamic Web TWAIN",bChromeEdition:_bHTML5Edition,bPluginEdition:_bPluginEdition,bActiveXEdition:_bActiveXEdition,ip:_html5ip,wsProtocol:"dwt_command",_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:function(){var e;return e=_bMac?Dynamsoft.WebTwainEnv.Trial?"/DynamicWebTWAINHTML5MACTrialEdition.pkg":"/DynamicWebTWAINHTML5MACFullEdition.pkg":_bLinux?"/dynamic_web_twainx64.deb":"/DynamicWebTWAINHTML5Edition.exe",Dynamsoft.WebTwainEnv.ResourcesPath+e},getLinuxHTML5DebPath:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/dynamic_web_twainx64.deb"},getLinuxHTML5RpmPath:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/dynamic_web_twainx64.rpm"},getPKGPath:function(){return"/DynamicWebTWAINMacEdition.pkg",Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB?Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAIN.cab":Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINActiveX.exe"},getActiveXCABx64Path:function(){return Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB?Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINx64.cab":Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINActiveX.exe"},strMIMEType:"Application/DynamicWebTwain-Plugin",strProClassID:"5220cb21-c88d-11cf-b347-00aa00a28331",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",strTrialClassID:"FFC6F181-A5CF-4ec4-A441-093D7134FBF2",scripts:{}},env:{bIE:_bIE,bChrome:_bChrome,bFirefox:_bFirefox,bSafari:_bSafari,bEdge:_bEdge,bWin:_bWin,bWin64:-1!=ua.indexOf("win64")||-1!=ua.indexOf("x64"),bMac:_bMac,bLinux:_bLinux,isX64:_isX64,iPluginLength:_bIE||_bEdge?0:navigator.plugins.length,strChromeVersion:_bChrome?_strChromeVersion:"",strFirefoxVersion:_bFirefox?_strFirefoxVersion:"",strIEVersion:_bIE||_bEdge?_strIEVersion:"",bFileSystem:_bFileSystem,basePath:_path,pathType:_pathType},config:{debug:FALSE,devMode:FALSE,usingMainMode:FALSE,bDiscardBlankImage:FALSE,msg:[],msgPrefix:'<span style="color:#cE5E04"><b>',msgSuffix:"</b></span><br />"},detect:{ssl:_ssl,arySTwains:[],arySTwainsByIP:[],aryReconnectSTwains:[],bFirst:TRUE,bOK:FALSE,__dialog:FALSE,scriptLoaded:FALSE,bNoControlEvent:FALSE,bNeedUpgradeEvent:FALSE,StartWSTimeoutId:FALSE,StartWSByIPTimeoutId:FALSE,bPromptJSOrServerOutdated:FALSE,detectType:_ssl?1:"http:"===_protocol||""===_host?0:-1,tryTimes:0,ports:[{port:18619,ssl:TRUE},{port:5492,ssl:TRUE},{port:6679,ssl:TRUE},{port:8992,ssl:TRUE},{port:18618,ssl:FALSE},{port:5491,ssl:FALSE},{port:6678,ssl:FALSE},{port:8991,ssl:FALSE}],cUrlIndex:0,urls:[],onNoControl:FALSE,onNotAllowedForChrome:FALSE,OnDetectNext:FALSE,OnCreatWS:FALSE},page:{bUnload:FALSE,OnUnload:FALSE},tmp:{IfAllowLocalCache:TRUE,EmptyFunction:function(){}}},_ret.get=function(e){return document.getElementById(e)},_ret.log=function(e){if(Dynamsoft.WebTwainEnv.Debug&&!DL.isUndefined(window.console)){var t=window.console.log;DL.isFunction(t)&&window.console.log(e)}},_ret.hide=function(e){var t;"string"==typeof e?t=_ret.get(e):e&&(t=e),t&&(t.style.display="none")},_ret.show=function(e){var t;"string"==typeof e?t=_ret.get(e):e&&(t=e),t&&(t.style.display="")},_ret.toggle=function(e){var t;"string"==typeof e?t=_ret.get(e):e&&(t=e),t&&("none"===t.style.display?t.style.display="":t.style.display="none")},_ret.appendMessage=function(e){if("string"==typeof e)_ret.config.msg.push(e);else if("[object Array]"===Object.prototype.toString.call(e))for(var t in e)_ret.appendMessage(e[t])},_ret.appendRichMessage=function(e){_ret.appendMessage([_ret.config.msgPrefix,e,_ret.config.msgSuffix])},_ret.clearMessage=function(){return _bIE&&8==_strIEVersion?_ret.config.msg.splice(0,_ret.config.msg.length):_ret.config.msg.splice(0),TRUE},_ret.getRealPath=function(e){return void 0===e?"":1==_ret.env.pathType?_ret.env.basePath+e:_ret.env.basePath+e.replace(new RegExp("/","g"),"\\\\")},_ret.getHex=function(e){var t;return 1==(t=Number(e).toString(16).toUpperCase()).length&&(t=["0",t].join("")),t},_ret.getColor=function(e){var t,n,r;return t=e>>16,n=(65280&e)>>8,r=255&e,["#",_ret.getHex(r),_ret.getHex(n),_ret.getHex(t)].join("")},_ret.replaceAll=function(srcString,str1,str2){return srcString.replace(eval("/"+str1+"/gi"),str2)},DL.mix(DL,_ret)}(Dynamsoft.Lib),function(e){var t=window.document,n=t.getElementsByTagName("head")[0]||t.documentElement,r=t.createElement("script").readyState?function(e,t){var n=e.onreadystatechange;e.onreadystatechange=function(){var r=e.readyState;"loaded"!==r&&"complete"!==r||(e.onreadystatechange=null,n&&n(),t.call(this))}}:function(e,t){e.addEventListener("load",t,!1)};e.getScript=function(o,i,a){var s,u,l;if(s=e.isFunction(a)?a:function(){},e.isString(o)&&""!=o){if(!(o in e.product.scripts))return e.product.scripts[o]=!0,u=t.createElement("script"),l=[Dynamsoft.WebTwainEnv.ResourcesPath,"/",o].join(""),u.src=l,i&&(u.async=!0),u.charset="utf-8",r(u,s),n.insertBefore(u,n.firstChild),u;setTimeout(s,10)}else setTimeout(s,10)},e.getCss=function(r){var o,i;if(e.isString(r)&&""!=r)return o=t.createElement("link"),i=[Dynamsoft.WebTwainEnv.ResourcesPath,"/",r].join(""),o.href=i,o.rel="stylesheet",n.insertBefore(o,n.firstChild),o}}(Dynamsoft.Lib),function(e){var t,n,r=window.document;n=function(e){var t=e;return"mousewheel"==t&&(t=KISSY.UA.gecko?"DOMMouseScroll":"mousewheel"),t},t={addEventListener:r.addEventListener?function(e,t,r){var o=n(t);e&&e.addEventListener(o,r,!1)}:function(e,t,r){var o=n(t);e&&e.attachEvent("on"+o,r)},removeEventListener:r.removeEventListener?function(e,t,r){var o=n(t);e&&e.removeEventListener(o,r,!1)}:function(e,t,r){var o=n(t);e&&e.detachEvent("on"+o,r)},getWheelDelta:function(e){var t,n=e.wheelDelta,r=e.detail;return n&&(t=n/120),r&&(t=-(r%3==0?r/3:r)),t}},e.mix(e,t)}(Dynamsoft.Lib),function(e){e.Events={registedClass:[],registedObjs:[]};e.addEventListener(document.documentElement,"keydown",function(t){var n=!0;return e.each(e.Events.registedObjs,function(r){e.each(e.Events.registedClass,function(e){if(r instanceof e&&r.bFocus&&r.handlerKeyDown&&!(n=r.handlerKeyDown(t)))return!1})}),n})}(Dynamsoft.Lib),Dynamsoft.Lib.stopPropagation=function(e){var t=e||window.event;t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0},function(e){e.Addon_Events=[],e.Addon_Sendback_Events=[]}(Dynamsoft.Lib),Dynamsoft.Lib.Errors={Server_Restarted:function(e){e._errorCode=-2208,e._errorString="The connection with the local scanning service (Dynamsoft WebTWAIN Service) encountered a problem and has been reset."},HTML5NotSupport:function(e){e._errorCode=-2209,e._errorString="The HTML5 edition does not support this method or property."},HttpServerCannotEmpty:function(e){e._errorCode=-2300,e._errorString="Http upload error: the HTTP Server cannot empty."},NetworkError:function(e){e._errorCode=-2301,e._errorString="Network error."},InvalidResultFormat:function(e){e._errorCode=-2302,e._errorString="The result format is invalid."},UploadError:function(e,t,n,r){t?(e._errorCode=-2303,e._errorString="Upload cancelled."):(e._errorCode=-2003,e._errorString=r&&r>0?"HTTP process error: "+r+".":"HTTP process error.",n&&(e._errorString+=" "+n))},HttpDownloadUrlError:function(e){e._errorCode=-2304,e._errorString="Http download error: the url is invalid."},HttpDownloadError:function(e,t,n,r){t?(e._errorCode=-2305,e._errorString="User cancelled the operation."):(e._errorCode=-2003,e._errorString=r&&r>0?"HTTP process error: "+r+".":"HTTP process error.",n&&(e._errorString+=" "+n))},UploadFileCannotEmpty:function(e){e._errorCode=-2306,e._errorString="Upload Error: the upload file cannot be empty."},InvalidWidthOrHeight:function(e){e._errorCode=-2307,e._errorString="The width or height you entered is invalid."},Server_Invalid:function(e){0==e._errorCode&&(e._errorCode=-2308,e._errorString="The local scanning service (Dynamsoft WebTWAIN Service) has been stopped.")},InvalidLocalFilename:function(e,t){e._errorCode=-2309,e._errorString="The LocalFile is emtpy in "+t+" Function."},BarCode_InvalidIndex:function(e,t){e._errorCode=-2310,e._errorString="The index is out of range."},BarCode_InvalidRemoteFilename:function(e){e._errorCode=-2311,e._errorString="The RemoteFile is emtpy in Barcode Download Function."},ImageFileLengthCannotZero:function(e){e._errorCode=-2312,e._errorString="The file length is emtpy."},UploadExceededMaxSize:function(e){e._errorCode=-2313,e._errorString="The size of the images you are about to upload has exceeded the allowed size."},ParameterCannotEmpty:function(e){e._errorCode=-2314,e._errorString="The parameter cannot be empty."},Webcam_InvalidIndex:function(e,t){e._errorCode=-2315,e._errorString="The index is out of range."},Webcam_InvalidRemoteFilename:function(e){e._errorCode=-2316,e._errorString="The RemoteFile is emtpy in Webcam Download Function."},OCR_InvalidIndex:function(e,t){e._errorCode=-2321,e._errorString="The index is out of range."},OCR_InvalidLeftOrTopOrRightOrBottom:function(e){e._errorCode=-2322,e._errorString="The left or top or right or bottom you entered is invalid."},OCR_InvalidOutputFormat:function(e){e._errorCode=-2323,e._errorString="The OCR output format is not supported."},OCR_InvalidPageSetMode:function(e){e._errorCode=-2324,e._errorString="The OCR page set mode is not supported."},InvalidIndex:function(e){e._errorCode=-1033,e._errorString="Invalid index."},Pdf_InvalidRemoteFilename:function(e){e._errorCode=-2317,e._errorString="The RemoteFile is emtpy in Pdf Download Function."},InvalidDestination:function(e){e._errorCode=-2318,e._errorString="Invalid destination file."},InvalidSourceFile:function(e){e._errorCode=-2319,e._errorString="Invalid source file."},InvalidFile:function(e){e._errorCode=-2320,e._errorString="Invalid file."},hasLicenseError:function(e){return e._errorCode>=-2348&&e._errorCode<=-2325},LicenseEmptyOrInvalid:function(e){e._errorCode=-2325,e._errorString="The current product key is empty or invalid, please contact the site administrator."},LicenseExpired:function(e,t){e._errorCode=-2326,e._errorString="The current product key has expired on "+t+", please contact the site administrator."},LicenseNoChrome:function(e){e._errorCode=-2327,e._errorString="The current product key does not support Chrome, please contact the site administrator."},LicenseNoFirefox:function(e){e._errorCode=-2328,e._errorString="The current product key does not support Firefox, please contact the site administrator."},LicenseNoIE:function(e){e._errorCode=-2329,e._errorString="The current product key does not support IE, please contact the site administrator."},LicenseNoEdge:function(e){e._errorCode=-2330,e._errorString="The current product key does not support Edge, please contact the site administrator."},LicenseTrialButServiceFull:function(e){e._errorCode=-2331,e._errorString="The current product key is a trial version key but your local scanning service is in full version, please uninstall your local version first and access this page again to install the correct version. If the issue persists, please contact the site administrator."},LicenseFullButServiceTrial:function(e){e._errorCode=-2332,e._errorString="The current product key is a full version key but your local scanning service is in trial version, please uninstall your local version first and access this page again to install the correct version. If the issue persists, please contact the site administrator."},LicenseNoCore:function(e){e._errorCode=-2333,e._errorString="The current product key is missing the core license, please contact the site administrator."},LicenseNo1D:function(e){e._errorCode=-2334,e._errorString="The current product key does not include a license for reading 1D barcode, please contact the site administrator."},LicenseNo2DQR:function(e){e._errorCode=-2335,e._errorString="The current product key does not include a license for reading QRcode barcode, please contact the site administrator."},LicenseNo2DPDF417:function(e){e._errorCode=-2336,e._errorString="The current product key does not include a license for reading PDF417 barcode, please contact the site administrator."},LicenseNo2DDataMatrix:function(e){e._errorCode=-2337,e._errorString="The current product key does not include a license for reading DataMatrix barcode, please contact the site administrator."},LicenseNoWebcam:function(e){e._errorCode=-2338,e._errorString="The current product key does not support Webcam, please contact the site administrator."},LicenseNoPDF:function(e){e._errorCode=-2339,e._errorString="The current product key does not support pdf rasterizer, please contact the site administrator."},LicenseNoOCR:function(e){e._errorCode=-2340,e._errorString="The current product key does not support OCR, please contact the site administrator."},LicenseNoOCRPro:function(e){e._errorCode=-2341,e._errorString="The current product key does not support OCR pro, please contact the site administrator."},LicenseBadDomain:function(e){e._errorCode=-2342,e._errorString="The domain of your current site does not match the domain bound in the current product key, please contact the site administrator."},LicenseNotSupportBorwser:function(e){e._errorCode=-2343,e._errorString="The current product key does not support your browser, please contact the site administrator."},LicenseNotSupportWindows:function(e){e._errorCode=-2344,e._errorString="The current product key does not support Windows OS, please contact the site administrator."},LicenseNotSupportMAC:function(e){e._errorCode=-2345,e._errorString="The current product key does not support MAC OS, please contact the site administrator."},LicenseNotSupportLinux:function(e){e._errorCode=-2346,e._errorString="The current product key does not support Linux OS, please contact the site administrator."},LicenseNotSupportOS:function(e){e._errorCode=-2347,e._errorString="The current product key does not support your OS, please contact the site administrator."},LicenseLower:function(e){e._errorCode=-2348,e._errorString="The current product key is invalid because it's generated with the licenses of a different major version."},BarcodeLicenseEmpty:function(e){e._errorCode=-2349,e._errorString=e._errorString="The current product key does not include a license for reading barcode, please contact the site administrator."},IndicesCannotEmpty:function(e){e._errorCode=-2350,e._errorString="The indices cannot be empty."},UploadIndexMoreThanOne:function(e){e._errorCode=-2351,e._errorString="You cannot upload more than one image when the format is BMP, JPG or PNG"},IndicesOutOfRange:function(e){e._errorCode=-2352,e._errorString="The indices are out of range."},HttpHeaderNotAllowed:function(e){e._errorCode=-2353,e._errorString="The header name being used is a protected keyword and is not allowed."},HttpHeaderIsEmpty:function(e){e._errorCode=-2354,e._errorString="The header name cannot be empty."},HttpHeaderIsNull:function(e){e._errorCode=-2355,e._errorString="The header name cannot be null."},HttpHeaderIsUndefined:function(e){e._errorCode=-2356,e._errorString="The header name cannot be undefined."},HttpHeaderIsInvalid:function(e){e._errorCode=-2357,e._errorString="The header name you entered is invalid."},IndicesNotArray:function(e){e._errorCode=-2358,e._errorString="The type of the parameter indices must be an Array."},IndexOutOfRange:function(e){e._errorCode=-2359,e._errorString="The index is out of range."},IndexNullOrUndefined:function(e){e._errorCode=-2360,e._errorString="The index is null or undefined."},ConvertBase64IndexMoreThanOne:function(e){e._errorCode=-2361,e._errorString="You cannot convert to base64 more than one image when the format is BMP, JPG or PNG."},InvalidImageType:function(e){e._errorCode=-2362,e._errorString="The image type is not supported."},InvalidDataFormat:function(e){e._errorCode=-2363,e._errorString="The data format is not supported."},InvalidUploadInSegements:function(e){e._errorCode=-2364,e._errorString="Please use a Boolean value for the parameter bUploadInSegements."},InvalidUrl:function(e){e._errorCode=-2365,e._errorString="The url is invalid."},ConvertBase64Failed:function(e){e._errorCode=-2366,e._errorString="Convert to base64 failed."},InvalidSegementUploadThreshold:function(e){e._errorCode=-2367,e._errorString="Invalid value for the parameter segementUploadThreshold."},InvalidModuleSize:function(e){e._errorCode=-2368,e._errorString="Invalid value for the parameter moduleSize."},MustUpgradeService:function(e){e._errorCode=-2207,e._errorString="The scanning service (Dynamsoft WebTWAIN Service) installed on your computer is outdated and no longer works with the JavaScript code on the website."},__last:!1},function(e){var t={},n=!1;e.env.bIE&&e.env.strIEVersion<=6&&(n=!0),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},o=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,o.prototype=new r,o}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1}),t.reposition=function(e){var t;t=(document.body.scrollTop||document.documentElement.scrollTop)+((window.innerHeight?window.innerHeight:document.documentElement.clientHeight)-e.offsetHeight)/2,e.style.top=t+"px",e.dialogPolyfillInfo.isTopOverridden=!0},t.inNodeList=function(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return!0;return!1},t.isInlinePositionSetByStylesheet=function(e){for(var n=0;n<document.styleSheets.length;++n){var r=document.styleSheets[n],o=null;try{o=r.cssRules}catch(e){}if(o)for(var i=0;i<o.length;++i){var a=o[i],s=null;try{s=document.querySelectorAll(a.selectorText)}catch(e){}if(s&&t.inNodeList(s,e)){var u=a.style.getPropertyValue("top"),l=a.style.getPropertyValue("bottom");if(u&&"auto"!=u||l&&"auto"!=l)return!0}}}return!1},t.needsCentering=function(e){return"absolute"==(e.currentStyle?e.currentStyle:getComputedStyle(e)).position&&(!("auto"!=e.style.top&&""!=e.style.top||"auto"!=e.style.bottom&&""!=e.style.bottom)&&!t.isInlinePositionSetByStylesheet(e))},t.showDialog=function(e){if(this.open)throw"InvalidStateError: showDialog called on open dialog";if(this.open=!0,this.setAttribute("open","open"),e){var r=null,o=null,i=function(e){for(var t=0;t<e.children.length;t++){var n=e.children[t];if(null!==r||n.disabled||"BUTTON"!=n.nodeName&&"INPUT"!=n.nodeName&&"KEYGEN"!=n.nodeName&&"SELECT"!=n.nodeName&&"TEXTAREA"!=n.nodeName||(r=n),n.autofocus)return void(o=n);if(i(n),null!==o)return}};i(this),null!==o?o.focus():null!==r&&r.focus()}if(t.needsCentering(this)&&t.reposition(this),e&&(this.dialogPolyfillInfo.modal=!0,t.dm.pushDialog(this),n)){var a=this.dialogPolyfillInfo.backdrop;a.style.backgroundColor="#000000",a.style.filter="alpha(opacity=30)",this.style.position="absolute";var s,u,l,c=this;u=this.currentStyle.left,l=this.currentStyle.top,s="BackCompat"===document.compatMode?document.body:document.documentElement,u=u.indexOf("%")<0?Number(u.replace("px","")):Number(u.replace("%","")*s.clientWidth/100),l=l.indexOf("%")<0?Number(l.replace("px","")):Number(l.replace("%","")*s.clientHeight/100),c.style.left="0",c.style.top=l+"px",this._scrollFn=function(){var e=s.scrollTop+"px",n=s.scrollLeft+"px",r=t.dm.overlay,o=c.dialogPolyfillInfo.backdrop;l+s.scrollTop+s.clientHeight<s.scrollHeight?c.style.top=l+s.scrollTop+"px":c.style.top=e,r&&(r.style.top=e),o&&(o.style.top=e),c.style.left=n,r&&(r.style.left=n),o&&(o.style.left=n),setTimeout(function(){c._resizeFn()},100)},this._resizeFn=function(){var e="BackCompat"===document.compatMode?document.body:document.documentElement,n=e.clientWidth+"px",r=e.clientHeight+"px",o=t.dm.overlay,i=c.dialogPolyfillInfo.backdrop;o.style.width=n,i&&(i.style.width=n),o.style.height=r,i&&(i.style.height=r)},this._scrollFn(),window.attachEvent("onscroll",this._scrollFn),window.attachEvent("onload",this._resizeFn),window.attachEvent("onresize",this._resizeFn)}},t.close=function(e){if(!this.open)throw new InvalidStateError;return this.open=!1,this.removeAttribute("open"),void 0!==e&&(this.returnValue=e),this.dialogPolyfillInfo.isTopOverridden&&(this.style.top="auto"),this.dialogPolyfillInfo.modal&&(this.bIE6&&(window.detachEvent("onscroll",this._scrollFn),window.detachEvent("onload",this._resizeFn),window.detachEvent("onresize",this._resizeFn)),t.dm.removeDialog(this)),this.returnValue},t.registerDialog=function(n){n.show,e.addEventListener(n,"dialog_submit",function(e){n.close(e.detail.target.value),e.preventDefault(),e.stopPropagation()}),n.show=t.showDialog.bind(n,!1),n.showModal=t.showDialog.bind(n,!0),n.close=t.close.bind(n),n.dialogPolyfillInfo={}};t.DialogManager=function(){this.pendingDialogStack=[],n?(this.overlay=document.createElement("iframe"),this.overlay.style.position="absolute"):(this.overlay=document.createElement("div"),this.overlay.style.position="fixed"),this.overlay.style.display="block",this.overlay.style.left="0px",this.overlay.style.top="0px",this.overlay.style.margin="0px",this.overlay.style.padding="0px",this.overlay.style.backgroundColor="#000000",this.overlay.style.filter="alpha(opacity=30)",this.overlay.style.opacity="0.3",this.overlay.style.MozOpacity="0.3",this.overlay.style.width="100%",n&&document.documentElement.clientHeight>0?this.overlay.style.height=document.documentElement.clientHeight+"px":this.overlay.style.height="100%",document.createEvent&&e.addEventListener(this.overlay,"click",function(e){var t=document.createEvent("MouseEvents");t.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),document.body.dispatchEvent(t)})},t.dm=new t.DialogManager,t.DialogManager.prototype.blockDocument=function(){document.body.contains(this.overlay)||document.body.appendChild(this.overlay)},t.DialogManager.prototype.unblockDocument=function(){document.body.removeChild(this.overlay)},t.DialogManager.prototype.updateStacking=function(){if(0!=this.pendingDialogStack.length){this.blockDocument();for(var e=5e5,t=0;t<this.pendingDialogStack.length;t++){t==this.pendingDialogStack.length-1&&(this.overlay.style.zIndex=e++);var n=this.pendingDialogStack[t];n.dialogPolyfillInfo.backdrop.style.zIndex=e++,n.style.zIndex=e++}}else this.unblockDocument()},t.DialogManager.prototype.pushDialog=function(t){if(this.pendingDialogStack.length>=5e5)throw"Too many modal dialogs";var r=document.createElement("div");r.className="backdrop",n&&(r.style.position="absolute"),document.createEvent&&e.addEventListener(r,"click",function(e){var n=document.createEvent("MouseEvents");n.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t.dispatchEvent&&t.dispatchEvent(n)}),t.parentNode.insertBefore(r,t.nextSibling),t.dialogPolyfillInfo.backdrop=r,this.pendingDialogStack.push(t),this.updateStacking()},t.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);if(-1!=t){this.pendingDialogStack.splice(t,1);var n=e.dialogPolyfillInfo.backdrop;n.parentNode.removeChild(n),e.dialogPolyfillInfo.backdrop=null,this.updateStacking()}},e.Dialog=t}(Dynamsoft.Lib),KISSY.ready(function(){Dynamsoft.Lib.install={_divInstallBody:"dwt-InstallBody",_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},Dynamsoft.Lib.install._strDynamsoftWithClose=['<div style="height:40px;width:350px;position:relative;">','<span><div class="DYNLogo" ','alt="Dynamsoft Corporation" border="0"></div>',"</span>",'<div style="height:30px;padding-left:205px; position:absolute; top:0; left:120px">','<a href="javascript: void(0)" style="text-decoration:none; padding:15px" class="ClosetblCanNotScan">X</a>',"</div></div>"].join(""),Dynamsoft.Lib.install._strNonInstallDIV=['<div style="text-align:center;" id="',Dynamsoft.Lib.install._divDWTNonInstallContainerID,'"></div>'].join("")}),Dynamsoft.WebTwainEnv.ShowDialog=function(e,t,n,r){var o;if(!Dynamsoft.Lib.get("J_waiting")){var i=document.createElement("div");if(i.className="ds-dialog-wrap",i.style.width="100%",o=r?['<div id="J_waiting" class="ds-dialog" style="width:455px;">','<div class="ks-dialog-header"></div>','<div class="ks-dialog-body">','<div class="ks-dialog-content"><div id="',Dynamsoft.Lib.install._divInstallBody,'"></div></div></div>','<div class="ks-dialog-footer"></div>',"</div>"]:['<div id="J_waiting" class="ds-dialog">','<div class="ks-dialog-header"></div>','<div class="ks-dialog-body">','<div class="ks-dialog-content"><div id="',Dynamsoft.Lib.install._divInstallBody,'"></div></div></div>','<div class="ks-dialog-footer"></div>',"</div>"],i.innerHTML=o.join(""),r)KISSY.one(".D_ImageUIEditor")[0].parentNode.appendChild(i);else document.body.appendChild(i);Dynamsoft.Lib.install._dlgFromImageEditor=r,Dynamsoft.Lib.install._dlgInstall=i,Dynamsoft.Lib.Dialog.registerDialog(Dynamsoft.Lib.install._dlgInstall)}if(!1!==n){Dynamsoft.Lib.get(Dynamsoft.Lib.install._divInstallBody).innerHTML=r?['<div class="ds-dialog-body" style="height:'+t+"px;width:"+e+'px">',n,"</div>"].join(""):['<div class="ds-dialog-body" style="height:'+t+'px">',Dynamsoft.Lib.install._strDynamsoftWithClose,n,"</div>"].join(""),Dynamsoft.Lib.get("J_waiting").style.width=e,Dynamsoft.Lib.install._dlgInstall.open&&Dynamsoft.Lib.install._dlgInstall.close(),Dynamsoft.Lib.install._dlgInstall.showModal();for(var a=0;a<document.links.length;a++)"ClosetblCanNotScan"==document.links[a].className&&(document.links[a].onclick=Dynamsoft__OnclickCloseInstallEx)}},Dynamsoft.WebTwainEnv.OnWebTwainPreExecute=function(){Dynamsoft.Lib.detect.OnWebTwainPreExecute()},Dynamsoft.WebTwainEnv.OnWebTwainPostExecute=function(){Dynamsoft.Lib.detect.OnWebTwainPostExecute()},function(e){e.mix(e.detect,{global_dlg:!1,__dialog:!1}),e.detect.showMask=function(){Dynamsoft.WebTwainEnv.ScanDirectly||(e.isFunction(OnWebTwainPreExecuteCallback)?OnWebTwainPreExecuteCallback():e.detect.OnWebTwainPreExecute())},e.detect.OnWebTwainPreExecute=function(){if(!e.detect.__dialog){var t=['<div style="margin:0 auto;width:100px;line-height:300px"><img src="',[Dynamsoft.WebTwainEnv.ResourcesPath,"/reference/loading.gif"].join(""),'" /></div>'].join(""),n=document.createElement("div");n.className="ds-dialog-wrap",n.innerHTML=t,document.body.appendChild(n),e.detect.__dialog=n,e.Dialog.registerDialog(e.detect.__dialog),e.detect.__dialog.showModal()}},e.detect.hideMask=function(){Dynamsoft.WebTwainEnv.ScanDirectly||(e.isFunction(OnWebTwainPostExecuteCallback)?OnWebTwainPostExecuteCallback():e.detect.OnWebTwainPostExecute())},e.detect.OnWebTwainPostExecute=function(){var t=e.detect.__dialog;t&&(t.close(),document.body.removeChild(t),e.detect.__dialog=!1)}}(Dynamsoft.Lib),function(e){var t={getHexColor:function(e){var t=[];return 7===e.length?(t.push(parseInt("0x"+e.slice(1,3))),t.push(parseInt("0x"+e.slice(3,5))),t.push(parseInt("0x"+e.slice(5,7))),t):[128,128,128]},drawBoxBorder:function(t,n,r,o,i,a,s){var u,l,c,d,h,f,g,p,m,_,v;for(p=Math.floor(n),m=Math.floor(r),_=Math.floor(o),v=Math.floor(i),d=(h=t.getImageData(p,m,_,v)).data,f=this.getHexColor(a),g=e.isUndefined(s)?f:this.getHexColor(s),c=0,u=0;u<_;u++)d[c]=f[0],d[c+1]=f[1],d[c+2]=f[2],c+=4;for(u=0,l=0;l<v;l++)d[c=4*(l*_+u)]=f[0],d[c+1]=f[1],d[c+2]=f[2];for(l=0;l<v;l++)d[c=4*(l*_+(u=_-1))]=g[0],d[c+1]=g[1],d[c+2]=g[2];for(c=(v-1)*_*4,u=0;u<_;u++)d[c]=g[0],d[c+1]=g[1],d[c+2]=g[2],c+=4;t.putImageData(h,p,m)},drawImageWithHermite:function(e,t,n,r,o,i){var a,s,u=e.width,l=e.height,c=Math.min(o,t.width),d=Math.min(i,t.height),h=e.getContext("2d").getImageData(0,0,u,l),f=t.getContext("2d").getImageData(n,r,c,d),g=h.data,p=f.data,m=u/c,_=l/d,v=Math.ceil(m/2),y=Math.ceil(_/2);for(s=0;s<d;s++)for(a=0;a<c;a++){for(var I=gx_g=gx_b=gx_a=0,S=4*(a+s*c),b=0,T=0,C=0,w=(s+.5)*_,E=Math.floor(s*_);E<(s+1)*_;E++)for(var P=Math.abs(w-(E+.5))/y,x=(a+.5)*m,D=P*P,A=Math.floor(a*m);A<(a+1)*m;A++){var F=Math.abs(x-(A+.5))/v,O=Math.sqrt(D+F*F);O>=-1&&O<=1&&(b=2*O*O*O-3*O*O+1)>0&&(F=4*(A+E*u),gx_a+=b*g[F+3],C+=b,g[F+3]<255&&(b=b*g[F+3]/250),I+=b*g[F],gx_g+=b*g[F+1],gx_b+=b*g[F+2],T+=b)}p[S]=I/T,p[S+1]=gx_g/T,p[S+2]=gx_b/T,p[S+3]=gx_a/C}t.getContext("2d").clearRect(0,0,t.width,t.height),t.getContext("2d").putImageData(f,n,r)}};e.mix(e,t)}(Dynamsoft.Lib),Dynamsoft.Lib.DOM={one:function(e){return KISSY.one(e)},getOffset:function(e,t){for(var n,r,o=e.target,i=0,a=0,s=0,u=0,l=!1;o&&!isNaN(o.offsetLeft)&&!isNaN(o.offsetTop);)r=o.scrollLeft,n=o.scrollTop,"BODY"===o.tagName?l?(r=0,n=0):(r|=document.documentElement.scrollLeft,n|=document.documentElement.scrollTop):"fixed"===o.style.position&&(l=!0),i+=o.offsetLeft-r,a+=o.offsetTop-n,o=o.offsetParent;return t&&(s=t.Left,u=t.Top),{x:i=e.clientX-i-s,y:a=e.clientY-a-u}}},function(e){function t(e,n){var r=this,o=0;r.isLoaded=!1,r.displayType=0,r.progress=0,r.progressPosition=0,r.borderWidth={left:0,right:0,top:0,bottom:0},r.orientation=n.orientation||t.Orientation.Horizontal,r.direction=n.direction||t.Direction.LeftToRight,r.creationType=n.creationType||t.CreationType.Replace,r.value=0,r.initialValue=n.value||0,r.minValue=n.minValue||0,r.maxValue=n.maxValue||100,r.showLabel=void 0===n.showLabel||n.showLabel,r.labelText=n.labelText||"",r.width=n.width||300,r.height=n.height||20,r.borderRadius=n.borderRadius||10,r.orientation==t.Orientation.Horizontal&&r.borderRadius>r.height/2&&(r.borderRadius=Math.round(r.height/2)),r.orientation==t.Orientation.Vertical&&r.borderRadius>r.width/2&&(r.borderRadius=Math.round(r.width/2)),r.backColor=n.backColor||"",r.color=n.color||"#fe8e14",r.animationStyle=0,r.animationInterval=n.animationInterval||100;var i=["parent","background","wrapper","left","middle","right","horizontalText","verticalText","marker"];for(r.extraClassName={},o=0;o<i.length;o++)n.extraClassName?"string"==typeof n.extraClassName?r.extraClassName[i[o]]=n.extraClassName:r.extraClassName[i[o]]=n.extraClassName[i[o]]||"":r.extraClassName[i[o]]="";r.onLoad=n.onLoad||null,r.onValueChanged=n.onValueChanged||null,r.onAnimate=n.onAnimate||null,r.creationType==t.CreationType.Replace?r.parentElement=document.getElementById(e):(r.parentElement=document.createElement("DIV"),document.getElementById(e).appendChild(r.parentElement)),r.finishLoading()}t.Orientation={Horizontal:0,Vertical:1},t.Direction={LeftToRight:0,RightToLeft:1,TopToBottom:0,BottomToTop:1},t.CreationType={Replace:0,AppendChild:1},t.AnimationStyle={None:0,Static:1,StaticFull:2,Custom:3,CustomFull:4,Flickering1:10,Flickering2:11,Flickering3:12,LeftToRight1:20,LeftToRight2:21,RightToLeft1:22,RightToLeft2:23,TwoWay:24},t.prototype.finishLoading=function(){var e,n=this;n.wrapperElement=null,n.backgroundElement=null,n.valueElement=null,n.leftElement=null,n.middleElement=null,n.rightElement=null,n.backgroundElement=document.createElement("DIV"),n.backgroundElement.className="progressbar_background"+(n.extraClassName.background?" ":"")+n.extraClassName.background,n.backgroundElement.style.cssText=n.backgroundElement.style.cssText+t._createBorderRadiusCss(n.borderRadius),n.parentElement.appendChild(n.backgroundElement);var r=["border-radius","border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius","-khtml-border-radius-bottomright","-khtml-border-bottom-right-radius"],o=0,i="";for(o=0;o<r.length&&(!(i=t._elementCurrentStyle(n.backgroundElement,r[o]))&&"string"!=typeof i);o++);""!=i&&t._parseInt(i)!=n.borderRadius&&(n.borderRadius=t._parseInt(i)),n.orientation==t.Orientation.Horizontal||n.orientation==t.Orientation.Vertical?n.displayType=0:n.displayType=1,n.parentElement.className=(""!=n.parentElement.className?" ":"")+"progressbar_parent"+(n.extraClassName.parent?" ":"")+n.extraClassName.parent,0==n.displayType?((e=n.wrapperElement=document.createElement("DIV")).style.border="1px solid #A0A0A0",e.style.cssFloat="left",e.style.display="inline-block",e.style.width=n.width+"px",e.style.height=n.height+"px",e.style.left="0px",e.style.top=-n.height+"px",e.style.backgroundColor=n.backColor,e.style.backgroundRepeat="no-repeat",e.style.position="relative",e.style.cssText=e.style.cssText+t._createBorderRadiusCss(n.borderRadius),n.parentElement.appendChild(e),n.borderWidth={left:t._parseInt(t._elementCurrentStyle(e,"border-left-width")),right:t._parseInt(t._elementCurrentStyle(e,"border-right-width")),top:t._parseInt(t._elementCurrentStyle(e,"border-top-width")),bottom:t._parseInt(t._elementCurrentStyle(e,"border-bottom-width"))}):1==n.displayType&&(n.orientation==t.Orientation.Horizontal?n.borderRadius>n.width/2&&(n.borderRadius=n.width):n.orientation==t.Orientation.Vertical&&n.borderRadius>n.height/2&&(n.borderRadius=n.height),n.valueElement=document.createElement("DIV"),n.valueElement.className="",n.leftElement=document.createElement("DIV"),n.middleElement=document.createElement("DIV"),n.rightElement=document.createElement("DIV"),n.leftElement.style.border="1px solid #A0A0A0",n.leftElement.style.cssFloat="left",n.leftElement.style.display="inline-block",n.leftElement.style.backgroundColor=n.backColor,n.leftElement.style.backgroundRepeat="no-repeat",n.leftElement.style.position="relative",n.rightElement.style.border="1px solid #A0A0A0",n.rightElement.style.cssFloat="left",n.rightElement.style.display="inline-block",n.rightElement.style.backgroundColor=n.backColor,n.rightElement.style.backgroundRepeat="no-repeat",n.rightElement.style.position="relative",n.middleElement.style.border="1px solid #A0A0A0",n.middleElement.style.cssFloat="left",n.middleElement.style.display="inline-block",n.middleElement.style.overflow="hidden",n.middleElement.style.position="relative",n.valueElement.style.backgroundColor=n.backColor,n.valueElement.style.position="relative",n.orientation==t.Orientation.Horizontal?(n.leftElement.style.width=n.borderRadius+"px",n.leftElement.style.height=n.height+"px",n.leftElement.style.top=-n.height+"px",n.leftElement.style.left="0px",n.leftElement.style.borderRight="none",n.leftElement.style.cssText=n.leftElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,0,0,n.borderRadius),n.rightElement.style.width=n.borderRadius+"px",n.rightElement.style.height=n.height+"px",n.rightElement.style.top=-n.height+"px",n.rightElement.style.borderLeft="none",n.rightElement.style.cssText=n.rightElement.style.cssText+t._createBorderRadiusCss(0,n.borderRadius,n.borderRadius,0),n.middleElement.style.width=n.width-2*n.borderRadius+"px",n.middleElement.style.height=n.height+"px",n.middleElement.style.top=-n.height+"px",n.middleElement.style.borderLeft="none",n.middleElement.style.borderRight="none",n.valueElement.style.width="0px",n.valueElement.style.height=n.height+"px"):n.orientation==t.Orientation.Vertical&&(n.leftElement.style.width=n.width+"px",n.leftElement.style.height=n.borderRadius+"px",n.leftElement.style.top=-n.height+"px",n.leftElement.style.left="0px",n.leftElement.style.borderBottom="none",n.leftElement.style.cssText=n.leftElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,n.borderRadius,0,0),n.rightElement.style.width=n.width+"px",n.rightElement.style.height=n.borderRadius+"px",n.rightElement.style.top=-n.height+"px",n.rightElement.style.left="0px",n.rightElement.style.borderTop="none",n.rightElement.style.cssText=n.rightElement.style.cssText+t._createBorderRadiusCss(0,0,n.borderRadius,n.borderRadius),n.middleElement.style.width=n.width+"px",n.middleElement.style.height=n.height-2*n.borderRadius+"px",n.middleElement.style.top=-n.height+"px",n.middleElement.style.left="0px",n.middleElement.style.borderTop="none",n.middleElement.style.borderBottom="none",n.valueElement.style.width=n.width+"px",n.valueElement.style.height="0px"),n.middleElement.appendChild(n.valueElement),n.parentElement.appendChild(n.leftElement),n.parentElement.appendChild(n.middleElement),n.parentElement.appendChild(n.rightElement),n.orientation==t.Orientation.Horizontal?n.borderWidth={left:t._parseInt(t._elementCurrentStyle(n.leftElement,"border-left-width")),right:t._parseInt(t._elementCurrentStyle(n.rightElement,"border-right-width")),top:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-top-width")),bottom:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-bottom-width"))}:n.orientation==t.Orientation.Vertical&&(n.borderWidth={left:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-left-width")),right:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-right-width")),top:t._parseInt(t._elementCurrentStyle(n.leftElement,"border-top-width")),bottom:t._parseInt(t._elementCurrentStyle(n.rightElement,"border-bottom-width"))})),n.parentElement.style.width=n.width+n.borderWidth.left+n.borderWidth.right+"px",n.parentElement.style.height=n.height+n.borderWidth.top+n.borderWidth.bottom+"px",n.backgroundElement.style.cssFloat="left",n.backgroundElement.style.display="inline-block",n.backgroundElement.style.width=n.width+n.borderWidth.left+n.borderWidth.right+"px",n.backgroundElement.style.height=n.height+"px",n.backgroundElement.style.backgroundColor="#FFFFFF",n.backgroundElement.style.position="relative",0==n.displayType&&(n.backgroundElement.style.width=n.width+n.borderWidth.left+n.borderWidth.right+"px"),n.backgroundElement.style.top=n.borderWidth.top+"px",n.markerElement=document.createElement("DIV"),n.markerElement.style.display="inline-block",n.markerElement.style.zoom="1.0",n.markerElement.style.width=n.width+"px",n.markerElement.style.height=n.height+"px",n.markerElement.style.top=2*-n.height-n.borderWidth.top+"px",n.markerElement.style.left=n.borderWidth.left+"px",n.markerElement.style.backgroundColor=n.color,n.markerElement.style.lineHeight=n.height+"px",n.markerElement.style.position="relative",n.parentElement.appendChild(n.markerElement),n.isLoaded=!0,n.setValue(n.initialValue),null!=n.onLoad&&n.onLoad()},t.prototype.setValue=function(e){var n=this;if(null!==e&&e<n.minValue&&(e=n.minValue),null!==e&&e>n.maxValue&&(e=n.maxValue),null===e||(n.value=e),n.isLoaded){var r=0;if(n.orientation==t.Orientation.Horizontal){r=n.value/n.maxValue*n.width,n.progressPosition=r,0==n.displayType?(n.direction,t.Direction.LeftToRight):1==n.displayType&&(n.direction==t.Direction.LeftToRight?r<=n.borderRadius?n.valueElement.style.width="0px":r>=n.width-n.borderRadius?n.valueElement.style.width=n.middleElement.style.width:n.valueElement.style.width=r-n.borderRadius+"px":r<=n.borderRadius?n.valueElement.style.width="0px":r>=n.width-n.borderRadius?(n.valueElement.style.left="0px",n.valueElement.style.width=n.middleElement.style.width):(n.valueElement.style.left=n.width-r-n.borderRadius+"px",n.valueElement.style.width=r-n.borderRadius+"px")),r>0?(n.animationStyle!=t.AnimationStyle.StaticFull&&n.animationStyle!=t.AnimationStyle.CustomFull?n.markerElement.style.width=r+"px":n.markerElement.style.width=n.width+"px",n.markerElement.style.visibility="visible"):(n.markerElement.style.width=n.width+"px",n.animationStyle!=t.AnimationStyle.StaticFull&&n.animationStyle!=t.AnimationStyle.CustomFull&&(n.markerElement.style.visibility="hidden")),n.animationStyle!=t.AnimationStyle.StaticFull&&n.animationStyle!=t.AnimationStyle.CustomFull?n.direction==t.Direction.LeftToRight?n.markerElement.style.left=n.borderWidth.left+"px":n.markerElement.style.left=n.width-r+n.borderWidth.left+"px":n.markerElement.style.left=n.borderWidth.left+"px";n.height,n.height,n.borderWidth.top;var o=2*-n.height-n.borderWidth.top;if(0==r||n.width==r)n.markerElement.style.top=o+"px",n.markerElement.style.height=n.height+"px",n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius);else if(r<n.borderRadius){var i=n.height-2.25*(n.borderRadius-Math.sqrt(Math.pow(n.borderRadius,2)-Math.pow(n.borderRadius-r,2))),a=o+n.height/2-i/2;n.markerElement.style.top=a+"px",n.markerElement.style.height=i+"px",n.direction==t.Direction.LeftToRight?n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,0,0,n.borderRadius):n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(0,n.borderRadius,n.borderRadius,0)}else if(n.width-r<n.borderRadius){var s=(2*(n.borderRadius-(n.width-r))+(n.borderRadius-Math.sqrt(Math.pow(n.borderRadius,2)-Math.pow(n.borderRadius-(n.width-r),2))))/3;n.direction==t.Direction.LeftToRight?n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,s,s,n.borderRadius):n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(s,n.borderRadius,n.borderRadius,s)}else n.markerElement.style.top=o+"px",n.markerElement.style.height=n.height+"px",n.direction==t.Direction.LeftToRight?n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,0,0,n.borderRadius):n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(0,n.borderRadius,n.borderRadius,0)}else if(n.orientation==t.Orientation.Vertical){r=n.value/n.maxValue*n.height,n.progressPosition=r,0==n.displayType?(n.direction,t.Direction.TopToBottom):1==n.displayType&&(n.direction==t.Direction.TopToBottom?r<=n.borderRadius?n.valueElement.style.height="0px":r>=n.height-n.borderRadius?n.valueElement.style.height=n.middleElement.style.height:n.valueElement.style.height=r-n.borderRadius+"px":r<=n.borderRadius?n.valueElement.style.height="0px":r>=n.height-n.borderRadius?(n.valueElement.style.top="0px",n.valueElement.style.height=n.middleElement.style.height):(n.valueElement.style.top=n.height-r-n.borderRadius+"px",n.valueElement.style.height=r+2*n.borderRadius+"px")),r>0?(n.animationStyle!=t.AnimationStyle.StaticFull&&n.animationStyle!=t.AnimationStyle.CustomFull?n.markerElement.style.height=r+"px":(n.markerElement.style.height=n.height+"px",n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius)),n.markerElement.style.visibility="visible"):(n.markerElement.style.height="0px",n.animationStyle!=t.AnimationStyle.StaticFull&&n.animationStyle!=t.AnimationStyle.CustomFull&&(n.markerElement.style.visibility="hidden"));n.borderWidth.left;var u=n.borderWidth.left;if(0==r||n.height==r)n.markerElement.style.left=u+"px",n.markerElement.style.width=n.width+"px",n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius);else if(r<n.borderRadius){var l=2.5*r;l>n.width&&(l=n.width);var c=u+n.width/2-l/2;n.markerElement.style.left=c+"px",n.markerElement.style.width=l+"px",n.direction==t.Direction.BottomToTop?n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(0,0,n.borderRadius,n.borderRadius):n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,n.borderRadius,0,0)}else if(n.height-r<n.borderRadius){s=(2*(n.borderRadius-(n.height-r))+(n.borderRadius-Math.sqrt(Math.pow(n.borderRadius,2)-Math.pow(n.borderRadius-(n.height-r),2))))/3;n.direction==t.Direction.BottomToTop?n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(s,s,n.borderRadius,n.borderRadius):n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,n.borderRadius,s,s)}else n.markerElement.style.left=u+"px",n.markerElement.style.width=n.width+"px",n.direction==t.Direction.BottomToTop?n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(0,0,n.borderRadius,n.borderRadius):n.markerElement.style.cssText=n.markerElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,n.borderRadius,0,0);n.animationStyle!=t.AnimationStyle.StaticFull&&n.animationStyle!=t.AnimationStyle.CustomFull?n.direction==t.Direction.TopToBottom?n.markerElement.style.top=2*-n.height-n.borderWidth.top+"px":n.markerElement.style.top=-n.height-r-n.borderWidth.top+"px":n.markerElement.style.top=2*-n.height-n.borderWidth.top+"px"}n.progress=n.value/n.maxValue}null!=n.onValueChanged&&n.onValueChanged()},t._elementCurrentStyle=function(e,t){if(e.currentStyle){var n=0,r="",o=!1;for(n=0;n<t.length;n++)"-"!=t[n].toString()?(r+=o?t[n].toString().toUpperCase():t[n].toString(),o=!1):o=!0;return t=r,e.currentStyle[t]}return getComputedStyle(e,null).getPropertyValue(t)},t._parseInt=function(e){var t=parseInt(e);return isNaN(t)&&(t=0),t},t._createBorderRadiusCss=function(e,t,n,r){return null!=e&&null==t&&null==n&&null==r?"; -moz-border-radius: "+e+"px; -ms-border-radius: "+e+"px; -o-border-radius: "+e+"px; -webkit-border-radius: "+e+"px; -khtml-border-radius: "+e+"px; border-radius: "+e+"px;":"; -moz-border-radius: "+(e=e||0)+"px "+(t=t||0)+"px "+(n=n||0)+"px "+(r=r||0)+"px; -ms-border-radius: "+e+"px "+t+"px "+n+"px "+r+"px; -o-border-radius: "+e+"px "+t+"px "+n+"px "+r+"px; -webkit-border-radius: "+e+"px "+t+"px "+n+"px "+r+"px; -khtml-border-radius: "+e+"px "+t+"px "+n+"px "+r+"px; border-radius: "+e+"px "+t+"px "+n+"px "+r+"px;"},e.ProgressBar=t}(Dynamsoft.Lib),function(e){if(e.product.bPluginEdition||e.product.bActiveXEdition){Object.defineProperty||(Object.defineProperty=function(e,t,n){var r=e[t],o=function(){return n.get.apply(e,[r])},i=function(t){return r=n.set.apply(e,[t])};if(e.__defineGetter__)e.__defineGetter__(t,o),e.__defineSetter__(t,i);else{var a=function(n){if(event.propertyName==t){e.detachEvent("onpropertychange",a);i(e[t]);e[t]=o,e[t].toString=o,e.attachEvent("onpropertychange",a)}};e[t]=o,e[t].toString=o,e.attachEvent("onpropertychange",a)}});var t={isFunction:function(e){return e&&"function"==typeof e},checkErrorString:function(e){return 0==e.getSWebTwain().ErrorCode},wrapperRet:function(e,n,r,o,i){return t.checkErrorString(e)?t.isFunction(r)&&(i?r(e.getSWebTwain().HTTPPostResponseString):r()):t.isFunction(o)&&(i?o(e.getSWebTwain().ErrorCode,e.getSWebTwain().ErrorString,e.getSWebTwain().HTTPPostResponseString):o(e.getSWebTwain().ErrorCode,e.getSWebTwain().ErrorString)),n},getImageType:function(e){if(e.length<4)return-1;var t=e.lastIndexOf(".");if(-1===t)return-1;var n=e.slice(t).toLowerCase();return".bmp"===n||".dib"===n?0:".jpg"===n||".jpe"===n||".jpeg"===n||".jfif"===n?1:".tif"===n||".tiff"===n?2:".png"===n?3:".pdf"===n?4:".gif"===n?5:-1},replaceLocalFilename:function(t){var n=t;return e.env.bFileSystem&&(n=decodeURI(n)),n},makeParams:function(){var e=arguments;return void 0===e||0===e.length?void 0:e}};e.wrapperRet=t.wrapperRet,e.DynamicLoadAddonFuns=[],e.attachAddon=function(t){e.each(e.DynamicLoadAddonFuns,function(n){e.isFunction(n)&&n(t)})},e.attachProperty=function(t){Object.defineProperty(t,"ErrorCode",{get:function(){return t.getSWebTwain().ErrorCode}}),Object.defineProperty(t,"ErrorString",{get:function(){return t.getSWebTwain().ErrorString}}),Object.defineProperty(t,"LogLevel",{get:function(){return t.getSWebTwain().LogLevel},set:function(e){return e*=1,t.getSWebTwain().LogLevel=e,!0}}),Object.defineProperty(t,"Manufacturer",{get:function(){return t.getSWebTwain().Manufacturer},set:function(e){return t.getSWebTwain().Manufacturer=e,!0}}),Object.defineProperty(t,"ProductFamily",{get:function(){return t.getSWebTwain().ProductFamily},set:function(e){return t.getSWebTwain().ProductFamily=e,!0}}),Object.defineProperty(t,"ProductKey",{get:function(){return Dynamsoft.WebTwainEnv.ProductKey},set:function(e){return Dynamsoft.WebTwainEnv.ProductKey=e,t.getSWebTwain().ProductKey=e,!0}}),Object.defineProperty(t,"ProductName",{get:function(){return t.getSWebTwain().ProductName},set:function(e){return t.getSWebTwain().ProductName=e,!0}}),Object.defineProperty(t,"VersionInfo",{get:function(){return t.getSWebTwain().VersionInfo},set:function(e){return t.getSWebTwain().VersionInfo=e,!0}}),Object.defineProperty(t,"BitDepth",{get:function(){return t.getSWebTwain().BitDepth},set:function(e){return t.getSWebTwain().BitDepth=e,!0}}),Object.defineProperty(t,"Brightness",{get:function(){return t.getSWebTwain().Brightness},set:function(e){return t.getSWebTwain().Brightness=e,!0}}),Object.defineProperty(t,"Contrast",{get:function(){return t.getSWebTwain().Contrast},set:function(e){return t.getSWebTwain().Contrast=e,!0}}),Object.defineProperty(t,"CurrentSourceName",{get:function(){return t.getSWebTwain().CurrentSourceName}}),Object.defineProperty(t,"DataSourceStatus",{get:function(){return t.getSWebTwain().DataSourceStatus}}),Object.defineProperty(t,"DefaultSourceName",{get:function(){return t.getSWebTwain().DefaultSourceName}}),Object.defineProperty(t,"Duplex",{get:function(){return t.getSWebTwain().Duplex}}),Object.defineProperty(t,"IfAppendImage",{get:function(){return t.getSWebTwain().IfAppendImage},set:function(e){return t.getSWebTwain().IfAppendImage=e,!0}}),Object.defineProperty(t,"IfAutoBright",{get:function(){return t.getSWebTwain().IfAutoBright},set:function(e){return t.getSWebTwain().IfAutoBright=e,!0}}),Object.defineProperty(t,"IfAutoDiscardBlankpages",{get:function(){return t.getSWebTwain().IfAutoDiscardBlankpages},set:function(e){return t.getSWebTwain().IfAutoDiscardBlankpages=e,!0}}),Object.defineProperty(t,"IfAutoFeed",{get:function(){return t.getSWebTwain().IfAutoFeed},set:function(e){return t.getSWebTwain().IfAutoFeed=e,!0}}),Object.defineProperty(t,"IfAutomaticBorderDetection",{get:function(){return t.getSWebTwain().IfAutomaticBorderDetection},set:function(e){return t.getSWebTwain().IfAutomaticBorderDetection=e,!0}}),Object.defineProperty(t,"IfAutomaticDeskew",{get:function(){return t.getSWebTwain().IfAutomaticDeskew},set:function(e){return t.getSWebTwain().IfAutomaticDeskew=e,!0}}),Object.defineProperty(t,"IfAutoScan",{get:function(){return t.getSWebTwain().IfAutoScan},set:function(e){return t.getSWebTwain().IfAutoScan=e,!0}}),Object.defineProperty(t,"IfDisableSourceAfterAcquire",{get:function(){return t.getSWebTwain().IfDisableSourceAfterAcquire},set:function(e){return t.getSWebTwain().IfDisableSourceAfterAcquire=e,!0}}),Object.defineProperty(t,"IfDuplexEnabled",{get:function(){return t.getSWebTwain().IfDuplexEnabled},set:function(e){return t.getSWebTwain().IfDuplexEnabled=e,!0}}),Object.defineProperty(t,"IfFeederEnabled",{get:function(){return t.getSWebTwain().IfFeederEnabled},set:function(e){return t.getSWebTwain().IfFeederEnabled=e,!0}}),Object.defineProperty(t,"IfFeederLoaded",{get:function(){return t.getSWebTwain().IfFeederLoaded}}),Object.defineProperty(t,"IfModalUI",{get:function(){return t.getSWebTwain().IfModalUI},set:function(e){return t.getSWebTwain().IfModalUI=e,!0}}),Object.defineProperty(t,"IfPaperDetectable",{get:function(){return t.getSWebTwain().IfPaperDetectable}}),Object.defineProperty(t,"IfScanInNewThread",{get:function(){return t.getSWebTwain().IfScanInNewThread},set:function(e){return t.getSWebTwain().IfScanInNewThread=e,!0}}),Object.defineProperty(t,"IfShowCancelDialogWhenImageTransfer",{get:function(){return t.getSWebTwain().IfShowCancelDialogWhenImageTransfer},set:function(e){return t.getSWebTwain().IfShowCancelDialogWhenImageTransfer=e,!0}}),Object.defineProperty(t,"IfShowUI",{get:function(){return t.getSWebTwain().IfShowUI},set:function(e){return t.getSWebTwain().IfShowUI=e,!0}}),Object.defineProperty(t,"IfShowIndicator",{get:function(){return t.getSWebTwain().IfShowIndicator},set:function(e){return t.getSWebTwain().IfShowIndicator=e,!0}}),Object.defineProperty(t,"IfUseTwainDSM",{get:function(){return t.getSWebTwain().IfUseTwainDSM},set:function(e){return t.getSWebTwain().IfUseTwainDSM=e,!0}}),Object.defineProperty(t,"IfUIControllable",{get:function(){return t.getSWebTwain().IfUIControllable}}),Object.defineProperty(t,"ImageBitsPerPixel",{get:function(){return t.getSWebTwain().ImageBitsPerPixel}}),Object.defineProperty(t,"ImageCaptureDriverType",{get:function(){return t.getSWebTwain().ImageCaptureDriverType},set:function(e){return t.getSWebTwain().ImageCaptureDriverType=e,!0}}),Object.defineProperty(t,"ImageLayoutDocumentNumber",{get:function(){return t.getSWebTwain().ImageLayoutDocumentNumber}}),Object.defineProperty(t,"ImageLayoutFrameBottom",{get:function(){return t.getSWebTwain().ImageLayoutFrameBottom}}),Object.defineProperty(t,"ImageLayoutFrameLeft",{get:function(){return t.getSWebTwain().ImageLayoutFrameLeft}}),Object.defineProperty(t,"ImageLayoutFrameNumber",{get:function(){return t.getSWebTwain().ImageLayoutFrameNumber}}),Object.defineProperty(t,"ImageLayoutFrameRight",{get:function(){return t.getSWebTwain().ImageLayoutFrameRight}}),Object.defineProperty(t,"ImageLayoutFrameTop",{get:function(){return t.getSWebTwain().ImageLayoutFrameTop}}),Object.defineProperty(t,"ImageLayoutPageNumber",{get:function(){return t.getSWebTwain().ImageLayoutPageNumber}}),Object.defineProperty(t,"ImageLength",{get:function(){return t.getSWebTwain().ImageLength}}),Object.defineProperty(t,"ImagePixelType",{get:function(){return t.getSWebTwain().ImagePixelType}}),Object.defineProperty(t,"ImageWidth",{get:function(){return t.getSWebTwain().ImageWidth}}),Object.defineProperty(t,"ImageXResolution",{get:function(){return t.getSWebTwain().ImageXResolution}}),Object.defineProperty(t,"ImageYResolution",{get:function(){return t.getSWebTwain().ImageYResolution}}),Object.defineProperty(t,"MagData",{get:function(){return t.getSWebTwain().MagData}}),Object.defineProperty(t,"MagType",{get:function(){return t.getSWebTwain().MagType}}),Object.defineProperty(t,"PageSize",{get:function(){return t.getSWebTwain().PageSize},set:function(e){return e*=1,t.getSWebTwain().PageSize=e,!0}}),Object.defineProperty(t,"PendingXfers",{get:function(){return t.getSWebTwain().PendingXfers}}),Object.defineProperty(t,"PixelFlavor",{get:function(){return t.getSWebTwain().PixelFlavor},set:function(e){return t.getSWebTwain().PixelFlavor=e,!0}}),Object.defineProperty(t,"PixelType",{get:function(){return t.getSWebTwain().PixelType},set:function(e){return t.getSWebTwain().PixelType=e,!0}}),Object.defineProperty(t,"Resolution",{get:function(){return t.getSWebTwain().Resolution},set:function(e){return e*=1,t.getSWebTwain().Resolution=e,!0}}),Object.defineProperty(t,"SourceCount",{get:function(){return t.getSWebTwain().SourceCount}}),Object.defineProperty(t,"TransferMode",{get:function(){return t.getSWebTwain().TransferMode},set:function(e){return t.getSWebTwain().TransferMode=e,!0}}),Object.defineProperty(t,"Unit",{get:function(){return t.getSWebTwain().Unit},set:function(e){return t.getSWebTwain().Unit=e,!0}}),Object.defineProperty(t,"XferCount",{get:function(){return t.getSWebTwain().XferCount},set:function(e){return e*=1,t.getSWebTwain().XferCount=e,!0}}),Object.defineProperty(t,"Capability",{get:function(){return t.getSWebTwain().Capability},set:function(e){return t.getSWebTwain().Capability=e,!0}}),Object.defineProperty(t,"CapCurrentIndex",{get:function(){return t.getSWebTwain().CapCurrentIndex},set:function(e){return t.getSWebTwain().CapCurrentIndex=e,!0}}),Object.defineProperty(t,"CapCurrentValue",{get:function(){return t.getSWebTwain().CapCurrentValue},set:function(e){return t.getSWebTwain().CapCurrentValue=e,!0}}),Object.defineProperty(t,"CapDefaultIndex",{get:function(){return t.getSWebTwain().CapDefaultIndex}}),Object.defineProperty(t,"CapDefaultValue",{get:function(){return t.getSWebTwain().CapDefaultValue}}),Object.defineProperty(t,"CapDescription",{get:function(){return t.getSWebTwain().CapDescription},set:function(e){return t.getSWebTwain().CapDescription=e,!0}}),Object.defineProperty(t,"CapMaxValue",{get:function(){return t.getSWebTwain().CapMaxValue},set:function(e){return t.getSWebTwain().CapMaxValue=e,!0}}),Object.defineProperty(t,"CapMinValue",{get:function(){return t.getSWebTwain().CapMinValue},set:function(e){return t.getSWebTwain().CapMinValue=e,!0}}),Object.defineProperty(t,"CapNumItems",{get:function(){return t.getSWebTwain().CapNumItems},set:function(e){return t.getSWebTwain().CapNumItems=e,!0}}),Object.defineProperty(t,"CapStepSize",{get:function(){return t.getSWebTwain().CapStepSize},set:function(e){return t.getSWebTwain().CapStepSize=e,!0}}),Object.defineProperty(t,"CapType",{get:function(){return t.getSWebTwain().CapType},set:function(e){return t.getSWebTwain().CapType=e,!0}}),Object.defineProperty(t,"CapValue",{get:function(){return t.getSWebTwain().CapValue},set:function(e){return t.getSWebTwain().CapValue=e,!0}}),Object.defineProperty(t,"CapValueString",{get:function(){return t.getSWebTwain().CapValueString},set:function(e){return t.getSWebTwain().CapValueString=e,!0}}),Object.defineProperty(t,"CapValueType",{get:function(){return t.getSWebTwain().CapValueType},set:function(e){return t.getSWebTwain().CapValueType=e,!0}}),Object.defineProperty(t,"AllowMultiSelect",{get:function(){return t.getSWebTwain().AllowMultiSelect},set:function(e){return t.getSWebTwain().AllowMultiSelect=e,!0}}),Object.defineProperty(t,"BackgroundColor",{get:function(){return t.getSWebTwain().BackgroundColor},set:function(e){return t.getSWebTwain().BackgroundColor=e,!0}}),Object.defineProperty(t,"BackgroundFillColor",{get:function(){return t.getSWebTwain().BackgroundFillColor},set:function(e){return t.getSWebTwain().BackgroundFillColor=e,!0}}),Object.defineProperty(t,"BlankImageCurrentStdDev",{get:function(){return t.getSWebTwain().BlankImageCurrentStdDev},set:function(e){return!1}}),Object.defineProperty(t,"BlankImageMaxStdDev",{get:function(){return t.getSWebTwain().BlankImageMaxStdDev},set:function(e){return t.getSWebTwain().BlankImageMaxStdDev=e,!0}}),Object.defineProperty(t,"BlankImageThreshold",{get:function(){return t.getSWebTwain().BlankImageThreshold},set:function(e){return t.getSWebTwain().BlankImageThreshold=e,!0}}),Object.defineProperty(t,"CurrentImageIndexInBuffer",{get:function(){return t.getSWebTwain().CurrentImageIndexInBuffer},set:function(e){return e!=t.getSWebTwain().CurrentImageIndexInBuffer&&(t.getSWebTwain().CurrentImageIndexInBuffer=e),!0}}),Object.defineProperty(t,"FitWindowType",{get:function(){return t.getSWebTwain().FitWindowType},set:function(e){return t.getSWebTwain().FitWindowType=e,!0}}),Object.defineProperty(t,"HowManyImagesInBuffer",{get:function(){return t.getSWebTwain().HowManyImagesInBuffer},set:function(e){return t.getSWebTwain().HowManyImagesInBuffer=e,!0}}),Object.defineProperty(t,"IfFitWindow",{get:function(){return t.getSWebTwain().IfFitWindow},set:function(e){return t.getSWebTwain().IfFitWindow=e,!0}}),Object.defineProperty(t,"ImageMargin",{get:function(){return t.getSWebTwain().ImageMargin},set:function(e){return t.getSWebTwain().ImageMargin=e,!0}}),Object.defineProperty(t,"MaxImagesInBuffer",{get:function(){return t.getSWebTwain().MaxImagesInBuffer},set:function(e){return t.getSWebTwain().MaxImagesInBuffer=e,!0}}),Object.defineProperty(t,"MouseX",{get:function(){return t.getSWebTwain().MouseX},set:function(e){return!1}}),Object.defineProperty(t,"MouseY",{get:function(){return t.getSWebTwain().MouseY},set:function(e){return!1}}),Object.defineProperty(t,"SelectedImagesCount",{get:function(){return t.getSWebTwain().SelectedImagesCount},set:function(e){return t.getSWebTwain().SelectedImagesCount=e,!0}}),Object.defineProperty(t,"SelectionImageBorderColor",{get:function(){return t.getSWebTwain().SelectionImageBorderColor},set:function(e){return t.getSWebTwain().SelectionImageBorderColor=e,!0}}),Object.defineProperty(t,"Zoom",{get:function(){return t.getSWebTwain().Zoom},set:function(e){return t.getSWebTwain().Zoom=e,!0}}),Object.defineProperty(t,"MouseShape",{get:function(){return t.getSWebTwain().MouseShape},set:function(e){return t.getSWebTwain().MouseShape=e,!0}}),Object.defineProperty(t,"HTTPPostResponseString",{get:function(){return t.getSWebTwain().HTTPPostResponseString}}),Object.defineProperty(t,"AsyncMode",{get:function(){return t.getSWebTwain().AsyncMode},set:function(e){return t.getSWebTwain().AsyncMode=e,!0}}),Object.defineProperty(t,"FTPPassword",{get:function(){return t.getSWebTwain().FTPPassword},set:function(e){return t.getSWebTwain().FTPPassword=e,!0}}),Object.defineProperty(t,"FTPPort",{get:function(){return t.getSWebTwain().FTPPort},set:function(e){return""!==e&&(e*=1,t.getSWebTwain().FTPPort=e,!0)}}),Object.defineProperty(t,"FTPUserName",{get:function(){return t.getSWebTwain().FTPUserName},set:function(e){return t.getSWebTwain().FTPUserName=e,!0}}),Object.defineProperty(t,"HTTPPort",{get:function(){return t.getSWebTwain().HTTPPort},set:function(n){return""!==n?(n*=1,t.getSWebTwain().HTTPPort=n):(n=e.detect.ssl?443:80,t.getSWebTwain().HTTPPort=n),!0}}),Object.defineProperty(t,"HTTPPassword",{get:function(){return t.getSWebTwain().HTTPPassword},set:function(e){return t.getSWebTwain().HTTPPassword=e,!0}}),Object.defineProperty(t,"HTTPUserName",{get:function(){return t.getSWebTwain().HTTPUserName},set:function(e){return t.getSWebTwain().HTTPUserName=e,!0}}),Object.defineProperty(t,"IfPASVMode",{get:function(){return t.getSWebTwain().IfPASVMode},set:function(e){return t.getSWebTwain().IfPASVMode=e,!0}}),Object.defineProperty(t,"IfShowProgressBar",{get:function(){return t.getSWebTwain().IfShowProgressBar},set:function(e){return t.getSWebTwain().IfShowProgressBar=e,!0}}),Object.defineProperty(t,"ProxyServer",{get:function(){return t.getSWebTwain().ProxyServer},set:function(e){return t.getSWebTwain().ProxyServer=e,!0}}),Object.defineProperty(t,"IfShowFileDialog",{get:function(){return t.getSWebTwain().IfShowFileDialog},set:function(e){return t.getSWebTwain().IfShowFileDialog=e,!0}}),Object.defineProperty(t,"IfTiffMultiPage",{get:function(){return t.getSWebTwain().IfTiffMultiPage},set:function(e){return t.getSWebTwain().IfTiffMultiPage=e,!0}}),Object.defineProperty(t,"PDFAuthor",{get:function(){return t.getSWebTwain().PDFAuthor},set:function(e){return t.getSWebTwain().PDFAuthor=e,!0}}),Object.defineProperty(t,"PDFCompressionType",{get:function(){return t.getSWebTwain().PDFCompressionType},set:function(e){return t.getSWebTwain().PDFCompressionType=e,!0}}),Object.defineProperty(t,"PDFCreationDate",{get:function(){return t.getSWebTwain().PDFCreationDate},set:function(e){return t.getSWebTwain().PDFCreationDate=e,!0}}),Object.defineProperty(t,"PDFCreator",{get:function(){return t.getSWebTwain().PDFCreator},set:function(e){return t.getSWebTwain().PDFCreator=e,!0}}),Object.defineProperty(t,"PDFKeywords",{get:function(){return t.getSWebTwain().PDFKeywords},set:function(e){return t.getSWebTwain().PDFKeywords=e,!0}}),Object.defineProperty(t,"PDFModifiedDate",{get:function(){return t.getSWebTwain().PDFModifiedDate},set:function(e){return t.getSWebTwain().PDFModifiedDate=e,!0}}),Object.defineProperty(t,"PDFProducer",{get:function(){return t.getSWebTwain().PDFProducer},set:function(e){return t.getSWebTwain().PDFProducer=e,!0}}),Object.defineProperty(t,"PDFSubject",{get:function(){return t.getSWebTwain().PDFSubject},set:function(e){return t.getSWebTwain().PDFSubject=e,!0}}),Object.defineProperty(t,"PDFTitle",{get:function(){return t.getSWebTwain().PDFTitle},set:function(e){return t.getSWebTwain().PDFTitle=e,!0}}),Object.defineProperty(t,"PDFVersion",{get:function(){return t.getSWebTwain().PDFVersion},set:function(e){return t.getSWebTwain().PDFVersion=e,!0}}),Object.defineProperty(t,"TIFFCompressionType",{get:function(){return t.getSWebTwain().TIFFCompressionType},set:function(e){return t.getSWebTwain().TIFFCompressionType=e,!0}}),Object.defineProperty(t,"JPEGQuality",{get:function(){return t.getSWebTwain().JPEGQuality},set:function(e){return(e*=1)>=100&&(e=100),t.getSWebTwain().JPEGQuality=e,!0}}),Object.defineProperty(t,"HttpContentTypeFieldValue",{get:function(){return t.getSWebTwain().HttpContentTypeFieldValue},set:function(e){return t.getSWebTwain().HttpContentTypeFieldValue=e}}),Object.defineProperty(t,"SelectionRectAspectRatio",{get:function(){return t.getSWebTwain().SelectionRectAspectRatio},set:function(e){return t.getSWebTwain().SelectionRectAspectRatio=e,!0}}),Object.defineProperty(t,"IfAllowLocalCache",{get:function(){return t.getSWebTwain().IfAllowLocalCache},set:function(e){return t.getSWebTwain().IfAllowLocalCache=e,!0}}),Object.defineProperty(t,"_AutoCropMethod",{get:function(){return t.getSWebTwain().AutoCropMethod},set:function(e){return t.getSWebTwain().AutoCropMethod=e}}),Object.defineProperty(t,"BrokerProcessType",{get:function(){return t.getSWebTwain().BrokerProcessType},set:function(e){return t.getSWebTwain().BrokerProcessType=e,!0}}),Object.defineProperty(t,"BorderStyle",{get:function(){return t.getSWebTwain().BorderStyle},set:function(e){return t.getSWebTwain().BorderStyle=e,!0}}),Object.defineProperty(t,"IfShowPrintUI",{get:function(){return t.getSWebTwain().IfShowPrintUI},set:function(e){return t.getSWebTwain().IfShowPrintUI=e,!0}}),Object.defineProperty(t,"VScrollBar",{get:function(){return t.getSWebTwain().VScrollBar},set:function(e){return t.getSWebTwain().VScrollBar=e,!0}}),Object.defineProperty(t,"EnableInteractiveZoom",{get:function(){return t.getSWebTwain().EnableInteractiveZoom},set:function(e){return t.getSWebTwain().EnableInteractiveZoom=e,!0}}),Object.defineProperty(t,"ImageEditorIfEnableEnumerator",{get:function(){return t.getSWebTwain().ImageEditorIfEnableEnumerator},set:function(e){return t.getSWebTwain().ImageEditorIfEnableEnumerator=e,!0}}),Object.defineProperty(t,"ImageEditorIfReadonly",{get:function(){return t.getSWebTwain().ImageEditorIfReadonly},set:function(e){return t.getSWebTwain().ImageEditorIfReadonly=e,!0}}),Object.defineProperty(t,"ImageEditorIfModal",{get:function(){return t.getSWebTwain().ImageEditorIfModal},set:function(e){return t.getSWebTwain().ImageEditorIfModal=e,!0}}),Object.defineProperty(t,"ImageEditorWindowTitle",{get:function(){return t.getSWebTwain().ImageEditorWindowTitle},set:function(e){return t.getSWebTwain().ImageEditorWindowTitle=e,!0}}),Object.defineProperty(t,"IfSSL",{get:function(){return t.getSWebTwain().IfSSL},set:function(e){return t.getSWebTwain().IfSSL=e,!0}}),Object.defineProperty(t,"AllowPluginAuthentication",{get:function(){return t.getSWebTwain().AllowPluginAuthentication},set:function(e){return t.getSWebTwain().AllowPluginAuthentication=e,!0}}),Object.defineProperty(t,"HttpFieldNameOfUploadedImage",{get:function(){return t.getSWebTwain().HttpFieldNameOfUploadedImage},set:function(e){return t.getSWebTwain().HttpFieldNameOfUploadedImage=e,!0}}),Object.defineProperty(t,"MaxInternetTransferThreads",{get:function(){return t.getSWebTwain().MaxInternetTransferThreads},set:function(e){return t.getSWebTwain().MaxInternetTransferThreads=e,!0}}),Object.defineProperty(t,"MaxUploadImageSize",{get:function(){return t.getSWebTwain().MaxUploadImageSize},set:function(e){return t.getSWebTwain().MaxUploadImageSize=e,!0}}),Object.defineProperty(t,"IfOpenImageWithGDIPlus",{get:function(){return t.getSWebTwain().IfOpenImageWithGDIPlus},set:function(e){return t.getSWebTwain().IfOpenImageWithGDIPlus=e,!0}}),Object.defineProperty(t,"BufferMemoryLimit",{get:function(){return t.getSWebTwain().BufferMemoryLimit},set:function(e){return t.getSWebTwain().BufferMemoryLimit=e,!0}}),Object.defineProperty(t,"Width",{get:function(){return t.getSWebTwain().style.width},set:function(e){return t._ChangeWidth(e),!0}}),Object.defineProperty(t,"Height",{get:function(){return t.getSWebTwain().style.height},set:function(e){return t._ChangeHeight(e),!0}}),Object.defineProperty(t,"IfThrowException",{get:function(){return t.getSWebTwain().IfThrowException},set:function(e){return t.getSWebTwain().IfThrowException=e,!0}}),Object.defineProperty(t,"IfAutoScroll",{get:function(){return t.getSWebTwain().IfAutoScroll},set:function(e){return t.getSWebTwain().IfAutoScroll=e,!0}}),Object.defineProperty(t,"ShowPageNumber",{get:function(){return!1},set:function(e){return!1}})},e.attachMethod=function(n){var r=n;n.RegisterEvent=function(e,t){var n=["__",e].join("");return r[n]=t,r.getSWebTwain().RegisterEvent(e,t),!0},n.onEvent=function(e,t){return r.RegisterEvent(e,t),!0},n.on=function(e,t){return r.RegisterEvent(e,t),!0},n.CancelAllPendingTransfers=function(){return r.getSWebTwain().CancelAllPendingTransfers()},n.CloseSource=function(){return r.getSWebTwain().CloseSource()},n.CloseSourceManager=function(){return r.getSWebTwain().CloseSourceManager()},n.DisableSource=function(){return r.getSWebTwain().DisableSource()},n.FeedPage=function(){return r.getSWebTwain().FeedPage()},n.GetDeviceType=function(){return r.getSWebTwain().GetDeviceType()},n.GetSourceNameItems=function(e){return r.getSWebTwain().GetSourceNameItems(e)},n.SourceNameItems=function(e){return r.getSWebTwain().GetSourceNameItems(e)},n.GetSourceNames=function(){return[]},n.GetSourceType=function(e){return r.getSWebTwain().GetSourceType(e)},n.OpenSource=function(){return r.getSWebTwain().OpenSource()},n.OpenSourceManager=function(){return r.getSWebTwain().OpenSourceManager()},n.ResetImageLayout=function(){return r.getSWebTwain().ResetImageLayout()},n.RewindPage=function(){return r.getSWebTwain().RewindPage()},n.SelectSource=function(){return r.getSWebTwain().SelectSource()},n.SelectSourceByIndex=function(e){return r.getSWebTwain().SelectSourceByIndex(e)},n.SetFileXferInfo=function(e,n){var o=t.replaceLocalFilename(e);return r.getSWebTwain().SetFileXferInfo(o,n)},n.SetImageLayout=function(e,t,n,o){return r.getSWebTwain().SetImageLayout(e,t,n,o)},n.CapGet=function(){return r.getSWebTwain().CapGet()},n.CapGetCurrent=function(){return r.getSWebTwain().CapGetCurrent()},n.CapGetDefault=function(){return r.getSWebTwain().CapGetDefault()},n.CapGetFrameBottom=function(e){return r.getSWebTwain().CapGetFrameBottom(e)},n.CapGetFrameLeft=function(e){return r.getSWebTwain().CapGetFrameLeft(e)},n.CapGetFrameRight=function(e){return r.getSWebTwain().CapGetFrameRight(e)},n.CapGetFrameTop=function(e){return r.getSWebTwain().CapGetFrameTop(e)},n.CapGetHelp=function(){return r.getSWebTwain().CapGetHelp()},n.CapGetLabel=function(){return r.getSWebTwain().CapGetLabel()},n.CapGetLabels=function(){return r.getSWebTwain().CapGetLabels()},n.CapIfSupported=function(e){return r.getSWebTwain().CapIfSupported(e)},n.CapReset=function(){return r.getSWebTwain().CapReset()},n.CapSet=function(){return r.getSWebTwain().CapSet()},n.CapSetFrame=function(e,t,n,o,i){return r.getSWebTwain().CapSetFrame(e,t,n,o,i)},n.GetCapItems=function(e){return r.getSWebTwain().GetCapItems(e)},n.GetCapItemsString=function(e){return r.getSWebTwain().GetCapItemsString(e)},n.SetCapItems=function(e,n){return r.getSWebTwain().SetCapItems(e,n),t.checkErrorString(r)},n.SetCapItemsString=function(e,n){return r.getSWebTwain().SetCapItemsString(e,n),t.checkErrorString(r)},n.AddText=function(e,t,n,o,i,a,s,u){return r.getSWebTwain().AddText(e,t,n,o,i,a,s,u)},n.CreateTextFont=function(e,t,n,o,i,a,s,u,l,c,d,h,f,g){return r.getSWebTwain().CreateTextFont(e,t,n,o,i,a,s,u,l,c,d,h,f,g)},n.CopyToClipboard=function(e){return r.getSWebTwain().CopyToClipboard(e)},n.Erase=function(e,t,n,o,i){return r.getSWebTwain().Erase(e,t,n,o,i)},n.GetImageBitDepth=function(e){return r.getSWebTwain().GetImageBitDepth(e)},n.GetImageWidth=function(e){return r.getSWebTwain().GetImageWidth(e)},n.GetImageHeight=function(e){return r.getSWebTwain().GetImageHeight(e)},n.GetImageSize=function(e,t,n){return r.getSWebTwain().GetImageSize(e,t,n)},n.GetImageSizeWithSpecifiedType=function(e,t){return r.getSWebTwain().GetImageSizeWithSpecifiedType(e,t)},n.GetImageXResolution=function(e){return r.getSWebTwain().GetImageXResolution(e)},n.GetImageYResolution=function(e){return r.getSWebTwain().GetImageYResolution(e)},n.GetSelectedImageIndex=function(e){return r.getSWebTwain().GetSelectedImageIndex(e)},n.SetSelectedImageIndex=function(e,n){return r.getSWebTwain().SetSelectedImageIndex(e,n),t.checkErrorString(r)},n.GetSelectedImagesSize=function(e){return r.getSWebTwain().GetSelectedImagesSize(e)},n.GetSkewAngle=function(e){return r.getSWebTwain().GetSkewAngle(e)},n.GetSkewAngleEx=function(e,t,n,o,i){return r.getSWebTwain().GetSkewAngleEx(e,t,n,o,i)},n.IsBlankImage=function(e){return r.getSWebTwain().IsBlankImage(e)},n.IsBlankImageEx=function(e,t,n,o,i,a){return r.getSWebTwain().IsBlankImageEx(e,t,n,o,i,a)},n.Mirror=function(e){return r.getSWebTwain().Mirror(e)},n.OverlayRectangle=function(e,n,o,i,a,s,u){return r.getSWebTwain().OverlayRectangle(e,n,o,i,a,s,u),t.checkErrorString(r)},n.RemoveAllImages=function(){var e;return r.getSWebTwain().RemoveAllImages(),(e=t.checkErrorString(r))&&r.__innerRefreshImage(),e},n.RemoveAllSelectedImages=function(){var e;return r.getSWebTwain().RemoveAllSelectedImages(),(e=t.checkErrorString(r))&&r.__innerRefreshImage(),e},n.RemoveImage=function(e){return r.getSWebTwain().RemoveImage(e)},n.Rotate=function(e,t,n){var o=parseInt(e);return 1==r.getSWebTwain().Rotate(o,t,n)},n.RotateEx=function(e,t,n,o){var i=parseInt(e);return 1==r.getSWebTwain().RotateEx(i,t,n,o)},n.RotateLeft=function(e){var t=parseInt(e);return 1==r.getSWebTwain().RotateLeft(t)},n.RotateRight=function(e){var t=parseInt(e);return 1==r.getSWebTwain().RotateRight(t)},n.ChangeImageSize=function(e,t,n,o){var i=parseInt(e);return 1==r.getSWebTwain().ChangeImageSize(i,t,n,o)},n.Flip=function(e){var t=parseInt(e);return 1==r.getSWebTwain().Flip(t)},n.Crop=function(e,t,n,o,i){var a=parseInt(e);return 1==r.getSWebTwain().Crop(a,t,n,o,i)},n.CropToClipboard=function(e,t,n,o,i){var a=parseInt(e);return 1==r.getSWebTwain().CropToClipboard(a,t,n,o,i)},n.CutFrameToClipboard=function(e,t,n,o,i){var a=parseInt(e);return 1==r.getSWebTwain().CutFrameToClipboard(a,t,n,o,i)},n.CutToClipboard=function(e){var t=parseInt(e);return 1==r.getSWebTwain().CutToClipboard(t)},n.SetDPI=function(e,t,n,o,i){var a=parseInt(e);return r.getSWebTwain().SetDPI(a,t,n,o,i)},n.SetViewMode=function(e,t){return r.getSWebTwain().SetViewMode(e,t)},n.GetViewModeH=function(){return r.getSWebTwain().GetViewModeH()},n.GetViewModeV=function(){return r.getSWebTwain().GetViewModeV()},n.MoveImage=function(e,t){var n=parseInt(e),o=parseInt(t);return r.getSWebTwain().MoveImage(n,o)},n.SwitchImage=function(e,t){var n=parseInt(e),o=parseInt(t);return r.getSWebTwain().SwitchImage(n,o)},n.Print=function(){return r.getSWebTwain().Print()},n.checkErrorString=function(){var e=r.ErrorCode;if(-2115===e)return!0;-2003===e&&window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no").document.writeln(r.HTTPPostResponseString);return 0===e},n.FileExists=function(e){var n=t.replaceLocalFilename(e);return r.getSWebTwain().FileExists(n)},n.SaveAllAsMultiPageTIFF=function(e,n,o){var i,a=t.replaceLocalFilename(e);return i=r.getSWebTwain().SaveAllAsMultiPageTIFF(a),t.wrapperRet(r,i,n,o)},n.SaveAllAsPDF=function(e,n,o){var i=t.replaceLocalFilename(e);return _ret=r.getSWebTwain().SaveAllAsPDF(i),t.wrapperRet(r,_ret,n,o)},n.SaveAsBMP=function(e,n,o,i){var a=t.replaceLocalFilename(e);return _ret=r.getSWebTwain().SaveAsBMP(a,n),t.wrapperRet(r,_ret,o,i)},n.SaveAsJPEG=function(e,n,o,i){var a=t.replaceLocalFilename(e);return _ret=r.getSWebTwain().SaveAsJPEG(a,n),t.wrapperRet(r,_ret,o,i)},n.SaveAsPDF=function(e,n,o,i){var a=t.replaceLocalFilename(e);return _ret=r.getSWebTwain().SaveAsPDF(a,n),t.wrapperRet(r,_ret,o,i)},n.SaveAsPNG=function(e,n,o,i){var a=t.replaceLocalFilename(e);return _ret=r.getSWebTwain().SaveAsPNG(a,n),t.wrapperRet(r,_ret,o,i)},n.SaveAsTIFF=function(e,n,o,i){var a=t.replaceLocalFilename(e);return _ret=r.getSWebTwain().SaveAsTIFF(a,n),t.wrapperRet(r,_ret,o,i)},n.SaveSelectedImagesAsMultiPagePDF=function(e,n,o){var i,a=t.replaceLocalFilename(e);return i=r.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(a),t.wrapperRet(r,i,n,o)},n.SaveSelectedImagesAsMultiPageTIFF=function(e,n,o){var i,a=t.replaceLocalFilename(e);return i=r.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(a),t.wrapperRet(r,i,n,o)},n.SaveSelectedImagesToBase64Binary=function(){return r.getSWebTwain().SaveSelectedImagesToBase64Binary()},n.ShowFileDialog=function(e,t,n,o,i,a,s,u){return r.getSWebTwain().ShowFileDialog(e,t,n,o,i,a,s,u)},n.FTPDownload=function(e,n,o,i){var a=r.getSWebTwain().FTPDownload(e,n);return t.wrapperRet(r,a,o,i)},n.FTPDownloadDirectly=function(e,n,o,i,a){var s=r.getSWebTwain().FTPDownloadDirectly(e,n,o);return t.wrapperRet(r,s,i,a)},n.FTPDownloadEx=function(e,n,o,i,a){var s=r.getSWebTwain().FTPDownloadEx(e,n,o);return t.wrapperRet(r,s,i,a)},n.FTPUpload=function(e,n,o,i,a){var s=r.getSWebTwain().FTPUpload(e,n,o);return t.wrapperRet(r,s,i,a)},n.FTPUploadDirectly=function(e,n,o,i,a){var s=r.getSWebTwain().FTPUploadDirectly(e,n,o);return t.wrapperRet(r,s,i,a)},n.FTPUploadEx=function(e,n,o,i,a,s){var u=r.getSWebTwain().FTPUploadEx(e,n,o,i);return t.wrapperRet(r,u,a,s)},n.FTPUploadAllAsMultiPageTIFF=function(e,n,o,i){var a=r.getSWebTwain().FTPUploadAllAsMultiPageTIFF(e,n);return t.wrapperRet(r,a,o,i)},n.FTPUploadAllAsPDF=function(e,n,o,i){var a=r.getSWebTwain().FTPUploadAllAsPDF(e,n);return t.wrapperRet(r,a,o,i)},n.FTPUploadAsMultiPagePDF=function(e,n,o,i){var a=r.getSWebTwain().FTPUploadAsMultiPagePDF(e,n);return t.wrapperRet(r,a,o,i)},n.FTPUploadAsMultiPageTIFF=function(e,n,o,i){var a=r.getSWebTwain().FTPUploadAsMultiPageTIFF(e,n);return t.wrapperRet(r,a,o,i)},n.HTTPDownload=function(e,n,o,i){var a=t.getImageType(n);return r.HTTPDownloadEx(e,n,a,o,i)},n.HTTPDownloadDirectly=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPDownloadDirectly(e,n,o),t.wrapperRet(r,s,i,a)},n.HTTPDownloadEx=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPDownloadEx(e,n,o),t.wrapperRet(r,s,i,a)},n.HTTPUploadThroughPostDirectly=function(e,n,o,i,a,s){var u;return u=r.getSWebTwain().HTTPUploadThroughPostDirectly(e,n,o,i),t.wrapperRet(r,u,a,s,!0)},n.HTTPUploadThroughPost=function(e,n,o,i,a,s){var u;return u=r.getSWebTwain().HTTPUploadThroughPost(e,n,o,i),t.wrapperRet(r,u,a,s,!0)},n.HTTPUploadThroughPostEx=function(e,n,o,i,a,s,u){var l;return l=r.getSWebTwain().HTTPUploadThroughPostEx(e,n,o,i,a),t.wrapperRet(r,l,s,u,!0)},n.ClearAllHTTPFormField=function(){return r.getSWebTwain().ClearAllHTTPFormField(),t.checkErrorString(r)},n.SetHTTPFormField=function(e,n){return r.getSWebTwain().SetHTTPFormField(e,n),t.checkErrorString(r)},n.HTTPUploadAllThroughPostAsMultiPageTIFF=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(e,n,o),t.wrapperRet(r,s,i,a,!0)},n.HTTPUploadThroughPostAsMultiPageTIFF=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(e,n,o),t.wrapperRet(r,s,i,a,!0)},n.HTTPUploadAllThroughPostAsPDF=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPUploadAllThroughPostAsPDF(e,n,o),t.wrapperRet(r,s,i,a,!0)},n.HTTPUploadThroughPostAsMultiPagePDF=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(e,n,o),t.wrapperRet(r,s,i,a,!0)},n.HTTPUploadThroughPutDirectly=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPUploadThroughPutDirectly(e,n,o),t.wrapperRet(r,s,i,a)},n.HTTPUploadThroughPut=function(e,n,o,i,a){var s=t.getImageType(o);return r.HTTPUploadThroughPutEx(e,n,o,s,i,a)},n.HTTPUploadThroughPutEx=function(e,n,o,i,a,s){var u;return u=r.getSWebTwain().HTTPUploadThroughPutEx(e,n,o,i),t.wrapperRet(r,u,a,s)},n.HTTPUploadAllThroughPutAsMultiPageTIFF=function(e,t,n,o){return r.HTTPUploadThroughPutEx(e,-1,t,2,n,o)},n.HTTPUploadThroughPutAsMultiPageTIFF=function(e,t,n,o){return r.HTTPUploadThroughPutEx(e,-2,t,2,n,o)},n.HTTPUploadAllThroughPutAsPDF=function(e,t,n,o){return r.HTTPUploadThroughPutEx(e,-1,t,4,n,o)},n.HTTPUploadThroughPutAsMultiPagePDF=function(e,t,n,o){return r.HTTPUploadThroughPutEx(e,-2,t,4,n,o)},n.ShowImageEditor=function(){return r.getSWebTwain().ShowImageEditor()},n.SetCookie=function(e){return r.getSWebTwain().SetCookie(e),!0},n.LoadImageFromBase64Binary=function(e,t){return r.getSWebTwain().LoadImageFromBase64Binary(e,t)},n.SaveSelectedImagesToBytes=function(e,t){return r.getSWebTwain().SaveSelectedImagesToBytes(e,t)},n.LoadImageFromBytes=function(e,t,n){return r.getSWebTwain().LoadImageFromBytes(e,t,n)},n.UnregisterEvent=function(e,t){return r.getSWebTwain().UnregisterEvent(e,t)},n.SetImageWidth=function(e,t){return r.getSWebTwain().SetImageWidth(e,t)},n.HTTPDownloadThroughPost=function(e,n,o,i,a){var s;return s=r.getSWebTwain().HTTPDownloadThroughPost(e,n,o),t.wrapperRet(r,s,i,a)},n.SetCustomDSDataEx=function(e){return r.getSWebTwain().SetCustomDSDataEx(e)},n.SetCustomDSData=function(e){return r.getSWebTwain().SetCustomDSData(e)},n.GetCustomDSDataEx=function(){return r.getSWebTwain().GetCustomDSDataEx()},n.GetCustomDSData=function(e){return r.getSWebTwain().GetCustomDSData(e)},n.ChangeBitDepth=function(e,t,n){return r.getSWebTwain().ChangeBitDepth(e,t,n)},n.ConvertToGrayScale=function(e){return r.getSWebTwain().ConvertToGrayScale(e)},n.ShowImageEditorEx=function(e,t,n,o,i){return r.getSWebTwain().ShowImageEditorEx(e,t,n,o,i)},n.ClearTiffCustomTag=function(){return r.getSWebTwain().ClearTiffCustomTag(),t.checkErrorString(r)},n.SetTiffCustomTag=function(e,n,o){return r.getSWebTwain().SetTiffCustomTag(e,n,o),t.checkErrorString(r)},n.IsBlankImageExpress=function(e){return r.getSWebTwain().IsBlankImageExpress(e)},n._ChangeWidth=function(t){var o,i=document.getElementById(n._strDWTInnerContainerID);if(e.isString(t)&&t.length>0&&"%"===t.charAt(t.length-1)&&(o=t),!o){var a=parseInt(t);a&&a>2&&(o=a-2+"px")}return o&&(r._strWidth=o,r.getSWebTwain().style.width=o,i&&(i.style.width=o)),!0},n._ChangeHeight=function(t){var o,i=document.getElementById(n._strDWTInnerContainerID);if(e.isString(t)&&t.length>0&&"%"===t.charAt(t.length-1)&&(o=t),!o){var a=parseInt(t);a&&(o=a+"px")}return o&&(r._strHeight=o,r.getSWebTwain().style.height=o,i&&(i.style.height=o)),!0},n.SetSize=function(e,t){return this._ChangeWidth(e),this._ChangeHeight(t),!0},n.SetSelectedImageArea=function(e,t,n,o,i){return r.getSWebTwain().SetSelectedImageArea(e,t,n,o,i)},n.SetVideoRotateMode=function(e){return r.getSWebTwain().SetVideoRotateMode(e)},n.SetOpenSourceTimeout=function(e){return r.getSWebTwain().SetOpenSourceTimeout(e)},n.GetLicenseInfo=function(){return{}},n.SetHTTPHeader=function(e,t){return!1},n.GetImageURL=function(e,t,n){return""},n.LoadDibFromClipboard=function(e,n){var o;return o=r.getSWebTwain().LoadDibFromClipboard(),t.wrapperRet(r,o,e,n)},n.LoadImage=function(e,n,o){var i,a=t.replaceLocalFilename(e);return i=r.getSWebTwain().LoadImage(a),t.wrapperRet(r,i,n,o)},n.LoadImageEx=function(e,n,o,i){var a,s=t.replaceLocalFilename(e),u=n;return u==EnumDWT_ImageType.IT_ALL&&(u=-1),a=r.getSWebTwain().LoadImageEx(s,u),t.wrapperRet(r,a,o,i)},n.EnableSource=function(e,t,n){return r.AcquireImage(e,t,n)},n.AcquireImage=function(t,n,o){var i,a=r.getSWebTwain(),s=null;(e.isUndefined(o)&&(e.isFunction(t)&&e.isFunction(n)||e.isFunction(t)&&e.isUndefined(n)||e.isFunction(t)&&null==n||null==t&&e.isFunction(n))?(s=null,e.isFunction(t)&&t,e.isFunction(n)&&n):(e.isUndefined(t)||(s=t),e.isFunction(n)&&n,e.isFunction(o)&&o),null!=s)&&(null!=(i=s.SelectSourceByIndex)&&void 0!==i&&(a.SelectSourceByIndex(i),a.CloseSource(),a.OpenSource()),null!=(i=s.IfShowUI)&&void 0!==i&&(a.IfShowUI=i),null!=(i=s.PixelType)&&void 0!==i&&(a.PixelType=i),null!=(i=s.Resolution)&&void 0!==i&&(a.Resolution=i),null!=(i=s.IfFeederEnabled)&&void 0!==i&&(a.IfFeederEnabled=i),null!=(i=s.IfDuplexEnabled)&&void 0!==i&&(a.IfDuplexEnabled=i),null!=(i=s.IfDisableSourceAfterAcquire)&&void 0!==i&&(a.IfDisableSourceAfterAcquire=i));return a.AcquireImage()},n._innerFun=function(e,t,n){var o=r.getSWebTwain(),i=o[e];return"function"==typeof i?i.apply(o,t):i},n.ActiveUI=function(e,t){},n.first=function(){return r.HowManyImagesInBuffer>0&&(r.CurrentImageIndexInBuffer=0,r.__innerRefreshImage()),!0},n.previous=function(){var e;return r.HowManyImagesInBuffer>0&&(e=r.CurrentImageIndexInBuffer)>0&&(r.CurrentImageIndexInBuffer=e-1,r.__innerRefreshImage()),!0},n.next=function(){var e,t=r.HowManyImagesInBuffer;return t>0&&(e=r.CurrentImageIndexInBuffer)>=0&&e<t-1&&(r.CurrentImageIndexInBuffer=e+1,r.__innerRefreshImage()),!0},n.last=function(){var e=r.HowManyImagesInBuffer;return e>0&&(r.CurrentImageIndexInBuffer=e-1,r.__innerRefreshImage()),!0},n.__innerRefreshImage=function(){var e,t=r.HowManyImagesInBuffer;t>0&&(e=r.CurrentImageIndexInBuffer,r.__OnRefreshUI&&r.__OnRefreshUI(e,t))},n._attachEvents=function(){var e,t=r.getSWebTwain();(e=Dynamsoft.Lib.detect.getVersionArray(new String(r.VersionInfo))).length<=2||e[0]<9||9==e[0]&&e[1]<=2||(""!=r.__OnPostTransfer&&t.RegisterEvent("OnPostTransfer",r.__OnPostTransfer),""!=r.__OnPostAllTransfers&&t.RegisterEvent("OnPostAllTransfers",r.__OnPostAllTransfers),""!=r.__OnMouseClick&&t.RegisterEvent("OnMouseClick",r.__OnMouseClick),""!=r.__OnPostLoad&&t.RegisterEvent("OnPostLoad",r.__OnPostLoad),""!=r.__OnImageAreaSelected&&t.RegisterEvent("OnImageAreaSelected",r.__OnImageAreaSelected),""!=r.__OnMouseDoubleClick&&t.RegisterEvent("OnMouseDoubleClick",r.__OnMouseDoubleClick),""!=r.__OnMouseRightClick&&t.RegisterEvent("OnMouseRightClick",r.__OnMouseRightClick),""!=r.__OnTopImageInTheViewChanged&&t.RegisterEvent("OnTopImageInTheViewChanged",r.__OnTopImageInTheViewChanged),""!=r.__OnImageAreaDeSelected&&t.RegisterEvent("OnImageAreaDeSelected",r.__OnImageAreaDeSelected),""!=r.__OnGetFilePath&&t.RegisterEvent("OnGetFilePath",r.__OnGetFilePath),""!=r.__OnAfterOperate&&t.RegisterEvent("OnAfterOperate",r.__OnAfterOperate),""!=r.__OnBeforeOperate&&t.RegisterEvent("OnBeforeOperate",r.__OnBeforeOperate),""!=r.__OnOperateStatus&&t.RegisterEvent("OnOperateStatus",r.__OnOperateStatus),""!=r.__OnBitmapChanged&&t.RegisterEvent("OnBitmapChanged",r.__OnBitmapChanged),""!=r.__OnMouseMove&&t.RegisterEvent("OnMouseMove",r.__OnMouseMove),""!=r.__OnPreAllTransfers&&t.RegisterEvent("OnPreAllTransfers",r.__OnPreAllTransfers),""!=r.__OnPreTransfer&&t.RegisterEvent("OnPreTransfer",r.__OnPreTransfer),""!=r.__OnSourceUIClose&&t.RegisterEvent("OnSourceUIClose",r.__OnSourceUIClose),""!=r.__OnTransferCancelled&&t.RegisterEvent("OnTransferCancelled",r.__OnTransferCancelled),""!=r.__OnTransferError&&t.RegisterEvent("OnTransferError",r.__OnTransferError),""!=r.__OnInternetTransferPercentage&&t.RegisterEvent("OnInternetTransferPercentage",r.__OnInternetTransferPercentage),""!=r.__OnInternetTransferPercentageEx&&t.RegisterEvent("OnInternetTransferPercentageEx",r.__OnInternetTransferPercentageEx))}}}}(Dynamsoft.Lib),function(e){if(e.product.bActiveXEdition){var t=function(t){if(e.isFunction(e.detect.onNoControl))e.detect.onNoControl(t._strDWTControlContainerID,t._strWidth,t._strHeight);else for(var n=e.detect.arySTwains,r=0;r<n.length;r++){var o=n[r];o._vPluginExist||(o._createNonInstallDivPlugin(),e.show(o._strDWTNonInstallInnerContainerID),e.hide(o._strDWTInnerContainerID))}};n.prototype._createControl=function(){var t,n,r=this,o=r._strWidth,i=r._strHeight;e.isString(o)&&(o=o.indexOf("%")>0?"100%":parseInt(o)+2+"px"),e.isString(i)&&(i=i.indexOf("%")>0?"100%":parseInt(i)+2+"px"),(n=Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB?['<div id="',r._strDWTInnerContainerID,'" style="width:',o,";height:",i,'">','<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' codebase="',e.env.bWin64?e.product.getActiveXCABx64Path():e.product.getActiveXCABx86Path(),"#version=",Dynamsoft.WebTwainEnv.ActiveXVersion,'"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?e.product.strTrialClassID:e.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>","</div>"]:['<div id="',r._strDWTInnerContainerID,'" style="width:',o,";height:",i,'">','<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?e.product.strTrialClassID:e.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>","</div>"]).push('<div id="',r._strDWTNonInstallInnerContainerID,'" style="width: ',o,';display:none"></div>'),(t=document.getElementById(r._strDWTControlContainerID))&&(t.innerHTML=n.join("")),r._fakeControl._objWebTwain=null,r._fakeControl.getSWebTwain=function(){return null===this._objWebTwain&&(this._objWebTwain=document.getElementById(r._strObjectName)),this._objWebTwain}},n.prototype.getInstance=function(){return!!this._fakeControl.getSWebTwain()&&this._fakeControl},e.detect._controlDetect=function(){var n=e.detect.arySTwains,r=n[0],o=r&&r._fakeControl&&r._fakeControl.getSWebTwain();if(o)if(0==o.ErrorCode){clearInterval(e.detect._varSeed);for(var i=0;i<n.length;i++){var a=n[i],s=a._fakeControl.getSWebTwain();e.__innerInitEvents(a._fakeControl,a.__config),a._fakeControl.__OnRefreshUI=a.__config.onRefreshUI||"",e.attachProperty(a._fakeControl),e.attachMethod(a._fakeControl),a._fakeControl._attachEvents(),e.attachAddon(a._fakeControl),s.ProductKey=Dynamsoft.WebTwainEnv.ProductKey,s.BrokerProcessType=e.product._iBrokerProcessType,e.env.bWin||(a._objectWebTwain.ImageCaptureDriverType=e.product._iImageCaptureDriverType),e.isFunction(a.__OnPluginReady)&&a.__OnPluginReady()}}else Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB||e.detect.bNoControlEvent||(t(r),e.detect.bNoControlEvent=!0),e.isFunction(o.__OnPluginNotReady)&&o.__OnPluginNotReady();else clearInterval(e.detect._varSeed)},e.ie={},e.ie.DynamicWebTwain=function(t){var r=new n(t);return e.detect.arySTwains.push(r),r},e.ie.closeAll=function(){var t,n,r,o=e.detect.arySTwains;for(t=0;t<o.length;t++)(n=o[t])&&n._fakeControl&&(r=n._fakeControl.getSWebTwain())&&0==r.ErrorCode&&r.RemoveAllImages();e.detect.arySTwains=[]},Dynamsoft.WebTwainEnv.RemoveAllAuthorizations=function(){return!1}}function n(t){var n=this,r=t||{};n._strDWTControlContainerID=r.containerID||"dwtcontrolContainer",n._strWidth=r.width||270,n._strHeight=r.height||350,e.isString(n._strWidth)&&n._strWidth.indexOf("%")>0||(n._strWidth=[parseInt(n._strWidth),"px"].join("")),e.isString(n._strHeight)&&n._strHeight.indexOf("%")>0||(n._strHeight=[parseInt(n._strHeight),"px"].join("")),n._strObjectName=n._strDWTControlContainerID+"_Obj",n.__config=r,n.__OnPluginReady=r.onPluginReady,n.__OnPluginNotReady=r.onPluginNotReady,n.Addon={},n._strDWTInnerContainerID=n._strDWTControlContainerID+"_CID",n._strDWTNonInstallInnerContainerID=n._strDWTControlContainerID+"_NonInstallCID";var o=document.createElement("div");document.body.appendChild(o),n._fakeControl=o,n._createControl()}}(Dynamsoft.Lib),function(e){if(e.product.bPluginEdition){var t=function(t){if(e.isFunction(e.detect.onNoControl))e.detect.onNoControl(t._strDWTControlContainerID,t._strWidth,t._strHeight);else for(var n=e.detect.arySTwains,r=0;r<n.length;r++){var o=n[r];o._vPluginExist||(o._createNonInstallDivPlugin(),e.show(o._strDWTNonInstallInnerContainerID),e.hide(o._strDWTInnerContainerID))}};n.prototype.getSWebTwain=function(){return this._objectWebTwain},n.prototype.getInstance=function(){return!!this._objectWebTwain&&this},n.prototype._createControl=function(){var t,n,r=this,o=r._strWidth,i=r._strHeight;if(e.isString(o)&&(o=o.indexOf("%")>0?"100%":parseInt(o)+2+"px"),e.isString(i)&&(i=i.indexOf("%")>0?"100%":parseInt(i)+2+"px"),n=['<div id="',r._strDWTInnerContainerID,'" style="width:',o,";height:",i,'">'],e.env.bIE)Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB?n.push('<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' codebase="',e.env.bWin64?e.product.getActiveXCABx64Path():e.product.getActiveXCABx86Path(),"#version=",Dynamsoft.WebTwainEnv.ActiveXVersion,'"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?e.product.strTrialClassID:e.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>"):n.push('<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?e.product.strTrialClassID:e.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>");else{var a=r._strWidth;e.isString(a)&&-1==a.indexOf("%")&&(a=parseInt(a)-2+"px"),n.push('<embed id="',r._strObjectName,'" style="display: inline; width:',a,";height:",r._strHeight,'" type="',e.product.strMIMEType,'"',' pluginspage="',e.env.bWin?e.product.getMSIPath():e.product.getPKGPath(),'"></embed>')}n.push('</div><div id="',r._strDWTNonInstallInnerContainerID,'" style="width: ',o,';display:none"></div>'),(t=document.getElementById(r._strDWTControlContainerID))&&(t.innerHTML=n.join("")),r._objectWebTwain=document.getElementById(r._strObjectName)},n.prototype._notAllowedForChrome=function(){e.env.bIE||(ua=navigator.userAgent.toLowerCase(),ua.match(/chrome\/([\d.]+)/)&&(this.__OnNotAllowedForChrome?this.__OnNotAllowedForChrome(_this._strDWTInnerContainerID):(this._createNonAllowedDivPlugin(),document.getElementById(this._strDWTNonInstallInnerContainerID).style.display="inline",document.getElementById(this._strDWTInnerContainerID).style.display="none")))},n.prototype._createNonAllowedDivPlugin=function(){var t=this;if(""==(o=document.getElementById(t._strDWTNonInstallInnerContainerID)).innerHTML){var n=t._strHeight;e.isString(n)&&-1==n.indexOf("%")&&(n=parseInt(n)-10+"px");var r=['<div style="display: block; border:1px solid black; width:',t._strWidth,";height:",n,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.</div>",'<div>Please click <img src="',Dynamsoft.WebTwainEnv.ResourcesPath+'/reference/imgs/plug-in-blocked.png"/>','at the right end of the address bar and click "<b>Always allow plug-ins</b>". Then refresh/restart the browser.</div>',"</div></div>"].join("");o.innerHTML=r;for(var i=0;i<document.links.length;i++)"DWT_CloseNonAllowedDiv"==document.links[i].className&&(document.links[i].onclick=function(){document.getElementById(t._strDWTNonInstallInnerContainerID).style.display="none",document.getElementById(t._strDWTInnerContainerID).style.display="inline"})}},n.prototype._createNonInstallDivPlugin=function(){var t=document.getElementById(this._strDWTNonInstallInnerContainerID);if(""==t.innerHTML){var n="";if(Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB&&e.env.bIE)var r=["<div style='display: block; border:solid black 1px; text-align:center; width:",this._strWidth,";height:",this._strHeight,"'>","<ul style='padding-top:100px;'>","<li>The Component is not installed</li>","<li>You need to download and install the ActiveX to use this sample.</li>","<li>Please follow the instructions in the information bar.</li>","</ul></div>"].join("");else{location.protocol;n=e.product.bChromeEdition?e.product.getChromeEditionPath():!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB&&e.env.bIE?e.env.bWin64?e.product.getActiveXCABx64Path():e.product.getActiveXCABx86Path():e.env.bWin?e.product.getMSIPath():e.product.getPKGPath();r=["<div style='display: block; border:solid black 1px; text-align:center; width:",this._strWidth,";height:",this._strHeight,"'>","<ul style='padding-top:100px;'>","<li>The Component is not installed</li>","<li>You need to download and install to use this sample.</li>","<li>Please click the below link to download it.</li>","<li>After the installation, please RESTART your browser.</li>","<li><a href='",n,"'>Download</a></li>","</ul></div>"].join("")}t.innerHTML=r}},e.detect._controlDetect=function(){var n=e.detect.arySTwains,r=n[0],o=r&&r._objectWebTwain;if(o)if(0==o.ErrorCode){clearInterval(e.detect._varSeed);for(var i=0;i<n.length;i++){var a=n[i];e.attachProperty(a),e.attachMethod(a),a._attachEvents(),e.attachAddon(a),a._objectWebTwain.ProductKey=Dynamsoft.WebTwainEnv.ProductKey,a._objectWebTwain.BrokerProcessType=e.product._iBrokerProcessType,e.env.bWin||(a._objectWebTwain.ImageCaptureDriverType=e.product._iImageCaptureDriverType),e.isFunction(a.__OnPluginReady)&&a.__OnPluginReady()}}else{if(e.env.bIE)Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB||e.detect.bNoControlEvent||(t(r),e.detect.bNoControlEvent=!0);else{var s=!0;if(navigator.plugins.refresh(!1),e.env.iPluginLength!=navigator.plugins.length)for(i=0;i<navigator.mimeTypes.length;i++)navigator.mimeTypes[i].type.toLowerCase().indexOf(e.product.strMIMEType.toLowerCase())>-1&&location.reload();for(i=0;i<navigator.mimeTypes.length;i++)if(navigator.mimeTypes[i].type.toLowerCase().indexOf(e.product.strMIMEType.toLowerCase())>-1)for(var u=0;u<n.length;u++){s=!1,(a=n[u])._vPluginExist=!0,0==a._vNotAllowedForChrome&&(a._notAllowedForChrome(),a._vNotAllowedForChrome=!0)}s&&!e.detect.bNoControlEvent&&(t(r),e.detect.bNoControlEvent=!0)}e.isFunction(r.__OnPluginNotReady)&&r.__OnPluginNotReady()}else clearInterval(e.detect._varSeed)},e.plugin={},e.plugin.DynamicWebTwain=function(t){var r=new n(t);return r._createControl(),e.detect.arySTwains.push(r),r},e.plugin.closeAll=function(){var t,n,r,o=e.detect.arySTwains;for(t=0;t<o.length;t++)(n=o[t])&&n._objectWebTwain&&(r=n._objectWebTwain)&&0==r.ErrorCode&&r.RemoveAllImages();e.detect.arySTwains=[]},Dynamsoft.WebTwainEnv.RemoveAllAuthorizations=function(){return!1}}function n(t){var n=this,r=t||{};n._strDWTControlContainerID=r.containerID||"dwtcontrolContainer",n._strWidth=r.width||270,n._strHeight=r.height||350,e.isString(n._strWidth)&&n._strWidth.indexOf("%")>0||(n._strWidth=[parseInt(n._strWidth),"px"].join("")),e.isString(n._strHeight)&&n._strHeight.indexOf("%")>0||(n._strHeight=[parseInt(n._strHeight),"px"].join("")),n._strObjectName=n._strDWTControlContainerID+"_Obj",e.__innerInitEvents(n,r),n.__OnPluginReady=r.onPluginReady,n.__OnPluginNotReady=r.onPluginNotReady,n.__OnRefreshUI=r.onRefreshUI||"",n._objectWebTwain=null,n._strDWTInnerContainerID=n._strDWTControlContainerID+"_CID",n._strDWTNonInstallInnerContainerID=n._strDWTControlContainerID+"_NonInstallCID",n._vNotAllowedForChrome=!1,n._vPluginExist=!1,n.Addon={}}}(Dynamsoft.Lib),function(e){var t;e.product.bChromeEdition&&(e.LS=(t=!1,e.env.bEdge&&e.env.bFileSystem||(t=!!window.localStorage),{isSupportLS:function(){return t},item:function(e,t){var n=null;return!!this.isSupportLS()&&(t?(localStorage.setItem(e,t),n=t):n=localStorage.getItem(e),null!==n&&n)},removeItem:function(e){return!!this.isSupportLS()&&(localStorage.removeItem(e),!0)}}))}(Dynamsoft.Lib),function(e){if(e.html5=e.html5||{},Dynamsoft.Lib.product.bChromeEdition){var t,n=1,r=2,o=3,i=4,a=7,s=8,u=9,l=10,c=50,d=51,h=52,f=1,g=2,p=3,m=4,_=6,v=9;t=Dynamsoft.Lib.html5.Funs={notSupportProperty:function(e){},notSupportMethod:function(e){},getRandom:function(){for(var e,t=(new Date).getTime()%1e4,n=[],r=0;r<5;r++)e=Math.floor(10*Math.random()),0!=r||0!=e?n.push(e):r=-1;return t<10?n.push("000"):t<100?n.push("00"):t<1e3&&n.push("0"),n.push(t),n.join("")},generateCmdId:function(){return++n},sendData:function(e,t,n,r){var o,i,a,s,u,l,c,d;if(!r){try{e.send(t)}catch(e){Dynamsoft.Lib.log(e)}return!1}for(s=new ArrayBuffer(12),i=n&&n.size?n.size:0,a=(o=(d=new Blob([t])).size)+i,u=new DataView(s),c=0;c<8&&a;c++)u.setUint8(c,a%256),a=parseInt(a/256);for(c=0;c<4&&o;c++)u.setUint8(8+c,o%256),o=parseInt(o/256);return l=new Blob([s,d]),e.send(l),i>0&&e.send(n),!0},init:function(n,r){var o,i,a,s;if((s=[]).push('<dialog id="dialogProgress" class="ds-dwt-dialogProgress" style="top:30%"><h3 id="finalMessage"></h3><p id="status">0%</p>'),Dynamsoft.Lib.env.bIE?s.push('<div id="progressBar" value="" max="100"></div>'):s.push('<progress id="progressBar" value="" max="100"></progress>'),s.push('<br /><button id="btnCancel" value="cancel" autofcus >cancel</button></dialog>'),'<div class="ds-dwt-container-box"></div>',(o=KISSY.one("#"+r)).html(""),o.attr("class",n.containerClass),o.append('<div class="ds-dwt-container-box"></div>'),(a=o.one(".ds-dwt-container-box"))&&(a.style("position","relative"),t.changeImageUISize(n,n._width,n._height)),!e.dlgProgress){if((i=KISSY.one("#dialogProgress"))&&i.remove(),KISSY.one(document.body).append(s.join("")),e.env.bIE)e.get("progressBar").objProgressBar=new e.ProgressBar("progressBar",{width:300,height:20});(i=e.get("dialogProgress"))&&(e.dlgProgress=i,e.Dialog.registerDialog(e.dlgProgress)),e.dlgRef=0,e.dialogShowStatus=!1,e.cancelFrome=0;e.addEventListener(e.get("btnCancel"),"mousedown",function(){var t=e.cancelFrome;e.closeProgress(0),e.bio?(e.bio.abort(),e.bio=!1):3!=t&&4!=t||n.SetCancel()})}t.initImageUI(n,a)},initImageUI:function(e,n){var r,o,i=e._width,a=e._height,s=!1;r=KISSY.one("#"+e._strDWTControlContainerID),Dynamsoft.Lib.isString(i)&&i.indexOf("%")>=0?(i=KISSY.DOM.width(r)*parseInt(i)/100,s=!0):i=parseInt(i),Dynamsoft.Lib.isString(a)&&a.indexOf("%")>=0?(a=KISSY.DOM.height(r)*parseInt(a)/100,s=!0):a=parseInt(a),o={Container:n,Width:i,Height:a},t.bindUIViewEvents(e,o),e._UIManager=new Dynamsoft.Lib.UI.ImageUIManager(e,o),s&&t.changeImageUISize(e,e._width,e._height)},changeImageUISize:function(e,n,r){var o,i,a,s,u=n,l=r,c=!1;o=KISSY.one("#"+e._strDWTControlContainerID),Dynamsoft.Lib.isString(n)&&n.indexOf("%")>=0?(a=KISSY.DOM.width(o)*parseInt(n)/100,c=!0):u=[(a=parseInt(n))+2,"px"].join(""),Dynamsoft.Lib.isString(r)&&r.indexOf("%")>=0?(s=KISSY.DOM.height(o)*parseInt(r)/100,c=!0):l=[(s=parseInt(r))+2,"px"].join(""),o&&(i=o.one(".ds-dwt-container-box"))&&(i.style("width",u),i.style("height",l)),c?(e.__funResize||(e.__funResize=function(){var n=t.__innerGetUIViewRealSize(e._strDWTControlContainerID,e._width,e._height);return!e._UIManager||e._UIManager.ChangeSize(n.width,n.height)}),Dynamsoft.Lib.removeEventListener(window,"resize",e.__funResize),Dynamsoft.Lib.addEventListener(window,"resize",e.__funResize)):e.__funResize&&(Dynamsoft.Lib.removeEventListener(window,"resize",e.__funResize),e.__funResize=!1);var d=t.__innerGetUIViewRealSize(e._strDWTControlContainerID,a,s);return!e._UIManager||e._UIManager.ChangeSize(d.width,d.height)},__innerGetUIViewRealSize:function(e,t,n){var r,o=-1,i=-1;return r=KISSY.one("#"+e),Dynamsoft.Lib.isString(t)&&t.indexOf("%")>=0&&(o=KISSY.DOM.width(r)*parseInt(t)/100),o<0&&t&&(o=parseInt(t)),Dynamsoft.Lib.isString(n)&&n.indexOf("%")>=0&&(i=KISSY.DOM.height(r)*parseInt(n)/100),i<0&&n&&(i=parseInt(n)),{width:o,height:i}},bindUIViewEvents:function(e,n){var r=e;n.onSelected=function(e){var n,o=e.length;o>0?(r.__SelectedImagesCount=o,n=e[o-1],r.__cIndex=n,t.__SetSelectedImages(r,r.__cIndex,e)&&Dynamsoft.Lib.isFunction(r.__OnRefreshUI)&&r.__OnRefreshUI(n)):r.__SelectedImagesCount=0},n.onRefreshUI=function(e){t.__innerRefreshFromUIView(r,e)},n.onResetCurrentIndex=function(e){e>=0&&r.__cIndex!=e&&(r._innerFun("CurrentImageIndexInBuffer",t.makeParams(e)),r.__cIndex=e)},n.onMouseMove=function(e){var t=e.index;if(e){var n=e.x,o=e.y;r.__MouseX=n,r.__MouseY=o}Dynamsoft.Lib.isFunction(r.__OnMouseMove)&&r.__OnMouseMove(t)},n.onMouseClick=function(e){var t=e.index;if(e){var n=e.x,o=e.y;r.__MouseX=n,r.__MouseY=o}Dynamsoft.Lib.isFunction(r.__OnMouseClick)&&r.__OnMouseClick(t)},n.onMouseDoubleClick=function(e){var t=e.index;Dynamsoft.Lib.isFunction(r.__OnMouseDoubleClick)&&r.__OnMouseDoubleClick(t)},n.onMouseRightClick=function(e){var t=e.index;if(e){var n=e.x,o=e.y;r.__MouseX=n,r.__MouseY=o}return!Dynamsoft.Lib.isFunction(r.__OnMouseRightClick)||r.__OnMouseRightClick(t)},n.onImageAreaSelected=function(e){Dynamsoft.Lib.isFunction(r.__OnImageAreaSelected)&&(e.fromScroll||r.__OnImageAreaSelected(e.index,e.left,e.top,e.right,e.bottom))},n.onImageAreaDeSelected=function(e){Dynamsoft.Lib.isFunction(r.__OnImageAreaDeSelected)&&r.__OnImageAreaDeSelected(e)}},__pushElement:function(e,n){if(Dynamsoft.Lib.isString(n))e.push('"'),e.push(n),e.push('"');else if(Dynamsoft.Lib.isArray(n)){var r=!0;e.push("["),Dynamsoft.Lib.each(n,function(n){r?r=!1:e.push(","),t.__pushElement(e,n)}),e.push("]")}else void 0===n?e.push('""'):e.push(n)},makeParams:function(){var e=arguments;if(void 0!==e&&0!==e.length){var n=[];if(1===e.length){var r=e[0];n.push("["),t.__pushElement(n,r),n.push("]")}else if(2===e.length){r=e[0];var o=e[1];n.push("["),t.__pushElement(n,r),n.push(","),t.__pushElement(n,o),n.push("]")}else t.__pushElement(n,Array.prototype.slice.call(e));return n.join("")}},getJson:function(e,t,n,r){var o=[];return o.push("{"),o.push('"id":"'),o.push(e.clientId),o.push('"'),r&&(o.push(',"cmdId":"'),o.push(r),o.push('"')),o.push(',"method":"'),o.push(t),o.push('"'),null!=n&&(o.push(',"parameter":'),o.push(n)),o.push("}"),o.join("")},refreshImageAfterInvokeFun:function(e,t,n){return 1==n},loadHttpBlob:function(e,t,n,r,o,i,a){var s,u=!1;if(s={type:t,url:n,async:r,success:o,error:function(t,n,r){var o,a;if(t&&KISSY.isArray(t)&&t.length>2?(o=t[1],a=t[2]):(o=n,a=r),2==a.state&&0==a.status)if("abort"===a.statusText){Dynamsoft.Lib.Errors.HttpDownloadError(e,!0)}else Dynamsoft.Lib.Errors.HttpDownloadUrlError(e);else Dynamsoft.Lib.Errors.HttpDownloadError(e,!1,o,a.status);Dynamsoft.Lib.isFunction(i)&&i()},complete:function(){Dynamsoft.Lib.bio=!1}},""!=e.HTTPUserName&&(s.username=e.HTTPUserName,s.password=e.HTTPPassword),r?(s.responseType="blob",Dynamsoft.Lib.isFunction(a)&&(s.beforeSend=function(e){e.getNativeXhr().addEventListener("progress",function(e){delete e.totalSize,delete e.position,a(e)},!1)}),u=!0):(Dynamsoft.Lib.env.bIE?(s.responseType="arraybuffer",s.success=function(t,n,r){var i,a;(i=t||r.responseData)&&(a=new Uint8Array(i)),e._errorCode=0,e._errorString="",o(a),e._HowManyImagesInBuffer=e._innerFun("HowManyImagesInBuffer"),e.__cIndex=e._innerFun("CurrentImageIndexInBuffer"),u=!0}):(s.contentType="text/plain; charset=x-user-defined",s.mimeType="text/plain; charset=x-user-defined",s.success=function(t,n,r){var i,a,s;a=(i=r.responseText).length,s=new Uint8Array(a);for(var l=0;l<a;l++)s[l]=i.charCodeAt(l);e._errorCode=0,e._errorString="",o(s),e._HowManyImagesInBuffer=e._innerFun("HowManyImagesInBuffer"),e.__cIndex=e._innerFun("CurrentImageIndexInBuffer"),u=!0}),KISSY.mix(s,{headers:{"X-Requested-With":!1}})),"post"==t){var l,c=e.httpFormFields;if(c)try{l=new FormData,KISSY.each(c,function(e,t){l.append(t,e)}),KISSY.mix(s,{data:l,processData:!1,contentType:!1})}catch(e){}}var d=new KISSY.IO(s);return r&&(Dynamsoft.Lib.bio=d),u},getServerImageUrlPrefix:function(e,t){return[e.httpUrl,"img?id=",e.clientId].join("")},getServerSmallImageUrl:function(e,t,n){var r=[e.httpUrl,"img?id=",e.clientId];return null!=t&&(r.push("&index="),r.push(t)),n?(r.push("&act="),r.push(n)):(r.push("&width="),r.push(e._width/2),r.push("&height="),r.push(e._height/2)),r.join("")},combineUrl:function(e,t,n){var r=[],o=t;return void 0!==o&&void 0!==n&&(Dynamsoft.Lib.isString(o)||(o=new String(t)),0==o.indexOf("http://")?(o=o.replace("http://",""),r.push("http://")):0==o.indexOf("https://")?(o=o.replace("https://",""),r.push("https://")):(0==o.indexOf("//")&&(o=o.replace("//","")),e.IfSSL?r.push("https://"):r.push("http://")),r.push(o),o.indexOf(":")<0&&(""==e.HTTPPort&&(e.HTTPPort=Dynamsoft.Lib.detect.ssl?443:80),(!Dynamsoft.Lib.detect.ssl&&80!=e.HTTPPort||Dynamsoft.Lib.detect.ssl&&443!=e.HTTPPort)&&(r.push(":"),r.push(e.HTTPPort))),0!==n.indexOf("/")&&r.push("/"),r.push(n),r.join(""))},httpPostUpload:function(e,t,n,r,o,i,a,s,u){if(!n||n.size<=0)return Dynamsoft.Lib.Errors.UploadFileCannotEmpty(e),Dynamsoft.Lib.isFunction(u)&&u(),!1;var l,c=e.MaxUploadImageSize,d=n.size,h=n.type;if(d>c&&-1!=c)return Dynamsoft.Lib.Errors.UploadExceededMaxSize(e),Dynamsoft.Lib.isFunction(u)&&u(),!1;""===h||h&&h!=e.HttpContentTypeFieldValue?(l=(n.slice||n.webkitSlice||n.mozSlice).call(n,0,d,e.HttpContentTypeFieldValue)).name=n.name:l=n;return l.remoteFilename=e.__remoteFilename,this.httpUploadByBIO(e,t,l,o,r,i,a,s,u)},httpPostUploadString:function(e,t,n,r,o,i,a,s,u){var l,c;return""==n?(Dynamsoft.Lib.Errors.UploadFileCannotEmpty(e),Dynamsoft.Lib.isFunction(u)&&u(),!1):(c=e.MaxUploadImageSize,n.length>c&&-1!=c?(Dynamsoft.Lib.Errors.UploadExceededMaxSize(e),Dynamsoft.Lib.isFunction(u)&&u(),!1):((l=new Blob([n],{type:"text/plain"})).name=r,this.httpUploadByBIO(e,t,l,o,!0,i,a,s,u)))},httpUploadByBIO:function(t,n,r,o,i,a,s,u,l){var c,d;return Dynamsoft.Lib.bio=new KISSY.BIO({action:n,data:t.httpFormFields,async:i}),(c=Dynamsoft.Lib.bio.get("uploadType"))&&((d=c.get("ajaxConfig"))&&d.headers&&a&&e.mix(d.headers,a),o>=0&&c.set("blockSize",o)),t.__HTTPPostResponseString=!1,Dynamsoft.Lib.bio.on(KISSY.BIO.event.SUCCESS,function(e){Dynamsoft.Lib.bio=!1,e&&Dynamsoft.Lib.isString(e.response)?t.__HTTPPostResponseString=e.response:t.__HTTPPostResponseString="",Dynamsoft.Lib.isFunction(u)&&u(t.__HTTPPostResponseString)}),Dynamsoft.Lib.bio.on(KISSY.BIO.event.ERROR,function(e){var n=e&&e.canceled,r=(e&&e.timeout,!1),o=!1;Dynamsoft.Lib.bio=!1,e&&Dynamsoft.Lib.isString(e.response)?t.__HTTPPostResponseString=e.response:t.__HTTPPostResponseString="",n||(e&&e.msg&&(r=e.msg),e&&e.httpStatus&&(o=e.httpStatus)),Dynamsoft.Lib.Errors.UploadError(t,n,r,o),Dynamsoft.Lib.isFunction(l)&&l(t.__HTTPPostResponseString)}),s&&(Dynamsoft.Lib.bio.on(KISSY.BIO.event.PROGRESS,function(e){delete e.totalSize,delete e.position;var n=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");t._OnPercentDone([0,n,"","http"])}),t._OnPercentDone([0,-1,"uploading...","http"])),Dynamsoft.Lib.bio.upload(r)},httpPutImage:function(t,n,r,o,i,a,s){var u=!0,l={type:"PUT",url:n,hasContent:!0,processData:!1,async:o,data:r,success:i,error:function(){u=!1,e.isFunction(a)&&a()},complete:function(){Dynamsoft.Lib.bio=!1},beforeSend:function(t){e.isFunction(s)&&t.getNativeXhr().upload.addEventListener("progress",function(e){delete e.totalSize,delete e.position,s(e)},!1)}};return""!=t.HTTPUserName&&(l.username=t.HTTPUserName,l.password=t.HTTPPassword),o||KISSY.mix(l,{headers:{"X-Requested-With":!1}}),Dynamsoft.Lib.bio=new KISSY.IO(l),u},dialog:!1,dialogRef:0,showMask:function(e){Dynamsoft.Lib.log("showMask:"+e+"--"+this.dialogRef),0==this.dialogRef&&Dynamsoft.Lib.detect.showMask(),this.dialogRef++},hideMask:function(e){Dynamsoft.Lib.log("hideMask:"+e+"--"+this.dialogRef),this.dialogRef>1?this.dialogRef--:this.dialogRef<=1&&(Dynamsoft.Lib.detect.hideMask(),this.dialog=!1,this.dialogRef=0)},setBtnCancelVisibleForProgress:function(e,t){if(0==Dynamsoft.Lib.cancelFrome&&1==e.__IfShowProgressBar||0!=Dynamsoft.Lib.cancelFrome&&1==e.__IfShowCancelDialogWhenImageTransfer){var n=Dynamsoft.Lib.get("btnCancel");n.style.display=0==t?"none":""}},EVENTS:["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnBitmapChanged","OnGetFilePath","OnPercentDone"],SEND_BACK_EVENTS:["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],handleEvent:function(n,r){var o=r.result[0],i=n._objWS,a=!1;return Dynamsoft.Lib.each(t.EVENTS,function(e,t){if(r.event===e){var o=["_",e].join("");return a=!0,Dynamsoft.Lib.isFunction(n[o])&&n[o](r.result,r),!1}}),a?(Dynamsoft.Lib.log("handled event:"+r.event),Dynamsoft.Lib.each(t.SEND_BACK_EVENTS,function(e,a){return!t.isServerInvalid(n)&&(r.event===e?(Dynamsoft.Lib.log("sendback event:"+r.event),t.sendData(i,t.getJson(n,r.event,t.makeParams(o),0),!1,!0),!1):void 0)})):(Dynamsoft.Lib.each(e.Addon_Events,function(e,t){if(r.event===e){var o=["_",e].join("");return a=!0,Dynamsoft.Lib.isFunction(n[o])&&n[o](r.result),!1}}),a&&(Dynamsoft.Lib.log("handled addon event:"+r.event),Dynamsoft.Lib.each(e.Addon_Sendback_Events,function(e,a){return!t.isServerInvalid(n)&&(r.event===e?(Dynamsoft.Lib.log("sendback addon event:"+r.event),t.sendData(i,t.getJson(n,r.event,t.makeParams(o),0),!1,!0),!1):void 0)}))),a},getImageType:function(e){if(void 0===e)return-1;if(e.length<4)return-1;var t=e.lastIndexOf(".");if(-1===t)return-1;var n=e.slice(t).toLowerCase();return".bmp"===n||".dib"===n?EnumDWT_ImageType.IT_BMP:".jpg"===n||".jpe"===n||".jpeg"===n||".jfif"===n?EnumDWT_ImageType.IT_JPG:".tif"===n||".tiff"===n?EnumDWT_ImageType.IT_TIF:".png"===n?EnumDWT_ImageType.IT_PNG:".pdf"===n?EnumDWT_ImageType.IT_PDF:".gif"===n?6:-1},addImageFileExt:function(e,t){var n;return t==EnumDWT_ImageType.IT_BMP?n=[e,".bmp"].join(""):t==EnumDWT_ImageType.IT_JPG?n=[e,".jpg"].join(""):t==EnumDWT_ImageType.IT_PNG?n=[e,".png"].join(""):t==EnumDWT_ImageType.IT_TIF?n=[e,".tif"].join(""):t==EnumDWT_ImageType.IT_PDF&&(n=[e,".pdf"].join("")),n},autoDiscardBlankImage:function(e,t){if(Dynamsoft.Lib.config.bDiscardBlankImage){var n=e.__cIndex;e.IsBlankImage(n)&&e.RemoveImage(n);var r=["Blank Discard (",t,"): ",e.ErrorString].join("");Dynamsoft.Lib.isFunction(e.__OnPrintMsg)&&e.__OnPrintMsg(r)}},replaceLocalFilename:function(e){var t;return void 0===e?"":(t=(e=new String(e)).replace(/\\/g,"\\\\"),Dynamsoft.Lib.env.bFileSystem&&(t=decodeURI(t)),t)},__innerRefreshFromUIView:function(e,t,n){var r=e;t>=0&&(n||(r.CurrentImageIndexInBuffer=t),r._UIManager.refreshEditor(r._UIManager.GetCurrentImageIndex(),r._UIManager.count())),Dynamsoft.Lib.isFunction(r.__OnRefreshUI)&&r.__OnRefreshUI(t)},__SetSelectedImages:function(e,n,r){return e.__SelectedImagesCount=r.length,void 0===n&&(n=""),e._innerFun("SetSelectedImages",t.makeParams(n,r.join(",")))},GetImageInfo:function(e,n){return e._innerFun("GetImageInfo",t.makeParams(n))},isServerInvalid:function(e){var t,n,r=e;return t=!r.bReady||null===r._objWS,n=r.__bMustUpgradeService,t?Dynamsoft.Lib.Errors.Server_Invalid(r):n&&Dynamsoft.Lib.Errors.MustUpgradeService(r),t||n||-2208==r._errorCode},isHttpServerInvalid:function(e){var t,n,r=e;return t=!r.bReady||null===r.httpUrl,n=r.__bMustUpgradeService,t?Dynamsoft.Lib.Errors.Server_Invalid(r):n&&Dynamsoft.Lib.Errors.MustUpgradeService(r),t||n||-2208==r._errorCode},isExpired:function(e){if(""==e)return!1;var t=this.parseDateFromString(e),n=new Date;return t.getTime()<n.getTime()},isOSOK:function(e){return""==e||"0"==e||(!("windows"!=(e=e.toLowerCase())&&"windows custom"!=e||!Dynamsoft.Lib.env.bWin&&!Dynamsoft.Lib.env.bWin64)||(!("mac os x"!=e||!Dynamsoft.Lib.env.bMac)||!("linux"!=e||!Dynamsoft.Lib.env.bLinux)))},isBrowserOK:function(e){if(""==e||"0"==e)return!0;if(e){if("chrome"==(e=e.toLowerCase())&&Dynamsoft.Lib.env.bChrome)return!0;if("ie"==e&&Dynamsoft.Lib.env.bIE)return!0;if("firefox"==e&&Dynamsoft.Lib.env.bFirefox)return!0}return!1},isBindDomainOK:function(t,n){if(n)return!0;if(e.isUndefined(t)||null==t||""==t||"*"==t||"*.*"==t)return!0;var r=location.hostname,o=!1;if(""==r)return!0;for(var i=r.toLowerCase().split("."),a=i.length,s=t.toLowerCase().split(";"),u=0;u<s.length;u++){var l=s[u];if("*.com"==l){o=!0;break}var c=l.split("."),d=c.length;if(d>0&&d-1<=a){for(var h=!0,f=d-1;f>0;f--)if(f+a-d>=0){if(i[f+a-d]!=c[f]){h=!1;break}}else if("*"!=c[f]){h=!1;break}if(h&&("*"==c[0]||a>=d&&i[a-d]==c[0])){o=!0;break}}}return o},parseDateFromString:function(e){var t,n=e;return n=n.replace(/-/g,"/"),t=Date.parse(n),isNaN(t)&&(t=0),new Date(t)},getEnumLicenseType:function(t){var n=!1,f=!1,g=!1,p=!1,m=!1,_=!1,v=!1,y=!1,I=!1;if(e.isString(t)||e.isNumber(t)){var S=1*t;S==r||S==o?n=!0:S==i?f=!0:S==c?g=!0:S==d?p=!0:S==h?m=!0:S==a?_=!0:S==s?v=!0:S==u?y=!0:S==l&&(I=!0)}return{Core:n,PDFRasterizer:y,Webcam:v,barcode1D:f,QR:g,PDF417:p,DataMatrix:m,OCR:_,OCRPro:I}},getEnumLicenseTypeFor10x:function(t){var n=!1,r=!1,o=!1,i=!1,a=!1,s=!1,u=!1,l=!1;if(e.isString(t)||e.isNumber(t)){var c=1*t;c==f?n=!0:c==g?r=!0:c==p?(o=!0,i=!0,a=!0):c==m?s=!0:c==_?u=!0:c==v&&(l=!0)}return{Core:n,PDFRasterizer:l,Webcam:u,barcode1D:r,QR:o,PDF417:i,DataMatrix:a,OCR:s,OCRPro:!1}},getLicenseType:function(e){var t=!1,n=!1,r=!1,o=!1,i=!1,a=!1,s=!1,u=!1,l=!1;return e&&""!=e&&("html5"==(e=e.toLowerCase())||"win=(aph) or mac=(ph) or linux(h)"==e?t=!0:"1d barcode reader"==e?n=!0:"2d barcode reader(qrcode)"==e?r=!0:"2d barcode reader(pdf417)"==e?o=!0:"2d barcode reader(data matrix)"==e?i=!0:"ocr"==e?a=!0:"webcam"==e?s=!0:"pdf rasterizer"==e?u=!0:"proocr"==e&&(l=!0)),{Core:t,PDFRasterizer:u,Webcam:s,barcode1D:n,QR:r,PDF417:o,DataMatrix:i,OCR:a,OCRPro:l}},isAllowLicenseType:function(e,t,n){var r;return r=parseInt(t)>=12?this.getEnumLicenseType(e):this.getEnumLicenseTypeFor10x(e),n.Core?r.Core:n.PDFRasterizer?r.PDFRasterizer:n.Webcam?r.Webcam:n.barcode1D?r.barcode1D:n.QR?r.QR:n.PDF417?r.PDF417:n.DataMatrix?r.DataMatrix:n.OCR?r.OCR:n.OCRPro?r.OCRPro:r.Core},setNoAllowedLicenseTypeError:function(e,t){t.Core?Dynamsoft.Lib.Errors.LicenseNoCore(e):t.PDFRasterizer?Dynamsoft.Lib.Errors.LicenseNoPDF(e):t.Webcam?Dynamsoft.Lib.Errors.LicenseNoWebcam(e):t.barcode1D?Dynamsoft.Lib.Errors.LicenseNo1D(e):t.QR?Dynamsoft.Lib.Errors.LicenseNo2DQR(e):t.PDF417?Dynamsoft.Lib.Errors.LicenseNo2DPDF417(e):t.DataMatrix?Dynamsoft.Lib.Errors.LicenseNo2DDataMatrix(e):t.OCR?Dynamsoft.Lib.Errors.LicenseNoOCR(e):t.OCRPro?Dynamsoft.Lib.Errors.LicenseNoOCRPro(e):Dynamsoft.Lib.Errors.LicenseEmptyOrInvalid(e)},promptLicenseErr:function(e){if(e.ErrorCode<0){var t=['<div class="dwt-box-title"></div>','<div style="margin:35px 0 0 20px;font-size:16px">',e.ErrorString,"</div>"];Dynamsoft.WebTwainEnv.ShowDialog(392,220,t.join(""))}},checkPDFProductKeyWhenNeeds:function(e,t){if(e.__addon&&e.__addon.PDF){var n=e.__addon.PDF.GetConvertMode();if(4==t&&(1==n||2==n))return this.checkProductKey(e,{PDFRasterizer:!0})}return!0},checkProductKey:function(t,n,r){var o;if(o=TestLicense||t.__licenseInfo,""==Dynamsoft.WebTwainEnv.ProductKey||"******"==Dynamsoft.WebTwainEnv.ProductKey||!o||!e.isArray(o.Detail)||0==o.Detail.length)return e.Errors.LicenseEmptyOrInvalid(t),this.promptLicenseErr(t),!1;var i,a=0,s=0,u=[],l=!1,c=!1,d=!1,h=!1,f=!1,g=t.__bTrial;if(!this.isBindDomainOK(o.Domain,g))return e.Errors.LicenseBadDomain(t),this.promptLicenseErr(t),!1;for(i=0;i<o.Detail.length;i++){var p=o.Detail[i],m=!0;this.isAllowLicenseType(p.EnumLicenseType,p.Version,n)&&(g&&"TRUE"==p.Trial||!g&&"FALSE"==p.Trial?this.isExpired(p.ExpireDate)?u.push(p.ExpireDate):parseInt(p.Version)>=13?this.isBrowserOK(p.Browser)||r?this.isOSOK(p.OS)?(a++,m=!1):d=!0:h=!0:f=!0:g?c=!0:l=!0,m&&s++)}if(a>0)return!0;if(0==s)return this.setNoAllowedLicenseTypeError(t,n),this.promptLicenseErr(t),!1;if(l)return e.Errors.LicenseTrialButServiceFull(t),this.promptLicenseErr(t),!1;if(c)return e.Errors.LicenseFullButServiceTrial(t),this.promptLicenseErr(t),!1;if(u.length>0){var _=0,v="";for(i=0;i<u.length;i++){(y=this.parseDateFromString(u[i])).getTime()>_&&(_=y.getTime(),v=u[i])}if(""!=v){var y=this.parseDateFromString(v);v=this.getLicenseDateString(y)}return e.Errors.LicenseExpired(t,v),this.promptLicenseErr(t),!1}return f?(e.Errors.LicenseLower(t),this.promptLicenseErr(t),!1):h?(Dynamsoft.Lib.env.bEdge?e.Errors.LicenseNoEdge(t):Dynamsoft.Lib.env.bChrome?e.Errors.LicenseNoChrome(t):Dynamsoft.Lib.env.bFirefox?e.Errors.LicenseNoFirefox(t):Dynamsoft.Lib.env.bIE?e.Errors.LicenseNoIE(t):e.Errors.LicenseNotSupportBorwser(t),this.promptLicenseErr(t),!1):d?(Dynamsoft.Lib.env.bWin||Dynamsoft.Lib.env.bWin64?e.Errors.LicenseNotSupportWindows(t):Dynamsoft.Lib.env.bMac?e.Errors.LicenseNotSupportMAC(t):Dynamsoft.Lib.env.bLinux?e.Errors.LicenseNotSupportLinux(t):e.Errors.LicenseNotSupportOS(t),this.promptLicenseErr(t),!1):(e.Errors.LicenseEmptyOrInvalid(t),this.promptLicenseErr(t),!1)},getLicenseDateString:function(e){var t,n=e.getFullYear();return[(t=e.getMonth()+1)>=10?""+t:"0"+t,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",n].join("")},callbacks:[],pushCallback:function(e,n,r){var o={method:e,callback:n,ticks:r};t.callbacks(o)},refreshUIRef:0}}}(Dynamsoft.Lib);var TestLicense=!1,o={Domain:"www.dynamsoft.com; www.aa.com",Detail:[{Trial:"TRUE",OS:"Windows",Browser:"Chrome",EnumLicenseType:3,LicenseType:"win=(aph) or mac=(ph) or linux(h)",Version:"13.x",ExpireDate:"2016-07-26"},{Trial:"TRUE",OS:"Windows",Browser:"Chrome",EnumLicenseType:3,LicenseType:"win=(aph) or mac=(ph) or linux(h)",Version:"13.x",ExpireDate:"2016-07-21"}]};!function(e){if(e.product.bChromeEdition){e.html5=e.html5||{};e.html5.STwainStyle=function(e){var t;this._parent=e,t=this,Object.defineProperty(t,"width",{get:function(){return this._parent._width},set:function(e){this.SetSize(e,!1)}}),Object.defineProperty(t,"height",{get:function(){return this._parent._height},set:function(e){this.SetSize(!1,e)}})},e.html5.STwainStyle.prototype.SetSize=function(e,t){this._parent._innerSetSize(e,t)}}}(Dynamsoft.Lib),function(e,t){if(e.product.bChromeEdition){var n=e.html5.Funs;e.html5.STwain=function(t){var r=this,o=t||{};r.clientId=n.getRandom(),r._strDWTControlContainerID=o.containerID||"dwt-container-"+r.clientId,r._width=o.width,r._height=o.height,r._customIP=!1,r._ssl=e.detect.ssl,r._ip=e.product.ip,o.customIP&&(r._customIP=!0,r._ip=o.ip,r._port=o.port,r._portSSL=o.portSSL),r.containerClass="ds-dwt-container noPadding",n.init(r,r._strDWTControlContainerID),r.objectName=r._strDWTControlContainerID+"_obj",r.bReady=!1,r.httpFormFields={},r._objWS=null,r.__wsRetry=0,r.curCommand=[],r.curCommand_SaveImagesToBytes=[],e.__innerInitEvents(r,o),r.__OnMouseClick=o.onMouseClick||"",r.__OnMouseDoubleClick=o.onMouseDoubleClick||"",r.__OnMouseRightClick=o.onMouseRightClick||"",r.__OnMouseMove=o.onMouseMove||"",r.__OnImageAreaSelected=o.onImageAreaSelected||"",r.__OnImageAreaDeSelected=o.onImageAreaDeSelected||"",r.__OnInternetTransferPercentage=o.onInternetTransferPercentage||"",r.__OnInternetTransferPercentageEx=o.onInternetTransferPercentageEx||"",r.__OnWSReady=o.onWSReady||null,r.__OnWSReconnect=o.onWSReconnect||null,r.__OnWSClose=o.onWSClose||null,r.__OnWSMessage=o.onWSMessage||null,r.__OnWSError=o.onWSError||null,r.__OnPercentDone=o.onPercentDone||"",r.__OnRefreshUI=o.onRefreshUI||"",r.__OnPrintMsg=o.onPrintMsg||"",r.__OnResult=o.onResult||"",r.HTTPPassword=o.HTTPPassword||"",r.HTTPPort=o.HTTPPort||(e.detect.ssl?443:80),r.HTTPUserName=o.HTTPUserName||"",r.__HTTPPostResponseString="",r.__strHttpContentTypeFieldValue="application/octet-stream",r.__IfShowProgressBar=!0,r.__IfShowCancelDialogWhenImageTransfer=!0,r.__cIndex=-1,r._HowManyImagesInBuffer=0,r._errorCode=0,r._errorString="",r.__bLoadingImage=!1,r.__backgroundColor=!1,r.__MouseX=0,r.__MouseY=0,r.__style=new e.html5.STwainStyle(r),r.__addon={},r.__remoteFilename="RemoteFile",r.__sourceName=[],r.__defaultSourceName="",r.__sourceCount=-1,r.__SelectedImagesCount=0,r.__serverId="",r.__fSelectionRectAspectRatio=0,r.__bConnecting=!1,r.__bTrial=Dynamsoft.WebTwainEnv.Trial,r.__licenseInfo=!1,r.__httpHeaderMap=!1,r.__bForceClose=!1,r.__strProductName="",r.__versionInfo="",r.__bMustUpgradeService=!1,r._moduleSize=1048576,r._segementUploadThreshold=524288e3};var r=e.html5.STwain.prototype;r.getInstance=function(){return this},r._OnReady=function(t){var r,o,i=this,a=i._objWS;null!==a&&(i._customIP?r={ip:i._ip,ssl:i._ssl,port:i._ssl?i._portSSL:i._port}:(r=e.detect.urls[e.detect.cUrlIndex]).ip=e.product.ip,o=e.getHttpUrl(r),e.detect.starting=!1,e.detect.bOK=!0,i.bReady=!0,i.__wsRetry=0,a.onopen=null,i.httpUrl=o,a.onmessage=function(t){var r=t.data;if("object"!=typeof r){i.__OnWSMessage&&i.__OnWSMessage(r);var o=r.replace(/\0/g,"");if(o.indexOf("Exception:")>=0||0==o.indexOf("Error")){var a=r,s=!1;d=i.curCommand.pop()||{};return e.log(a+"@"+d.cmd),d.fFun&&(s=d.fFun(a)),void(!s&&e.isFunction(i.__OnPrintMsg)&&i.__OnPrintMsg(a))}try{o=KISSY.JSON.parse(o)}catch(t){e.log(r)}if(o.event)n.handleEvent(i,o);else{if(o.cmdId){var u,l=i.curCommand.length,c=-1;for(u=l-1;u>=0;u--)if(i.curCommand[u].cmdId==o.cmdId){c=u,d=i.curCommand.splice(c,1)[0];break}if(c<0){for(u=(l=i.curCommand_SaveImagesToBytes.length)-1;u>=0;u--)if(i.curCommand_SaveImagesToBytes[u].cmdId==o.cmdId){c=u,d=i.curCommand_SaveImagesToBytes.splice(c,1)[0];break}if(c<0)return}}else d=i.curCommand.pop()||{};if(void 0!==o.exception&&void 0!==o.description?(i._errorCode=o.exception,i._errorString=o.description):(i._errorCode=0,i._errorString=""),"ReadBarcode"==o.method||"OCRRecognize"==o.method||o.request&&"OCRProRecognize"==o.request.method)d.sFun&&d.sFun(o);else{if("ActiveUI"==o.method||"VersionInfo"==o.method||"SaveSelectedImagesToBase64Binary"==o.method){if(d.sFun&&o.result.length>0)return void d.sFun(o.result)}else if(("ShowFileDialog"==o.method||"SplitTiff"==o.method||"SplitPDF"==o.method||"EncodeAsBase64"==o.method)&&d.sFun)return void d.sFun(o.result);if(o.result&&o.result.length&&"1"==o.result[0])d.sFun&&d.sFun();else if(o.exception){s=!1;d.fFun&&(s=d.fFun(i._errorString)),!s&&o.exception&&o.exception<0&&-2115!=o.exception&&e.isFunction(i.__OnPrintMsg)&&i.__OnPrintMsg(i._errorString)}else{d.fFun&&d.fFun(n.__pushElement(["result:"],o.result))}}}}else{var d;(d=i.curCommand_SaveImagesToBytes.shift()||{}).sFun&&d.sFun(r)}},a.onclose=function(){i.bReady=!1,i.__wsRetry=0,e.Errors.Server_Invalid(i),i.__bForceClose||e.page.bUnload||e.detect.starting||(e.detect.aryReconnectSTwains.push(i),setTimeout(e._reconnect,1e3),e.detect.starting=!0),i.__OnWSClose&&i.__OnWSClose(),n.hideMask(!0),e.detect.bOK=!1,i.__bForceClose=!1},a.onerror=function(t){i.bReady=!1,i.__wsRetry=0,e.Errors.Server_Invalid(i),e.detect.bOK=!1,e.page.bUnload||e.detect.starting||(e.detect.aryReconnectSTwains.push(i),setTimeout(e._reconnect,1e3),e.detect.starting=!0),t&&e.log("websocket error: "+t),i.__OnWSError&&i.__OnWSError(),n.hideMask(!0)},t?i._innerActiveUI(function(t){var n,r,a,s,u=i.__serverId;(t&&t.length>=3?(n=t[1],r=t[2],i.__strProductName=r):t&&t.length>=2?n=t[1]:e.log("ActiveUI return parameters error."),r&&((r=r.toLowerCase()).indexOf("trial")>-1?i.__bTrial=!0:i.__bTrial=!1),i.__serverId=n,e.closeProgress("Reconnect"),""!==Dynamsoft.WebTwainEnv.ProductKey&&"******"!==Dynamsoft.WebTwainEnv.ProductKey&&(i.ProductKey=Dynamsoft.WebTwainEnv.ProductKey),u!=n)?(e.Errors.Server_Restarted(i),e.isFunction(i.__OnWSReconnect)&&(a=i._ssl?i._portSSL:i._port,s=e.getWSUrl(i._ip,a,i._ssl),i.__OnWSReconnect(s,o))):(i._errorCode=0,i._errorString="")}):(e.LS.item("D_port",r.port),e.LS.item("D_ssl",r.ssl?"true":"false"),e.attachProperty(i),e.attachAddon(i),i._UIManager.OnReady(),i.SetViewMode(1,1),i._innerActiveUI(function(t){var n,r,o=!1;t&&t.length>=3?(n=t[1],r=t[2],i.__strProductName=r):t&&t.length>=2?(n=t[1],o=!0):(o=!0,e.log("ActiveUI return parameters error.")),r&&((r=r.toLowerCase()).indexOf("trial")>-1?i.__bTrial=!0:i.__bTrial=!1),i.__serverId=n,i.__versionInfo=i._innerFun("VersionInfo"),i.__bMustUpgradeService=o,o||(""!==Dynamsoft.WebTwainEnv.ProductKey&&"******"!==Dynamsoft.WebTwainEnv.ProductKey&&(i.ProductKey=Dynamsoft.WebTwainEnv.ProductKey),i.LogLevel=0),e.isFunction(i.__OnWSReady)&&i.__OnWSReady(i)})))},r.__unload=function(){var e,t=this._strDWTControlContainerID,n=document.getElementById(t);this._UIManager&&this._UIManager.clear(),this.bReady&&((e=this._objWS)&&(this.__bForceClose=!0,e.close(),this.curCommand.splice(0),delete this._objWS),this.bReady=!1),n&&(n.innerHTML="")}}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=e.html5.Funs;e.DynamicLoadAddonFuns=[],e.attachAddon=function(t){e.each(e.DynamicLoadAddonFuns,function(n){e.isFunction(n)&&n(t)})},Dynamsoft.Lib.attachProperty=function(n){var r=n;Object.defineProperty(r,"ErrorCode",{get:function(){return r._errorCode}}),Object.defineProperty(r,"ErrorString",{get:function(){return-2207==r._errorCode&&r.__bMustUpgradeService&&e.Errors.MustUpgradeService(r),0!=r._errorCode?r._errorString:"Successful."}}),Object.defineProperty(r,"LogLevel",{get:function(){return r._innerFun("LogLevel")},set:function(e){var n=1*e;return r._innerFun("LogLevel",t.makeParams(n))}}),Object.defineProperty(r,"Manufacturer",{get:function(){return r._innerFun("Manufacturer")},set:function(e){return r._innerFun("Manufacturer",t.makeParams(e))}}),Object.defineProperty(r,"ProductFamily",{get:function(){return r._innerFun("ProductFamily")},set:function(e){return r._innerFun("ProductFamily",t.makeParams(e))}}),Object.defineProperty(r,"ProductKey",{get:function(){return Dynamsoft.WebTwainEnv.ProductKey},set:function(e){Dynamsoft.WebTwainEnv.ProductKey=e;var n=r._innerFun("ProductKey",t.makeParams(e));return r.__licenseInfo=!1,r.GetLicenseInfo(),n}}),Object.defineProperty(r,"ProductName",{get:function(){return r.__strProductName},set:function(e){return r.__strProductName=e,!0}}),Object.defineProperty(r,"VersionInfo",{get:function(){return r.__versionInfo}}),Object.defineProperty(r,"BitDepth",{get:function(){return r._innerFun("BitDepth")},set:function(e){return r._innerFun("BitDepth",t.makeParams(e))}}),Object.defineProperty(r,"Brightness",{get:function(){return r._innerFun("Brightness")},set:function(e){return r._innerFun("Brightness",t.makeParams(e))}}),Object.defineProperty(r,"Contrast",{get:function(){return r._innerFun("Contrast")},set:function(e){return r._innerFun("Contrast",t.makeParams(e))}}),Object.defineProperty(r,"CurrentSourceName",{get:function(){return r._innerFun("CurrentSourceName")}}),Object.defineProperty(r,"DataSourceStatus",{get:function(){return r._innerFun("DataSourceStatus")}}),Object.defineProperty(r,"DefaultSourceName",{get:function(){return""!=r.__defaultSourceName&&-1!=r.__sourceCount||r.SourceCount,r.__defaultSourceName}}),Object.defineProperty(r,"Duplex",{get:function(){return r._innerFun("Duplex")}}),Object.defineProperty(r,"IfAppendImage",{get:function(){return r._innerFun("IfAppendImage")},set:function(e){return r._innerFun("IfAppendImage",t.makeParams(e))}}),Object.defineProperty(r,"IfAutoBright",{get:function(){return r._innerFun("IfAutoBright")},set:function(e){return r._innerFun("IfAutoBright",t.makeParams(e))}}),Object.defineProperty(r,"IfAutoDiscardBlankpages",{get:function(){return r._innerFun("IfAutoDiscardBlankpages")},set:function(e){return r._innerFun("IfAutoDiscardBlankpages",t.makeParams(e))}}),Object.defineProperty(r,"IfAutoFeed",{get:function(){return r._innerFun("IfAutoFeed")},set:function(e){return r._innerFun("IfAutoFeed",t.makeParams(e))}}),Object.defineProperty(r,"IfAutomaticBorderDetection",{get:function(){return r._innerFun("IfAutomaticBorderDetection")},set:function(e){return r._innerFun("IfAutomaticBorderDetection",t.makeParams(e))}}),Object.defineProperty(r,"IfAutomaticDeskew",{get:function(){return r._innerFun("IfAutomaticDeskew")},set:function(e){return r._innerFun("IfAutomaticDeskew",t.makeParams(e))}}),Object.defineProperty(r,"IfAutoScan",{get:function(){return r._innerFun("IfAutoScan")},set:function(e){return r._innerFun("IfAutoScan",t.makeParams(e))}}),Object.defineProperty(r,"IfDisableSourceAfterAcquire",{get:function(){return r._innerFun("IfDisableSourceAfterAcquire")},set:function(e){return r._innerFun("IfDisableSourceAfterAcquire",t.makeParams(e))}}),Object.defineProperty(r,"IfDuplexEnabled",{get:function(){return r._innerFun("IfDuplexEnabled")},set:function(e){return r._innerFun("IfDuplexEnabled",t.makeParams(e))}}),Object.defineProperty(r,"IfFeederEnabled",{get:function(){return r._innerFun("IfFeederEnabled")},set:function(e){return r._innerFun("IfFeederEnabled",t.makeParams(e))}}),Object.defineProperty(r,"IfFeederLoaded",{get:function(){return r._innerFun("IfFeederLoaded")}}),Object.defineProperty(r,"IfModalUI",{get:function(){return r._innerFun("IfModalUI")},set:function(e){return r._innerFun("IfModalUI",t.makeParams(e))}}),Object.defineProperty(r,"IfPaperDetectable",{get:function(){return r._innerFun("IfPaperDetectable")}}),Object.defineProperty(r,"IfScanInNewThread",{get:function(){return r._innerFun("IfScanInNewThread")},set:function(e){return r._innerFun("IfScanInNewThread",t.makeParams(e))}}),Object.defineProperty(r,"IfShowCancelDialogWhenImageTransfer",{get:function(){return r.__IfShowCancelDialogWhenImageTransfer},set:function(e){return r.__IfShowCancelDialogWhenImageTransfer=e}}),Object.defineProperty(r,"IfShowUI",{get:function(){return r._innerFun("IfShowUI")},set:function(e){return r._innerFun("IfShowUI",t.makeParams(e))}}),Object.defineProperty(r,"IfShowIndicator",{get:function(){return r._innerFun("IfShowIndicator")},set:function(e){return r._innerFun("IfShowIndicator",t.makeParams(e))}}),Object.defineProperty(r,"IfUseTwainDSM",{get:function(){return r._innerFun("IfUseTwainDSM")},set:function(e){return r._innerFun("IfUseTwainDSM",t.makeParams(e))}}),Object.defineProperty(r,"IfUIControllable",{get:function(){return r._innerFun("IfUIControllable")}}),Object.defineProperty(r,"ImageBitsPerPixel",{get:function(){return r._innerFun("ImageBitsPerPixel")}}),Object.defineProperty(r,"ImageCaptureDriverType",{get:function(){return r._innerFun("ImageCaptureDriverType")},set:function(e){return r._innerFun("ImageCaptureDriverType",t.makeParams(e))}}),Object.defineProperty(r,"ImageLayoutDocumentNumber",{get:function(){return r._innerFun("ImageLayoutDocumentNumber")}}),Object.defineProperty(r,"ImageLayoutFrameBottom",{get:function(){return r._innerFun("ImageLayoutFrameBottom")}}),Object.defineProperty(r,"ImageLayoutFrameLeft",{get:function(){return r._innerFun("ImageLayoutFrameLeft")}}),Object.defineProperty(r,"ImageLayoutFrameNumber",{get:function(){return r._innerFun("ImageLayoutFrameNumber")}}),Object.defineProperty(r,"ImageLayoutFrameRight",{get:function(){return r._innerFun("ImageLayoutFrameRight")}}),Object.defineProperty(r,"ImageLayoutFrameTop",{get:function(){return r._innerFun("ImageLayoutFrameTop")}}),Object.defineProperty(r,"ImageLayoutPageNumber",{get:function(){return r._innerFun("ImageLayoutPageNumber")}}),Object.defineProperty(r,"ImageLength",{get:function(){return r._innerFun("ImageLength")}}),Object.defineProperty(r,"ImagePixelType",{get:function(){return r._innerFun("ImagePixelType")}}),Object.defineProperty(r,"ImageWidth",{get:function(){return r._innerFun("ImageWidth")}}),Object.defineProperty(r,"ImageXResolution",{get:function(){return r._innerFun("ImageXResolution")}}),Object.defineProperty(r,"ImageYResolution",{get:function(){return r._innerFun("ImageYResolution")}}),Object.defineProperty(r,"MagData",{get:function(){return r._innerFun("MagData")}}),Object.defineProperty(r,"MagType",{get:function(){return r._innerFun("MagType")}}),Object.defineProperty(r,"PageSize",{get:function(){return r._innerFun("PageSize")},set:function(e){var n=1*e;return r._innerFun("PageSize",t.makeParams(n))}}),Object.defineProperty(r,"PendingXfers",{get:function(){return r._innerFun("PendingXfers")}}),Object.defineProperty(r,"PixelFlavor",{get:function(){return r._innerFun("PixelFlavor")},set:function(e){return r._innerFun("PixelFlavor",t.makeParams(e))}}),Object.defineProperty(r,"PixelType",{get:function(){return r._innerFun("PixelType")},set:function(e){return r._innerFun("PixelType",t.makeParams(e))}}),Object.defineProperty(r,"Resolution",{get:function(){return r._innerFun("Resolution")},set:function(e){var n=1*e;return r._innerFun("Resolution",t.makeParams(n))}}),Object.defineProperty(r,"SourceCount",{get:function(){var e=r._innerFunRaw("GetSourceNames"),t=e.length-1;return 0!=r._errorCode?0:t<=0?(r.__sourceName=[],r.__defaultSourceName="",r.__sourceCount=-1,0):1==t&&""==e[0]?(r.__sourceName=[],r.__defaultSourceName="",r.__sourceCount=0,0):(r.__defaultSourceName=e[e.length-1],e.splice(e.length-1,1),r.__sourceName=e,r.__sourceCount=t,t)}}),Object.defineProperty(r,"TransferMode",{get:function(){return r._innerFun("TransferMode")},set:function(e){return r._innerFun("TransferMode",t.makeParams(e))}}),Object.defineProperty(r,"Unit",{get:function(){return r._innerFun("Unit")},set:function(e){return r._innerFun("Unit",t.makeParams(e))}}),Object.defineProperty(r,"XferCount",{get:function(){return r._innerFun("XferCount")},set:function(e){var n=1*e;return r._innerFun("XferCount",t.makeParams(n))}}),Object.defineProperty(r,"Capability",{get:function(){return r._innerFun("Capability")},set:function(e){return r._innerFun("Capability",t.makeParams(e))}}),Object.defineProperty(r,"CapCurrentIndex",{get:function(){return r._innerFun("CapCurrentIndex")},set:function(e){return r._innerFun("CapCurrentIndex",t.makeParams(e))}}),Object.defineProperty(r,"CapCurrentValue",{get:function(){return r._innerFun("CapCurrentValue")},set:function(e){return r._innerFun("CapCurrentValue",t.makeParams(e))}}),Object.defineProperty(r,"CapDefaultIndex",{get:function(){return r._innerFun("CapDefaultIndex")}}),Object.defineProperty(r,"CapDefaultValue",{get:function(){return r._innerFun("CapDefaultValue")}}),Object.defineProperty(r,"CapDescription",{get:function(){return r._innerFun("CapDescription")},set:function(e){return r._innerFun("CapDescription",t.makeParams(e))}}),Object.defineProperty(r,"CapMaxValue",{get:function(){return r._innerFun("CapMaxValue")},set:function(e){return r._innerFun("CapMaxValue",t.makeParams(e))}}),Object.defineProperty(r,"CapMinValue",{get:function(){return r._innerFun("CapMinValue")},set:function(e){return r._innerFun("CapMinValue",t.makeParams(e))}}),Object.defineProperty(r,"CapNumItems",{get:function(){return r._innerFun("CapNumItems")},set:function(e){return r._innerFun("CapNumItems",t.makeParams(e))}}),Object.defineProperty(r,"CapStepSize",{get:function(){return r._innerFun("CapStepSize")},set:function(e){return r._innerFun("CapStepSize",t.makeParams(e))}}),Object.defineProperty(r,"CapType",{get:function(){return r._innerFun("CapType")},set:function(e){return r._innerFun("CapType",t.makeParams(e))}}),Object.defineProperty(r,"CapValue",{get:function(){return r._innerFun("CapValue")},set:function(e){return r._innerFun("CapValue",t.makeParams(e))}}),Object.defineProperty(r,"CapValueString",{get:function(){return r._innerFun("CapValueString")},set:function(e){return r._innerFun("CapValueString",t.makeParams(e))}}),Object.defineProperty(r,"CapValueType",{get:function(){return r._innerFun("CapValueType")},set:function(e){return r._innerFun("CapValueType",t.makeParams(e))}}),Object.defineProperty(r,"AllowMultiSelect",{get:function(){return r._UIManager.getView().GetAllowMultiSelect()},set:function(e){r._UIManager.getView().SetAllowMultiSelect(e)}}),Object.defineProperty(r,"BackgroundColor",{get:function(){return r._UIManager.GetBackgroundColor()},set:function(e){return r._UIManager.SetBackgroundColor(e)}}),Object.defineProperty(r,"BackgroundFillColor",{get:function(){return r._innerFun("BackgroundFillColor")},set:function(e){return r._innerFun("BackgroundFillColor",t.makeParams(e))}}),Object.defineProperty(r,"BlankImageCurrentStdDev",{get:function(){return r._innerFun("BlankImageCurrentStdDev")},set:function(e){return!1}}),Object.defineProperty(r,"BlankImageMaxStdDev",{get:function(){return r._innerFun("BlankImageMaxStdDev")},set:function(e){return r._innerFun("BlankImageMaxStdDev",t.makeParams(e))}}),Object.defineProperty(r,"BlankImageThreshold",{get:function(){return r._innerFun("BlankImageThreshold")},set:function(e){return r._innerFun("BlankImageThreshold",t.makeParams(e))}}),Object.defineProperty(r,"CurrentImageIndexInBuffer",{get:function(){return r.__cIndex},set:function(e){var n=1*e;return n>=0&&n<r._UIManager.count()&&(n!=r.__cIndex&&r._innerSendCmd("CurrentImageIndexInBuffer",t.makeParams(n)),r.__cIndex=n,r._UIManager.getView().Go(r.__cIndex),t.__innerRefreshFromUIView(r,r.__cIndex,!0)),!0}}),Object.defineProperty(r,"FitWindowType",{get:function(){return r._UIManager.getView().GetFitWindowType()},set:function(e){var t=1*e;return r._UIManager.getView().SetFitWindowType(t)}}),Object.defineProperty(r,"HowManyImagesInBuffer",{get:function(){return r._HowManyImagesInBuffer}}),Object.defineProperty(r,"IfFitWindow",{get:function(){return r._UIManager.getView().GetIfFitWindow()},set:function(e){return e?r._UIManager.getView().SetIfFitWindow(!0):r._UIManager.getView().SetIfFitWindow(!1)}}),Object.defineProperty(r,"ImageMargin",{get:function(){return r._UIManager.getView().GetImageMargin()},set:function(e){return r._UIManager.getView().SetImageMargin(e)}}),Object.defineProperty(r,"MaxImagesInBuffer",{get:function(){return r._innerFun("MaxImagesInBuffer")},set:function(e){return r._innerFun("MaxImagesInBuffer",t.makeParams(e))}}),Object.defineProperty(r,"MouseX",{get:function(){return r.__MouseX}}),Object.defineProperty(r,"MouseY",{get:function(){return r.__MouseY}}),Object.defineProperty(r,"SelectedImagesCount",{get:function(){return r._UIManager.count()<=0?0:0==r.__SelectedImagesCount?1:r.__SelectedImagesCount},set:function(e){var n=1*e;return r._UIManager.count()<=0?n=0:n<1&&(n=1),r.__SelectedImagesCount=n,r._UIManager.getView().SetSelectedImageCount(n),r._innerFun("SelectedImagesCount",t.makeParams(n))}}),Object.defineProperty(r,"SelectionImageBorderColor",{get:function(){return r._UIManager.GetSelectionImageBorderColor()},set:function(e){return r._UIManager.SetSelectionImageBorderColor(e)}}),Object.defineProperty(r,"Zoom",{get:function(){return r._UIManager.getView().GetZoom()},set:function(e){return r._UIManager.getView().SetZoom(e)}}),Object.defineProperty(r,"MouseShape",{get:function(){return r._UIManager.getView().GetMouseShape()==EnumDWT_MouseShape.Hand},set:function(e){var t=EnumDWT_MouseShape.Default;return e&&(t=EnumDWT_MouseShape.Hand),r._UIManager.getView().SetMouseShape(t)}}),Object.defineProperty(r,"HTTPPostResponseString",{get:function(){return r.__HTTPPostResponseString?r.__HTTPPostResponseString:""}}),Object.defineProperty(r,"FTPPassword",{get:function(){return r._innerFun("FTPPassword")},set:function(e){return r._innerFun("FTPPassword",t.makeParams(e))}}),Object.defineProperty(r,"FTPPort",{get:function(){return r._innerFun("FTPPort")},set:function(e){if(""!==e){var n=1*e;return r._innerFun("FTPPort",t.makeParams(n))}}}),Object.defineProperty(r,"FTPUserName",{get:function(){return r._innerFun("FTPUserName")},set:function(e){return r._innerFun("FTPUserName",t.makeParams(e))}}),Object.defineProperty(r,"IfPASVMode",{get:function(){return r._innerFun("IfPASVMode")},set:function(e){return r._innerFun("IfPASVMode",t.makeParams(e))}}),Object.defineProperty(r,"IfShowProgressBar",{get:function(){return r.__IfShowProgressBar},set:function(e){return r.__IfShowProgressBar=e}}),Object.defineProperty(r,"ProxyServer",{get:function(){return r._innerFun("ProxyServer")},set:function(e){return r._innerFun("ProxyServer",t.makeParams(e))}}),Object.defineProperty(r,"IfShowFileDialog",{get:function(){return r._innerFun("IfShowFileDialog")},set:function(e){return r._innerFun("IfShowFileDialog",t.makeParams(e))}}),Object.defineProperty(r,"IfTiffMultiPage",{get:function(){return r._innerFun("IfTiffMultiPage")},set:function(e){return r._innerFun("IfTiffMultiPage",t.makeParams(e))}}),Object.defineProperty(r,"PDFAuthor",{get:function(){return r._innerFun("PDFAuthor")},set:function(e){return r._innerFun("PDFAuthor",t.makeParams(e))}}),Object.defineProperty(r,"PDFCompressionType",{get:function(){return r._innerFun("PDFCompressionType")},set:function(e){return r._innerFun("PDFCompressionType",t.makeParams(e))}}),Object.defineProperty(r,"PDFCreationDate",{get:function(){return r._innerFun("PDFCreationDate")},set:function(e){return r._innerFun("PDFCreationDate",t.makeParams(e))}}),Object.defineProperty(r,"PDFCreator",{get:function(){return r._innerFun("PDFCreator")},set:function(e){return r._innerFun("PDFCreator",t.makeParams(e))}}),Object.defineProperty(r,"PDFKeywords",{get:function(){return r._innerFun("PDFKeywords")},set:function(e){return r._innerFun("PDFKeywords",t.makeParams(e))}}),Object.defineProperty(r,"PDFModifiedDate",{get:function(){return r._innerFun("PDFModifiedDate")},set:function(e){return r._innerFun("PDFModifiedDate",t.makeParams(e))}}),Object.defineProperty(r,"PDFProducer",{get:function(){return r._innerFun("PDFProducer")},set:function(e){return r._innerFun("PDFProducer",t.makeParams(e))}}),Object.defineProperty(r,"PDFSubject",{get:function(){return r._innerFun("PDFSubject")},set:function(e){return r._innerFun("PDFSubject",t.makeParams(e))}}),Object.defineProperty(r,"PDFTitle",{get:function(){return r._innerFun("PDFTitle")},set:function(e){return r._innerFun("PDFTitle",t.makeParams(e))}}),Object.defineProperty(r,"PDFVersion",{get:function(){return r._innerFun("PDFVersion")},set:function(e){return r._innerFun("PDFVersion",t.makeParams(e))}}),Object.defineProperty(r,"TIFFCompressionType",{get:function(){return r._innerFun("TIFFCompressionType")},set:function(e){return r._innerFun("TIFFCompressionType",t.makeParams(e))}}),Object.defineProperty(r,"JPEGQuality",{get:function(){return r._innerFun("JPEGQuality")},set:function(e){var n=1*e;return n>=100&&(n=100),r._innerFun("JPEGQuality",t.makeParams(n))}}),Object.defineProperty(r,"HttpContentTypeFieldValue",{get:function(){return r.__strHttpContentTypeFieldValue},set:function(e){return r.__strHttpContentTypeFieldValue=e,e}}),Object.defineProperty(r,"SelectionRectAspectRatio",{get:function(){return r._UIManager.GetSelectionRectAspectRatio()},set:function(e){var t=parseFloat(e);return t>=0&&(r._UIManager.SetSelectionRectAspectRatio(t),!0)}}),Object.defineProperty(r,"IfAllowLocalCache",{get:function(){return r._innerFun("IfAllowLocalCache")},set:function(e){return r._innerFun("IfAllowLocalCache",t.makeParams(e))}}),Object.defineProperty(r,"_AutoCropMethod",{get:function(){return r._innerFun("AutoCropMethod")},set:function(e){return r._innerFun("AutoCropMethod",t.makeParams(e))}}),Object.defineProperty(r,"BrokerProcessType",{get:function(){return 1},set:function(e){return!0}}),Object.defineProperty(r,"BorderStyle",{get:function(){return 0},set:function(e){return!1}}),Object.defineProperty(r,"IfSSL",{get:function(){return r._innerFun("IfSSL")},set:function(e){return r._innerFun("IfSSL",t.makeParams(e))}}),Object.defineProperty(r,"AllowPluginAuthentication",{get:function(){return r._innerFun("AllowPluginAuthentication")},set:function(e){return r._innerFun("AllowPluginAuthentication",t.makeParams(e))}}),Object.defineProperty(r,"HttpFieldNameOfUploadedImage",{get:function(){return r.__remoteFilename},set:function(e){return r.__remoteFilename=e}}),Object.defineProperty(r,"MaxInternetTransferThreads",{get:function(){return r._innerFun("MaxInternetTransferThreads")},set:function(e){return r._innerFun("MaxInternetTransferThreads",t.makeParams(e))}}),Object.defineProperty(r,"MaxUploadImageSize",{get:function(){return r._innerFun("MaxUploadImageSize")},set:function(e){return r._innerFun("MaxUploadImageSize",t.makeParams(e))}}),Object.defineProperty(r,"style",{get:function(){return r.__style}}),Object.defineProperty(r,"Addon",{get:function(){return r.__addon}}),Object.defineProperty(r,"BufferMemoryLimit",{get:function(){return r._innerFun("BufferMemoryLimit")},set:function(e){return r._innerFun("BufferMemoryLimit",t.makeParams(e))}}),Object.defineProperty(r,"Width",{get:function(){return r._width},set:function(e){var n=!1;if(Dynamsoft.Lib.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(n=e),!n&&e){var o=parseInt(e);o&&(n=o+"px")}return!!n&&(r._width=n,t.changeImageUISize(r,n,!1))}}),Object.defineProperty(r,"Height",{get:function(){return r._height},set:function(e){var n=!1;if(Dynamsoft.Lib.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(n=e),!n&&e){var o=parseInt(e);o&&(n=o+"px")}return!!n&&(r._height=n,t.changeImageUISize(r,!1,n))}}),Object.defineProperty(r,"ShowPageNumber",{get:function(){return r._UIManager.getView().GetShowPageNumber()},set:function(e){return r._UIManager.getView().SetShowPageNumber(e)}}),Object.defineProperty(r,"IfAutoScroll",{get:function(){return r._UIManager.getView().GetIfAutoScroll()},set:function(e){return r._UIManager.getView().SetIfAutoScroll(e)}}),Object.defineProperty(r,"ImageEditorIfEnableEnumerator",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"ImageEditorIfReadonly",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"ImageEditorIfModal",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"ImageEditorWindowTitle",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"EnableInteractiveZoom",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"IfShowPrintUI",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"VScrollBar",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"AsyncMode",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"IfThrowException",{get:function(){return!0},set:function(e){return!0}}),Object.defineProperty(r,"IfOpenImageWithGDIPlus",{get:function(){return!0},set:function(e){return!0}})}}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=e.html5.STwain.prototype,n=e.html5.Funs;t.__innerLoadImage=function(t,n,r,o,i,a){return e.html5.Funs.checkProductKey(this,{Core:!0})&&e.html5.Funs.checkPDFProductKeyWhenNeeds(this,r)?e.isFunction(i)?this.__innerAcquireImage(t,n,o,i,a):this.__innerLoadImageFun(t,n):(e.isFunction(a)&&a(this._errorCode,this._errorString),!1)},t.__innerLoadImageFun=function(e,t){var r=this;if(n.isServerInvalid(r))return!1;var o=r._innerFun(e,t);return o&&(r._HowManyImagesInBuffer=r._innerFun("HowManyImagesInBuffer"),r.__cIndex=r._innerFun("CurrentImageIndexInBuffer")),r.__cIndex>=0&&(o&&r._UIManager.refreshEditor(r.__cIndex,r._UIManager.count()),r.OnRefreshUI(r.__cIndex)),o},t.__innerAcquireImage=function(t,r,o,i,a){var s=this,u="LoadImage"==t||"LoadImageEx"==t,l=function(r){s.__bLoadingImage=!1;var o=s.__cIndex;return o>=0&&s.OnRefreshUI(o),e.isFunction(a)&&a(s.ErrorCode,s.ErrorString),u?Dynamsoft.Lib.closeProgress(t):n.hideMask(t),r&&Dynamsoft.Lib.log(r),!1};return n.isServerInvalid(s)?(l(),!1):(u?Dynamsoft.Lib.showProgress(s,t,!1):n.showMask(t),s._innerSend(t,r,!0,function(){if(s.__bLoadingImage=!1,u){Dynamsoft.Lib.closeProgress(t);var r=s._UIManager.GetCurrentImageIndex();r>=0&&(s._UIManager.refreshEditor(r,s._UIManager.count()),s.OnRefreshUI(r))}else n.hideMask(t);e.isFunction(i)&&i()},l),!0)},t.__innerSaveImage=function(e,t,n,r){return this.__innerProgressFunction(e,t,!1,n,r)},t.__innerFTPDownloadDirectly=function(t,n,r,o,i){return e.html5.Funs.checkProductKey(this,{Core:!0})&&e.html5.Funs.checkPDFProductKeyWhenNeeds(this,r)?(e.cancelFrome=4,this.__innerProgressFunction(t,n,!0,o,i)):(e.isFunction(i)&&i(this._errorCode,this._errorString),!1)},t.__innerFTPDownload=function(t,n,r,o,i){var a,s=this;if(!e.html5.Funs.checkProductKey(s,{Core:!0}))return e.isFunction(i)&&i(s._errorCode,s._errorString),!1;if(!e.html5.Funs.checkPDFProductKeyWhenNeeds(s,r))return e.isFunction(i)&&i(s._errorCode,s._errorString),!1;if(e.cancelFrome=4,e.isFunction(i))return s.__innerProgressFunction(t,n,!0,function(){var t=s.__cIndex;t>=0&&s.OnRefreshUI(t),e.isFunction(o)&&o()},i);a=s._innerFun(t,n);var u=s.__cIndex;return u>=0&&s.OnRefreshUI(u),a},t.__innerFTPUpload=function(e,t,n,r){return Dynamsoft.Lib.cancelFrome=3,this.__innerProgressFunction(e,t,!0,n,r)},t.__innerProgressFunction=function(t,n,r,o,i){var a=this;if(!e.isFunction(i))return this._innerFun(t,n);return Dynamsoft.Lib.showProgress(a,t,r),this._innerSend(t,n,!0,function(){Dynamsoft.Lib.closeProgress(t),e.isFunction(o)&&o()},function(n){return e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),Dynamsoft.Lib.closeProgress(t),n&&Dynamsoft.Lib.log(n),!0})},t.__innerGetBarcodeResultAsyncFunction=function(e){var t=Dynamsoft.Lib.NewBarcodeResult();return e&&(t._errorCode=e.exception,t._errorString=e.description,t._resultlist=e.result,t._Count=e.result.length),t},t.__innerGetOCRResultAsyncFunction=function(e){var t=Dynamsoft.Lib.NewOCRResult(this);return e&&(t._errorCode=e.exception,t._errorString=e.description,t._resultlist=e.result),t},t.__innerGetOCRProResultAsyncFunction=function(e){var t=Dynamsoft.Lib.NewOCRProResult(this);return e&&(t._errorCode=e.code,t._errorString=e.message,t._request=e.request,t._errorlist=e.errorList,t._ocrTotalCount=e.ocrTotalCount,t._alreadyOCRCount=e.alreadyOCRCount,t._resultlist=e.resultDetail),t},t._innerSendCmd=function(e,t){if(n.isHttpServerInvalid(this))return!1;this._innerFunRaw(e,t,!0,!1,!1)},t._innerFun=function(e,t){var r;return!n.isHttpServerInvalid(this)&&(r=this._innerFunRaw(e,t,!1,!1,!1),Dynamsoft.Lib.isArray(r)?r[0]:r)},t._innerFunRaw=function(t,r,o,i,a,s,u){var l,c=this;if(n.isHttpServerInvalid(c))return!1;c._errorCode=0,c._errorString="";var d,h=!1;return o&&(h=!0),l={type:"post",url:[c.httpUrl,"f/",t,"?",n.getRandom()].join(""),data:n.getJson(c,t,r,0),async:h,success:function(t,n,r){var o=!1;try{o=e.isString(t)&&"text/json"===r.responseHeaders["content-type"]?KISSY.JSON.parse(t):t}catch(e){}o?(void 0!==o.exception&&void 0!==o.description?(c._errorCode=o.exception,c._errorString=o.description):(c._errorCode=0,c._errorString=""),d=a?o:o.result):(Dynamsoft.Lib.Errors.InvalidResultFormat(c),d=""),e.isFunction(s)&&s(d)},error:function(){Dynamsoft.Lib.Errors.NetworkError(c),d="",e.isFunction(u)&&u()}},i&&(Dynamsoft.Lib.env.bIE?(l.responseType="arraybuffer",l.success=function(e,t,n){var r,o,i=!1;n.responseHeadersString&&(-1!=n.responseHeadersString.indexOf("text/json")&&(i=!0));if(r=n.responseData,c._errorCode=0,c._errorString="",d=!1,r&&(o=new Uint8Array(r),i?r=String.fromCharCode.apply(null,o):d=new Blob([o],{type:c.__strHttpContentTypeFieldValue})),!r||i){var a,s=!1;if((a=i?r:n.responseText).length>0){if("{"==a.charAt(0))try{s=KISSY.JSON.parse(a),i=!0}catch(e){Dynamsoft.Lib.log(a)}i?void 0!==s.exception&&void 0!==s.description?(c._errorCode=s.exception,c._errorString=s.description,d=!1):d=!0:(o=new Uint8Array(a),d=new Blob([o],{type:c.__strHttpContentTypeFieldValue}))}}}):(l.contentType="text/plain; charset=x-user-defined",l.mimeType="text/plain; charset=x-user-defined",l.success=function(e,t,n){var r,o,i;if(o=(r=n.responseText).length,c._errorCode=0,c._errorString="",o>0){var a,s=!1;if("{"==r.charAt(0))try{a=KISSY.JSON.parse(r),s=!0}catch(e){Dynamsoft.Lib.log(r)}if(s)void 0!==a.exception&&void 0!==a.description?(c._errorCode=a.exception,c._errorString=a.description,d=!1):d=!0;else{i=new Uint8Array(o);for(var u=0;u<o;u++)i[u]=r.charCodeAt(u);d=new Blob([i],{type:c.__strHttpContentTypeFieldValue})}}else d=""})),h||KISSY.mix(l,{headers:{"X-Requested-With":!1}}),e.env.bFileSystem&&(l.crossDomain=!1),new KISSY.IO(l),d},t._innerSend=function(t,r,o,i,a){var s=this._objWS,u=!1,l=!1,c=!1;if("ActiveUI"!=t&&(c=n.isServerInvalid(this)),c)return e.isFunction(a)&&a(),!0;e.isFunction(i)&&(l=i),e.isFunction(a)&&(u=a);var d,h=n.generateCmdId();return"SaveSelectedImagesToBytes"==t?(this.curCommand_SaveImagesToBytes.push({cmdId:h,sFun:l,fFun:u,objWS:s,json:n.getJson(this,t,r,h),binary:o}),d=1!=this.curCommand_SaveImagesToBytes.length||n.sendData(s,n.getJson(this,t,r,h),!1,o)):(this.curCommand.push({cmd:t,cmdId:h,sFun:l,fFun:u}),d=n.sendData(s,n.getJson(this,t,r,h),!1,o)),d},t.__SaveSelectedImagesToBytes=function(t,r,o,i,a,s){if(i)return this.__SaveSelectedImagesToBytesByBlock(t,r,o,a,s);if(r<=0&&o<=0)return e.isFunction(s)&&s(),!1;var u=this._innerFunRaw("SaveSelectedImagesToBytes",n.makeParams(t,-2,"",r,o),!1,!0,!1);return 0==this.ErrorCode?a(u,r):(e.isFunction(s)&&s(),!1)},t.__GetSelectedImagesLength=function(t,r,o,i){var a=this._innerFunRaw("SaveSelectedImagesToBytes",n.makeParams(t,r,"",0,0),!1,!1,!1);return 0==this.ErrorCode?(e.isFunction(o)&&(e.isArray(a)?o(a[0]):o(a)),!0):(e.isFunction(i)&&i(),!1)},t.__SaveSelectedImagesToBytesByBlock=function(t,r,o,i,a){return r<=0&&o<=0?(e.isFunction(a)&&a(),!1):this._innerSend("SaveSelectedImagesToBytes",n.makeParams(t,-2,"",r,o),!0,function(t){e.isFunction(i)&&i(t,r)},a)},t.__SaveLocalFileToBytes=function(e,t,r,o){if(t)return this._innerSend("SaveSelectedImagesToBytes",n.makeParams(0,0,e),!0,r,o);var i=this._innerFunRaw("SaveSelectedImagesToBytes",n.makeParams(0,0,e),!1,!0,!1);return 0==this.ErrorCode?r(i):(o(),!1)},t.__LoadImageFromBytes=function(t,r,o,i,a,s,u,l){var c,d=this,h="LoadImageFromBytes",f=r||3,g=t.size||t.length,p=n.isServerInvalid(d),m=!0;c=!isNaN(u)&&u>=0&&!isNaN(l)&&l>0?["[",g,",",0,",",f,',"',o,'", ',u,",",l,"]"].join(""):["[",g,",",0,",",f,',"',o,'"]'].join("");var _=function(){if(Dynamsoft.Lib.closeProgress(h),d.__bLoadingImage=!1,m){var t=d.__cIndex;t>=0&&d.OnRefreshUI(t)}return e.isFunction(s)&&s(d._errorCode,d._errorString),!1};return p?(m=!1,_()):e.html5.Funs.checkProductKey(d,{Core:!0})&&e.html5.Funs.checkPDFProductKeyWhenNeeds(d,r)?0===g?(Dynamsoft.Lib.Errors.ImageFileLengthCannotZero(d),m=!1,_()):(n.setBtnCancelVisibleForProgress(d,!1),this._innerSendBlob(h,c,t,i,function(){(u+g==l||l<=0||isNaN(l))&&Dynamsoft.Lib.closeProgress(h),d.__bLoadingImage=!1;var t=d._UIManager.GetCurrentImageIndex();return i&&t>=0&&(d._UIManager.refreshEditor(t,d._UIManager.count()),d.OnRefreshUI(t)),e.isFunction(a)&&a(),!0},_)):(m=!1,_())},t._innerSendBlob=function(t,r,o,i,a,s){var u=this,l=u._objWS,c=!1,d=!1;if(n.isServerInvalid(u))return e.isFunction(s)&&s(),!1;if(e.isFunction(a)&&(c=a),e.isFunction(s)&&(d=s),!i){var h,f,g,p;return!n.isHttpServerInvalid(u)&&(u._errorCode=0,u._errorString="",f=[u.httpUrl,"f/",t,"?",n.getRandom()].join(""),g=n.getJson(u,t,r,0),g+="\r\n\r\n",p={type:"post",url:f,processData:!1,data:g+=Dynamsoft.Lib.base64.encodeArray(o),async:!1,success:function(t,n,r){var o=!1;try{o=e.isString(t)&&"text/json"===r.responseHeaders["content-type"]?KISSY.JSON.parse(t):t}catch(e){}null!=o?(void 0!==o.exception&&void 0!==o.description?(u._errorCode=o.exception,u._errorString=o.description):(u._errorCode=0,u._errorString=""),h=o.result):(Dynamsoft.Lib.Errors.InvalidResultFormat(u),h="")},error:function(){Dynamsoft.Lib.Errors.NetworkError(u),h=""}},KISSY.mix(p,{headers:{"X-Requested-With":!1}}),e.env.bFileSystem&&(p.crossDomain=!1),new KISSY.IO(p),0==u._errorCode?e.isFunction(c)&&c():e.isFunction(d)&&d(),h)}var m=n.generateCmdId();u.curCommand.push({cmd:t,cmdId:m,sFun:c,fFun:d}),n.sendData(l,n.getJson(u,t,r,m),o,!0)},t._innerActiveUI=function(e,t){this._innerSend("ActiveUI",n.makeParams(Dynamsoft.Lib.env.WSVersion,Dynamsoft.Lib.env.WSSession),!1,e,t)},t._innerSetSize=function(e,t){var r,o=!1,i=!1;(Dynamsoft.Lib.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(o=e),!o&&e)&&((r=parseInt(e))&&(o=r+"px"));(Dynamsoft.Lib.isString(t)&&t.length>0&&"%"===t.charAt(t.length-1)&&(i=t),!i&&t)&&((r=parseInt(t))&&(i=r+"px"));return o&&(this._width=o),i&&(this._height=i),n.changeImageUISize(this,o,i)}}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=e.html5.STwain.prototype,n=e.html5.Funs,r=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer"];t.LoadDibFromClipboard=function(e,t){return this.__innerLoadImage("LoadDibFromClipboard",null,-1,!0,e,t)},t.LoadImage=function(t,r,o){var i=n.replaceLocalFilename(t),a=e.html5.Funs.getImageType(i);return this.__innerLoadImage("LoadImage",n.makeParams(i),a,!0,r,o)},t.LoadImageEx=function(e,t,r,o){var i=n.replaceLocalFilename(e),a=t;return a==EnumDWT_ImageType.IT_ALL&&(a=-1),this.__innerLoadImage("LoadImageEx",n.makeParams(i,a),a,!0,r,o)},t.EnableSource=function(e,t,n){return this.AcquireImage(e,t,n)},t.AcquireImage=function(t,o,i){var a,s,u=null,l=null;if(e.isUndefined(i)&&(e.isFunction(t)&&e.isFunction(o)||e.isFunction(t)&&e.isUndefined(o)||e.isFunction(t)&&null==o||null==t&&e.isFunction(o))?(s={},e.isFunction(t)&&(u=t),e.isFunction(o)&&(l=o)):(s=e.isUndefined(t)||null==t?{}:t,e.isFunction(o)&&(u=o),e.isFunction(i)&&(l=i)),n.isServerInvalid(this))return e.isFunction(l)&&l(this._errorCode,this._errorString),!1;if(!e.html5.Funs.checkProductKey(this,{Core:!0}))return e.isFunction(l)&&l(this._errorCode,this._errorString),!1;for(var c=0,d=0;d<r.length;d++){var h=["__",r[d]].join("");e.isFunction(this[h])&&(c|=1<<d)}return c|=4,s.EnableEvents=c,a=["[",KISSY.JSON.stringify(s),"]"].join(""),this.__innerAcquireImage("AcquireImage",a,!1,u,l)},t.CancelAllPendingTransfers=function(){return this._innerFun("CancelAllPendingTransfers")},t.CloseSource=function(){return this._innerFun("CloseSource")},t.CloseSourceManager=function(){return this._innerFun("CloseSourceManager")},t.DisableSource=function(){return this._innerFun("DisableSource")},t.FeedPage=function(){return this._innerFun("FeedPage")},t.GetDeviceType=function(){return this._innerFun("GetDeviceType")},t.GetSourceNameItems=function(e){return this.__sourceCount<0&&this.SourceCount,e<this.__sourceCount&&e>=0?this.__sourceName[e]:""},t.SourceNameItems=function(e){return this.__sourceCount<0&&this.SourceCount,e<this.__sourceCount&&e>=0?this.__sourceName[e]:""},t.GetSourceNames=function(){var e=this._innerFunRaw("GetSourceNames");return 0!=this._errorCode?[]:e},t.GetSourceType=function(e){return this._innerFun("GetSourceType",n.makeParams(e))},t.OpenSource=function(){return this._innerFun("OpenSource")},t.OpenSourceManager=function(){return this._innerFun("OpenSourceManager")},t.ResetImageLayout=function(){return this._innerFun("ResetImageLayout")},t.RewindPage=function(){return this._innerFun("RewindPage")},t.SelectSource=function(){return this._innerFun("SelectSource")},t.SelectSourceByIndex=function(e){return this._innerFun("SelectSourceByIndex",n.makeParams(e))},t.SetFileXferInfo=function(e,t){var r=n.replaceLocalFilename(e);return this._innerFun("SetFileXferInfo",n.makeParams(r,t))},t.SetImageLayout=function(e,t,r,o){return this._innerFun("SetImageLayout",n.makeParams(e,t,r,o))},t.CapGet=function(){return this._innerFun("CapGet")},t.CapGetCurrent=function(){return this._innerFun("CapGetCurrent")},t.CapGetDefault=function(){return this._innerFun("CapGetDefault")},t.CapGetFrameBottom=function(e){return this._innerFun("CapGetFrameBottom",n.makeParams(e))},t.CapGetFrameLeft=function(e){return this._innerFun("CapGetFrameLeft",n.makeParams(e))},t.CapGetFrameRight=function(e){return this._innerFun("CapGetFrameRight",n.makeParams(e))},t.CapGetFrameTop=function(e){return this._innerFun("CapGetFrameTop",n.makeParams(e))},t.CapGetHelp=function(){return this._innerFun("CapGetHelp")},t.CapGetLabel=function(){return this._innerFun("CapGetLabel")},t.CapGetLabels=function(){return this._innerFun("CapGetLabels")},t.CapIfSupported=function(e){return this._innerFun("CapIfSupported",n.makeParams(e))},t.CapReset=function(){return this._innerFun("CapReset")},t.CapSet=function(){return this._innerFun("CapSet")},t.CapSetFrame=function(e,t,r,o,i){return this._innerFun("CapSetFrame",n.makeParams(e,t,r,o,i))},t.GetCapItems=function(e){return this._innerFun("GetCapItems",n.makeParams(e))},t.GetCapItemsString=function(e){return this._innerFun("GetCapItemsString",n.makeParams(e))},t.SetCapItems=function(e,t){return this._innerFun("SetCapItems",n.makeParams(e,t))},t.SetCapItemsString=function(e,t){return this._innerFun("SetCapItemsString",n.makeParams(e,t))}}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=e.html5.STwain.prototype,n=e.html5.Funs;t.AddText=function(e,t,r,o,i,a,s,u){return this._innerFun("AddText",n.makeParams(e,t,r,o,i,a,s,u))},t.CreateTextFont=function(e,t,r,o,i,a,s,u,l,c,d,h,f,g){return this._innerFun("CreateTextFont",n.makeParams(e,t,r,o,i,a,s,u,l,c,d,h,f,g))},t.CopyToClipboard=function(e){return this._innerFun("CopyToClipboard",n.makeParams(e))},t.Erase=function(e,t,r,o,i){return this._innerFun("Erase",n.makeParams(e,t,r,o,i))},t.GetImageBitDepth=function(e){return this._innerFun("GetImageBitDepth",n.makeParams(e))},t.GetImageWidth=function(e){return this._innerFun("GetImageWidth",n.makeParams(e))},t.GetImageHeight=function(e){return this._innerFun("GetImageHeight",n.makeParams(e))},t.GetImageSize=function(e,t,r){return this._innerFun("GetImageSize",n.makeParams(e,t,r))},t.GetImageSizeWithSpecifiedType=function(e,t){return this._innerFun("GetImageSizeWithSpecifiedType",n.makeParams(e,t))},t.GetImageXResolution=function(e){return this._innerFun("GetImageXResolution",n.makeParams(e))},t.GetImageYResolution=function(e){return this._innerFun("GetImageYResolution",n.makeParams(e))},t.GetSelectedImageIndex=function(e){return e>=0?this._UIManager.GetSelectedImageIndex(e):-1},t.SetSelectedImageIndex=function(t,r){this.__SelectedImagesCount;return t<this.__SelectedImagesCount&&t>=0?(this._UIManager.getView().SetSelectedImageIndex(t,r),this._innerFun("SetSelectedImageIndex",n.makeParams(t,r))):(e.Errors.InvalidIndex(this),!1)},t.GetSkewAngle=function(e){return this._innerFun("GetSkewAngle",n.makeParams(e))},t.GetSkewAngleEx=function(e,t,r,o,i){return this._innerFun("GetSkewAngleEx",n.makeParams(e,t,r,o,i))},t.IsBlankImageEx=function(e,t,r,o,i,a){return this._innerFun("IsBlankImageEx",n.makeParams(e,t,r,o,i,a))},t.Mirror=function(e){return this._innerFun("Mirror",n.makeParams(e))},t.OverlayRectangle=function(e,t,r,o,i,a,s){return!n.isServerInvalid(this)&&this._UIManager.getView().OverlayRectangle(e,t,r,o,i,a,s)},t.RemoveAllImages=function(){var e;return(e=this._innerFun("RemoveAllImages"))&&(this._HowManyImagesInBuffer=0,this._UIManager.clear()),e},t.RemoveAllSelectedImages=function(){var e,t=this;return(e=n.__SetSelectedImages(t,t._UIManager.GetCurrentImageIndex(),t._UIManager.GetSelectedIndexes()))&&(e=t._innerFun("RemoveAllSelectedImages"))&&(t._HowManyImagesInBuffer=t._innerFun("HowManyImagesInBuffer"),t.__cIndex=t._innerFun("CurrentImageIndexInBuffer"),0==t._HowManyImagesInBuffer&&t._UIManager.clear(),t._UIManager.getView().SetSelectedImageCount(0),t.__SelectedImagesCount=0),e},t.RemoveImage=function(t){var r,o=parseInt(t);return o<0||o>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((r=this._innerFun("RemoveImage",n.makeParams(o)))&&(this._HowManyImagesInBuffer=this._innerFun("HowManyImagesInBuffer"),this.__cIndex=this._innerFun("CurrentImageIndexInBuffer"),0==this._HowManyImagesInBuffer&&this._UIManager.clear()),r)},t.Rotate=function(t,r,o){var i,a=parseInt(t);return a<0||a>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((i=1==this._innerFun("Rotate",n.makeParams(a,r,o)))&&n.refreshImageAfterInvokeFun(this,a),i)},t.RotateEx=function(t,r,o,i){var a,s=parseInt(t);return s<0||s>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((a=1==this._innerFun("RotateEx",n.makeParams(s,r,o,i)))&&n.refreshImageAfterInvokeFun(this,s),a)},t.RotateLeft=function(t){var r,o=parseInt(t);return o<0||o>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((r=1==this._innerFun("RotateLeft",n.makeParams(o)))&&n.refreshImageAfterInvokeFun(this,o),r)},t.RotateRight=function(t){var r,o=parseInt(t);return o<0||o>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((r=1==this._innerFun("RotateRight",n.makeParams(o)))&&n.refreshImageAfterInvokeFun(this,o),r)},t.ChangeImageSize=function(t,r,o,i){var a,s=parseInt(t),u=1*r,l=1*o;return s<0||s>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):u<=0||l<=0?(e.Errors.InvalidWidthOrHeight(this),!1):((a=1==this._innerFun("ChangeImageSize",n.makeParams(s,u,l,i)))&&n.refreshImageAfterInvokeFun(this,s),a)},t.Flip=function(t){var r,o=parseInt(t);return o<0||o>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((r=1==this._innerFun("Flip",n.makeParams(o)))&&n.refreshImageAfterInvokeFun(this,o),r)},t.Crop=function(t,r,o,i,a){var s,u=parseInt(t);return u<0||u>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((s=1==this._innerFun("Crop",n.makeParams(u,r,o,i,a)))&&n.refreshImageAfterInvokeFun(this,u),s)},t.CropToClipboard=function(t,r,o,i,a){var s,u=parseInt(t);return u<0||u>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((s=1==this._innerFun("CropToClipboard",n.makeParams(u,r,o,i,a)))&&n.refreshImageAfterInvokeFun(this,u),s)},t.CutFrameToClipboard=function(t,r,o,i,a){var s,u=parseInt(t);return u<0||u>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((s=1==this._innerFun("CutFrameToClipboard",n.makeParams(u,r,o,i,a)))&&n.refreshImageAfterInvokeFun(this,u),s)},t.CutToClipboard=function(t){var r,o=parseInt(t);return o<0||o>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((r=1==this._innerFun("CutToClipboard",n.makeParams(o)))&&n.refreshImageAfterInvokeFun(this,o),r)},t.SetDPI=function(t,r,o,i,a){var s=parseInt(t);return s<0||s>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):this._innerFun("SetDPI",n.makeParams(s,r,o,i,a))},t.SetViewMode=function(e,t){var n,r;return n=Math.floor(e),r=Math.floor(t),this._UIManager.SetViewMode(n,r),!0},t.MoveImage=function(t,r){var o,i=parseInt(t),a=parseInt(r);return i<0||i>=this.HowManyImagesInBuffer||a<0||a>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((o=this._innerFun("MoveImage",n.makeParams(i,a)))&&(o=this._UIManager.MoveImage(i,a)),o)},t.SwitchImage=function(t,r){var o,i=parseInt(t),a=parseInt(r);return i<0||i>=this.HowManyImagesInBuffer||a<0||a>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):((o=this._innerFun("SwitchImage",n.makeParams(i,a)))&&this._UIManager.SwitchImage(i,a),o)},t.Print=function(e){if(e){return this._innerSend("PrintEx",n.makeParams(!0),function(){},function(){})}return this._UIManager.getView().Print(),!0},t.SetSelectedImageArea=function(t,r,o,i,a){var s=parseInt(t);return s<0||s>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),!1):!n.isServerInvalid(this)&&this._UIManager.getView().SetSelectedImageArea(s,r,o,i,a)},t.CloseWorkingProcess=function(){return this._innerFun("CloseWorkerProcess")}}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=e.html5.STwain,n=t.prototype,r=e.html5.Funs;n.FileExists=function(e){var t=r.replaceLocalFilename(e);return this._innerFun("FileExists",r.makeParams(t))},n.SaveAllAsMultiPageTIFF=function(e,t,n){var o=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAllAsMultiPageTIFF",r.makeParams(o),t,n)},n.SaveAllAsPDF=function(e,t,n){var o=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAllAsPDF",r.makeParams(o),t,n)},n.SaveAsBMP=function(e,t,n,o){var i=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAsBMP",r.makeParams(i,t),n,o)},n.SaveAsJPEG=function(e,t,n,o){var i=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAsJPEG",r.makeParams(i,t),n,o)},n.SaveAsPDF=function(e,t,n,o){var i=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAsPDF",r.makeParams(i,t),n,o)},n.SaveAsPNG=function(e,t,n,o){var i=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAsPNG",r.makeParams(i,t),n,o)},n.SaveAsTIFF=function(e,t,n,o){var i=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAsTIFF",r.makeParams(i,t),n,o)},n.SaveAsGIF=function(e,t,n,o){var i=r.replaceLocalFilename(e);return this.__innerSaveImage("SaveAsGIF",r.makeParams(i,t),n,o)},n.SaveSelectedImagesAsMultiPagePDF=function(e,t,n){var o=r.replaceLocalFilename(e);return!!r.__SetSelectedImages(this,this._UIManager.GetCurrentImageIndex(),this._UIManager.GetSelectedIndexes())&&this.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",r.makeParams(o),t,n)},n.SaveSelectedImagesAsMultiPageTIFF=function(e,t,n){var o=r.replaceLocalFilename(e);return!!r.__SetSelectedImages(this,this._UIManager.GetCurrentImageIndex(),this._UIManager.GetSelectedIndexes())&&this.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",r.makeParams(o),t,n)},n.SaveSelectedImagesToBase64Binary=function(t,n){return!!r.__SetSelectedImages(this,this._UIManager.GetCurrentImageIndex(),this._UIManager.GetSelectedIndexes())&&(e.isFunction(t)?this._innerSend("SaveSelectedImagesToBase64Binary",null,!0,t,n):this._innerFun("SaveSelectedImagesToBase64Binary"))},n.ShowFileDialog=function(e,t,n,o,i,a,s,u){var l=r.replaceLocalFilename(i);return this._innerSend("ShowFileDialog",r.makeParams(e,t,n,o,l,a,s,u),!0)},n.FTPDownload=function(t,n,o,i){var a=e.html5.Funs.getImageType(n);return this.__innerFTPDownload("FTPDownload",r.makeParams(t,n),a,o,i)},n.FTPDownloadDirectly=function(t,n,o,i,a){var s=r.replaceLocalFilename(o),u=e.html5.Funs.getImageType(s);return this.__innerFTPDownloadDirectly("FTPDownloadDirectly",r.makeParams(t,n,s),u,i,a)},n.FTPDownloadEx=function(e,t,n,o,i){return this.__innerFTPDownload("FTPDownloadEx",r.makeParams(e,t,n),n,o,i)},n.FTPUpload=function(e,t,n,o,i){return this.__innerFTPUpload("FTPUpload",r.makeParams(e,t,n),o,i)},n.FTPUploadDirectly=function(t,n,o,i,a){var s;return e.html5.Funs.checkProductKey(this,{Core:!0})?(s=r.replaceLocalFilename(n),this.__innerFTPUpload("FTPUploadDirectly",r.makeParams(t,s,o),i,a)):(e.isFunction(a)&&a(this._errorCode,this._errorString),!1)},n.FTPUploadEx=function(e,t,n,o,i,a){return this.__innerFTPUpload("FTPUploadEx",r.makeParams(e,t,n,o),i,a)},n.FTPUploadAllAsMultiPageTIFF=function(e,t,n,o){return this.__innerFTPUpload("FTPUploadAllAsMultiPageTIFF",r.makeParams(e,t),n,o)},n.FTPUploadAllAsPDF=function(e,t,n,o){return this.__innerFTPUpload("FTPUploadAllAsPDF",r.makeParams(e,t),n,o)},n.FTPUploadAsMultiPagePDF=function(e,t,n,o){return this.__innerFTPUpload("FTPUploadAsMultiPagePDF",r.makeParams(e,t),n,o)},n.FTPUploadAsMultiPageTIFF=function(e,t,n,o){return this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",r.makeParams(e,t),n,o)},n.HTTPDownload=function(e,t,n,o){var i=r.getImageType(t);return this.HTTPDownloadThroughGet(e,t,i,n,o)},t.prototype.HTTPDownloadEx=function(e,t,n,r,o){return this.HTTPDownloadThroughGet(e,t,n,r,o)},n.HTTPDownloadDirectly=function(t,n,o,i,a){var s,u,l=this,c=r.combineUrl(l,t,n);if(!1===c)return e.Errors.ParameterCannotEmpty(l),!1;if(!o||""==o)return e.Errors.InvalidLocalFilename(l,"HTTPDownloadDirectly"),e.isFunction(a)&&a(l.ErrorCode,l.ErrorString),!1;if(s=e.html5.Funs.getImageType(o),r.isServerInvalid(l))return e.isFunction(a)&&a(l.ErrorCode,l.ErrorString),!1;if(!e.html5.Funs.checkProductKey(l,{Core:!0}))return e.isFunction(a)&&a(l._errorCode,l._errorString),!1;if(!e.html5.Funs.checkPDFProductKeyWhenNeeds(l,s))return e.isFunction(a)&&a(l._errorCode,l._errorString),!1;e.cancelFrome=2,u=r.replaceLocalFilename(o),e.showProgress(l,"HTTPDownloadDirectly",!0);var d=!0;return l._OnPercentDone([0,-1,"HTTP Downloading...","http"]),e.isFunction(i)||(d=!1),ret=r.loadHttpBlob(l,"get",c,d,function(e){l._OnPercentDone([0,-1,"Loading..."]);return l.__LoadImageFromBytes(e,3,u,d,i,a)},function(){return e.closeProgress("HTTPDownloadDirectly"),e.isFunction(a)&&a(l.ErrorCode,l.ErrorString),!1},function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");l._OnPercentDone([0,t,"","http"])}),ret},n.HTTPUploadThroughPostDirectly=function(t,n,i,a,s,u){var l,c=this,d=o.GetHttpHeadersAndClear(c),h="HTTPUploadThroughPostDirectly",f=r.combineUrl(c,t,i),g=!0;if(""===t)return e.Errors.HttpServerCannotEmpty(c),e.isFunction(u)&&u(c.ErrorCode,c.ErrorString,""),!1;if(!1===f||""===f)return e.Errors.ParameterCannotEmpty(c),e.isFunction(u)&&u(c.ErrorCode,c.ErrorString,""),!1;if(e.isFunction(s)||(g=!1),!e.html5.Funs.checkProductKey(c,{Core:!0}))return e.isFunction(u)&&u(c.ErrorCode,c.ErrorString,""),!1;e.cancelFrome=1;var p=function(){return e.needShowTwiceShowDialog=!1,e.closeProgress(h),e.isFunction(u)&&u(c.ErrorCode,c.ErrorString,c.__HTTPPostResponseString),!1};return e.needShowTwiceShowDialog=!0,e.showProgress(c,h,!1),l=r.replaceLocalFilename(n),c.__SaveLocalFileToBytes(l,g,function(t){return e.needShowTwiceShowDialog=!1,t&&(e.dlgRef>0||0==c.__IfShowCancelDialogWhenImageTransfer||0==g)?(t.name=a,r.setBtnCancelVisibleForProgress(c,!0),r.httpPostUpload(c,f,t,g,0,d,!0,function(t){e.closeProgress(h),e.isFunction(s)&&s(t)},p)):(e.closeProgress(h),!1)},p)},n.HTTPUploadThroughPost=function(e,t,n,o,i,a){var s=r.getImageType(o);return this.HTTPUploadThroughPostEx(e,t,n,o,s,i,a)},n.HTTPUploadThroughPostEx=function(t,n,i,a,s,u,l){var c=this,d=o.GetHttpHeadersAndClear(c),h="HTTPUploadThroughPostEx",f=r.combineUrl(c,t,i),g=!0,p="",m=0;c.__HTTPPostResponseString="",e.isFunction(u)||(g=!1),e.cancelFrome=1;var _=function(){var t=c.curCommand_SaveImagesToBytes.length;if(e.needShowTwiceShowDialog=!1,e.closeProgress(h),e.isFunction(l)&&l(c.ErrorCode,c.ErrorString,c.__HTTPPostResponseString),t>0){e.cancelFrome=1,e.needShowTwiceShowDialog=!0,e.showProgress(c,h,!1);var n=c.curCommand_SaveImagesToBytes[0];r.sendData(n.objWS,n.json,!1,n.binary)}return!1};if(e.needShowTwiceShowDialog=!0,e.showProgress(c,h,!1),""===t)return e.Errors.HttpServerCannotEmpty(c),_();if(!1===f)return e.Errors.ParameterCannotEmpty(c),_();if(-2==n){if(!r.__SetSelectedImages(c,c._UIManager.GetCurrentImageIndex(),c._UIManager.GetSelectedIndexes()))return _()}else if(!(-1==n||n>=0))return e.Errors.IndexOutOfRange(c),_();return c.__GetSelectedImagesLength(s,n,function(e){var t=e.split(";");2==t.length&&(p=t[0],m=parseInt(t[1]))})?0==m?(e.Errors.UploadFileCannotEmpty(c),_()):(d["dwt-md5"]=p,c.__SaveSelectedImagesToBytes(s,0,m,g,function(t){return e.needShowTwiceShowDialog=!1,t&&(e.dlgRef>0||0==c.__IfShowCancelDialogWhenImageTransfer||0==g)?(t.name=a,r.setBtnCancelVisibleForProgress(c,!0),r.httpPostUpload(c,f,t,g,0,d,!0,function(t){var n=c.curCommand_SaveImagesToBytes.length;if(e.closeProgress(h),e.isFunction(u)&&u(t),n>0){e.cancelFrome=1,e.needShowTwiceShowDialog=!0,e.showProgress(c,h,!1);var o=c.curCommand_SaveImagesToBytes[0];r.sendData(o.objWS,o.json,!1,o.binary)}},_)):(e.closeProgress(h),!1)},_)):_()},n._checkIndices=function(t){var n;if(!e.isArray(t))return e.Errors.IndicesNotArray(this),!1;if(0==t.length)return e.Errors.IndicesCannotEmpty(this),!1;for(n=this._HowManyImagesInBuffer,i=0;i<t.length;i++){var r=t[i];if(e.isUndefined(r)||null===r)return e.Errors.IndexNullOrUndefined(this),!1;if(r=parseInt(r),isNaN(r))return e.Errors.InvalidIndex(this),!1;if(r<0||r>=n)return e.Errors.IndicesOutOfRange(this),!1}return!0},n.SetUploadSegment=function(t,n){return t>=0?n>0?(this._segementUploadThreshold=1024*t*1024,this._moduleSize=1024*n,!0):(e.Errors.InvalidModuleSize(this),!1):(e.Errors.InvalidSegementUploadThreshold(this),!1)},n.HTTPUpload=function(t,n,i,a,s,u){var l,c,d=this,h=parseInt(i),f=parseInt(a),g="HTTPUpload",p=t,m=!1,_=d._moduleSize,v=d._segementUploadThreshold;if(d.__HTTPPostResponseString="",l=function(){return e.isFunction(u)&&u(d.ErrorCode,d.ErrorString,d.__HTTPPostResponseString),!1},e.isUndefined(t)||""===t)return e.Errors.ParameterCannotEmpty(d),l();if(!e.isString(t))return e.Errors.InvalidUrl(d),l();if(0!=t.indexOf("http://")&&0!=t.indexOf("https://")&&(t=e.detect.ssl?"https://"+t:"http://"+t),r.isServerInvalid(d))return l();if(!d._checkIndices(n))return l();if(h==EnumDWT_ImageType.IT_BMP||h==EnumDWT_ImageType.IT_JPG||h==EnumDWT_ImageType.IT_PNG){if(n.length>1)return e.Errors.UploadIndexMoreThanOne(d),l()}else if(h!=EnumDWT_ImageType.IT_TIF&&h!=EnumDWT_ImageType.IT_PDF)return e.Errors.InvalidImageType(d),l();if(f!=EnumDWT_UploadDataFormat.Binary&&f!=EnumDWT_UploadDataFormat.Base64)return e.Errors.InvalidDataFormat(d),l();d.__HTTPPostResponseString="",e.cancelFrome=1;var y=function(){var t=d.curCommand_SaveImagesToBytes.length;if(e.needShowTwiceShowDialog=!1,e.closeProgress(g),t>0){e.cancelFrome=1,e.needShowTwiceShowDialog=!0,e.showProgress(d,g,!1);var n=d.curCommand_SaveImagesToBytes[0];r.sendData(n.objWS,n.json,!1,n.binary)}return e.isFunction(u)&&u(d.ErrorCode,d.ErrorString,d.__HTTPPostResponseString),!1};if(c=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");d._OnPercentDone([0,t,"","http"])},f==EnumDWT_UploadDataFormat.Binary){var I="",S=0;if(!(m=r.__SetSelectedImages(d,"",n)))return y();if(e.needShowTwiceShowDialog=!0,e.showProgress(d,g,!1),!(m=d.__GetSelectedImagesLength(h,-2,function(e){var t=e.split(";");2==t.length&&(I=t[0],S=parseInt(t[1]))})))return y();if(0==S)return e.Errors.UploadFileCannotEmpty(d),y();if(v>0&&S>v){var b=o.GetHttpHeadersAndClear(d);b["dwt-md5"]=I,d._OnPercentDone([0,-1,"HTTP Uploading...","http"]),m=o.UploadBinary(d,p,h,S,b,0,_,c,function(){e.needShowTwiceShowDialog=!1,e.closeProgress(g),e.isFunction(s)&&s(d.__HTTPPostResponseString)},y)}else d.__innnerHTTPUploadBinaryFull(t,I,S,h,s,y)}else if(f==EnumDWT_UploadDataFormat.Base64){var T=r.addImageFileExt("RemoteFile",h);e.needShowTwiceShowDialog=!0,e.showProgress(d,g,!1),m=d.ConvertToBase64(n,h,function(n){if(!n||n.getLength()<=0)return e.Errors.UploadFileCannotEmpty(d),y();if(v>0&&n.getLength()>v){var r=n.getMD5(),i=o.GetHttpHeadersAndClear(d);i["dwt-md5"]=r,d._OnPercentDone([0,-1,"HTTP Uploading...","http"]),o.UploadBase64(d,p,h,n,T,i,0,_,c,function(){e.needShowTwiceShowDialog=!1,e.closeProgress(g),e.isFunction(s)&&s(d.__HTTPPostResponseString)},y)}else{var a;r=n.getMD5();if(!(a=n.getData(0,n.getLength()))||""==a)return e.Errors.UploadFileCannotEmpty(d),y();d.__innnerHTTPUploadBase64Full(t,r,a,h,s,y)}},y)}return m};var o={UploadBinary:function(t,n,i,a,s,u,l,c,d,h){var f,g;return(f=a-u)>0?(f>=l?(f-=l,g=l):(g=f,f=0),t.__SaveSelectedImagesToBytesByBlock(i,u,g,function(p,m){return p?e.dlgRef>0||0==t.__IfShowCancelDialogWhenImageTransfer?(p.name="RemoteFile",r.setBtnCancelVisibleForProgress(t,!0),s["Content-Range"]=["bytes ",m,"-",m+p.size-1,"/",a].join(""),c({total:a,loaded:u}),r.httpPostUpload(t,n,p,!0,0,s,!1,function(p){if(t.curCommand_SaveImagesToBytes.length>0){e.cancelFrome=1;var m=t.curCommand_SaveImagesToBytes[0];r.sendData(m.objWS,m.json,!1,m.binary)}0==f?(e.needShowTwiceShowDialog=!1,c({total:a,loaded:a}),e.isFunction(d)&&d(p)):(u+=g,setTimeout(function(){e.cancelFrome=1,o.UploadBinary(t,n,i,a,s,u,l,c,d,h)},100))},h),!0):(e.Errors.UploadError(t,!0),h()):(e.Errors.UploadFileCannotEmpty(t),h())},h)):(e.needShowTwiceShowDialog=!1,e.closeProgress("HttpUpload"),e.isFunction(d)&&d("")),!0},UploadBase64:function(t,n,i,a,s,u,l,c,d,h,f){var g,p,m=a.getLength();return(g=m-l)>0?(g>=c?(g-=c,p=c):(p=g,g=0),t.__GetBase64ResultDataAsync(-1,l,c,function(_){return strBase64Data=_[0],strBase64Data&&""!=strBase64Data?e.dlgRef>0||0==t.__IfShowCancelDialogWhenImageTransfer?(r.setBtnCancelVisibleForProgress(t,!0),u["Content-Range"]=["bytes ",l,"-",l+p-1,"/",m].join(""),d({total:m,loaded:l}),r.httpPostUploadString(t,n,strBase64Data,s,0,u,!1,function(_){if(t.curCommand_SaveImagesToBytes.length>0){e.cancelFrome=1;var v=t.curCommand_SaveImagesToBytes[0];r.sendData(v.objWS,v.json,!1,v.binary)}0==g?(e.needShowTwiceShowDialog=!1,d({total:m,loaded:m}),e.isFunction(h)&&h(_)):(l+=p,setTimeout(function(){e.cancelFrome=1,o.UploadBase64(t,n,i,a,s,u,l,c,d,h,f)},100))},f),!0):(e.Errors.UploadError(t,!0),f()):(e.Errors.UploadFileCannotEmpty(t),f())},f)):(e.needShowTwiceShowDialog=!1,e.closeProgress("HttpUpload"),e.isFunction(h)&&h("")),!0},GetHttpHeadersAndClear:function(e){var t=e.__httpHeaderMap;return e.__httpHeaderMap={},t||(t={}),t}};n.__innnerHTTPUploadBinaryFull=function(t,n,i,a,s,u){var l,c=this,d=o.GetHttpHeadersAndClear(c),h="HTTPUpload",f=t;l=r.addImageFileExt("RemoteFile",a);return d["dwt-md5"]=n,c.__SaveSelectedImagesToBytesByBlock(a,0,i,function(t,n){return!t||t.size<=0?(e.Errors.UploadFileCannotEmpty(c),u()):e.dlgRef>0||0==c.__IfShowCancelDialogWhenImageTransfer?(t.name=l,r.setBtnCancelVisibleForProgress(c,!0),r.httpPostUpload(c,f,t,!0,0,d,!0,function(t){var n=c.curCommand_SaveImagesToBytes.length;if(e.needShowTwiceShowDialog=!1,e.closeProgress(h),e.isFunction(s)&&s(t),n>0){e.cancelFrome=1,e.needShowTwiceShowDialog=!0,e.showProgress(c,h,!1);var o=c.curCommand_SaveImagesToBytes[0];r.sendData(o.objWS,o.json,!1,o.binary)}},u)):(e.Errors.UploadError(c,!0),u())},u)},n.__innnerHTTPUploadBase64Full=function(t,n,i,a,s,u){var l,c=this,d=o.GetHttpHeadersAndClear(c),h="HTTPUpload",f=t;return l=r.addImageFileExt("RemoteFile",a),e.needShowTwiceShowDialog=!0,e.showProgress(c,h,!1),e.dlgRef>0||0==c.__IfShowCancelDialogWhenImageTransfer?(d&&(d["dwt-md5"]=n),r.setBtnCancelVisibleForProgress(c,!0),r.httpPostUploadString(c,f,i,l,0,d,!0,function(t){var n=c.curCommand_SaveImagesToBytes.length;if(e.needShowTwiceShowDialog=!1,e.closeProgress(h),e.isFunction(s)&&s(t),n>0){e.cancelFrome=1,e.needShowTwiceShowDialog=!0,e.showProgress(c,h,!1);var o=c.curCommand_SaveImagesToBytes[0];r.sendData(o.objWS,o.json,!1,o.binary)}},u)):(e.Errors.UploadError(c,!0),u())},n.ConvertToBase64=function(t,n,o,i){var a=this,s=parseInt(n),u="SaveSelectedImagesToBase64Binary";if(r.isServerInvalid(a))return e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),!1;if(!a._checkIndices(t))return e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),!1;if(s==EnumDWT_ImageType.IT_BMP||s==EnumDWT_ImageType.IT_JPG||s==EnumDWT_ImageType.IT_PNG){if(t.length>1)return e.Errors.ConvertBase64IndexMoreThanOne(a),e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),!1}else if(s!=EnumDWT_ImageType.IT_TIF&&s!=EnumDWT_ImageType.IT_PDF)return e.Errors.InvalidImageType(a),e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),!1;if(!r.__SetSelectedImages(a,"",t))return e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),!1;e.showProgress(a,u,!1);var l=function(){return e.closeProgress(u),e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),!1};return a._innerSend(u,r.makeParams(s,0,0),!0,function(t){var n,r,i=0,s="";0==a.ErrorCode?t&&e.isArray(t)&&1==t.length?(2==(r=t[0].split(";")).length&&(s=r[0],i=parseInt(r[1])),n=new e.html5.Base64Result(a,i,s),e.closeProgress(u),e.isFunction(o)&&o(n)):(e.Errors.ConvertBase64Failed(a),l()):l()},l)},n.ClearAllHTTPFormField=function(){return this.httpFormFields={},!0},n.SetHTTPFormField=function(t,n){var r=t;return e.isString(r)||(r=""+r),this.httpFormFields[r]=n,!0},n.HTTPUploadAllThroughPostAsMultiPageTIFF=function(e,t,n,r,o){return this.HTTPUploadThroughPostEx(e,-1,t,n,2,r,o)},n.HTTPUploadThroughPostAsMultiPageTIFF=function(e,t,n,r,o){return this.HTTPUploadThroughPostEx(e,-2,t,n,2,r,o)},n.HTTPUploadAllThroughPostAsPDF=function(e,t,n,r,o){return this.HTTPUploadThroughPostEx(e,-1,t,n,4,r,o)},n.HTTPUploadThroughPostAsMultiPagePDF=function(e,t,n,r,o){return this.HTTPUploadThroughPostEx(e,-2,t,n,4,r,o)},n.HTTPUploadThroughPutDirectly=function(t,n,r,o,i){return e.Errors.HTML5NotSupport(this),!1},n.HTTPUploadThroughPut=function(e,t,n,o,i){var a=r.getImageType(n);return this.HTTPUploadThroughPutEx(e,t,n,a,o,i)},n.HTTPUploadThroughPutEx=function(t,n,i,a,s,u){var l=this,c=o.GetHttpHeadersAndClear(l),d="HTTPUploadThroughPutEx",h=r.combineUrl(l,t,i),f=!0;if(!1===h)return e.Errors.ParameterCannotEmpty(l),!1;e.isFunction(s)||(f=!1),e.cancelFrome=1;var g,p=function(){var t=l.curCommand_SaveImagesToBytes.length;if(e.needShowTwiceShowDialog=!1,e.closeProgress(d),e.isFunction(u)&&u(l.ErrorCode,l.ErrorString,l.__HTTPPostResponseString),t>0){e.cancelFrome=1,e.needShowTwiceShowDialog=!0,e.showProgress(l,d,!1);var n=l.curCommand_SaveImagesToBytes[0];r.sendData(n.objWS,n.json,!1,n.binary)}return!1};if(e.needShowTwiceShowDialog=!0,e.showProgress(l,d,!1),""===t)return e.Errors.HttpServerCannotEmpty(l),p();if(-2==n){if(!r.__SetSelectedImages(l,l._UIManager.GetCurrentImageIndex(),l._UIManager.GetSelectedIndexes()))return p()}else if(!(-1==n||n>=0))return e.Errors.IndexOutOfRange(l),p();return l.__GetSelectedImagesLength(a,n,function(e){var t=e.split(";");2==t.length&&(md5=t[0],iLen=parseInt(t[1]))})?0==iLen?(e.Errors.UploadFileCannotEmpty(l),p()):(c["dwt-md5"]=md5,l.__SaveSelectedImagesToBytes(a,0,iLen,f,function(t){return e.needShowTwiceShowDialog=!1,t&&(e.dlgRef>0||0==l.__IfShowCancelDialogWhenImageTransfer||0==f)?(g=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");l._OnPercentDone([0,t,"","http"])},l._OnPercentDone([0,-1,"uploading...","http"]),r.setBtnCancelVisibleForProgress(l,!0),r.httpPutImage(l,h,t,f,function(t){var n=l.curCommand_SaveImagesToBytes.length;if(l.__HTTPPostResponseString=t,e.closeProgress(d),e.isFunction(s)&&s(l.__HTTPPostResponseString),n>0){e.cancelFrome=1,e.needShowTwiceShowDialog=!0,e.showProgress(l,d,!1);var o=l.curCommand_SaveImagesToBytes[0];r.sendData(o.objWS,o.json,!1,o.binary)}},p,g)):(e.closeProgress(d),!1)},p)):p()},n.HTTPUploadAllThroughPutAsMultiPageTIFF=function(e,t,n,r){return this.HTTPUploadThroughPutEx(e,-1,t,2,n,r)},n.HTTPUploadThroughPutAsMultiPageTIFF=function(e,t,n,r){return this.HTTPUploadThroughPutEx(e,-2,t,2,n,r)},n.HTTPUploadAllThroughPutAsPDF=function(e,t,n,r){return this.HTTPUploadThroughPutEx(e,-1,t,4,n,r)},n.HTTPUploadThroughPutAsMultiPagePDF=function(e,t,n,r){return this.HTTPUploadThroughPutEx(e,-2,t,4,n,r)},n.GetSelectedImagesSize=function(e){return!!r.__SetSelectedImages(this,this._UIManager.GetCurrentImageIndex(),this._UIManager.GetSelectedIndexes())&&this._innerFun("GetSelectedImagesSize",r.makeParams(e))},n.SetHTTPHeader=function(t,n){var r,o,i=this,a=t;if(i.__httpHeaderMap||(i.__httpHeaderMap={}),!a||!e.isString(a))return e.isUndefined(a)?e.Errors.HttpHeaderIsUndefined(i):""===a?e.Errors.HttpHeaderIsEmpty(i):null===a?e.Errors.HttpHeaderIsNull(i):e.Errors.HttpHeaderIsInvalid(i),!1;for(r=["if-modified-since","if-none-match","if-range","range","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via","dwt-md5"],a=a.toLowerCase(),o=0;o<r.length;o++)if(r[o]==a)return e.Errors.HttpHeaderNotAllowed(i),!1;return e.isUndefined(n)||null===n||""===n?(t in i.__httpHeaderMap&&delete i.__httpHeaderMap[t],!0):(e.isNumber(n)&&(n=""+n),i.__httpHeaderMap[t]=n,!0)},n.__GetBase64ResultData=function(e,t,n){return this._innerFun("SaveSelectedImagesToBase64Binary",r.makeParams(e,t,n))},n.__GetBase64ResultDataAsync=function(e,t,n,o,i){return this._innerFunRaw("SaveSelectedImagesToBase64Binary",r.makeParams(e,t,n),!0,!1,!1,o,i)},e.html5.Base64Result=function(e,t,n){this._stwain=e,this._md5=n,this._length=t},e.html5.Base64Result.prototype.getLength=function(){return this._length},e.html5.Base64Result.prototype.getMD5=function(){return this._md5},e.html5.Base64Result.prototype.getData=function(e,t){var n=t;return e<0||t<=0?"":(e+n>this._length&&(n=this._length-e),this._stwain.__GetBase64ResultData(-1,e,n))}}}(Dynamsoft.Lib),function(e){if(Dynamsoft.Lib.product.bChromeEdition){var t=Dynamsoft.Lib.html5.STwain,n=Dynamsoft.Lib.html5.Funs,r=t.prototype;r.RegisterEvent=function(e,t){return this[["__",e].join("")]=t,!0},r.onEvent=function(e,t){this.RegisterEvent(e,t)},r.on=function(e,t){this.RegisterEvent(e,t)},r.OnRefreshUI=function(e,t,n,r){return n&&this._UIManager.refresh(e,t,!0,r),Dynamsoft.Lib.isFunction(this.__OnRefreshUI)&&this.__OnRefreshUI(this._UIManager.GetCurrentImageIndex(),t),!0},r._OnBitmapChanged=function(e){var t=this,n=e[1].split(","),r=e[2],o=e[3],i=e[4],a=0;e.length>5&&(a=e[5]),t.__cIndex=o,t._HowManyImagesInBuffer=i,Dynamsoft.Lib.log("OnBitmapChanged:"+e),1==r||2==r?(Dynamsoft.Lib.each(n,function(e){var n=parseInt(e);if(isNaN(n)||n<0)return!0;t._UIManager.add(n,i,a)}),Dynamsoft.Lib.isFunction(t.__OnRefreshUI)&&t.__OnRefreshUI(o,i)):3==r?(1==n.length&&-1==n[0]||0==i?t._UIManager.clear():(Dynamsoft.Lib.each(n,function(e,n){var r=parseInt(e);if(isNaN(r)||r<0)return!0;t._UIManager.remove(r,o)}),o>=0&&!t.__bLoadingImage&&t._UIManager.count()>0&&t._UIManager.refreshEditor(o,i)),Dynamsoft.Lib.isFunction(t.__OnRefreshUI)&&t.__OnRefreshUI(o,i)):4==r?Dynamsoft.Lib.each(n,function(e,n){var r=parseInt(e);if(isNaN(r)||r<0)return!0;r>=0&&!t.__bLoadingImage&&t.OnRefreshUI(r,i,!0,a)}):5==r&&o>=0&&!t.__bLoadingImage&&t.OnRefreshUI(o,i,!0,a),Dynamsoft.Lib.isFunction(t.__OnBitmapChanged)&&t.__OnBitmapChanged(n,r,o,i)},r._OnPostLoad=function(e,t){var r,o,i;void 0!==t&&void 0!==t.exception&&void 0!==t.description&&(this._errorCode=t.exception,this._errorString=t.description),Dynamsoft.Lib.log("OnPostLoad Results:"),o=e[1].split(","),r=Dynamsoft.Lib.base64.decode(o[0]),name=Dynamsoft.Lib.base64.decode(o[1]),Dynamsoft.Lib.log(r),Dynamsoft.Lib.log(name),Dynamsoft.Lib.log(o[2]),n.autoDiscardBlankImage(this,"On PostLoad"),(i=this.__cIndex)>=0&&this.OnRefreshUI(i),Dynamsoft.Lib.isFunction(this.__OnPostLoad)&&this.__OnPostLoad(r,name,o[2])},r._OnPostTransfer=function(e){Dynamsoft.Lib.log("On PostTransfer Results:"+e),n.autoDiscardBlankImage(this,"On PostTransfer"),Dynamsoft.Lib.isFunction(this.__OnPostTransfer)&&this.__OnPostTransfer()},r._OnPostAllTransfers=function(e){var t=this._UIManager.GetCurrentImageIndex(),n=this._UIManager.count();e.length>=2&&(this._errorCode=e[1],this._errorString=e[2]),Dynamsoft.Lib.log("On PostAllTransfers Results:"+e),this.__bLoadingImage=!1,this._UIManager.refreshEditor(t,n),Dynamsoft.Lib.isFunction(this.__OnPostAllTransfers)&&this.__OnPostAllTransfers()},r._OnResult=function(e){var t=e[1];Dynamsoft.Lib.isFunction(this.__OnResult)&&this.__OnResult(t)},r._OnTransferCancelled=function(e){var t=this._UIManager.GetCurrentImageIndex(),n=this._UIManager.count();this.__bLoadingImage=!1,this._UIManager.refreshEditor(t,n),Dynamsoft.Lib.isFunction(this.__OnTransferCancelled)&&this.__OnTransferCancelled()},r._OnTransferError=function(e){Dynamsoft.Lib.isFunction(this.__OnTransferError)&&this.__OnTransferError()},r._OnSourceUIClose=function(e){Dynamsoft.Lib.isFunction(this.__OnSourceUIClose)&&this.__OnSourceUIClose()},r._OnPreTransfer=function(e){Dynamsoft.Lib.isFunction(this.__OnPreTransfer)&&this.__OnPreTransfer()},r._OnPreAllTransfers=function(e){Dynamsoft.Lib.isFunction(this.__OnPreAllTransfers)&&this.__OnPreAllTransfers()},r._OnPercentDone=function(e){var t=this,r=!1;if(0==Dynamsoft.Lib.cancelFrome&&1==t.__IfShowProgressBar||0!=Dynamsoft.Lib.cancelFrome&&1==t.__IfShowCancelDialogWhenImageTransfer){var o,i=Dynamsoft.Lib.get("progressBar"),a=Dynamsoft.Lib.get("status"),s=Dynamsoft.Lib.get("finalMessage"),u=0;if(3==Dynamsoft.Lib.cancelFrome||4==Dynamsoft.Lib.cancelFrome){var l=e[3];0==l?n.setBtnCancelVisibleForProgress(t,!1):1==l&&n.setBtnCancelVisibleForProgress(t,!0)}if((u=e[1])<0?(u=0,Dynamsoft.Lib.progressMessage=e[2],o=Dynamsoft.Lib.progressMessage):(o=""!=e[2]?Dynamsoft.Lib.progressMessage+"("+e[2]+")":Dynamsoft.Lib.progressMessage,1!=Dynamsoft.Lib.cancelFrome&&2!=Dynamsoft.Lib.cancelFrome||"http"==e[3]&&(r=!0),3!=Dynamsoft.Lib.cancelFrome&&4!=Dynamsoft.Lib.cancelFrome||"ftp"==e[4]&&(r=!0)),s&&(s.innerHTML=o),(u||0===u)&&(a&&(a.innerHTML=u+"%"),i&&(Dynamsoft.Lib.env.bIE&&i.objProgressBar?i.objProgressBar.setValue(u):i.value=u),1==r&&(Dynamsoft.Lib.isFunction(t.__OnInternetTransferPercentage)&&t.__OnInternetTransferPercentage(u,!1),Dynamsoft.Lib.isFunction(t.__OnInternetTransferPercentageEx)&&t.__OnInternetTransferPercentageEx(u,!1))),u&&(u>=100||Dynamsoft.Lib.dlgRef<=0)&&Dynamsoft.Lib.dlgRef<=0){Dynamsoft.Lib.closeProgress("OnPercentDone")}}Dynamsoft.Lib.isFunction(t.__OnPercentDone)&&t.__OnPercentDone()},r._OnGetFilePath=function(e){var t,n;n=e[1].split(","),Dynamsoft.Lib.log("On GetFilePath Results:"+e),t=Dynamsoft.Lib.base64.decode(n[3]),name=Dynamsoft.Lib.base64.decode(n[4]),Dynamsoft.Lib.isFunction(this.__OnGetFilePath)&&this.__OnGetFilePath(n[0],n[1],n[2],t,name)},r.checkErrorString=function(){var e=this.ErrorCode;if(-2115===e)return!0;-2003===e&&window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no").document.writeln(this.__HTTPPostResponseString);return 0===e}}}(),function(e){if(e.product.bChromeEdition){var t=e.html5.STwain,n=(t.prototype,e.html5.Funs);t.prototype.ShowImageEditor=function(){return!n.isServerInvalid(this)&&this.ShowImageEditorEx(-1,-1,-1,-1,0)},t.prototype.SetCookie=function(e){return this._cookie=e,document.cookie=e,!0},t.prototype.LoadImageFromBase64Binary=function(t,r){var o;return!!e.html5.Funs.checkProductKey(this,{Core:!0})&&(!!e.html5.Funs.checkPDFProductKeyWhenNeeds(this,r)&&(o=this._innerFun("LoadImageFromBase64Binary",n.makeParams(t,r)),0==this.ErrorCode&&(this._HowManyImagesInBuffer=this._innerFun("HowManyImagesInBuffer"),this.__cIndex=this._innerFun("CurrentImageIndexInBuffer")),o))},t.prototype.SaveSelectedImagesToBytes=function(t,n){return e.Errors.HTML5NotSupport(this),!1},t.prototype.LoadImageFromBytes=function(t,n,r){return e.Errors.HTML5NotSupport(this),!1},t.prototype.UnregisterEvent=function(e,t){return this[["__",e].join("")]=null,!0},t.prototype.first=function(){return this._UIManager.count()>0&&(this._UIManager.getView().Go(0),n.__innerRefreshFromUIView(this,this._UIManager.GetCurrentImageIndex())),!0},t.prototype.previous=function(){return this._UIManager.count()>0&&(this._UIManager.getView().__Previous(),n.__innerRefreshFromUIView(this,this._UIManager.GetCurrentImageIndex())),!0},t.prototype.next=function(){return this._UIManager.count()>0&&(this._UIManager.getView().__Next(),n.__innerRefreshFromUIView(this,this._UIManager.GetCurrentImageIndex())),!0},t.prototype.last=function(){var e=this._UIManager.count();return e>0&&(this._UIManager.getView().Go(e-1),n.__innerRefreshFromUIView(this,this._UIManager.GetCurrentImageIndex())),!0},t.prototype.SetCancel=function(e,t){return this._innerSend("SetCancel",null,!0,e,t)},t.prototype.SetImageWidth=function(e,t){return this._innerFun("SetImageWidth",n.makeParams(e,t))},t.prototype.HTTPDownloadStreamThroughPost=function(t,n){return e.Errors.HTML5NotSupport(this),!1},t.prototype.HTTPUploadStreamThroughPost=function(t,n,r,o,i){return e.Errors.HTML5NotSupport(this),!1},t.prototype.HTTPDownloadThroughPost=function(t,r,o,i,a){var s=this,u=n.combineUrl(s,t,r);if(!1===u)return e.Errors.ParameterCannotEmpty(s),!1;if(n.isServerInvalid(s))return e.isFunction(a)&&a(s.ErrorCode,s.ErrorString),!1;if(!e.html5.Funs.checkProductKey(s,{Core:!0}))return e.isFunction(a)&&a(s._errorCode,s._errorString),!1;if(!e.html5.Funs.checkPDFProductKeyWhenNeeds(s,o))return e.isFunction(a)&&a(s._errorCode,s._errorString),!1;e.cancelFrome=2,e.showProgress(s,"HttpDownloadThroughPost",!0);var l=!0;return s._OnPercentDone([0,-1,"HTTP Downloading...","http"]),e.isFunction(i)||(l=!1),n.loadHttpBlob(s,"post",u,l,function(e){s._OnPercentDone([0,-1,"Loading..."]);var t=o;(t<-1||t>5)&&(t=-1),s.__LoadImageFromBytes(e,t,"",l,i,a)},function(){e.closeProgress("HttpDownloadThroughPost"),e.isFunction(a)&&a(s.ErrorCode,s.ErrorString)},function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");s._OnPercentDone([0,t,"","http"])})},t.prototype.HTTPDownloadThroughGet=function(t,r,o,i,a){var s=this,u=n.combineUrl(s,t,r);if(!1===u)return e.Errors.ParameterCannotEmpty(s),!1;if(n.isServerInvalid(s))return e.isFunction(a)&&a(s.ErrorCode,s.ErrorString),!1;if(!e.html5.Funs.checkProductKey(s,{Core:!0}))return e.isFunction(a)&&a(s._errorCode,s._errorString),!1;if(!e.html5.Funs.checkPDFProductKeyWhenNeeds(s,o))return e.isFunction(a)&&a(s._errorCode,s._errorString),!1;e.cancelFrome=2,e.showProgress(s,"HTTPDownloadThroughGet",!0);var l=!0;return s._OnPercentDone([0,-1,"HTTP Downloading...","http"]),e.isFunction(i)||(l=!1),n.loadHttpBlob(s,"get",u,l,function(e){s._OnPercentDone([0,-1,"Loading..."]);var t=o;(t<-1||t>5)&&(t=-1),s.__LoadImageFromBytes(e,t,"",l,i,a)},function(){e.closeProgress("HTTPDownloadThroughGet"),e.isFunction(a)&&a(s.ErrorCode,s.ErrorString)},function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");s._OnPercentDone([0,t,"","http"])})},t.prototype.SetCustomDSDataEx=function(e){return this._innerFun("SetCustomDSDataEx",n.makeParams(e))},t.prototype.SetCustomDSData=function(e){var t=n.replaceLocalFilename(e);return this._innerFun("SetCustomDSData",n.makeParams(t))},t.prototype.GetCustomDSDataEx=function(){return this._innerFun("GetCustomDSDataEx")},t.prototype.GetCustomDSData=function(e){var t=n.replaceLocalFilename(e);return this._innerFun("GetCustomDSData",n.makeParams(t))},t.prototype.ChangeBitDepth=function(e,t,r){return this._innerFun("ChangeBitDepth",n.makeParams(e,t,r))},t.prototype.ConvertToGrayScale=function(e){return this._innerFun("ConvertToGrayScale",n.makeParams(e))},t.prototype.ShowImageEditorEx=function(e,t,n,r,o){return this._UIManager.ShowImageEditorEx(e,t,n,r,o)},t.prototype.ClearTiffCustomTag=function(){return this._innerFun("ClearTiffCustomTag")},t.prototype.SetTiffCustomTag=function(e,t,r){return this._innerFun("SetTiffCustomTag",n.makeParams(e,t,r))},t.prototype.IsBlankImage=function(e){return this._innerFun("IsBlankImage",n.makeParams(e,!1))},t.prototype.IsBlankImageExpress=function(e){return this._innerFun("IsBlankImage",n.makeParams(e,!0))},t.prototype.GetVersionInfoAsync=function(e,t){return this._innerSend("VersionInfo",null,!0,e,t)},t.prototype.SetOpenSourceTimeout=function(e){return this._innerFun("SetOpenSourceTimeout",n.makeParams(e))},t.prototype.GetLicenseInfo=function(){if(!this.__licenseInfo){if(n.isHttpServerInvalid(this))return!1;var e;(e=this._innerFunRaw("GetLicenseInfo",null,!1,!1,!0))&&!e.exception&&(this.__licenseInfo=e)}return this.__licenseInfo},t.prototype.GetImageURL=function(t,n,r){var o=t,i=parseInt(n),a=parseInt(r),s=[this.httpUrl,"img?id=",this.clientId];return e.isUndefined(o)||null===o?(e.Errors.IndexNullOrUndefined(this),""):(o=parseInt(o),isNaN(o)?(e.Errors.InvalidIndex(this),""):o<0||o>=this.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(this),""):(s.push("&index="),s.push(o),i>0&&a>0&&(s.push("&width="),s.push(i),s.push("&height="),s.push(a)),s.push("&t="),s.push((new Date).getTime()),s.join("")))}}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=!0,n=!1,r=function(e){};o.prototype.__changeSizeForData=function(e,t){var n=this;n.Width=e,n.Height=t,n.Horizontal?(n.scrollSize=n.Width-2*n.Height,n.arrowSize=n.Height):(n.scrollSize=n.Height-2*n.Width,n.arrowSize=n.Width),n.scrollZeroPos=n.arrowSize,n.canvas&&(n.canvas.width=e,n.canvas.height=t)},o.prototype.__init=function(r){var o=this;window.document;r.MaxValue&&(o._maxPosition=r.MaxValue),r.Value&&o.SetPosition(r.Value),o.Horizontal=r.Horizontal,o.__changeSizeForData(r.Width,r.Height),o.bCanvas?(o.canvas=document.createElement("canvas"),o.canvas.width=o.Width,o.canvas.height=o.Height):(o.canvas=document.createElement("div"),o.canvas.style.width=o.Width+"px",o.canvas.style.height=o.Height+"px",o.canvas.style.border="1px solid #CCC",o.canvas.style.position="relative",o.divSlide=document.createElement("div"),o.divSlide.style.position="absolute",o.divSlide.style.top="0",o.divSlide.style.left="0",o.divArrow1=document.createElement("div"),o.divArrow1.style.position="absolute",o.divArrow1.style.top="0",o.divArrow1.style.left="0",o.divArrow2=document.createElement("div"),o.divArrow2.style.position="absolute",o.divArrow2.style.top="0",o.divArrow2.style.left="0",o.canvas.appendChild(o.divArrow1),o.canvas.appendChild(o.divSlide),o.canvas.appendChild(o.divArrow2),o.arrowColor="#777",o.arrowSize=12),o.canvas.onselectstart=function(){return n},Dynamsoft.Lib.addEventListener(o.canvas,"mousedown",function(t){o.onMouseDown(t),e.stopPropagation(t)}),Dynamsoft.Lib.addEventListener(o.canvas,"mouseenter",function(e){o.bFocus=t}),Dynamsoft.Lib.addEventListener(o.canvas,"mouseleave",function(e){o.bFocus=n}),o.onValueChanged=r.onValueChanged},o.prototype.InitScroll=function(e,r){var o=0;return e>=r&&r>=0?(this._PagePositionSize=r,o=e-r,this.SetMaxPosition(o),t):n},o.prototype.GetPagePositionSize=function(){return this._PagePositionSize},o.prototype.SetPagePositionSize=function(e){return this._PagePositionSize=e,t},o.prototype.__getCurrentPage=function(){return this._currentPosition/this._PagePositionSize},o.prototype.GetMaxPage=function(){return this._maxPosition/this._PagePositionSize-1},o.prototype.GetCurrentPosition=function(){return this._currentPosition},o.prototype.SetPosition=function(t){var n=t;(e.isUndefined(t)||e.isNaN(t))&&(t=0),n<0?n=0:n>this._maxPosition&&(n=this._maxPosition),this._currentPosition=n},o.prototype.GetEL=function(){return this.canvas},o.prototype.Refresh=function(){return this.__drawScroll(),t},o.prototype.ChangeControlSize=function(e,t){this.__changeSizeForData(e,t),this.__drawFrame(),this.__drawScroll()},o.prototype.GetControlHeight=function(){return this.Height},o.prototype.GetControlWidth=function(){return this.Width},o.prototype.onMouseDown=function(o){var i,a,s,u,l=this,c=o.target,d=n;if(c==l.canvas||c==l.divArrow1||c==l.divArrow2?(c==l.canvas?(i=e.DOM.getOffset(o),r("mouse down"+i.x+" "+i.y),s=l.Horizontal?i.x:i.y):c==l.divArrow1?s=0:c==l.divArrow2&&(s=l.scrollSize+l.arrowSize),s<=l.arrowSize?(u=l._currentPosition,l.__click_previous(),u!=l._currentPosition&&l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onPrevious"})):s>=l.scrollSize+l.arrowSize?(u=l._currentPosition,l.__click_next(),u!=l._currentPosition&&l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onNext"})):(u=l._currentPosition,(a=l.__getPosDirection(i.x,i.y))<0?(l.PageUp(),u!=l._currentPosition&&l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onPageUp"})):a>0?(l.PageDown(),u!=l._currentPosition&&l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onPageDown"})):d=t)):c==l.divSlide&&(i=e.DOM.getOffset(o),a=0,d=t,r("mouse down"+i.x+" "+i.y)),d){l.dragging=t,l.canvas.style.cursor="default",l.mousePos_StartDrag.x=i.x,l.mousePos_StartDrag.y=i.y,l.mousePos_Dragging.x=i.x,l.mousePos_Dragging.y=i.y;var h,f=o||event;disX=f.clientX,disY=f.clientY,l.canvas.setCapture?(h=l.canvas,l.canvas.setCapture()):h=document,onMouseMove=function(e){var t=e||event,n={x:0,y:0};if(n.x=l.mousePos_StartDrag.x+t.clientX-disX,n.y=l.mousePos_StartDrag.y+t.clientY-disY,r("onMouseMove: "+n.x+" "+n.y),l.dragging){var o=l.__caculateDraggingNewPosition(n.x,n.y);o!=l._currentPosition&&(l.SetPosition(o),l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onMouseMoving"})),l.__drawScroll("mousemove")}},onMouseUp=function(e){var t=e||event,o={x:0,y:0};if(o.x=l.mousePos_StartDrag.x+t.clientX-disX,o.y=l.mousePos_StartDrag.y+t.clientY-disY,r("onMouseUp: "+o.x+" "+o.y),l.canvas.releaseCapture&&l.canvas.releaseCapture(),Dynamsoft.Lib.removeEventListener(h,"mouseup",onMouseUp),Dynamsoft.Lib.removeEventListener(h,"mousemove",onMouseMove),l.dragging){var i=l.__caculateDraggingNewPosition(o.x,o.y);i!=l._currentPosition&&(l.SetPosition(i),l.__drawScroll(),l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onMouseUp"})),l.dragging=n,l.mousePos_StartDrag.x=-1,l.mousePos_StartDrag.y=-1}},Dynamsoft.Lib.addEventListener(h,"mouseup",onMouseUp),Dynamsoft.Lib.addEventListener(h,"mousemove",onMouseMove),l.__drawScroll("mousedown")}},o.prototype.GetScrollDelta=function(e){return e*this.__caculateSlideSize()},o.prototype.ManualMoving=function(t){var n,o=this;r("ManualMoving: "+[o._currentPosition,t].join(",")),e.isUndefined(t)||e.isNaN(t)||e.isUndefined(o._currentPosition)||e.isNaN(o._currentPosition)||(n=o._currentPosition,o.SetPosition(o._currentPosition+t),n!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onMouseMoving"}),o.__drawScroll("mousemove"))},o.prototype.ManualMovingScroll=function(e){var t,n,o=this,i=0;n=o._currentPosition,t=o.__caculateSlideSize(),i=o._currentPosition+o._PagePositionSize*e/t,r("ManualMovingScroll: "+[e,t,e/t,o._currentPosition,i].join(",")),o.SetPosition(i),n!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onMouseMoving"}),o.__drawScroll("mousemove")},o.prototype.handlerKeyDown=function(e){var r,o=this,i=t;if(!o.bFocus)return i;switch(r=o._currentPosition,e.keyCode){case 37:o.Horizontal&&(i=n,o.Previous(),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onPrevious"}));break;case 39:o.Horizontal&&(i=n,o.Next(),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onNext"}));break;case 38:o.Horizontal||(i=n,o.Previous(),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onPrevious"}));break;case 40:o.Horizontal||(i=n,o.Next(),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onNext"}));break;case 33:i=n,o.PageUp(),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onPageUp"});break;case 34:i=n,o.PageDown(),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onPageDown"});break;case 35:i=n,o.GoPosition(o._maxPosition),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:o._currentPosition,EventName:"onEnd"});break;case 36:i=n,o.GoPosition(0),r!=o._currentPosition&&o.__fireEvent("onValueChanged",{Value:0,EventName:"onBegin"})}return i},o.prototype.__click_previous=function(){var e;r("__click_previous from mouse click arrow"),this.GoPosition(this._currentPosition-this._track,200),this.canvas&&this.bCanvas&&(e=this.canvas.getContext("2d"),this.__redrawUpOrLeftArrow(e,t))},o.prototype.__click_next=function(){var e;r("__click_next from mouse click arrow"),this.GoPosition(this._currentPosition+this._track,200),this.canvas&&this.bCanvas&&(e=this.canvas.getContext("2d"),this.__redrawDownOrRightArrow(e,t))},o.prototype.Previous=function(){r("previous"),this.GoPosition(this._currentPosition-this._track)},o.prototype.Next=function(){r("next"),this.GoPosition(this._currentPosition+this._track)},o.prototype.PageUp=function(){r("pageUp"),this.GoPosition(this._currentPosition-this._PagePositionSize)},o.prototype.PageDown=function(){r("pageDown"),this.GoPosition(this._currentPosition+this._PagePositionSize)},o.prototype.GetMaxPosition=function(){return this._maxPosition},o.prototype.SetMaxPosition=function(t){var n=this;if(e.isUndefined(t)||e.isNaN(t))return n._maxPosition=0,void(n._currentPosition=0);n._maxPosition=t,n._maxPosition<0&&(n._maxPosition=0),n._currentPosition<0?n._currentPosition=0:n._currentPosition>n._maxPosition&&(n._currentPosition=n._maxPosition)},o.prototype.GoPage=function(e){var t;return r("go page: "+e),t=e*this._PagePositionSize,this.GoPosition(t)},o.prototype.GoPosition=function(e,t){var n=this;r("go position: "+e),n.SetPosition(e),t&&t>0?setTimeout(function(){n.__drawScroll()},t):n.__drawScroll()},o.prototype.__drawBoxBorder=function(e,t,n,r,o,i,a){var s,u,l,c,d,h,f,g,p,m,_;if(g=Math.floor(t),p=Math.floor(n),!(r<=0||o<=0)){try{m=Math.floor(r),_=Math.floor(o)}catch(e){return}for(c=(d=e.getImageData(g,p,m,_)).data,h=this.__getHexColor(i),f=this.__getHexColor(a),l=0,s=0;s<m;s++)c[l]=h[0],c[l+1]=h[1],c[l+2]=h[2],l+=4;for(s=0,u=0;u<_;u++)c[l=4*(u*m+s)]=h[0],c[l+1]=h[1],c[l+2]=h[2];for(u=0;u<_;u++)c[l=4*(u*m+(s=m-1))]=f[0],c[l+1]=f[1],c[l+2]=f[2];for(l=(_-1)*m*4,s=0;s<m;s++)c[l]=f[0],c[l+1]=f[1],c[l+2]=f[2],l+=4;e.putImageData(d,g,p)}},o.prototype.__drawUpTriangle=function(e,t,n){var r,o,i,a,s,u,l,c,d,h;for(l=Math.floor(t),c=Math.floor(n),d=Math.floor(9),h=Math.floor(4),a=(s=e.getImageData(l,c,d,h)).data,o=0;o<4;o++)for(u=(r=4-o)+1+2*o,i=4*(9*o+r);r<u;)a[i]=a[i+1]=a[i+2]=0,r++,i+=4;e.putImageData(s,t,n)},o.prototype.__drawDownTriangle=function(e,t,n){var r,o,i,a,s,u,l,c,d,h;for(l=Math.floor(t),c=Math.floor(n),d=Math.floor(9),h=Math.floor(4),a=(s=e.getImageData(l,c,d,h)).data,o=0;o<4;o++)for(u=(r=o)+7-2*o,i=4*(9*o+r);r<u;)a[i]=a[i+1]=a[i+2]=0,r++,i+=4;e.putImageData(s,t,n)},o.prototype.__drawLeftTriangle=function(e,t,n){var r,o,i,a,s,u,l,c,d;for(u=Math.floor(t),l=Math.floor(n),c=Math.floor(4),d=Math.floor(7),a=(s=e.getImageData(u,l,c,d)).data,o=0;o<7;o++)for(i=4*(4*o+(r=o>3?o-3:3-o));r<4;)a[i]=a[i+1]=a[i+2]=0,r++,i+=4;e.putImageData(s,t,n)},o.prototype.__drawRightTriangle=function(e,t,n){var r,o,i,a,s,u,l,c,d;for(u=Math.floor(t),l=Math.floor(n),c=Math.floor(4),d=Math.floor(7),a=(s=e.getImageData(u,l,c,d)).data,o=0;o<7;o++)for(r=0,max=o>3?7-o:o+1,i=4*(4*o+r);r<max;)a[i]=a[i+1]=a[i+2]=0,r++,i+=4;e.putImageData(s,t,n)},o.prototype.__drawBox=function(t,n,r,o,i,a,s,u,l,c){var d,h,f=this;if(!(o<=0||i<=0)){try{d=Math.floor(o),h=Math.floor(i)}catch(e){return}t?(t.fillStyle=a,t.fillRect(n,r,d,h),t.lineWidth=f.borderWidth,e.drawBoxBorder(t,n+0,r+0,d-0,h-0,s,u),n+=f.borderWidth,r+=f.borderWidth,d-=2*f.borderWidth,h-=2*f.borderWidth,e.drawBoxBorder(t,n+0,r+0,d-0,h-0,l,c)):f.divSlide&&(f.divSlide.style.backgroundColor=a,f.divSlide.style.left=n+"px",f.divSlide.style.top=r+"px",f.divSlide.style.width=d+"px",f.divSlide.style.height=h+"px")}},o.prototype.__drawBackground=function(e,t,n){var r,o,i,a,s,u,l;if(e.fillStyle=this.bgColor,this.Width>0&&this.Height>0){for(e.fillRect(this.borderWidth,this.borderWidth,this.Width-2*this.borderWidth,this.Height-2*this.borderWidth),0,0,u=Math.floor(t),l=Math.floor(n),a=(s=e.getImageData(0,0,u,l)).data,o=0;o<n;o++)for(i=4*(o*t+(r=o%2));r<t;)a[i]=a[i+1]=a[i+2]=255,r+=2,i+=8;e.putImageData(s,0,0)}},o.prototype.__drawUpButton=function(e,t){var n,r=this;n=t?r.arrowHoverColor:r.arrowColor,e?(r.__drawBox(e,0,0,r.arrowSize,r.arrowSize,n,r.boxOuterBorderLightColor,r.boxOuterBorderDarkColor,r.boxInnerBorderLightColor,r.boxInnerBorderDarkColor),r.__drawUpTriangle(e,3,6,r.arrowColor)):r.divArrow1&&(r.divArrow1.style.top=-r.arrowSize/4+"px",r.divArrow1.style.left=(r.Width-r.arrowSize)/2+"px",r.divArrow1.style.borderStyle="dotted dotted solid",r.divArrow1.style.borderWidth=r.arrowSize/2+"px",r.divArrow1.style.borderColor="transparent transparent "+r.arrowColor,r.divArrow1.style.overflow="hidden")},o.prototype.__drawDownButton=function(e,t){var n,r=this;n=t?r.arrowHoverColor:r.arrowColor,e?(r.__drawBox(e,0,r.Height-r.arrowSize,r.arrowSize,r.arrowSize,n,r.boxOuterBorderLightColor,r.boxOuterBorderDarkColor,r.boxInnerBorderLightColor,r.boxInnerBorderDarkColor),r.__drawDownTriangle(e,4,r.Height-10,r.arrowColor)):r.divArrow2&&(r.divArrow2.style.top=r.Height-3*r.arrowSize/4+"px",r.divArrow2.style.left=(r.Width-r.arrowSize)/2+"px",r.divArrow2.style.borderStyle="dotted dotted solid",r.divArrow2.style.borderWidth=r.arrowSize/2+"px",r.divArrow2.style.borderColor=r.arrowColor+" transparent transparent",r.divArrow2.style.overflow="hidden")},o.prototype.__drawLeftButton=function(e,t){var n,r=this;n=t?r.arrowHoverColor:r.arrowColor,e?(r.__drawBox(e,0,0,r.arrowSize,r.arrowSize,n,r.boxOuterBorderLightColor,r.boxOuterBorderDarkColor,r.boxInnerBorderLightColor,r.boxInnerBorderDarkColor),r.__drawLeftTriangle(e,5,4,r.arrowColor)):r.divArrow1&&(r.divArrow1.style.top=(r.Height-r.arrowSize)/2+"px",r.divArrow1.style.left=-r.arrowSize/4+"px",r.divArrow1.style.borderStyle="dotted solid dotted dotted",r.divArrow1.style.borderWidth=r.arrowSize/2+"px",r.divArrow1.style.borderColor="transparent "+r.arrowColor+" transparent transparent",r.divArrow1.style.overflow="hidden")},o.prototype.__drawRightButton=function(e,t){var n,r=this;n=t?r.arrowHoverColor:r.arrowColor,e?(r.__drawBox(e,r.Width-r.arrowSize,0,r.arrowSize,r.arrowSize,n,r.boxOuterBorderLightColor,r.boxOuterBorderDarkColor,r.boxInnerBorderLightColor,r.boxInnerBorderDarkColor),r.__drawRightTriangle(e,r.Width-10,4,r.arrowColor)):r.divArrow2&&(r.divArrow2.style.top=(r.Height-r.arrowSize)/2+"px",r.divArrow2.style.left=r.Width-3*r.arrowSize/4+"px",r.divArrow2.style.borderStyle="dotted dotted solid dotted",r.divArrow2.style.borderWidth=r.arrowSize/2+"px",r.divArrow2.style.borderColor="transparent transparent transparent "+r.arrowColor,r.divArrow2.style.overflow="hidden")},o.prototype.__drawFrame=function(){var e=this,t=n,r=n;e.canvas&&e.bCanvas&&((t=e.canvas.getContext("2d")).clearRect(0,0,e.Width,e.Height),e.__drawBackground(t,e.Width,e.Height)),e.__redrawUpOrLeftArrow(t,r),e.__redrawDownOrRightArrow(t,r)},o.prototype.__redrawUpOrLeftArrow=function(e,t){this.Horizontal?this.__drawLeftButton(e,t):this.__drawUpButton(e,t)},o.prototype.__redrawDownOrRightArrow=function(e,t){this.Horizontal?this.__drawRightButton(e,t):this.__drawDownButton(e,t)},o.prototype.__drawScroll=function(e){var t,o,i,a=this,s=n;a._maxPosition>0&&a.canvas?(a.canvas.style.display="",o=a.__caculateSlideSize(),t=Math.ceil(a.scrollZeroPos+a._currentPosition*o/a._PagePositionSize),r("__drawScroll: "+[t,a.__getCurrentPage(),o].join(",")),a.canvas&&a.bCanvas&&(s=a.canvas.getContext("2d")),a.__drawFrame(),i=a.bgColor,a.Horizontal?a.__drawBox(s,t,0,a.slideSize,a.Height,i,a.boxOuterBorderLightColor,a.boxOuterBorderDarkColor,a.boxInnerBorderLightColor,a.boxInnerBorderDarkColor):a.__drawBox(s,0,t,a.Width,a.slideSize,i,a.boxOuterBorderLightColor,a.boxOuterBorderDarkColor,a.boxInnerBorderLightColor,a.boxInnerBorderDarkColor)):a.canvas&&(a.canvas.style.display="none")},o.prototype.__caculateDraggingNewPosition=function(e,t){var n,o=this,i=0,a=0;return n=o.__caculateSlideSize(),slidePos=o.__caculateSlidePos(),o.Horizontal?(startPos=e-o.arrowSize,a=e-o.mousePos_Dragging.x,e):(startPos=t-o.arrowSize,a=t-o.mousePos_Dragging.y,t),r("__caculateDraggingNewPosition: "+[o._currentPosition,o._PagePositionSize,a,n].join(",")),(i=o._currentPosition+o._PagePositionSize*a/n)<0&&(i=0),i>o._maxPosition&&(i=o._maxPosition),o.mousePos_Dragging.x=e,o.mousePos_Dragging.y=t,i},o.prototype.__getPosDirection=function(e,t){var n,r;return n=this.__caculateSlidePos(),(r=this.Horizontal?e:t)<n.start?-1:r<=n.end?0:1},o.prototype.__caculateSlidePos=function(){var e,t,n={start:0,end:0};return e=this.__caculateSlideSize(),t=this.scrollSize+this.arrowSize,n.start=this.__getCurrentPage()*e+this.arrowSize,n.end=n.start+this.slideSize,n.end>=t&&(n.end=t,n.start=t-this.slideSize),n},o.prototype.__caculateSlideSize=function(){var e,t=this,n=0;return e=t.scrollSize,t._maxPosition>0&&e>0&&(t.slideSize=e*(t._PagePositionSize/(t._maxPosition+t._PagePositionSize)),t.slideSize<t.minslideSize?(t.slideSize=t.minslideSize,n=(e-t.slideSize)*t._PagePositionSize/t._maxPosition):n=t.slideSize),n},o.prototype.__fireEvent=function(n,r){return e.isFunction(this[n])?this[n](r):t},o.prototype.SetVisible=function(e){this.canvas&&(e?(this.canvas.style.display="",this.__drawFrame(),this.__drawScroll()):(this._maxPosition=0,this._currentPosition=0,this.canvas.style.display="none"))},o.prototype.GetVisible=function(){return this.canvas?"none"==this.canvas.style.display?n:t:n},o.prototype.Destroy=function(){this._maxPosition=0,this._currentPosition=0},o.prototype.SetLocation=function(e,t){var n=this;n.Left=e,n.Top=t,n.Right=e+n.Width,n.Bottom=e+n.Height,n.canvas&&(n.canvas.parentNode&&(n.canvas.parentNode.style.position="relative"),n.canvas.style.position="absolute",n.canvas.style.left=e+"px",n.canvas.style.top=t+"px")},Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{},Dynamsoft.Lib.UI.ScrollBar=o}function o(r){var o=this;o._maxPosition=0,o._currentPosition=0,o._PagePositionSize=1,o._track=1,o.Horizontal=n,o.Width=16,o.Height=-1,o.Left=0,o.Top=0,o.Right=0+o.Width,o.Bottom=0+o.Height,o.bgColor="#D4D0C8",o.boxOuterBorderLightColor="#D4D0C8",o.boxOuterBorderDarkColor="#404040",o.boxInnerBorderLightColor="#FFFFFF",o.boxInnerBorderDarkColor="#808080",o.arrowColor="#D4D0C8",o.arrowHoverColor="#BBBBBB",o.slideColor="#D4D0C8",o.draggingColor="#BBBBBB",o.hoverColor="#D4D0C8",o.arrowSize=o.Width,o.scrollSize=-1,o.scrollZeroPos=o.arrowSize,o.slideSize=-1,o.minslideSize=18,o.dragging=n,o.mousePos_StartDrag={x:-1,y:-1},o.mousePos_Dragging={x:-1,y:-1},o.mousePos={x:-1,y:-1},o.bFocus=n,o.borderWidth=1,o.borderStyle=0,o.canvas=n,o.bCanvas=n,e.product.bChromeEdition&&(o.bCanvas=t),o.divSlide=n,o.divArrow1=n,o.divArrow2=n,o.bFloatValue=t,o.__init(r)}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=!0,n=!1,r=function(e){};o.prototype.GetEL=function(){return this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0"),this.canvas},o.prototype.ChangeControlSize=function(e,t){var n=this;n.__controlWidth=e,n.__controlHeight=t,n.canvas&&(n.bCanvas?(n.canvas.width=n.__controlWidth,n.canvas.height=n.__controlHeight):(n.canvas.style.width=n.__controlWidth,n.canvas.style.height=n.__controlHeight))},o.prototype.SetDrawImageLocationAndSize=function(e,t,n,o){var i=this;r("SetLocationAndSize: "+[e,t,n,o].join(",")),i.drawWidth=n,i.drawHeight=o,i.Left=e,i.Top=t,i.Right=i.Left+i.drawWidth,i.Bottom=i.Top+i.drawHeight},o.prototype.__fireEvent=function(t,n){return!e.isFunction(this[t])||this[t](n)},o.prototype.__MouseShapeIsHand=function(){return this.imageControl.iMouseShape==EnumDWT_MouseShape.Hand},o.prototype.__MouseShapeIsZoom=function(){return this.imageControl.iMouseShape==EnumDWT_MouseShape.Zoom},o.prototype.__GetSelectionRectAspectRatio=function(){return this.imageControl.__fSelectionRectAspectRatio},o.prototype.__restoreCanvas=function(e,t,n){e&&(e.canvas.width=t,e.canvas.height=n)},o.prototype.__draw_dashRect=function(e,t,n,o){var i=this.canvas.getContext("2d"),a=this.drawWidth,s=this.drawHeight,u=e,l=t,c=n,d=o;this.canvas&&(r("__select_rect: "+[e,t,n,o].join(",")),c>a&&(c=a),d>s&&(d=s),u<0?u=0:u+c>a&&(c=a-u),l<0?l=0:l+d>s&&(d=s-l),i=this.canvas.getContext("2d"),this.__restoreCanvas(i,i.canvas.width,i.canvas.height),c>0&&d>0&&i.__dashedLineRect(u+this.Left,l+this.Top,c,d))},o.prototype.SetSelectedArea=function(e,t,n,o,i){var a,s,u,l,c,d,h=this,f=h.canvas.getContext("2d"),g=h.drawWidth,p=h.drawHeight,m=!1;return r("SetSelectedArea: "+[e,t,n,o].join(",")),!!h.canvas&&(e<n?(a=e,u=n):(a=n,u=e),t<o?(s=t,l=o):(s=o,l=t),a<0&&(a=0),s<0&&(s=0),(c=u-a)>g&&(u=a+(c=g)),(d=l-s)>p&&(l=s+(d=p)),e>g||t>p?m=!0:Math.abs(c)+Math.abs(d)<=5&&(m=!0),m?(a=h.selectedCanvasArea.left,s=h.selectedCanvasArea.top,u=h.selectedCanvasArea.right,l=h.selectedCanvasArea.bottom,0==a&&0==s&&0==u&&0==l||(h.selectedCanvasArea.left=0,h.selectedCanvasArea.top=0,h.selectedCanvasArea.right=0,h.selectedCanvasArea.bottom=0,h.__restoreCanvas(f,f.canvas.width,f.canvas.height),i&&h.__fireEvent("onImageAreaDeSelected"))):(h.selectedCanvasArea.left=a,h.selectedCanvasArea.top=s,h.selectedCanvasArea.right=u,h.selectedCanvasArea.bottom=l,h.__draw_dashRect(a,s,c,d),i&&0==h.__mousedownStatus&&h.__fireEvent("onImageAreaSelected",{left:a,top:s,right:u,bottom:l,fromScroll:!1})),!0)},o.prototype.ReFireSelectedEventWhenImageMoved=function(){var e,t,n,r;e=this.selectedCanvasArea.left,t=this.selectedCanvasArea.top,n=this.selectedCanvasArea.right,r=this.selectedCanvasArea.bottom,0!=e&&0!=t&&0!=n&&0!=r&&this.__fireEvent("onImageAreaSelected",{left:e,top:t,right:n,bottom:r,fromScroll:!0})},o.prototype.SetMouseShape=function(t){var n,r,o,i,a=this;a.canvas&&(a.canvas.getContext("2d"),t==EnumDWT_MouseShape.Hand?(a.canvas.style.cursor="pointer",n=a.selectedCanvasArea.left,r=a.selectedCanvasArea.top,o=a.selectedCanvasArea.right,i=a.selectedCanvasArea.bottom,0==n&&0==r&&0==o&&0==i||a.SetSelectedArea(0,0,0,0,!0)):t==EnumDWT_MouseShape.Crosshair?a.canvas.style.cursor="crosshair":t==EnumDWT_MouseShape.Zoom?e.env.bIE?a.canvas.style.cursor="":a.canvas.style.cursor="zoom-in":a.canvas.style.cursor="")},o.prototype.Destroy=function(){var e;r("Destroy:"),this.canvas&&(e=this.canvas.parentNode)&&e.removeChild(this.canvas);var t=Dynamsoft.Lib.UI.ImageAreaSelectorEvt,n=t.indexOf(this);n>=0&&t.splice(n,1)},o.prototype.__movingRect=function(){},o.prototype.__funReSelectArea=function(e){var t,n,r,o,i,a=this;if(t=a.mouse_zero_x,n=a.mouse_zero_y,r=a.mouse_x,o=a.mouse_y,(i=a.__GetSelectionRectAspectRatio())>0){var s,u,l=1;i<1?(s=(u=o-n)*i,r>t&&o>n||r<t&&o<n?(r=t+s,l=-1):(r>t&&o<n||r<t&&o>n)&&(r=t-s),(r>a.drawWidth||r<0)&&(r>a.drawWidth?r=a.drawWidth:r<0&&(r=0),o=n+(u=(s=l*(t-r))/i))):(u=(s=r-t)/i,r>t&&o>n||r<t&&o<n?(o=n+u,l=-1):(r>t&&o<n||r<t&&o>n)&&(o=n-u),(o>a.drawHeight||o<0)&&(o>a.drawHeight?o=a.drawHeight:o<0&&(o=0),r=t+(s=(u=l*(n-o))*i)))}a.SetSelectedArea(t,n,r,o,!0)},o.prototype.BindEvents=function(){var t,n=this;t=n.canvas.getContext("2d"),Dynamsoft.Lib.UI.ImageAreaSelectorEvt.push(n),Dynamsoft.Lib.addEventListener(n.canvas,"mousemove",function(t){var r;(r=e.DOM.getOffset(t,n)).x<0?r.x=0:r.x>n.drawWidth&&(r.x=n.drawWidth),r.y<0?r.y=0:r.y>n.drawHeight&&(r.y=n.drawHeight),n.__mousedownStatus&&r.x==n.mouse_zero_x&&r.y==n.mouse_zero_y||(n.mouse_x=r.x,n.mouse_y=r.y,n.__fireEvent("onMouseMove",{e:t,dragging:0!=n.__mousedownStatus,x:r.x,y:r.y,origX:n.mouse_zero_x,origY:n.mouse_zero_y}),n.__MouseShapeIsHand()||n.__mousedownStatus&&n.__funReSelectArea())}),Dynamsoft.Lib.addEventListener(n.canvas,"mousedown",function(t){var o,i,a=new Date;n.__mousedownStatus=1,n.lastClick&&(i=a.getTime()-n.lastClick.getTime()),n.lastClick=a,(o=e.DOM.getOffset(t,n)).x<0?o.x=0:o.x>n.drawWidth&&(o.x=n.drawWidth),o.y<0?o.y=0:o.y>n.drawHeight&&(o.y=n.drawHeight),r("click on selector canvase: "+[o.x,o.y].join(",")),n.SetSelectedArea(0,0,0,0,!0),n.mouse_zero_x=parseInt(o.x),n.mouse_zero_y=parseInt(o.y),i<500?(n.__fireEvent("onMouseDoubleClick",{e:t,x:o.x,y:o.y}),n.lastClick=!1):(t.which?3==t.which:2==t.button)?n.__fireEvent("onMouseRightClick",{e:t,x:o.x,y:o.y}):n.__fireEvent("onMouseClick",{e:t,x:o.x,y:o.y}),e.stopPropagation(t)}),Dynamsoft.Lib.addEventListener(n.canvas,"mouseup",function(r){var o;if(n.mouse_zero_x<0&&n.mouse_zero_y<0)return n.__mousedownStatus=0,n.mouse_zero_x=-1,void(n.mouse_zero_y=-1);if((o=e.DOM.getOffset(r,n)).x<0?o.x=0:o.x>n.drawWidth&&(o.x=n.drawWidth),o.y<0?o.y=0:o.y>n.drawHeight&&(o.y=n.drawHeight),n.mouse_x=o.x,n.mouse_y=o.y,n.__mousedownStatus=0,n.__MouseShapeIsHand())n.__restoreCanvas(t,t.canvas.width,t.canvas.height);else if(n.__MouseShapeIsZoom()){var i,a;if(Math.abs(s)<3&&Math.abs(u)<3)n.__fireEvent("onZoom",{e:r,x:o.x,y:o.y,out:!1});else i=(o.x+n.mouse_zero_x)/2,a=(o.y+n.mouse_zero_y)/2,n.__fireEvent("onZoom",{e:r,x:i,y:a,out:!1}),n.__funReSelectArea()}else{var s=o.x-n.mouse_zero_x,u=o.y-n.mouse_zero_y;Math.abs(s)<3&&Math.abs(u)<3||(n.__funReSelectArea(),n.__fireEvent("onMouseUp",{e:r,x:o.x,y:o.y,out:!1}))}n.mouse_zero_x=-1,n.mouse_zero_y=-1,e.stopPropagation(r)})},o.prototype.__InvokeMouseUpOutside=function(t){var n,r=this;if(r.mouse_zero_x<0&&r.mouse_zero_y<0)return r.__mousedownStatus=0,r.mouse_zero_x=-1,void(r.mouse_zero_y=-1);if((n=e.DOM.getOffset(t,r)).x<0?n.x=0:n.x>r.drawWidth&&(n.x=r.drawWidth),n.y<0?n.y=0:n.y>r.drawHeight&&(n.y=r.drawHeight),r.__mousedownStatus&&(r.__mousedownStatus=0,!r.__MouseShapeIsHand())){var o=n.x-r.mouse_zero_x,i=n.y-r.mouse_zero_y;Math.abs(o)<3&&Math.abs(i)<3||r.__funReSelectArea(!0)}r.mouse_zero_x=-1,r.mouse_zero_y=-1,r.__fireEvent("onMouseUp",{e:t,x:-1,y:-1,out:!0})},o.prototype.__isInSelectedArea=function(e){var t,n,o,i;return t=this.selectedCanvasArea.left,n=this.selectedCanvasArea.top,o=this.selectedCanvasArea.right,i=this.selectedCanvasArea.bottom,r("__deselectWhenMouseClick: "+[e.x,e.y,this.selectedCanvasArea.left,this.selectedCanvasArea.top,this.selectedCanvasArea.right,this.selectedCanvasArea.bottom].join(",")),(0!=t||0!=n||0!=o||0!=i)&&(e.x>=t&&e.x<=o&&e.y>=n&&e.y<=i)},Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{},Dynamsoft.Lib.UI.ImageAreaSelector=o,Dynamsoft.Lib.UI.ImageAreaSelectorEvt=[],Dynamsoft.Lib.addEventListener(window,"mouseup",function(e){for(var t=Dynamsoft.Lib.UI.ImageAreaSelectorEvt,n=0;n<t.length;n++)t[n].__InvokeMouseUpOutside(e)})}function o(r){var o=this;o.__controlWidth=0,o.__controlHeight=0,o.drawWidth=0,o.drawHeight=0,o.Left=0,o.Top=0,o.Right=0,o.Bottom=0,o.imageControl=r,o.__mousedownStatus=0,o.mouse_zero_x=-1,o.mouse_zero_y=-1,o.mouse_x=0,o.mouse_y=0,o.selectedCanvasArea={left:0,top:0,right:0,bottom:0},o.canvas=n,o.lastClick=n,o.bCanvas=n,e.product.bChromeEdition&&(o.bCanvas=t)}}(Dynamsoft.Lib),Dynamsoft.Lib.product.bChromeEdition&&(CanvasRenderingContext2D.prototype.__dashedLineRect=function(e,t,n,r,o){void 0===o&&(o=3);for(var i=[e,e,e+n,e],a=[t,t,t,t+r],s=[e+n,e,e+n,e+n],u=[t,t+r,t+r,t+r],l=0;l<4;l++){var c=s[l]-i[l],d=u[l]-a[l],h=Math.floor(Math.sqrt(c*c+d*d)),f=o<=0?h:h/o,g=d/h*o,p=c/h*o;this.beginPath();for(var m=0;m<f;m++)m%2?this.lineTo(i[l]+m*p,a[l]+m*g):this.moveTo(i[l]+m*p,a[l]+m*g);this.stroke()}}),function(e){if(Dynamsoft.Lib.product.bChromeEdition){t.prototype.SetContext=function(e){this.ctx=e},t.prototype.SetLocation=function(e,t){this.left=e,this.top=t},t.prototype.SetImageSize=function(e,t){this.MaxWidth=e,this.MaxHeight=t},t.prototype.SetZoom=function(e){this.fZoomValue=e},t.prototype.Add=function(e,t,n,r,o,i,a){var s;return s={l:e,t:t,r:n,b:r,c:o,o:i},this.aryOverlayInfo.push(s),a&&this.__drawOne(s),!0},t.prototype.Clear=function(){this.aryOverlayInfo.splice(0)},t.prototype.Destroy=function(){this.ctx=!1,this.Clear()},t.prototype.Draw=function(){var e,t,n;if(this.ctx)for(e=this.aryOverlayInfo.length,t=0;t<e;t++)n=this.aryOverlayInfo[t],this.__drawOne(n)},t.prototype.__drawOne=function(e){var t,n,r,o,i,a,s,u,l,c=this;c.ctx&&(t=e.l,n=e.t,r=e.r,o=e.b,s=e.c,u=e.o,t<0&&(t=0),n<0&&(n=0),r>c.MaxWidth&&(r=c.MaxWidth),o>c.MaxHeight&&(o=c.MaxHeight),t*=c.fZoomValue,n*=c.fZoomValue,i=(r*=c.fZoomValue)-t,a=(o*=c.fZoomValue)-n,Dynamsoft.Lib.isNumber(s)&&(s=Dynamsoft.Lib.getColor(s)),l=c.ctx.globalAlpha,c.ctx.fillStyle=s,c.ctx.globalAlpha=parseFloat(u),c.ctx.fillRect(c.left+t,c.top+n,i,a),c.ctx.globalAlpha=l)},Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{},Dynamsoft.Lib.UI.ImageOverlay=t}function t(e){var t=this;t.MaxWidth=-1,t.MaxHeight=-1,t.fZoomValue=-1,t.ctx=!1,t.left=-1,t.top=-1,e&&(t.MaxWidth=e.MaxWidth,t.MaxHeight=e.MaxHeight,t.fZoomValue=e.fZoomValue,t.ctx=e.ctx,t.left=e.left,t.top=e.top),t.aryOverlayInfo=[]}}(),function(e){if(e.product.bChromeEdition){var t=!0,n=!1,r={isNaNOrUndefined:function(t){return e.isUndefined(t)||e.isNaN(t)},getAdjustedImageSize:function(e,t,n,o){var i={w:e,h:t,zoom:1},a=Math.floor(n+.5),s=Math.floor(o+.5);if(r.output(["image info:",e,",",t,"; max is ",a,",",s].join("")),a<=e||s<=t)if(a<=e&&s<=t){var u=a/e,l=s/t;u<l?(i.w=Math.floor(e*u+.5),i.h=Math.floor(t*u+.5),i.zoom=u):(i.w=Math.floor(e*l+.5),i.h=Math.floor(t*l+.5),i.zoom=l)}else a<=e?(i.zoom=a/e,i.w=Math.floor(a+.5),i.h=Math.floor(t*i.zoom+.5)):s<=t&&(i.zoom=s/t,i.w=Math.floor(e*i.zoom+.5),i.h=Math.floor(s+.5));return r.output(["change result:",i.w,",",i.h].join("")),i},getHex:function(e){var t;return 1==(t=Number(e).toString(16).toUpperCase()).length&&(t=["0",t].join("")),t},getColor:function(e){var t,n,o;return t=e>>16,n=(65280&e)>>8,o=255&e,["#",r.getHex(o),r.getHex(n),r.getHex(t)].join("")},SetPageNumber:function(t,n){var r,o,i=1*n;t.innerHTML=i+1,i>=99&&i<999?(r=32,o=24):i>=999&&i<9999?(r=40,o=30):i>=9999&&i<99999?(r=46,o=34):i>=99999?(r=55,o=36):(r=24,o=20),t.style.width=r+"px",t.style.height=o+"px",e.env.bFirefox||(t.style.lineHeight=o+"px")},output:function(t){Dynamsoft.WebTwainEnv.Debug&&e.log(t)}};o.prototype.ChangeControlSize=function(e,t){var n=this;return n._width=e,n._height=t,n.canvasWidth=e,n.canvasHeight=t,n.Right=n.Left+n._width,n.Bottom=n.Top+n._height,n.divInner.style.height=n.canvasHeight+"px",n.__recaculateDrawArea(),n.imageAreaSelector.ChangeControlSize(n.canvasWidth,n.canvasHeight),n.Show(),!0},o.prototype.SetVisible=function(e){return this.bVisible=e,e?(this.divOut.style.display="",this.Show()):this.divOut.style.display="none",!0},o.prototype.SetOrigMode=function(e){this.bOrigMode&&0==e&&this.objImage&&(this.objImage.onload=void 0,this.objImage.src="data:,",this.objImage=n),this.bOrigMode=e},o.prototype.__init=function(t){var n=this,r=window.document;t.Width&&(n.canvasWidth=t.Width),t.Height&&(n.canvasHeight=t.Height),t.index&&(n.cIndex=t.index),n.divOut=r.createElement("div"),n.divOut.style.position="absolute",n.divOut.onselectstart=function(){return!1},n.divInner=r.createElement("div"),n.divInner.style.position="relative",n.divInner.style.height=n.canvasHeight+"px",n.divTag=r.createElement("div"),n.divTag.className="imgTag",n.divTag.style.position="absolute",n.divTag.style.height="20px",n.canvas=r.createElement("canvas"),n.canvas.width=n.canvasWidth,n.canvas.height=n.canvasHeight,n.divOut.appendChild(n.divInner),n.divInner.appendChild(n.divTag),n.divInner.appendChild(n.canvas),n.__createSelector(t),e.isFunction(t.onMouseRightClick)&&(n.onMouseRightClick=t.onMouseRightClick),e.isFunction(t.onMouseClick)&&(n.onMouseClick=t.onMouseClick),e.isFunction(t.onZoomChanged)&&(n.onZoomChanged=t.onZoomChanged),n.__overlay=new Dynamsoft.Lib.UI.ImageOverlay},o.prototype.bindEvents=function(){return this.divOut.parentNode&&(this.imageAreaSelector.ChangeControlSize(this.canvasWidth,this.canvasHeight),this.imageAreaSelector.BindEvents(),this.imageAreaSelector.SetMouseShape(this.iMouseShape)),!0},o.prototype.__getRealZoomValue=function(){var e,t=this;return t.bOrigMode?e=t.fZoomValue:(t._origImageWidth<=0&&t.__getImageOrignalSize(),t._origImageWidth>0?null!=t.objImage&&null!=t.objImage.width&&(e=t.fZoomValue*t.objImage.width/t._origImageWidth):(r.output("cannot get image width."),e=-1)),e},o.prototype.__getOrigImageWidth=function(){return this.bOrigMode&&this.objImage?this.objImage.width:this._origImageWidth},o.prototype.__getOrigImageHeight=function(){return this.bOrigMode&&this.objImage?this.objImage.height:this._origImageHeight},o.prototype.__checkNewZoomValue=function(e){var t=Math.floor(100*e);return 0<t&&t<2500},o.prototype.__checkZoomValue=function(t){if(this._origImageWidth<=0||this._origImageHeight<=0)return!1;if(e.isUndefined(t)){if(parseInt(this._origImageWidth*this.fZoomValue)>15e3||parseInt(this._origImageHeight*this.fZoomValue)>15e3)return!1}else if(parseInt(this._origImageWidth*t)>15e3||parseInt(this._origImageHeight*t)>15e3)return!1;return!0},o.prototype.__createSelector=function(t){var n=this;if(!n.imageAreaSelector){n.imageAreaSelector=new Dynamsoft.Lib.UI.ImageAreaSelector(n);var o=n.imageAreaSelector.GetEL();n.divInner.appendChild(o),n.imageAreaSelector.onMouseUp=function(e){n.mousePreviosPositionWhenMoving.x=-1,n.mousePreviosPositionWhenMoving.y=-1},n.imageAreaSelector.onZoom=function(e){var t,o,i,a,s;e.ddx,e.ddy;if(i=n.__getOrigImagePos(),!(r.isNaNOrUndefined(i.x)||r.isNaNOrUndefined(i.y)||(a=n.__getRealZoomValue())<0)){t=(e.x+i.x)/a,o=(e.y+i.y)/a;var u=!1;n.__checkZoomValue()?(s=n.fZoomInStep*n.fZoomValue,n.__checkNewZoomValue(s)||(s=25,u=!0),n.fZoomValue!=s?n.__zoomInAt(s,t,o,e.x,e.y):u=!0,n.__fireEvent("onZoomChanged",{zoom:n.fZoomValue,isMax:u,index:n.cIndex})):n.__fireEvent("onZoomChanged",{zoom:n.fZoomValue,isMax:!0,index:n.cIndex}),n.mousePreviosPositionWhenMoving.x=-1,n.mousePreviosPositionWhenMoving.y=-1}},n.imageAreaSelector.onMouseMove=function(e){var t,o,i,a,s=e.dragging;if(i=n.__getOrigImagePos(),!r.isNaNOrUndefined(i.x)&&!r.isNaNOrUndefined(i.y)&&!((a=n.__getRealZoomValue())<0)&&(t=(e.x+i.x)/a,o=(e.y+i.y)/a,n.__fireEvent("onMouseMove",{e:e.e,x:t,y:o,index:n.cIndex}),n.iMouseShape==EnumDWT_MouseShape.Hand&&s)){var u,l,c,d,h=n.__isShowScrollV(),f=n.__isShowScrollH();u=n.mousePreviosPositionWhenMoving.x,l=n.mousePreviosPositionWhenMoving.y,c=u-e.x,d=l-e.y,n.mousePreviosPositionWhenMoving.x=e.x,n.mousePreviosPositionWhenMoving.y=e.y,f&&n.scrollH&&n.scrollH.ManualMoving(c),h&&n.scrollV&&n.scrollV.ManualMoving(d)}},n.imageAreaSelector.onMouseClick=function(e){var t,o,i,a;i=n.__getOrigImagePos(),r.isNaNOrUndefined(i.x)||r.isNaNOrUndefined(i.y)||(a=n.__getRealZoomValue())<0||(t=(e.x+i.x)/a,o=(e.y+i.y)/a,n.mousePreviosPositionWhenMoving.x=e.x,n.mousePreviosPositionWhenMoving.y=e.y,n.__fireEvent("onMouseClick",{e:e.e,x:t,y:o,index:n.cIndex}))},n.imageAreaSelector.onMouseDoubleClick=function(e){var t,o,i,a;i=n.__getOrigImagePos(),r.isNaNOrUndefined(i.x)||r.isNaNOrUndefined(i.y)||(a=n.__getRealZoomValue())<0||(t=(e.x+i.x)/a,o=(e.y+i.y)/a,n.mousePreviosPositionWhenMoving.x=e.x,n.mousePreviosPositionWhenMoving.y=e.y,n.__fireEvent("onMouseDoubleClick",{e:e.e,x:t,y:o,index:n.cIndex}))},n.imageAreaSelector.onMouseRightClick=function(e){var t,o,i,a;i=n.__getOrigImagePos(),r.isNaNOrUndefined(i.x)||r.isNaNOrUndefined(i.y)||(a=n.__getRealZoomValue())<0||(t=(e.x+i.x)/a,o=(e.y+i.y)/a,n.__fireEvent("onMouseRightClick",{e:e.e,x:t,y:o,index:n.cIndex}))},n.imageAreaSelector.onImageAreaSelected=function(e){var t,o,i=e.left,a=e.top,s=e.right,u=e.bottom,l=e.fromScroll;if(r.output("selected Area in Selector: "+[i,a,s,u].join(",")),n.fZoomValue>0){if(t=n.__getOrigImagePos(),r.isNaNOrUndefined(t.x)||r.isNaNOrUndefined(t.y))return;if(i+=t.x,a+=t.y,s+=t.x,u+=t.y,r.output("selected zoomed Image Area: "+[i,a,s,u].join(",")),(o=n.__getRealZoomValue())<0)return;i/=o,a/=o,s/=o,u/=o,r.output("selected orig Image Area: "+[i,a,s,u].join(",")),i<0&&(i=0),a<0&&(a=0),s>n.__getOrigImageWidth()&&(s=n.__getOrigImageWidth()),u>n.__getOrigImageHeight()&&(u=n.__getOrigImageHeight()),n.__fireEvent("onImageAreaSelected",{index:n.cIndex,left:i,top:a,right:s,bottom:u,fromScroll:l})}},n.imageAreaSelector.onImageAreaDeSelected=function(){n.__fireEvent("onImageAreaDeSelected",n.cIndex)},e.isFunction(t.onMouseMove)&&(n.onMouseMove=t.onMouseMove),e.isFunction(t.onMouseClick)&&(n.onMouseClick=t.onMouseClick),e.isFunction(t.onMouseRightClick)&&(n.onMouseRightClick=t.onMouseRightClick),e.isFunction(t.onMouseDoubleClick)&&(n.onMouseDoubleClick=t.onMouseDoubleClick),e.isFunction(t.onImageAreaSelected)&&(n.onImageAreaSelected=t.onImageAreaSelected),e.isFunction(t.onImageAreaDeSelected)&&(n.onImageAreaDeSelected=t.onImageAreaDeSelected),e.isFunction(t.OnGetImageInfo)&&(n.OnGetImageInfo=t.OnGetImageInfo)}},o.prototype.__isShowScrollH=function(t){var n=t;return!!this.objImage&&(e.isUndefined(n)&&(n=this.canvasHeight),n<this._height)},o.prototype.__isShowScrollV=function(t){var n=t;return!!this.objImage&&(e.isUndefined(n)&&(n=this.canvasWidth),n<this._width)},o.prototype.ImageMoveLeft=function(){var e;return this.__isShowScrollH()&&this.scrollH&&(e=-.2*this.scrollH.GetPagePositionSize(),this.scrollH.ManualMoving(e)),!0},o.prototype.ImageMoveRight=function(){var e;return this.__isShowScrollH()&&this.scrollH&&(e=.2*this.scrollH.GetPagePositionSize(),this.scrollH.ManualMoving(e)),!0},o.prototype.ImageMoveUp=function(){var e;return this.__isShowScrollV()&&this.scrollV&&(e=-.2*this.scrollV.GetPagePositionSize(),this.scrollV.ManualMoving(e)),!0},o.prototype.ImageMoveDown=function(){var e;return this.__isShowScrollV()&&this.scrollV&&(e=.2*this.scrollV.GetPagePositionSize(),this.scrollV.ManualMoving(e)),!0},o.prototype.ImageMovePageUp=function(){var e;return this.__isShowScrollV()&&this.scrollV&&(e=-1*this.scrollV.GetPagePositionSize(),this.scrollV.ManualMoving(e)),!0},o.prototype.ImageMovePageDown=function(){var e;return this.__isShowScrollV()&&this.scrollV&&(e=this.scrollV.GetPagePositionSize(),this.scrollV.ManualMoving(e)),!0},o.prototype.ImageMoveHome=function(){var e,t=this.__isShowScrollV(),n=this.__isShowScrollH();return t&&this.scrollV&&(e=this.scrollV.GetMaxPosition(),this.scrollV.ManualMoving(-e)),n&&this.scrollH&&(e=this.scrollH.GetMaxPosition(),this.scrollH.ManualMoving(-e)),!0},o.prototype.ImageMoveEnd=function(){var e,t=this.__isShowScrollV(),n=this.__isShowScrollH();return t&&this.scrollV&&(e=this.scrollV.GetMaxPosition(),this.scrollV.ManualMoving(e)),n&&this.scrollH&&(e=this.scrollH.GetMaxPosition(),this.scrollH.ManualMoving(e)),!0},o.prototype.SetLocation=function(e,t){var n=this;return n.Left=e,n.Top=t,n.Right=e+n.canvasWidth,n.Bottom=t+n.canvasHeight,r.output("SetLocation:"+e+", "+t),n.divOut&&(n.divOut.parentNode&&(n.divOut.parentNode.style.position="relative"),n.divOut.style.left=e+"px",n.divOut.style.top=t+"px",n.__refreshImageAreaSelectorLocationAndSize(),n.__refreshImageOverlayInfo()),!0},o.prototype.SetMouseShape=function(e){var t=this.iMouseShape;return this.iMouseShape=e,r.output("SetMouseShape: "+[t,this.iMouseShape].join("->")),this.imageAreaSelector&&this.imageAreaSelector.SetMouseShape(this.iMouseShape),!0},o.prototype.SetBackgroundColor=function(e){return r.output("SetBackgroundColor:"+e),this.backgroundColor=e,(this.drawArea.width<this.canvasWidth||this.drawArea.height<this.canvasHeight)&&this.Show(),!0},o.prototype.SetSelectionImageBorderColor=function(e){return r.output("SetSelectionImageBorderColor:"+e),this.selectionBorderColor=e,this.__refreshBorder(),!0},o.prototype.GetEL=function(){return r.output("GetEL:"),this.divOut},o.prototype.__getOrigImagePos=function(){var e=this.drawArea.x,t=this.drawArea.y,n=this.drawArea.width,r=this.drawArea.height;return n<=this.canvasWidth&&(e+=.5*(this.canvasWidth-n)),r<=this.canvasHeight&&(t+=.5*(this.canvasHeight-r)),{x:e,y:t}},o.prototype.__getImageDrawLocationAndSize=function(e,t){var n,o,i=this,a=e,s=t;return r.isNaNOrUndefined(a)&&(a=0),r.isNaNOrUndefined(s)&&(s=0),n=i.drawArea.width,o=i.drawArea.height,n<=i.canvasWidth?(a=.5*(i.canvasWidth-n),n=i.drawArea.width):(a=(a-=i.drawArea.x)<0?0:a,n=i.canvasWidth),o<=i.canvasHeight?(s=.5*(i.canvasHeight-o),o=i.drawArea.height):(s=(s-=i.drawArea.y)<0?0:s,o=i.canvasHeight),{left:a+=i.borderWidth,top:s+=i.borderWidth,width:n,height:o}},o.prototype.__refreshImageOverlayInfo=function(){var e,t,n=this;e=n.__getImageDrawLocationAndSize(),(t=n.__getRealZoomValue())<0||(n.__overlay.SetLocation(e.left,e.top),n.__overlay.SetImageSize(n._origImageWidth,n._origImageHeight),n.__overlay.SetZoom(t),n.canvas?n.__overlay.SetContext(n.canvas.getContext("2d")):n.__overlay.SetContext(!1))},o.prototype.__refreshImageAreaSelectorLocationAndSize=function(){var e;return this.imageAreaSelector&&(e=this.__getImageDrawLocationAndSize(),this.imageAreaSelector.SetDrawImageLocationAndSize(e.left,e.top,e.width,e.height),this.imageAreaSelector.ChangeControlSize(this.canvasWidth,this.canvasHeight)),!0},o.prototype.SetBindIndex=function(e){return this._bindIndex=e,!0},o.prototype.GetBindIndex=function(){return this._bindIndex},o.prototype.SetCurrentIndex=function(e){return this.cIndex=e,!0},o.prototype.GetCurrentIndex=function(){return this.cIndex},o.prototype.ClearImage=function(){return this.bOrigMode&&(this.objImage.onload=void 0,this.objImage.src="data:,"),this.objImage=n,this.bHasOverlay=n,this.__overlay.Clear(),this._origImageWidth=-1,this._origImageHeight=-1,!0},o.prototype.__getImageOrignalSize=function(){var e=this;if(e.bOrigMode)e._origImageWidth=e.objImage.width,e._origImageHeight=e.objImage.height;else if(e.cIndex>=0){var t=e.__fireEvent("OnGetImageInfo",e.cIndex);e._origImageWidth=t.width,null!=e.objImage&&null!=e.objImage.height&&null!=e.objImage.width&&(e._origImageHeight=e._origImageWidth*e.objImage.height/e.objImage.width)}else e._origImageWidth=-1,e._origImageHeight=-1},o.prototype.AttachImage=function(e,n,o,i,a,s){var u=this;if(r.output("AttachImage: objImage,"+[n,o,i,s].join(",")),u.bOrigMode&&(u.objImage.onload=void 0,u.objImage.src="data:,"),u.objImage=e,u.bOrigMode=s,u.__resetTag(),a){var l,c,d=a.length;for(u.__overlay.Clear(),d&&(u.bHasOverlay=t),l=0;l<d;l++)c=a[l],u.__overlay.Add(c.Left,c.Top,c.Right,c.Bottom,c.ColorRGB,c.Opacity)}u.__getImageOrignalSize();if((!u.bIfFitWindow||0!=u.fitWindowType&&1!=u.fitWindowType&&2!=u.fitWindowType&&4!=u.fitWindowType)&&(s&&1!=u.fUserSetZoom))u.SetZoom(u.fUserSetZoom);else if(s&&!u.bIfFitWindow){var h,f={};f.x=u.drawArea.x,f.y=u.drawArea.y,f.fOldZoom=1,f.fNewZoom=1,f.oldIfFitWindow=!0,f.oldFitWindowType=0,f.oldCanvasWidth=u.canvasWidth,f.oldCanvasHeight=u.canvasHeight,u.fitWindowType=3,u.__recaculateDrawArea(),h=u.__getScrollInfoWithNewZoom(f),u.__setDrawArea(h.x,h.y,u.drawArea.width,u.drawArea.height),u.__resetScroll()}else u.__recaculateDrawArea();return!0},o.prototype.Show=function(t){var n,o=this;if(o.bVisible){if(o.divOut.style.display="",r.output("Show:"+[o.canvasWidth,o.canvasHeight].join(",")),n=o.canvas.getContext("2d"),o.__restoreCanvas(n,o.canvasWidth,o.canvasHeight),o.drawArea.width<=0||o.drawArea.height<=0||o.canvasWidth<=0||o.canvasHeight<=0)return!1;if(t||o.__resetScroll(),o.__resetTag(),!o.objImage||"data:,"==o.objImage.src||0==o.objImage.width||0==o.objImage.height||""==o.objImage.src)return n.fillStyle=o.backgroundColor,n.fillRect(0,0,n.canvas.width,n.canvas.height),o._width>53&&(n.font="12px Times New Roman",n.textAlign="center",n.strokeText("Loading ...",.5*n.canvas.width,.5*n.canvas.height)),!1;if(n.clearRect(0,0,o.canvasWidth,o.canvasHeight),-1!=o.cIndex){r.output("draw info: "+[o.objImage.width,o.objImage.height,o.drawArea.x,o.drawArea.y,o.drawArea.width,o.drawArea.height].join(",")),(o.drawArea.width<o.canvasWidth||o.drawArea.height<o.canvasHeight)&&(n.fillStyle=o.backgroundColor,n.fillRect(0,0,o.canvasWidth,o.canvasHeight));var i=function(){n.drawImage(o.objImage,Math.floor(-o.drawArea.x),Math.floor(-o.drawArea.y),Math.floor(o.drawArea.width),Math.floor(o.drawArea.height)),o.__overlay.Draw()};return e.env.bIE?setTimeout(i,10):i(),!0}}else o.divOut.style.display="none"},o.prototype.SetSelect=function(e){return r.output("SetSelect:"+e),this.bSelect=e,this.__resetTag(),this.__refreshBorder(),!0},o.prototype.GetIndex=function(){return this.cIndex},o.prototype.SetSelectedImageArea=function(e,t,n,o){var i=this,a=e,s=t,u=0,l=0,c=1;if(r.output("SetSelectedImageArea:"+[e,t,n,o].join(", ")),n<e&&o<t?(a=parseInt(n),s=parseInt(o),u=parseInt(e),l=parseInt(t)):(u=parseInt(n),l=parseInt(o),a=parseInt(e),s=parseInt(t)),i.selectedImageArea.left=a,i.selectedImageArea.top=s,i.selectedImageArea.right=u,i.selectedImageArea.bottom=l,i.imageAreaSelector){if(i._origImageWidth<=0&&i.__getImageOrignalSize(),!(i._origImageWidth>0))return!1;if((c=i.__getRealZoomValue())<0)return!1;var d=a*c,h=s*c,f=u*c,g=l*c;return i.imageAreaSelector.SetSelectedArea(d,h,f,g),!0}return!1},o.prototype.OverlayRectangle=function(e,n,o,i,a,s){return r.output("OverlayRectangle:"+[e,n,o,i,a,s].join(", ")),this.bHasOverlay=t,this._origImageWidth<=0&&this.__getImageOrignalSize(),this.__refreshImageOverlayInfo(),this.__overlay.Add(e,n,o,i,a,s,!0),!0},o.prototype.GetMousePosition=function(){return r.output("GetMousePosition:"),this.mousePosition},o.prototype.__setDrawArea=function(e,t,n,r){var o=this;o.drawArea.x=e,o.drawArea.y=t,o.drawArea.width=n,o.drawArea.height=r,o.drawArea.width>o.canvasWidth&&o.drawArea.x>o.drawArea.width-o.canvasWidth&&(o.drawArea.x=o.drawArea.width-o.canvasWidth),o.drawArea.height>o.canvasHeight&&o.drawArea.y>o.drawArea.height-o.canvasHeight&&(o.drawArea.y=o.drawArea.height-o.canvasHeight),o.__refreshImageAreaSelectorLocationAndSize(),o.__refreshImageOverlayInfo()},o.prototype.GetZoom=function(){return this.fZoomValue},o.prototype.SetZoom=function(t,n,o,i,a){var s,u,l=this,c={};if(r.output("SetZoom:"+[s,t].join("->")),l.fUserSetZoom=t,c.x=l.drawArea.x,c.y=l.drawArea.y,c.fOldZoom=l.fZoomValue,c.fNewZoom=t,c.oldIfFitWindow=l.bIfFitWindow,c.oldFitWindowType=l.fitWindowType,c.oldCanvasWidth=l.canvasWidth,c.oldCanvasHeight=l.canvasHeight,c.bMoveCenter=!1,!e.isUndefined(n)&&!e.isUndefined(o)){c.bMoveCenter=!0;l.fZoomValue,l.fZoomValue;c.newRealCenterX=n,c.newRealCenterY=o,c.newClickX=i,c.newClickY=a}if(l.bIfFitWindow=!1,l.fitWindowType=3,l.fZoomValue=t,l.objImage)return l.__recaculateDrawArea(),u=l.__getScrollInfoWithNewZoom(c),l.__setDrawArea(u.x,u.y,l.drawArea.width,l.drawArea.height),l.__resetScroll(),l.Show(),!0},o.prototype.SetSelectionRectAspectRatio=function(e){return r.output("SetSelectionRectAspectRatio:"+e),e<0&&(e=0),this.__fSelectionRectAspectRatio=e,!0},o.prototype.SetIfFitWindow=function(e,t){return r.output("SetIfFitWindow:"+[e,t].join(",")),this.bIfFitWindow=e,this.fitWindowType=e?t:3,this.__recaculateDrawArea(),this.Show(),!0},o.prototype.Stretch=function(){return r.output("Stretch"),this.canvasWidth=this._width,this.canvasHeight=this._height,this.__setDrawArea(0,0,this.canvasWidth,this.canvasHeight),this.__refreshImageAreaSelectorLocationAndSize(),this.__refreshImageOverlayInfo(),!0},o.prototype.Destroy=function(){return r.output("Destroy:"),this.SetBindIndex(-1),this.ClearImage(),this.imageAreaSelector&&(this.imageAreaSelector.Destroy(),this.imageAreaSelector=!1),this.__overlay&&this.__overlay.Destroy(),!0},o.prototype.SetShowPageNumber=function(e){return this.bShowPageNumber=e,this.__resetTag(),!0},o.prototype.__getScrollInfoWithNewZoom=function(e){var t,n,r,o,i,a,s,u,l,c,d,h,f,g,p,m,_=this,v={x:0,y:0},y=!1;if((s=_.fZoomValue)<=0||!_.objImage)return v;if(t=e.x,n=e.y,u=e.oldIfFitWindow,l=e.oldFitWindowType,u&&(0==l?y=!0:1==l?y=!0:2==l?y=!0:4==l&&(y=!0)),d=e.oldCanvasWidth,h=e.oldCanvasHeight,c=e.fOldZoom,e.bMoveCenter?(i=e.newRealCenterX*s,a=e.newRealCenterY*s):y?(t=r=.5*_.objImage.width,n=o=.5*_.objImage.height,i=r*s,a=o*s):(i=(r=(t+=.5*d)/c)*s,a=(o=(n+=.5*h)/c)*s),bOldShowScrollV=_.__isShowScrollV(d),bOldShowScrollH=_.__isShowScrollH(h),p=_.__isShowScrollV(),m=_.__isShowScrollH(),f=_.canvasWidth,g=_.canvasHeight,e.bMoveCenter){var I=.5*(_.drawArea.width-f),S=e.x,b=I-e.newRealCenterX*s-S+e.newRealCenterX*c;v.x=I-b;var T=.5*(_.drawArea.height-g),C=e.y;b=T-e.newRealCenterY*s-C+e.newRealCenterY*c;return v.y=T-b,v}return m?(v.x=i-.5*f,v.x<0&&(v.x=0)):v.x=.5*(_.drawArea.width-f),p?(v.y=a-.5*g,v.y<0&&(v.y=0)):v.y=.5*(_.drawArea.height-g),v},o.prototype.__recaculateDrawArea=function(){var e,t=this,n=!1,o=!1;t.canvasWidth=t._width,t.canvasHeight=t._height,t.objImage?t.bIfFitWindow?0==t.fitWindowType?(e=r.getAdjustedImageSize(t.objImage.width,t.objImage.height,t.canvasWidth,t.canvasHeight),t.fZoomValue=e.zoom):1==t.fitWindowType?((e=r.getAdjustedImageSize(t.objImage.width,t.objImage.height,t.objImage.width,t.canvasHeight)).w>t._width&&(!0,t.canvasHeight=t._height-t.scrollArrowSize,e=r.getAdjustedImageSize(t.objImage.width,t.objImage.height,t.objImage.width,t.canvasHeight)),t.fZoomValue=e.zoom):2==t.fitWindowType?((e=r.getAdjustedImageSize(t.objImage.width,t.objImage.height,t.canvasWidth,t.objImage.height)).h>t._height&&(!0,t.canvasWidth=t._width-t.scrollArrowSize,e=r.getAdjustedImageSize(t.objImage.width,t.objImage.height,t.canvasWidth,t.objImage.height)),t.fZoomValue=e.zoom):4==t.fitWindowType?n=!0:(e={w:t.objImage.width,h:t.objImage.height},o=!0,t.fZoomValue=t.fUserSetZoom):(e={w:t.objImage.width*t.fZoomValue,h:t.objImage.height*t.fZoomValue},o=!0):n=!0,n?t.Stretch():(o&&(e.h>t._height&&(!0,t.canvasWidth=t._width-t.scrollArrowSize),e.w>t._width&&(!0,t.canvasHeight=t._height-t.scrollArrowSize)),t.drawArea.width=e.w,t.drawArea.height=e.h,t.drawArea.width<t.canvasWidth?t.drawArea.x=.5*(t.drawArea.width-t.canvasWidth):t.drawArea.x=0,t.drawArea.height<t.canvasHeight?t.drawArea.y=.5*(t.drawArea.height-t.canvasHeight):t.drawArea.y=0,r.output("draw Area: "+[t.drawArea.x,t.drawArea.y,t.drawArea.width,t.drawArea.height].join(",")),t.__refreshImageAreaSelectorLocationAndSize(),t.__refreshImageOverlayInfo())},o.prototype.__resetScroll=function(){var e,t,n,r=this,o=r.__isShowScrollV(),i=r.__isShowScrollH();r.canvas&&(n=r.canvas.parentNode),n&&(o?(cPosition=r.drawArea.y,r.scrollV?(t=r.scrollV.GetEL(),r.scrollV.GetControlHeight()!=r.canvasHeight&&r.scrollV.ChangeControlSize(r.scrollArrowSize,r.canvasHeight),t.style.display="",r.scrollV.InitScroll(r.drawArea.height,r.canvasHeight),r.scrollV.SetPosition(cPosition)):((e={Width:r.scrollArrowSize,Height:r.canvasHeight,Horizontal:!1}).onValueChanged=function(e){r.drawArea.y=e.Value,r.drawArea.height>r.canvasHeight&&r.drawArea.y>r.drawArea.height-r.canvasHeight&&(r.drawArea.y=r.drawArea.height-r.canvasHeight),r.__reselectArea(),r.Show(!0)},r.scrollV=new Dynamsoft.Lib.UI.ScrollBar(e),r.scrollV.InitScroll(r.drawArea.height,r.canvasHeight),r.scrollV.SetLocation(1,1),(t=r.scrollV.GetEL()).style.position="absolute",n.appendChild(t)),t.style.top=r.borderWidth+"px",t.style.left=r.borderWidth+r._width-r.scrollArrowSize+"px",r.scrollV.Refresh()):r.scrollV&&((t=r.scrollV.GetEL()).style.display="none"),i?(cPosition=r.drawArea.x,r.scrollH?(t=r.scrollH.GetEL(),r.scrollH.GetControlWidth()!=r.canvasWidth&&r.scrollH.ChangeControlSize(r.canvasWidth,r.scrollArrowSize),t.style.display="",r.scrollH.InitScroll(r.drawArea.width,r.canvasWidth),r.scrollH.SetPosition(cPosition)):((e={Width:r.canvasWidth,Height:r.scrollArrowSize,Horizontal:!0}).onValueChanged=function(e){r.drawArea.x=e.Value,r.drawArea.width>r.canvasWidth&&r.drawArea.x>r.drawArea.width-r.canvasWidth&&(r.drawArea.x=r.drawArea.width-r.canvasWidth),r.__reselectArea(),r.Show(!0)},r.scrollH=new Dynamsoft.Lib.UI.ScrollBar(e),r.scrollH.InitScroll(r.drawArea.width,r.canvasWidth),r.scrollH.SetLocation(1,1),(t=r.scrollH.GetEL()).style.position="absolute",n.appendChild(t)),t.style.top=r.borderWidth+r._height-r.scrollArrowSize+"px",t.style.left=r.borderWidth+"px",r.scrollH.Refresh()):r.scrollH&&((t=r.scrollH.GetEL()).style.display="none"))},o.prototype.__restoreCanvas=function(e,t,n){e.canvas.width=t,e.canvas.height=n},o.prototype.__reselectArea=function(){this.imageAreaSelector&&this.imageAreaSelector.ReFireSelectedEventWhenImageMoved()},o.prototype.__zoomIn=function(){this.SetZoom(1.1*this.fZoomValue)},o.prototype.__zoomInAt=function(e,t,n,r,o){4==this.fitWindowType?(this.SetIfFitWindow(!0,0),this.__zoomIn()):this.SetZoom(e,t,n,r,o)},o.prototype.__zoomOut=function(){this.SetZoom(.9*this.fZoomValue)},o.prototype.__refreshBorder=function(){this.bSelect?this.divOut.style.border=this.borderWidth+"px solid "+this.selectionBorderColor:this.divOut.style.border=this.borderWidth+"px solid "+this.borderColor},o.prototype.__resetTag=function(){this.bShowPageNumber?(r.SetPageNumber(this.divTag,this.cIndex),this.bSelect?this.divTag.className="imgTag imgTag_Selected":this.divTag.className="imgTag imgTag_Normal",this.divTag.style.display="block"):(this.divTag.innerHTML="",this.divTag.style.display="none")},o.prototype.ClearControl=function(){return this.ClearImage(),this.bShowPageNumber=n,this.Show(),!0},o.prototype.__fireEvent=function(t,n){return!e.isFunction(this[t])||this[t](n)},e.UI=e.UI||{},e.UI.ImageControl=o}function o(e){var r=this;r._width=0,r._height=0,r.canvasWidth=0,r.canvasHeight=0,r.Left=0,r.Top=0,r.Right=0,r.Bottom=0,r.borderWidth=1,r.borderColor="#EEEEEE",r.selectionBorderColor="#7DA2CE",r.backgroundColor="#DDDDDD",r.bIfFitWindow=!0,r.fitWindowType=0,r.imageAreaSelector=!1,r.bSelect=!1,r.scrollH=!1,r.scrollV=!1,r.scrollArrowSize=16,r.cIndex=-1,r.objImage=!1,r.iMouseShape=EnumDWT_MouseShape.Default,r.fUserSetZoom=1,r.fZoomValue=1,r.fZoomInStep=1.2,r.fZoomOutStep=.8,r.mousePosition={x:-1,y:-1},r.mousePreviosPositionWhenMoving={x:-1,y:-1},r.drawArea={width:r.canvasWidth,height:r.canvasHeight,x:0,y:0},r.selectedImageArea={left:0,top:0,right:0,bottom:0},r.MoveStep=10,r.__fSelectionRectAspectRatio=0,r.bFocus=n,r.__overlay=n,r.bShowPageNumber=n,r.bVisible=t,r.divOut=n,r.divInner=n,r.divTag=n,r.canvas=n,r.bOrigMode=t,r.bHasOverlay=n,r._origImageWidth=-1,r._origImageHeight=-1,r.__init(e)}}(Dynamsoft.Lib);var ___ii=0,Funs2,Dynamsoft_OnClickInstallButton;!function(e){e.product.bChromeEdition&&(Funs2={getImageUrl:function(e,t,n,r){var o=[e];return null!=t&&(o.push("&index="),o.push(t)),o.push("&width="),o.push(n),o.push("&height="),o.push(r),o.push("&ticks="),o.push(___ii++),o.join("")},getUrlByAct:function(e,t,n){var r=[e];return null!=t&&(r.push("&index="),r.push(t)),n&&(r.push("&act="),r.push(n)),r.push("&ticks="),r.push(___ii++),r.join("")},output:function(t,n){Dynamsoft.WebTwainEnv.Debug&&e.log(n)},print:function(t){var n=850,r=1120,o=0,i=0,a=0,s="";Dynamsoft.Lib.product.bChromeEdition&&(e.env.bIE&&(r=1289),e.env.bFirefox&&(r=1169));var u=r;for(o=0;o<t.length;o++){var l=t[o],c=l.Width,d=l.Height,h=l.Url,f=n/c,g=u/d;f<g?u=parseInt(d*f):f>g&&(n=parseInt(c*g)),i+=c,a+=d,s=s+'<div style="width:850px;height:'+r+'px"> <img id="D_img'+o+'" src="'+h+'" style="position:relative;left:0px;top:0px;width: '+n+"px;height: "+u+'px" /></div>'}var p,m=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",i,",height=",a].join(""),_='<html><body id="D_img">'+s+"</body></html>",v=window.open("about:blank","_blank",m);v&&(v.document.write(_),v.document.close(),v.focus(),(p=v.document.getElementById("D_img"))?p.onload=function(){v.print(),v.close(),Dynamsoft.Lib.log("print image...ok")}:Dynamsoft.Lib.log("cannot find image"))}})}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){document;var t=[];r.prototype.Clear=function(){this.imageToShow&&(this.imageToShow.onload=void 0,this.imageToShow.src="data:,"),this.imageToShow=!1,this.imageUrl="",this.aryOverlayRectangleData=[]},o.prototype.__InitEvents=function(t){var n=this;e.isFunction(t.OnTopImageInTheViewChanged)&&(n.OnTopImageInTheViewChanged=t.OnTopImageInTheViewChanged),e.isFunction(t.OnGetImageInfo)&&(n.OnGetImageInfo=t.OnGetImageInfo),e.isFunction(t.onZoomChanged)&&(n.onZoomChanged=t.onZoomChanged),e.isFunction(t.onMouseMove)&&(n.onMouseMove=t.onMouseMove),e.isFunction(t.onMouseClick)&&(n.onMouseClick=t.onMouseClick),e.isFunction(t.onMouseRightClick)&&(n.onMouseRightClick=t.onMouseRightClick),e.isFunction(t.onMouseDoubleClick)&&(n.onMouseDoubleClick=t.onMouseDoubleClick),e.isFunction(t.onImageAreaDeSelected)&&(n.onImageAreaDeSelected=t.onImageAreaDeSelected),e.isFunction(t.onImageAreaSelected)&&(n.onImageAreaSelected=t.onImageAreaSelected),e.isFunction(t.onSelected)&&(n.onSelected=t.onSelected),e.isFunction(t.onRefreshUI)&&(n.onRefreshUI=t.onRefreshUI),e.isFunction(t.onResetCurrentIndex)&&(n.onResetCurrentIndex=t.onResetCurrentIndex)},o.prototype.__InitiHorizontalScrollBar=function(e){var t=this,n={Width:e.Width,Height:16,Value:0,MaxValue:0,Horizontal:!0,onValueChanged:function(e){t.__UpdateImageByScrollBar(e.Value)}};t.horizontalScrollBar=new Dynamsoft.Lib.UI.ScrollBar(n),t.canvas&&t.horizontalScrollBar&&t.canvas.appendChild(t.horizontalScrollBar.GetEL()),t.__SetHLocation(0,e.Height-t.__GetScrollWidth())},o.prototype.__InitiVerticalScrollBar=function(e){var t=this,n={Width:16,Height:e.Height,Value:0,MaxValue:0,Horizontal:!1,onValueChanged:function(e){t.__UpdateImageByScrollBar(e.Value)}};t.verticalScrollBar=new Dynamsoft.Lib.UI.ScrollBar(n),t.canvas&&t.verticalScrollBar&&t.canvas.appendChild(t.verticalScrollBar.GetEL()),t.__SetVLocation(e.Width-t.__GetScrollWidth(),0)},o.prototype.__UpdateImageByScrollBar=function(e){var t,n=this,r=-1,o=-1,i=-1;if(n.aryImageControls&&n.aryImageControls.length>0&&(t=n.aryImageControls[0])&&(o=t.GetCurrentIndex(),r=n.__GetRow(o)),1==n.bVerticalMode){if(i=parseInt(n.__GetVisibleRow(e)*n.imagesPerColumn),r==n.__GetRow(i))return}else if((i=parseInt(n.__GetVisibleRow(e)))==o)return;Funs2.output(n,"__UpdateImageByScrollBar(value, newIndex): "+[e,i].join(",")),n.__GoInner(i,!1,!0)},o.prototype.UpdateImage=function(e,t,n,r,o,i){var a=this,s=a.aryModelImageControl[e];s.imageToShow=t,s.imageWidth=n,s.imageHeight=r,s.iImageControlWidth=n,s.iImageControlHeight=r,s.aryOverlayRectangleData=o,s.imageUrl=i;var u=a.GetImageControl(e);if(null!=u)if(u.SetCurrentIndex(e),null==t||"data:,"!=t.src&&0!=t.width&&0!=t.height&&""!=t.src){if(null==t)if((l=a.__GetImageControlIndex(e))>=0){n=parseInt(a.imageViewWidth/2),r=parseInt(a.imageViewHeight/2);1==a.imagesPerRow&&1==a.imagesPerColumn?1==a.bSingleMode?(n=-1,r=-1,s.bOriginalImage=!0):(n=a.imageViewWidth,r=a.imageViewHeight,s.bOriginalImage=!1):(n<300&&(n=300),r<300&&(r=300),s.bOriginalImage=!1),a.__SetArrayControlLoadImage(l,e,u,s,n,r,a.AttachImagesForControl,!0)}a.AttachImagesForControl(u,s,e)}else{var l;(l=a.__GetImageControlIndex(e))>=0&&a.__SetArrayControlLoadImage(l,e,u,s,n,r,a.AttachImagesForControl,!1)}return a.iCurrentRow=-1,a.iCurrentColumn=-1,!0},o.prototype.__AddImage=function(e,t){this.__AddControl();var n=this.GetImageControl(e);n.SetCurrentIndex(e),this.AttachImagesForControl(n,t,e)},o.prototype.UpdateAllImage=function(e,t,n,r){return this.UpdateAllImageInner(e,t,!1,n,r)},o.prototype.UpdateAllImageInner=function(e,t,n,r,o){var i=this;i.aryModelImageControl=e,i.__OnlySetCurrentIndex(t),i.sHowManyImages=i.aryModelImageControl.length;var a=i.imagesPerRow*i.imagesPerColumn>i.sHowManyImages?i.sHowManyImages:i.imagesPerRow*i.imagesPerColumn,s=0;for(s=i.aryImageControls.length-1;s>=a;s--)i.__RemoveControl(s);for(s=i.aryImageControls.length;s<a;s++)i.__AddControl();return Dynamsoft.WebTwainEnv.ScanDirectly||(i.__ConfirmScrollMaxValue(),i.__ConfirmScrollVisibity(),i.iCurrentRow=-1,i.iCurrentColumn=-1,i.__SetCurrentIndex(i.cCurrentIndex),i.__ReInitChildrenPosition(),i.__AttachImages(n,r,o)),!0},o.prototype.__AddControl=function(){var t=this,n={};Dynamsoft.WebTwainEnv.ScanDirectly||(e.isFunction(t.onImageAreaDeSelected)&&(n.onImageAreaDeSelected=t.onImageAreaDeSelected),e.isFunction(t.onImageAreaSelected)&&(n.onImageAreaSelected=t.onImageAreaSelected),n.onZoomChanged=function(e){t.fZoom=e.zoom,t.__fireEvent("onZoomChanged",e)},n.onMouseClick=function(e){t.__OnMouseClick(e),t.__fireEvent("onMouseClick",e)},n.onMouseRightClick=function(e){t.__fireEvent("onMouseRightClick",e)},n.onMouseMove=function(e){t.__fireEvent("onMouseMove",e)},n.onMouseDoubleClick=function(e){t.__fireEvent("onMouseDoubleClick",e)},n.OnGetImageInfo=function(e){return t.__fireEvent("OnGetImageInfo",e)});var r=new Dynamsoft.Lib.UI.ImageControl(n);t.aryImageControls.push(r),Dynamsoft.Lib.imageControlCount++,t.__InitImageControl(r),Dynamsoft.WebTwainEnv.ScanDirectly||(t.canvas&&t.canvas.appendChild(r.GetEL()),r.bindEvents())},o.prototype.__InitImageControl=function(e){var t=this;1==t.imagesPerRow&&1==t.imagesPerColumn?(e.SetMouseShape(t.iMouseShape),e.SetShowPageNumber(!1)):(e.SetMouseShape(EnumDWT_MouseShape.Hand),e.SetShowPageNumber(t.bShowPageNumber)),e.SetSelectionRectAspectRatio(t.ratio),e.SetBackgroundColor(t.BackgroundColor),e.SetSelectionImageBorderColor(t.SelectionImageBorderColor),t.bSingleMode?t.bIfFitWindow?e.SetIfFitWindow(!0,t.enumDWTFitWindowType):e.SetZoom(t.fZoom):e.SetIfFitWindow(!0,0)},o.prototype.__OnMouseClick=function(e){var t=this,n=e.index,r=t.aryCurrentSelectedImageIndicesInBuffer.indexOf(n),o=e.e.ctrlKey,i=e.e.shiftKey,a=e.e.metaKey;if(-1==r)if(o||i||a||t.aryCurrentSelectedImageIndicesInBuffer.length<1)t.aryCurrentSelectedImageIndicesInBuffer.push(n);else if(1==t.aryCurrentSelectedImageIndicesInBuffer.length){if(t.aryCurrentSelectedImageIndicesInBuffer[0]==n)return;t.aryCurrentSelectedImageIndicesInBuffer[0]=n}else t.aryCurrentSelectedImageIndicesInBuffer=[],t.aryCurrentSelectedImageIndicesInBuffer.push(n);else if((o||a)&&t.aryCurrentSelectedImageIndicesInBuffer.length>1)t.aryCurrentSelectedImageIndicesInBuffer.splice(r,1);else if(i)t.aryCurrentSelectedImageIndicesInBuffer.push(n);else{if(1==t.aryCurrentSelectedImageIndicesInBuffer.length&&t.cCurrentIndex==n)return;t.aryCurrentSelectedImageIndicesInBuffer=[],t.aryCurrentSelectedImageIndicesInBuffer.push(n)}if(i){var s=t.aryCurrentSelectedImageIndicesInBuffer[0],u=t.aryCurrentSelectedImageIndicesInBuffer[t.aryCurrentSelectedImageIndicesInBuffer.length-1];if(t.aryCurrentSelectedImageIndicesInBuffer=[],u==s)t.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(s));else if(u>s)for(var l=u-s+1,c=0;c<l;c++)t.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(s+c));else{l=s-u+1;t.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(s));for(c=0;c<l-1;c++)t.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(u+c))}}1==t.aryCurrentSelectedImageIndicesInBuffer.length&&(t.__OnlySetCurrentIndex(t.aryCurrentSelectedImageIndicesInBuffer[0]),t.__SetCurrentIndexWithoutSetScroll(t.cCurrentIndex)),t.__SortCurrentSelectedImageIndicesInBuffer(),t.__SetUnselectAll();c=0;for(c=0;c<t.aryCurrentSelectedImageIndicesInBuffer.length;c++){var d=t.GetImageControl(t.aryCurrentSelectedImageIndicesInBuffer[c]);null!=d&&d.SetSelect(!0)}t.__fireEvent("onSelected",t.aryCurrentSelectedImageIndicesInBuffer)},o.prototype.__SortCurrentSelectedImageIndicesInBuffer=function(){var e=this.aryCurrentSelectedImageIndicesInBuffer.length;if(e>1){var t,n,r,o=!1;for(n=0;n<e-1;n++){for(o=!1,r=1;r<e;r++)this.aryCurrentSelectedImageIndicesInBuffer[r]<this.aryCurrentSelectedImageIndicesInBuffer[r-1]&&(o=!0,t=this.aryCurrentSelectedImageIndicesInBuffer[r-1],this.aryCurrentSelectedImageIndicesInBuffer[r-1]=this.aryCurrentSelectedImageIndicesInBuffer[r],this.aryCurrentSelectedImageIndicesInBuffer[r]=t);if(!o)return}}},o.prototype.__RemoveControl=function(e){if(e<this.aryImageControls.length&&e>=0){var t=this.aryImageControls[e];t.Destroy(),this.aryImageControls.splice(e,1),Dynamsoft.WebTwainEnv.ScanDirectly||this.canvas&&this.canvas.removeChild(t.GetEL()),Dynamsoft.Lib.imageControlCount--}},o.prototype.__ConfirmScrollMaxValue=function(){if(!this.bSingleMode)if(1==this.bVerticalMode){var e=this.__GetHowManyRows();this.__SetVScrollMaxValue(e,this.imagesPerRow)}else this.__SetHScrollMaxValue(this.sHowManyImages,this.imagesPerColumn)},o.prototype.__GetHowManyRows=function(){return parseInt((this.sHowManyImages+this.imagesPerColumn-1)/this.imagesPerColumn)},o.prototype.__ConfirmScrollVisibity=function(){var e=this;e.bSingleMode?(e.__SetIfHScroll(!1),e.__SetIfVScroll(!1)):0==e.bVerticalMode?(e.bScrollBar&&e.sHowManyImages>e.imagesPerRow*e.imagesPerColumn?e.__SetIfHScroll(!0):e.__SetIfHScroll(!1),e.__SetIfVScroll(!1)):(e.bScrollBar&&e.sHowManyImages>e.imagesPerRow*e.imagesPerColumn?e.__SetIfVScroll(!0):e.__SetIfVScroll(!1),e.__SetIfHScroll(!1))},o.prototype.__SetCurrentIndex=function(e){e>=0&&this.__SetCurrentIndexInnerInner(e,!0,!1)},o.prototype.__SetCurrentIndexInner=function(e,t,n){n?this.__SetCurrentIndexInnerInner(e,t,!0):this.__SetCurrentIndexInnerInner(e,t,n)},o.prototype.__SetCurrentIndexWithoutSetScroll=function(e){this.__SetCurrentIndexInnerInner(e,!0,!1,!0)},o.prototype.__SetCurrentIndexWithoutRefreshUI=function(e){this.__SetCurrentIndexInnerInner(e,!0,!1)},o.prototype.__SetCurrentIndexInnerInner=function(e,t,n,r){var o=this,i=!0;if(!(e<0||e>=o.aryModelImageControl.length)){if(o.__bAddingImage&&!o.__IfAutoScroll&&(i=!1),i)if(1==o.bVerticalMode){var a=o.iCurrentRow;if(o.iCurrentRow=o.__GetRow(e),o.iCurrentRow!=a&&(o.iCurrentRow<=o.iOldFirstVisibleRow||o.iCurrentRow-o.iOldFirstVisibleRow>=o.imagesPerRow)){if(o.iCurrentRow-o.iOldFirstVisibleRow==o.imagesPerRow&&0==n&&(o.iCurrentRow=o.iOldFirstVisibleRow+1),0==o.bSingleMode&&(!r||0==r)){var s=o.iCurrentRow;o.__SetVScrollPotion(s)}var u=o.__GetFirstVisibleRow();if(o.iOldFirstVisibleRow!=u){o.iOldFirstVisibleRow=u;var l=u*o.imagesPerColumn;o.__fireEvent("OnTopImageInTheViewChanged",l),o.__AttachImages(!1)}}}else{var c=o.iCurrentColumn;if(o.iCurrentColumn=e,o.iCurrentColumn!=c&&(o.iCurrentColumn<o.iOldFirstVisibleColum||o.iCurrentColumn-o.iOldFirstVisibleColum>=o.imagesPerColumn)){if(o.iCurrentColumn-o.iOldFirstVisibleColum==o.imagesPerColumn&&(o.iCurrentColumn=o.iOldFirstVisibleColum+1),0==o.bSingleMode&&(!r||0==r)){var d=o.iCurrentColumn;o.__SetHScrollPotion(d)}var h=o.__GetFirstVisibleColumn();if(o.iOldFirstVisibleColum!=h){o.iOldFirstVisibleColum=h;l=h;o.__fireEvent("OnTopImageInTheViewChanged",l),o.__AttachImages(!1)}}}if(t){o.__SetUnselectAll(),o.__OnlySetCurrentIndex(e);var f=o.GetImageControl(o.cCurrentIndex);null!=f&&f.SetSelect(!0)}}},o.prototype.__SetScrollByIndex=function(e){var t=this;if(1==t.bVerticalMode){var n=t.iCurrentRow;if(t.iCurrentRow=t.__GetRow(e),t.iCurrentRow!=n&&(t.iCurrentRow<=t.iOldFirstVisibleRow||t.iCurrentRow-t.iOldFirstVisibleRow>=t.imagesPerRow)){if(t.iCurrentRow,t.iOldFirstVisibleRow,t.imagesPerRow,0==t.bSingleMode){var r=t.iCurrentRow;t.__SetVScrollPotion(r)}var o=t.__GetFirstVisibleRow();if(t.iOldFirstVisibleRow!=o){t.iOldFirstVisibleRow=o;var i=o*t.imagesPerColumn;t.__fireEvent("OnTopImageInTheViewChanged",i),t.__AttachImages(!1)}}}else{var a=t.iCurrentColumn;if(t.iCurrentColumn=e,t.iCurrentColumn!=a&&(t.iCurrentColumn<t.iOldFirstVisibleColum||t.iCurrentColumn-t.iOldFirstVisibleColum>=t.imagesPerColumn)){if(t.iCurrentColumn-t.iOldFirstVisibleColum==t.imagesPerColumn&&(t.iCurrentColumn=t.iOldFirstVisibleColum+1),0==t.bSingleMode){var s=t.iCurrentColumn;t.__SetHScrollPotion(s)}var u=t.__GetFirstVisibleColumn();if(t.iOldFirstVisibleColum!=u){t.iOldFirstVisibleColum=u;i=u;t.__fireEvent("OnTopImageInTheViewChanged",i),t.__AttachImages(!1)}}}},o.prototype.__GetRow=function(e){return parseInt(e/this.imagesPerColumn)},o.prototype.__GetFirstVisibleColumn=function(){return parseInt(this.__GetVisibleRow(this.__GetHScrollPosionValue()))},o.prototype.__GetFirstVisibleRow=function(){return parseInt(this.__GetVisibleRow(this.__GetVScrollPosionValue()))},o.prototype.__GetVisibleRow=function(e){var t=this;if(0==t.__GetHowManyRows())return 0;var n=e;return t.bSingleMode?t.cCurrentIndex:(1==t.bVerticalMode?t.__GetHowManyRows()-n<t.imagesPerRow&&(n-=t.imagesPerRow-(t.__GetHowManyRows()-n)):t.sHowManyImages-n<t.imagesPerColumn&&(n-=t.imagesPerColumn-(t.sHowManyImages-n)),n<0&&(n=0),n)},o.prototype.__AttachImages=function(e,t,n){this.__AttachImagesInner(e,!0,t,n)},o.prototype.__AttachImagesInner=function(e,t,n,r){var o=this;if(o.aryImageControls&&o.aryImageControls.length>0){var i=0;(i=1==o.bVerticalMode?o.__GetFirstVisibleRow()*o.imagesPerColumn:o.__GetFirstVisibleColumn())<0&&(i=0);var a=0,s=i,u=i+o.aryImageControls.length-1;for(n&&n>0&&(s=n),r&&r>0&&(u=r),a=0;a<o.aryImageControls.length;a++){var l=o.aryImageControls[a];if(l){var c=i+a;if(Funs2.output(o,"__AttachImagesInner(baseIndex, index): "+[i,c].join(",")),c<o.sHowManyImages){if(e&&o.__InitImageControl(l),t){var d=o.aryModelImageControl[c];(c>=s&&c<=u||1==d.bIsDirty||l.GetCurrentIndex()!=c)&&(Funs2.output(o,"__AttachImagesInner() attach Image index -> control index:"+[c,a].join("->")),o.__GetImageAndAttach(l,d,c,!1))}l.SetVisible(!0),Funs2.output(o,"__AttachImagesInner() set control index Visible:"+[a].join()),o.__IfContains(o.aryCurrentSelectedImageIndicesInBuffer,c)?(Funs2.output(o,"__AttachImagesInner() set control index selected:"+[a].join()),l.SetSelect(!0)):l.SetSelect(!1)}else Funs2.output(o,"__AttachImagesInner() set control index InVisible:"+[a].join()),l.SetVisible(!1)}}}},o.prototype.__IfContains=function(e,t){var n=0;if(e)for(n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},o.prototype.__ReInitChildrenPosition=function(){var e,t=this,n=0,r=0;for(t.__InitControlsSize(),t.bSingleMode||(n=t.ImageMargin,r=t.ImageMargin),e=0;e<t.aryImageControls.length;e++){var o=t.aryImageControls[e];o.ChangeControlSize(t.iControlWidth,t.iControlHeight),t.bSingleMode?o.SetLocation(0,0):(o.SetLocation(n,r),n=o.Right+t.ImageMargin,1==t.bVerticalMode&&(e+1)%t.imagesPerColumn==0&&(n=t.ImageMargin,r=o.Bottom+t.ImageMargin,0==t.bScrollBar&&r+iControlHeight>t.imageViewHeight&&(r=t.ImageMargin)))}},o.prototype.__InitControlsSize=function(){var e=this;if(0==e.bSingleMode){var t=e.__GetScrollWidth();if(1==e.bVerticalMode){if((e.__GetHowManyRows()<=e.imagesPerRow||0==e.bScrollBar)&&(t=0),e.ImageMargin<=0||e.ImageMargin>e.imageViewWidth-t-3*e.imagesPerColumn||e.ImageMargin>e.imageViewHeight-3*e.imagesPerRow){var n=(r=parseInt(e.imageViewHeight/(10*e.imagesPerRow)))<(o=parseInt((e.imageViewWidth-t)/(10*e.imagesPerColumn)))?r:o;e.ImageMargin<=0?e.ImageMargin=parseInt(n):e.ImageMargin=parseInt(e.ImageMargin<n?e.ImageMargin:n)}}else if((e.sHowManyImages<=e.imagesPerColumn||0==e.bScrollBar)&&(t=0),e.ImageMargin<=0||e.ImageMargin>e.imageViewWidth-3*e.imagesPerColumn||e.ImageMargin>e.imageViewHeight-t-3*e.imagesPerRow){var r,o;n=(r=parseInt(e.imageViewHeight-t)/(10*e.imagesPerRow))<(o=parseInt(e.imageViewWidth/(10*e.imagesPerColumn)))?r:o;e.ImageMargin<=0?e.ImageMargin=parseInt(n):e.ImageMargin=parseInt(e.ImageMargin<n?e.ImageMargin:n)}e.imagesPerColumn==e.imagesPerRow&&1==e.imagesPerRow&&(e.ImageMargin=0);var i=0,a=0;1==e.bVerticalMode?(i=e.imageViewHeight-e.ImageMargin-2*e.borderWidth,a=e.imageViewWidth-t-e.ImageMargin-2*e.borderWidth):(i=e.imageViewHeight-t-e.ImageMargin-2*e.borderWidth,a=e.imageViewWidth-e.ImageMargin-2*e.borderWidth),e.iControlWidth=parseInt(a/e.imagesPerColumn-e.ImageMargin),e.iControlHeight=parseInt(i/e.imagesPerRow-e.ImageMargin)}else e.ImageMargin=0,e.iControlWidth=e.imageViewWidth-2*e.borderWidth,e.iControlHeight=e.imageViewHeight-2*e.borderWidth},o.prototype.GetDataImageControlList=function(){return this.aryModelImageControl},o.prototype.SetDataImageControl=function(e,t){if(!(e>this.aryModelImageControl.length||this.aryModelImageControl.length<=0)){var n;e==this.aryModelImageControl.length?((n=new r).imageIndex=e,n.rawWidth=t,this.aryModelImageControl.push(n)):(n=this.aryModelImageControl[e]).rawWidth=t,null!=n&&(n.bIsDirty=!0);var o=this.GetImageControl(e);return null!=o&&this.__GetImageAndAttach(o,n,e,!0),!0}},o.prototype.AttachImagesForControl=function(e,t,n){return e.GetBindIndex()==n&&(e.AttachImage(t.imageToShow,t.imageWidth,t.imageHeight,t.imageIndex,t.aryOverlayRectangleData,t.bOriginalImage),e.Show()),!0},o.prototype.__SetSelectionWinBorderColor=function(e){},o.prototype.__SetUnselectAll=function(){var e=0;for(e=0;e<this.aryImageControls.length;e++){this.aryImageControls[e].SetSelect(!1)}},o.prototype.GetImageControl=function(e){var t=this.__GetImageControlIndex(e);return t>=0&&t<this.aryImageControls.length?this.aryImageControls[t]:null},o.prototype.__GetImageControlIndex=function(e){var t=-1;return(t=1==this.bSingleMode?0:1==this.bVerticalMode?e-this.__GetFirstVisibleRow()*this.imagesPerColumn:e-this.__GetFirstVisibleColumn())>=0&&t<this.aryImageControls.length?t:-1},o.prototype.__SetIfHScroll=function(e){Funs2.output(this,"__SetIfHScroll"+e),this.horizontalScrollBar&&this.horizontalScrollBar.SetVisible(e)},o.prototype.__GetIfHScroll=function(){return!this.horizontalScrollBar||1==this.horizontalScrollBar.GetVisible()},o.prototype.__SetIfVScroll=function(e){Funs2.output(this,"__SetIfVScroll"+e),this.verticalScrollBar&&this.verticalScrollBar.SetVisible(e)},o.prototype.__GetIfVScroll=function(){return!this.verticalScrollBar||1==this.verticalScrollBar.GetVisible()},o.prototype.__GetHScrollPosionValue=function(){var e=0;return this.horizontalScrollBar&&(e=this.horizontalScrollBar.GetCurrentPosition()),e&&e>=0?e:0},o.prototype.__GetVScrollPosionValue=function(){var e=0;return this.verticalScrollBar&&(e=this.verticalScrollBar.GetCurrentPosition()),e&&e>=0?e:0},o.prototype.__SetHScrollMaxValue=function(e,t){Funs2.output(this,"__SetHScrollMaxValue(totalSize,pageSize):"+e+","+t),this.horizontalScrollBar&&this.horizontalScrollBar.InitScroll(e,t)},o.prototype.__SetVScrollMaxValue=function(e,t){Funs2.output(this,"__SetVScrollMaxValue(totalSize,pageSize):"+e+","+t),this.verticalScrollBar&&this.verticalScrollBar.InitScroll(e,t)},o.prototype.__SetHScrollPotion=function(e){this.horizontalScrollBar&&this.horizontalScrollBar.GoPosition(e)},o.prototype.__SetVScrollPotion=function(e){this.verticalScrollBar&&this.verticalScrollBar.GoPosition(e)},o.prototype.__SetHLocation=function(e,t){this.horizontalScrollBar&&this.horizontalScrollBar.SetLocation(e,t)},o.prototype.__SetVLocation=function(e,t){this.verticalScrollBar&&this.verticalScrollBar.SetLocation(e,t)},o.prototype.__ChangeHControlSize=function(e,t){this.horizontalScrollBar&&this.horizontalScrollBar.ChangeControlSize(e,t)},o.prototype.__ChangeVControlSize=function(e,t){this.verticalScrollBar&&this.verticalScrollBar.ChangeControlSize(e,t)},o.prototype.__GetScrollWidth=function(){return 16},o.prototype.SetSelectedImageArea=function(e,t,n,r,o){var i=this.GetImageControl(e);return null!=i&&(1==this.imagesPerRow&&1==this.imagesPerColumn&&i.SetSelectedImageArea(t,n,r,o))},o.prototype.OverlayRectangle=function(e,t,n,r,o,i,a){var s=this.GetImageControl(e);null!=s&&s.OverlayRectangle(t,n,r,o,i,a);var u=this.aryModelImageControl[e],l=new function(e,t,n,r,o,i){this.Left=e,this.Top=t,this.Right=n,this.Bottom=r,this.ColorRGB=o,this.Opacity=i}(t,n,r,o,i,a);return u.aryOverlayRectangleData.push(l)},o.prototype.GetMousePosition=function(){var e=this.GetImageControl(this.cCurrentIndex);return null!=e?e.GetMousePosition():null},o.prototype.ChangeImageViewSize=function(e,t){var n=this;return e>=0&&(n.imageViewWidth=e,n.__ChangeHControlSize(e,16),n.__SetVLocation(e-n.__GetScrollWidth(),0)),t>=0&&(n.imageViewHeight=t,n.__ChangeVControlSize(16,t),n.__SetHLocation(0,t-n.__GetScrollWidth())),n.canvas&&(n.canvas.style.width=e+"px",n.canvas.style.height=t+"px"),n.UpdateAllImage(n.aryModelImageControl,n.cCurrentIndex),!0},o.prototype.SetViewMode=function(e,t){var n=this,r=n.imagesPerColumn,o=n.imagesPerRow,i=n.bSingleMode,a=n.bVerticalMode;if(e>0&&(n.imagesPerColumn=e),t>0&&(n.imagesPerRow=t),-1==e&&-1==t?(n.imagesPerRow=1,n.imagesPerColumn=1,n.bSingleMode=!0):(n.bSingleMode=!1,-1==t?(n.imagesPerRow=1,n.bVerticalMode=!1):n.bVerticalMode=!0),n.iOldFirstVisibleRow=0,n.iOldFirstVisibleColum=0,0==n.bSingleMode){var s=0;for(s=0;s<n.aryImageControls.length;s++){null!=(u=n.aryImageControls[s])&&u.SetOrigMode(!1)}}if(r!=n.imagesPerColumn||o!=n.imagesPerRow||i!=n.bSingleMode||a!=n.bVerticalMode){if(1==n.imagesPerRow&&1==n.imagesPerColumn){s=0;for(s=0;s<n.aryImageControls.length;s++){var u;null!=(u=n.aryImageControls[s])&&u.ClearControl()}}if(n.aryCurrentSelectedImageIndicesInBuffer.length>0){var l=n.aryCurrentSelectedImageIndicesInBuffer[0];l>=0&&l<n.aryModelImageControl.length&&(n.cCurrentIndex=l)}n.UpdateAllImageInner(n.aryModelImageControl,n.cCurrentIndex,!0)}return n.__SetUnselectAll(),n.__SetSelectedImageIndicesInBuffer(),!0},o.prototype.RemoveAllImages=function(){return this.Clear()},o.prototype.Clear=function(){var e=this;for(t=e.aryImageControls.length-1;t>=0;t--)e.__RemoveControl(t);var t=0;for(t=0;t<e.aryModelImageControl.length;t++)e.aryModelImageControl[t].Clear();for(e.aryModelImageControl=[],Dynamsoft.WebTwainEnv.ScanDirectly||(e.__SetVScrollMaxValue(0,0),e.__SetHScrollMaxValue(0,0),e.__SetIfHScroll(!1),e.__SetIfVScroll(!1)),t=Dynamsoft.Lib.aryControlLoadImage.length-1;t>=0;t--){var n=Dynamsoft.Lib.aryControlLoadImage[t];n.imgControl&&n.View==e&&(n.imgControl.SetBindIndex(-1),n.imgControl.Destroy(),Dynamsoft.Lib.aryControlLoadImage.splice(t,1))}return e.cCurrentIndex=-1,!0},o.prototype.ShowImage=function(e,t){if(this.__OnlySetCurrentIndex(e),1==this.bSingleMode){var n=this.GetImageControl(this.cCurrentIndex);null!=n&&this.__GetImageAndAttach(n,t,e,!1)}return!0},o.prototype.__GetImageAndAttach=function(e,t,n,r){var o=this,i=parseInt(o.imageViewWidth/2),a=parseInt(o.imageViewHeight/2);1==o.imagesPerRow&&1==o.imagesPerColumn?1==o.bSingleMode?(i=-1,a=-1,t.bOriginalImage=!0):(i=o.imageViewWidth,a=o.imageViewHeight,t.bOriginalImage=!1):(i<300&&(i=300),a<300&&(a=300),t.bOriginalImage=!1);var s=!1;s=!!r||(1==t.bIsDirty||t.iImageControlWidth<i||t.iImageControlHeight<a||t.iImageControlWidth>0&&-1==i||t.iImageControlHeight>0&&-1==a),e.ClearImage(),e.SetCurrentIndex(n);var u=o.__GetImageControlIndex(n);u>=0&&o.__SetArrayControlLoadImage(u,n,e,t,i,a,o.AttachImagesForControl,s)},o.prototype.__SetArrayControlLoadImage=function(e,t,n,r,o,i,a,s){var u=0;for(u=0;u<Dynamsoft.Lib.aryControlLoadImage.length;u++){var l=Dynamsoft.Lib.aryControlLoadImage[u];if(l.iControlIndex==e&&l.View==this)return l.iImageIndex=t,l.imgControl=n,l.modelImageControl=r,l.iWidth=o,l.iHeight=i,l.AttachImagesForControl=a,void(l.bOnlyFromServer=s)}Dynamsoft.Lib.aryControlLoadImage.push(new function(e,t,n,r,o,i,a,s,u,l){var c=this;c.iControlIndex=e,c.iImageIndex=t,c.View=n,c.imgControl=r,c.modelImageControl=o,c.iWidth=i,c.iHeight=a,c.AttachImagesForControl=s,c.bOnlyFromServer=u,c.BaseUrl=l}(e,t,this,n,r,o,i,a,s,this.BaseUrl))},o.prototype.SetIfFitWindowAndType=function(e){if(1==this.bSingleMode){this.bIfFitWindow=!0,this.enumDWTFitWindowType=e;var t=this.GetImageControl(this.cCurrentIndex);null!=t&&(t.SetIfFitWindow(!0,e),this.fZoom=t.GetZoom(),t.Show())}else this.bIfFitWindow=!0;return!0},o.prototype.GetAllowMultiSelect=function(){return this.AllowMultiSelect},o.prototype.SetAllowMultiSelect=function(e){return this.AllowMultiSelect=e,!0},o.prototype.GetFitWindowType=function(){return this.enumDWTFitWindowType},o.prototype.SetSelectionRectAspectRatio=function(e){return this.ratio=e,this.__AttachImagesInner(!0,!1),!0},o.prototype.SetFitWindowType=function(e){return this.enumDWTFitWindowType=e,this.bSingleMode?this.__AttachImagesInner(!0,!1):(this.bIfFitWindow=!0,this.enumDWTFitWindowType=0),!0},o.prototype.GetIfFitWindow=function(){return this.bIfFitWindow},o.prototype.SetIfFitWindow=function(e){return this.bIfFitWindow=e,this.bSingleMode?this.__AttachImagesInner(!0,!1):(this.bIfFitWindow=!0,this.enumDWTFitWindowType=0),!0},o.prototype.GetImageMargin=function(){return this.ImageMargin},o.prototype.SetImageMargin=function(e){return this.ImageMargin=e,this.__ReInitChildrenPosition(),this.__AttachImagesInner(!1,!1),!0},o.prototype.GetSelectionImageBorderColor=function(){return this.SelectionImageBorderColor},o.prototype.SetSelectionImageBorderColor=function(e){return this.SelectionImageBorderColor=e,this.__AttachImagesInner(!0,!1),!0},o.prototype.GetZoom=function(){if(this.bIfFitWindow){var e=this.GetImageControl(this.cCurrentIndex);if(null!=e)return e.GetZoom()}return this.fZoom},o.prototype.SetZoom=function(e){var t=this;if(e<t.MIN_ZOOM&&(e=t.MIN_ZOOM),e>t.MAX_ZOOM&&(e=t.MAX_ZOOM),t.fZoom=e,1==t.bSingleMode){t.bIfFitWindow=!1,t.enumDWTFitWindowType=0;var n=t.GetImageControl(t.cCurrentIndex);null!=n&&n.SetZoom(t.fZoom)}else t.bIfFitWindow=!0;return!0},o.prototype.ZoomIn=function(){var e=this;if(1==e.bSingleMode){var t=e.aryModelImageControl[e.cCurrentIndex],n=e.fZoom;if(e.bIfFitWindow){var r=e.GetImageControl(e.cCurrentIndex);null!=r&&(n=r.GetZoom())}if(tempZoom=Math.floor(100*n*e.zoomInStep)+1,!(1<tempZoom&&tempZoom<2501))return Funs2.output(e,"You have reached the limit for zooming in"),alert("You have reached the limit for zooming in"),!1;if(parseInt(t.imageWidth*e.fZoom)>15e3||parseInt(t.imageHeight*e.fZoom)>15e3)return Funs2.output(e,"You have reached the limit for zooming in"),!1;e.SetZoom(tempZoom/100)}return!0},o.prototype.ZoomOut=function(){if(1==this.bSingleMode){var e=this.fZoom;if(this.bIfFitWindow){var t=this.GetImageControl(this.cCurrentIndex);null!=t&&(e=t.GetZoom())}var n=Math.floor(100*e*this.zoomOutStep)-1;if(!(1<n&&n<6501))return Funs2.output(this,"You have reached the limit for zooming out"),!1;this.SetZoom(n/100)}return!0},o.prototype.GetMouseShape=function(){return this.iMouseShape},o.prototype.SetMouseShape=function(e){return this.iMouseShape=e,this.__AttachImagesInner(!0,!1),!0},o.prototype.SetMouseShapeByIndex=function(e,t){this.__OnlySetCurrentIndex(e),this.iMouseShape=t;var n=this.GetImageControl(e);return null!=n&&(n.SetMouseShape(this.iMouseShape),n.Show(),!0)},o.prototype.GetShowPageNumber=function(){return this.bShowPageNumber},o.prototype.SetShowPageNumber=function(e){return this.bShowPageNumber=e,this.__AttachImagesInner(!0,!1),!0},o.prototype.SetBackgroundColor=function(e){return this.BackgroundColor=e,this.canvas&&(this.canvas.style.backgroundColor=e),this.__AttachImagesInner(!0,!1),!0},o.prototype.Go=function(e){return this.__GoInner(e,!0,!1),!0},o.prototype.SetCurrentIndexOnly=function(e){return this.__GoInner(e,!0,!1)},o.prototype.__GoInner=function(e,t,n){var r=this;r.cCurrentIndex;if(e<r.aryModelImageControl.length&&e>=0&&(0==n&&r.__OnlySetCurrentIndex(e),1==t&&(1==n?r.__SetCurrentIndex(r.cCurrentIndex):r.__SetCurrentIndexWithoutRefreshUI(r.cCurrentIndex)),1==n&&r.__AttachImages(!1),r.iCurrentRow=-1,r.iCurrentColumn=-1,0==t))if(1==r.bVerticalMode){var o=r.iCurrentRow;if(r.iCurrentRow=r.__GetRow(e),r.iCurrentRow!=o&&(r.iCurrentRow<=r.iOldFirstVisibleRow||r.iCurrentRow>r.iOldFirstVisibleRow)){var i=r.__GetFirstVisibleRow();if(r.iOldFirstVisibleRow!=i){r.iOldFirstVisibleRow=i;var a=i*r.imagesPerColumn;r.__fireEvent("OnTopImageInTheViewChanged",a)}}}else{var s=r.iCurrentColumn;if(r.iCurrentColumn=e,r.iCurrentColumn!=s&&(r.iCurrentColumn<r.iOldFirstVisibleColum||r.iCurrentColumn>r.iOldFirstVisibleColum)){var u=r.__GetFirstVisibleColumn();if(r.iOldFirstVisibleColum!=u){r.iOldFirstVisibleColum=u;a=u;r.__fireEvent("OnTopImageInTheViewChanged",a)}}}return!0},o.prototype.PrintCurrent=function(){if(!(this.cCurrentIndex<0)){var e=Funs2.getImageUrl(this.BaseUrl,this.cCurrentIndex,-1,-1),t=this.aryModelImageControl[this.cCurrentIndex],r=[],o=new n(e,t.imageWidth,t.imageHeight);return r.push(o),Funs2.print(r),!0}},o.prototype.Print=function(){if(!(this.cCurrentIndex<0)){var e=[];for(i=0;i<this.aryModelImageControl.length;i++){var t=Funs2.getImageUrl(this.BaseUrl,i,-1,-1),r=this.aryModelImageControl[i],o=new n(t,r.imageWidth,r.imageHeight);e.push(o)}return Funs2.print(e),!0}},o.prototype.SetSelectedImageCount=function(e){return this.aryCurrentSelectedImageIndicesInBuffer.splice(e),this.__SetUnselectAll(),this.__SetSelectedImageIndicesInBuffer(),!0},o.prototype.SetSelectedImageIndex=function(e,t){var n=this;n.aryCurrentSelectedImageIndicesInBuffer[e]=t,n.__SetUnselectAll(),n.__SetSelectedImageIndicesInBuffer();for(var r=-1,o=n.aryCurrentSelectedImageIndicesInBuffer.length,i=0;i<o;i++){var a=n.aryCurrentSelectedImageIndicesInBuffer[i];-1==r?r=a:a<r&&(r=a)}return r>=0&&r<n.aryModelImageControl.length&&n.cCurrentIndex!=r&&(n.cCurrentIndex=r,n.__fireEvent("onResetCurrentIndex",n.cCurrentIndex)),!0},o.prototype.__SetSelectedImageIndicesInBuffer=function(){0==this.aryCurrentSelectedImageIndicesInBuffer.length&&this.cCurrentIndex>=0&&this.aryCurrentSelectedImageIndicesInBuffer.push(this.cCurrentIndex);var e=0;for(e=0;e<this.aryCurrentSelectedImageIndicesInBuffer.length;e++){var t=this.aryCurrentSelectedImageIndicesInBuffer[e],n=this.GetImageControl(t);null!=n&&(n.SetSelect(!0),n.Show())}},o.prototype.__OnlySetCurrentIndex=function(e){var t=this.cCurrentIndex;this.cCurrentIndex=e,t!=e&&this.__fireEvent("onResetCurrentIndex",e),this.aryCurrentSelectedImageIndicesInBuffer[0]!=this.cCurrentIndex&&(this.aryCurrentSelectedImageIndicesInBuffer=[],this.aryCurrentSelectedImageIndicesInBuffer.push(this.cCurrentIndex))},o.prototype.__MousewheelChanged=function(e){e.__MousewheelValue>0?e.__MousewheelUp(e.__MousewheelValue):e.__MousewheelValue<0&&e.__MousewheelDown(-e.__MousewheelValue),e.__MousewheelValue=0},o.prototype.__MousewheelUp=function(e){var t=this;if(0==t.bSingleMode){if(1==t.__GetIfHScroll()||1==t.__GetIfVScroll()){var n=0,r=0;(r=1==t.bVerticalMode?(n=t.__GetFirstVisibleRow()*t.imagesPerColumn)-e*t.imagesPerColumn:(n=t.__GetFirstVisibleColumn())-e)<0&&(r=0),Funs2.output(t,"__MousewheelUp(baseIndex, index): "+[n,r].join(",")),t.__SetScrollByIndex(r)}}else{var o=t.GetImageControl(t.cCurrentIndex);null!=o&&o.ImageMoveUp()}},o.prototype.__MousewheelDown=function(e){var t=this;if(0==t.bSingleMode){if(1==t.__GetIfHScroll()||1==t.__GetIfVScroll()){var n=0,r=0;r=1==t.bVerticalMode?(n=t.__GetFirstVisibleRow()*t.imagesPerColumn)+e*t.imagesPerColumn:(n=t.__GetFirstVisibleColumn())+e,n+t.imagesPerColumn*t.imagesPerRow<t.aryModelImageControl.length&&(Funs2.output(t,"__MousewheelDown(baseIndex, index): "+[n,r].join(",")),t.__SetScrollByIndex(r,!0))}}else{var o=t.GetImageControl(t.cCurrentIndex);null!=o&&o.ImageMoveDown()}},o.prototype.__Previous=function(){return this.Go(this.cCurrentIndex-1),!0},o.prototype.__DoLeftArrow=function(){if(0==this.bSingleMode)this.Go(this.cCurrentIndex-1);else{var e=this.GetImageControl(this.cCurrentIndex);null!=e&&e.ImageMoveLeft()}return!0},o.prototype.__Next=function(){return this.Go(this.cCurrentIndex+1),!0},o.prototype.__DoRightArrow=function(){if(0==this.bSingleMode)this.__SetCurrentIndexInner(this.cCurrentIndex+1,!0);else{var e=this.GetImageControl(this.cCurrentIndex);null!=e&&e.ImageMoveRight()}return!0},o.prototype.__PreviousUp=function(){if(0==this.bSingleMode){var e=this.cCurrentIndex-this.imagesPerColumn;e>=0&&this.Go(e)}else{var t=this.GetImageControl(this.cCurrentIndex);null!=t&&t.ImageMoveUp()}return!0},o.prototype.__NextDown=function(){if(0==this.bSingleMode){var e=this.cCurrentIndex+this.imagesPerColumn;e<this.aryModelImageControl.length&&this.__SetCurrentIndexInner(e,!0)}else{var t=this.GetImageControl(this.cCurrentIndex);null!=t&&t.ImageMoveDown()}return!0},o.prototype.__PageUp=function(){var e=this;if(0==e.bSingleMode){if(1==e.bVerticalMode){var t=e.__GetFirstVisibleRow()*e.imagesPerColumn-e.imagesPerColumn*e.imagesPerRow;t>=0?e.__SetCurrentIndexInner(t,!1):e.__SetCurrentIndexInner(0,!1)}}else{var n=e.GetImageControl(e.cCurrentIndex);null!=n&&n.ImageMovePageUp()}return!0},o.prototype.__PageDown=function(){var e=this;if(0==e.bSingleMode){if(1==e.bVerticalMode){var t=e.__GetFirstVisibleRow()*e.imagesPerColumn+e.imagesPerColumn*e.imagesPerRow;t<e.aryModelImageControl.length?e.__SetCurrentIndexInner(t,!1):e.__SetCurrentIndexInner(e.aryModelImageControl.length-1,!1,!1)}}else{var n=e.GetImageControl(e.cCurrentIndex);null!=n&&n.ImageMovePageDown()}return!0},o.prototype.__Home=function(){if(0==this.bSingleMode)this.__SetCurrentIndexInner(0,!1);else{var e=this.GetImageControl(this.cCurrentIndex);null!=e&&e.ImageMoveHome()}return!0},o.prototype.__End=function(){if(0==this.bSingleMode)this.__SetCurrentIndexInner(this.aryModelImageControl.length-1,!1);else{var e=this.GetImageControl(this.cCurrentIndex);null!=e&&e.ImageMoveEnd()}return!0},o.prototype.__fireEvent=function(t,n){return!e.isFunction(this[t])||this[t](n)},o.prototype.AddImage=function(e,t,n){var r,o,i,a,s=1*e;if(r=(o=this.GetDataImageControlList()).length,s<0||s>t)return!1;for(i=s;i<r;i++)(a=o[i]).imageIndex=i+1;return(a=new Dynamsoft.Lib.UI.ModelImageControl).bIsDirty=!0,a.rawWidth=n,s>=r?(a.imageIndex=r,s=r,o.push(a)):(a.imageIndex=s,o.splice(s,0,a)),this.__bAddingImage=!0,this.UpdateAllImage(o,s,s,r),this.__bAddingImage=!1,!0},o.prototype.RemoveImage=function(e,t){var n,r,o,i=1*e,a=1*t;if(!(void 0===i||i<0)){if(1!=(n=(r=this.GetDataImageControlList()).length)){if(i>=n)i=n-1;else for(var s=i;s<r.length;s++)r[s].imageIndex=s-1;return(o=r.splice(i,1))&&o[0]&&o[0].Clear(),this.UpdateAllImage(r,a,i,n-2),!0}this.RemoveAllImages()}},o.prototype.MoveImage=function(e,t){var n,r,o,i,a;for((n=this.GetDataImageControlList()).length,r=e,o=n[e];r<n.length;r++)n[r].imageIndex=r-1;for(n.splice(e,1),r=t;r<n.length;r++)n[r].imageIndex=r+1;return n.splice(t,0,o),o.imageIndex=t,e<t?(i=e,a=t):(i=t,a=e),this.UpdateAllImage(n,this.GetCurrentImageIndex(),i,a),!0},o.prototype.GetCurrentImageIndex=function(){return this.cCurrentIndex},o.prototype.GetSelectedIndexes=function(){return this.aryCurrentSelectedImageIndicesInBuffer},o.prototype.HowManyImagesInBuffer=function(){return this.GetDataImageControlList().length},o.prototype.SwitchImage=function(e,t){var n,r,o;return(n=this.GetDataImageControlList()).length,e<n.length&&e>=0&&t<n.length&&t>=0&&((r=n[e]).imageIndex=t,(o=n[t]).imageIndex=e,n[t]=r,n[e]=o,this.UpdateImage(e,o.imageToShow,o.imageWidth,o.imageHeight,o.aryOverlayRectangleData,o.imageUrl),this.UpdateImage(t,r.imageToShow,r.imageWidth,r.imageHeight,r.aryOverlayRectangleData,r.imageUrl)),!0},o.prototype.GetIfAutoScroll=function(){return this.__IfAutoScroll},o.prototype.SetIfAutoScroll=function(e){return this.__IfAutoScroll=!!e,!0},o.prototype.handlerKeyDownView=function(t){var n=this,r=!0;if(!n.bFocus)return r;switch(n.iCurrentRow=-1,n.iCurrentColumn=-1,t.keyCode){case 37:r=!1,n.__DoLeftArrow();break;case 39:r=!1,n.__DoRightArrow();break;case 38:r=!1,n.__PreviousUp();break;case 40:r=!1,n.__NextDown();break;case 33:r=!1,n.__PageUp();break;case 34:r=!1,n.__PageDown();break;case 35:r=!1,n.__End();break;case 36:r=!1,n.__Home();break;case 82:break;case 107:n.ZoomIn();break;case 109:n.ZoomOut()}return 0==r&&e.stopPropagation(t),r},Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{},Dynamsoft.Lib.UI.ImageUIView=o,Dynamsoft.Lib.UI.ModelImageControl=r;Dynamsoft.Lib.addEventListener(document.documentElement,"keydown",function(e){var n=!0;return Dynamsoft.Lib.each(t,function(t){if(t instanceof Dynamsoft.Lib.UI.ImageUIView&&t.bFocus&&!(n=t.handlerKeyDownView(e)))return!1}),n})}function n(e,t,n){this.Url=e,this.Width=t,this.Height=n}function r(){var e=this;e.bIsDirty=!1,e.imageToShow,e.imageWidth=0,e.imageHeight=0,e.rawWidth=0,e.bOriginalImage=!1,e.imageUrl,e.iImageControlWidth,e.iImageControlHeight,e.imageIndex=-1,e.aryOverlayRectangleData=[]}function o(n){var r=this;Dynamsoft.WebTwainEnv.ScanDirectly||(r.bFocus=!1,r.borderWidth=e.isUndefined(n.borderWidth)?1:n.borderWidth,r.canvas=document.createElement("div"),r.canvas&&(r.canvas.style.width=n.Width+"px",r.canvas.style.height=n.Height+"px",r.borderWidth>0&&(r.canvas.style.border=r.borderWidth+"px solid #CCCCCC"),r.canvas.style.display="block"),r.BaseUrl=!1,n.Container.append(r.canvas),e.addEventListener(r.canvas,"mouseenter",function(e){r.bFocus=!0}),e.addEventListener(r.canvas,"mouseleave",function(e){r.bFocus=!1}),e.addEventListener(r.canvas,"mousewheel",function(t){if(!r.bFocus)return!0;var n=e.getWheelDelta(t);return n<0?r.__MousewheelValue--:n>0&&r.__MousewheelValue++,e.stopPropagation(t),setTimeout(function(){r.__MousewheelChanged(r)},200),!1}),r.imageViewWidth=n.Width,r.imageViewHeight=n.Height,r.imagesPerRow=1,r.imagesPerColumn=1,r.MAX_ROWS=128,r.MAX_COLUMNS=128,r.bSingleMode=!1,r.bVerticalMode=!0,r.iMouseShape=EnumDWT_MouseShape.Default,r.bIfFitWindow=!0,r.enumDWTFitWindowType=0,r.fZoom=1,r.zoomInStep=1.2,r.zoomOutStep=.8,r.MIN_ZOOM=.02,r.MAX_ZOOM=65,r.ImageMargin=0,r.iControlWidth,r.iControlHeight,r.iCurrentRow=-1,r.iOldFirstVisibleRow=0,r.iCurrentColumn=-1,r.iOldFirstVisibleColum=0,r.AllowMultiSelect=!0,r.SelectionImageBorderColor="#7DA2CE",r.BackgroundColor="#FFFFFF",r.cCurrentIndex=-1,r.sHowManyImages=0,r.bScrollBar=!0,r.__InitiHorizontalScrollBar(n),r.__InitiVerticalScrollBar(n)),r.aryCurrentSelectedImageIndicesInBuffer=[],r.aryModelImageControl=[],r.aryImageControls=[],r.bShowPageNumber=!1,r.ratio=0,r.__IfAutoScroll=!0,r.__bAddingImage=!1,r.__InitEvents(n),t.push(r),Dynamsoft.WebTwainEnv.ScanDirectly||(r.canvas&&(r.canvas.style.backgroundColor=r.BackgroundColor),r.__MousewheelValue=0)}}(Dynamsoft.Lib),Dynamsoft.Lib.aryControlLoadImage=[],Dynamsoft.Lib.imageControlCount=0,Dynamsoft.Lib.AttachAndShowImage=function(){if(!Dynamsoft.WebTwainEnv.ScanDirectly)if(0!=Dynamsoft.Lib.aryControlLoadImage.length){var e=Dynamsoft.Lib.aryControlLoadImage[0];if(Dynamsoft.Lib.aryControlLoadImage.splice(0,1),e.iControlIndex>=0&&e.iControlIndex<Dynamsoft.Lib.imageControlCount){var t=e.iWidth,n=e.iHeight;t>2&&(t-=2),n>2&&(n-=2),e.bOnlyFromServer?Dynamsoft.Lib.OnGetImageFromServer(e,e.modelImageControl,e.iImageIndex,t,n,e.BaseUrl,e.AttachImagesForControl):Dynamsoft.Lib.OnGetImageByURL(e,e.modelImageControl,e.iImageIndex,t,n,e.BaseUrl,e.AttachImagesForControl)}else setTimeout(Dynamsoft.Lib.AttachAndShowImage,0)}else setTimeout(Dynamsoft.Lib.AttachAndShowImage,500)},Dynamsoft.Lib.OnGetImageByURL=function(e,t,n,r,o,i,a){var s,u=e.imgControl;return a?t.imageUrl&&""!=t.imageUrl?(u.ClearImage(),u.SetBindIndex(n),(s=new Image).src=t.imageUrl,s.onload=function(){u.tmpImage=!1,t.imageToShow=s,t.imageWidth=s.width,t.imageHeight=s.height,t.iImageControlWidth=r,t.iImageControlHeight=o,t.bIsDirty=!1,a(u,t,n),s.onload=void 0,s.onerror=void 0,setTimeout(Dynamsoft.Lib.AttachAndShowImage,0)},s.onerror=function(n){var r,o=u.GetBindIndex();r=e.View.GetDataImageControlList().length,o>=0&&o<r?s.src=t.imageUrl:(s.src="data:,",s.onload=void 0,s.onerror=void 0,s=null,u.tmpImage=!1,setTimeout(Dynamsoft.Lib.AttachAndShowImage,0))},u.tmpImage&&(u.tmpImage.src="data:,",u.tmpImage.onload=void 0),u.tmpImage=s):Dynamsoft.Lib.OnGetImageFromServer(e,t,n,r,o,i,a):setTimeout(Dynamsoft.Lib.AttachAndShowImage,0),!0},Dynamsoft.Lib.OnGetImageFromServer=function(e,t,n,r,o,i,a){var s,u,l=e.imgControl;return a&&i?(l.ClearImage(),l.SetBindIndex(n),s=Funs2.getImageUrl(i,n,r,o),(u=new Image).src=s,u.onload=function(){l.tmpImage=!1,t.imageToShow=u,t.imageWidth=u.width,t.imageHeight=u.height,t.imageUrl=s,t.iImageControlWidth=r,t.iImageControlHeight=o,t.bIsDirty=!1,a(l,t,n),u.onload=void 0,u.onerror=void 0,setTimeout(Dynamsoft.Lib.AttachAndShowImage,0)},u.onerror=function(t){var n,a=l.GetBindIndex();n=e.View.GetDataImageControlList().length,a>=0&&a<n?(s=Funs2.getImageUrl(i,l.GetBindIndex(),r,o),u.src=s):(u.src="data:,",u.onload=void 0,u.onerror=void 0,u=null,l.tmpImage=!1,setTimeout(Dynamsoft.Lib.AttachAndShowImage,0))},l.tmpImage&&(l.tmpImage.src="data:,",l.tmpImage.onload=void 0),l.tmpImage=u):setTimeout(Dynamsoft.Lib.AttachAndShowImage,0),!0},setTimeout(Dynamsoft.Lib.AttachAndShowImage,500),function(e){if(Dynamsoft.Lib.product.bChromeEdition){var t=e.DOM,n={btninfo:["previous","next","","rotateleft","rotate","rotateright","deskew","crop","changeimagesize","flip","mirror","","zoomin","originalsize","zoomout","stretch","fit","fitw","fith","print","","hand","rectselect","zoom","","restore","save"],titlelan:["eng","chi"],titles:[["Previous Image","Next Image","","Rotate Left","Rotate","Rotate Right","Deskew","Crop Selected Area","Change Image Size","Flip","Mirror","","Zoom In","Original Size","Zoom Out","Stretch Mode","Fit Canvas","Fit Horizontally","Fit Vertically","Print","","Hand","Select","Zoom","","Restore","Save Changes"],["Previous Image","Next Image","","Rotate Left","Rotate","Rotate Right","Deskew","Crop Selected Area","Change Image Size","Flip","Mirror","","Zoom In","Original Size","Zoom Out","Stretch Mode","Fit Canvas","Fit Horizontally","Fit Vertically","Print","","Hand","Select","Zoom","","Restore","Save Changes"]]},r={isFunction:function(e){return e&&"function"==typeof e},init:function(e,t){var n=e,r=t||{};Math.floor(1e5*Math.random()+1);n.container=r.Container,n.containerWidth=r.width?r.width:0,n.containerHeight=r.height?r.height:0,n.width=n.containerWidth,n.height=n.containerHeight,n.defaultIndex=0,n.bEdit=r.bEdit||!1,n.evt_switch=r.evt_switch||"",n.evt_mouseMove=r.evt_mouseMove||"",n.evt_mouseIn=r.evt_mouseIn||"",n.evt_mouseOut=r.evt_mouseOut||"",n.evt_mouseClick=r.evt_mouseClick||"",n.evt_mouseDblClick=r.evt_mouseDblClick||"",n.selectionImageBorderColor=!1,n.backgroundColor="rgb(255, 255, 255)",n.onRefreshUI=r.onRefreshUI||!1,n.onMouseRightClick=r.onMouseRightClick||!1,n.onMouseClick=r.onMouseClick||!1,n.onMouseDoubleClick=r.onMouseDoubleClick||!1,n.onMouseMove=r.onMouseMove||!1},addClass:function(e,n){var r=t.one(e);r&&r.addClass(n)},removeClass:function(e,n){var r=t.one(e);r&&r.removeClass(n)},__createButton:function(e,t,n,r,o){var i=document.createElement("img");return i.src=Dynamsoft.WebTwainEnv.ResourcesPath+"/reference/imgs/"+t+".png",i.className="Class_D_DWT_Editor_Buttons_"+t,i.title=n,i.style.width=r+"px",i.style.height=o+"px",this.__btnBindEvents(e,i,t),i},__btnBindEvents:function(e,t,n){switch(n){case"previous":t.onclick=function(){e.previous_btn()};break;case"next":t.onclick=function(){e.next_btn()};break;case"rotateleft":t.onclick=function(){e.RotateLeft()};break;case"rotate":t.onclick=function(){e.RotateAnyAngle(this)};break;case"rotateright":t.onclick=function(){e.RotateRight()};break;case"deskew":t.onclick=function(){e.Deskew()};break;case"crop":t.onclick=function(){e.Crop_btn()};break;case"changeimagesize":t.onclick=function(){e.ChangeImageSizeGetinput(this)};break;case"flip":t.onclick=function(){e.Flip()};break;case"mirror":t.onclick=function(){e.Mirror()};break;case"zoomin":t.onclick=function(){e.ZoomIn()};break;case"originalsize":t.onclick=function(){e.OriginalSize()};break;case"zoomout":t.onclick=function(){e.ZoomOut()};break;case"stretch":t.onclick=function(){e.StrechMode()};break;case"fit":t.onclick=function(){e.FitsWindowSize()};break;case"fitw":t.onclick=function(){e.FitsWindowWidth()};break;case"fith":t.onclick=function(){e.FitsWindowHeight()};break;case"print":t.onclick=function(){e.print()};break;case"hand":t.onclick=function(){e.Hand_btn()};break;case"rectselect":t.onclick=function(){e.RectSelect_btn()};break;case"zoom":t.onclick=function(){e.Zoom_btn()};break;case"restore":t.style.display="none",t.onclick=function(){e.RestoreImage()};break;case"save":t.style.display="none",t.onclick=function(){e.SaveImage()}}},getToolBar:function(e,t,r){for(var o,i=0;i<n.titlelan.length;i++){if("eng"==n.titlelan[i]){o=n.titles[i];break}o=n.titles[0]}var a,s,u,l,c=document.createElement("ul"),d=n.btninfo.length,h=!1,f=t/d-4>r-4?r-4:t/d-4;for(f=Math.floor(f),c.style.paddingTop="2px",s=0;s<d;s++)a=document.createElement("li"),_w=f,a.style.floatLeft="true",""==(l=n.btninfo[s])?((u=document.createElement("span")).style.paddingLeft=f+"px",a.appendChild(u)):("hand"==l||"rectselect"==l||"zoom"==l?(_w=f-6,h=!0):h=!1,u=this.__createButton(e,l,o[s],_w,_w),h&&(u.style.padding="2px"),a.appendChild(u)),c.appendChild(a);(a=document.createElement("li")).style.float="right";var g=this.__createButton(e,"close","Click to Close Window",f,f);return g.onclick=function(){e.CloseImageEditor()},a.appendChild(g),c.appendChild(a),c},output:function(t,n){Dynamsoft.WebTwainEnv.Debug&&e.log(n)}};o.prototype.__NewAryModelImageControl=function(e){var t=[],n=0;for(n=0;n<e.length;n++){var r=new Dynamsoft.Lib.UI.ModelImageControl;r.bIsDirty=!0,r.imageToShow=null,r.imageWidth=-1,r.imageHeight=-1,r.iImageControlWidth=-1,r.iImageControlHeight=-1,r.imageIndex=e[n].imageIndex,r.aryOverlayRectangleData=[],t.push(r)}return t},o.prototype.ShowImageEditorEx=function(e,t,n,r){var o=this;return n=window.innerWidth,r=window.innerHeight,0,0,o.width=n-2,o.height=r-2,o.UIEditor.css({display:"",width:o.width+"px",height:o.height+"px",position:"fixed",left:0,top:0,"z-index":"9999"}),o.isFitWindow=!0,document.documentElement.scrollLeft=0,document.documentElement.scrollTop=0,document.body.style.overflow="hidden",o.toolbar.filled&&(o.toolbar.filled=!1),o.toolbar.width=o.width,o.toolbar.height=Math.ceil(o.height/20<20?20:o.height/20),this.updateEditor(),!0},o.prototype.updateEditor=function(){var n=this;if(r.output(n,'Editor is under mode "'+n.mode+'"'),n.toolbar.self){if(!n.bShow)return;if(n.toolbar.width+n.toolbar.height==0)r.addClass(n.toolbar.self,"notdisplayed");else{if(n.toolbar.self.style.width=n.toolbar.width+"px",n.toolbar.self.style.height=n.toolbar.height+"px",!n.toolbar.filled){for(n.toolbar.filled=!0;n.toolbar.self.firstChild;)n.toolbar.self.removeChild(n.toolbar.self.firstChild);if(n.toolbar.self.appendChild(r.getToolBar(n,n.toolbar.width,n.toolbar.height)),n._IfImageChanged){var o=t.one(n.toolbar.self).one(".Class_D_DWT_Editor_Buttons_save"),i=t.one(n.toolbar.self).one(".Class_D_DWT_Editor_Buttons_restore");o[0].style.display="",i[0].style.display=""}}r.removeClass(n.toolbar.self,"notdisplayed"),r.removeClass(n.toolbar.self,"overlay")}n.iControlWidth=n.width-2,n.iControlHeight=n.height-n.toolbar.height-2,e.log("ChangeImageViewSize: "+[n.iControlWidth,n.iControlHeight].join(",")),n._UIView.ChangeImageViewSize(n.iControlWidth,n.iControlHeight),n.updateMode()}else{var a,s,u=Math.floor(1e3*Math.random()+1).toString();(a=document.createElement("div")).id="ds-dwt-viewerToolbar"+u,a.style.width=n.toolbar.width+"px",a.style.height=n.toolbar.height+"px",a.style.whiteSpace="normal",a.className="ds-dwt-viewerToolbar",(s=document.createElement("div")).id="ds-dwt-imageViewer"+u,s.style.width=n.width+"px",s.style.height=n.height-n.toolbar.height+"px",s.style.backgroundColor=n.backgroundColor,s.className="ds-dwt-imageViewer",n.UIEditor.css({width:n.width+"px",height:n.height+"px"}),n.UIEditor.append(a),n.UIEditor.append(s),n.iControlWidth=n.width-2,n.iControlHeight=n.height-n.toolbar.height-2;var l={Container:n.container.one(".ds-dwt-imageViewer"),Width:n.iControlWidth,Height:n.iControlHeight,borderWidth:0,onImageAreaSelected:function(r){e.log("__onImageAreaSelected: "+[r.left,r.top,r.right,r.bottom].join(",")),n.Left=r.left,n.Top=r.top,n.Right=r.right,n.Bottom=r.bottom;var o=t.one(n.toolbar.self).one(".Class_D_DWT_Editor_Buttons_crop");if(o&&o[0]){var i=o[0].src;i=i.replace("crop_grey.","crop."),o[0].src=i,o.style("cursor","pointer")}},onImageAreaDeSelected:function(){e.log("__onImageAreaDeSelected: "),n.Left=0,n.Top=0,n.Right=0,n.Bottom=0,t.one(n.toolbar.self)&&n.__SetCropButtonGrey(!1)},onZoomChanged:function(e){n.__SetZoomInButtonEnable(!e.isMax),n.__SetZoomOutButtonEnable(!0),n.__SetCropButtonGrey(!0)}};n._UIView=new Dynamsoft.Lib.UI.ImageUIView(l),n._UIView.BaseUrl=n.BaseUrl,n._UIView.aryModelImageControl=n.aryModelImageControl,n._UIView.cCurrentIndex=n.cIndex,n._UIView.__fireEvent("onResetCurrentIndex",n.cIndex),n._UIView.SetViewMode(-1,-1),n.UIEditor.attr("class",["D_ImageUIEditor","noPaddingnoMarginInside","thinborder"].join(" ")),n.toolbar.self=document.getElementById("ds-dwt-viewerToolbar"+u),n.updateEditor()}},o.prototype.updateMode=function(e){var n,r=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_next"),o=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_previous");this.totalImagesCount>1?r&&r[0]&&(this.cIndex==this.totalImagesCount-1?(n=(n=r[0].src).replace("next.","next_grey."),r[0].src=n,r[0].style.cursor="auto"):(n=(n=r[0].src).replace("next_grey.","next."),r[0].src=n,r[0].style.cursor="pointer"),0==this.cIndex?(n=(n=o[0].src).replace("previous.","previous_grey."),o[0].src=n,o[0].style.cursor="auto"):(n=(n=o[0].src).replace("previous_grey.","previous."),o[0].src=n,o[0].style.cursor="pointer")):r&&r[0]&&(n=(n=r[0].src).replace("next.","next_grey."),r[0].src=n,r[0].style.cursor="auto",n=(n=o[0].src).replace("previous.","previous_grey."),o[0].src=n,o[0].style.cursor="auto"),this.__SetCropButtonGrey(!0),this.RectSelect_btn()},o.prototype.CloseImageEditor=function(){Dynamsoft.Lib.hide("J_ImgSizeEditor"),Dynamsoft.Lib.hide("J_RotateAnyAngle"),window.onresize=null,this._IfImageChanged?this.ShowDialogForSaveImage(-1,!0):(document.body.style.overflow="",this.__HideImageEditorInner())},o.prototype.__HideImageEditorInner=function(){this._UIView.Clear(),this.aryModelImageControl=[],this.container.remove()},o.prototype.previous_btn=function(){var e=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_previous");if(e&&e[0]){if(-1!=e[0].src.indexOf("grey"))return;this.previous()}},o.prototype.next_btn=function(){var e=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_next");if(e&&e[0]){if(-1!=e[0].src.indexOf("grey"))return;this.next()}},o.prototype.previous=function(){this.go(this.cIndex-1)},o.prototype.next=function(){this.go(this.cIndex+1)},o.prototype.go=function(e){this._IfImageChanged?this.ShowDialogForSaveImage(e,!1):this.__goInner(e)},o.prototype.__goInner=function(e){var n=this;if(void 0!==e){if(e<0||e>=n.totalImagesCount)return;n.cIndex=e,n._UIView.ShowImage(e,n.aryModelImageControl[n.cIndex]),n._UIManager.getView().SetCurrentIndexOnly(e)}var r=t.one(n.toolbar.self).one(".Class_D_DWT_Editor_Buttons_previous"),o=t.one(n.toolbar.self).one(".Class_D_DWT_Editor_Buttons_next");if(0==e)r&&r[0]&&(i=(i=r[0].src).replace("previous.","previous_grey."),r[0].src=i,r[0].style.cursor="auto",n.totalImagesCount>1&&(i=(i=o[0].src).replace("next_grey.","next."),o[0].src=i,o[0].style.cursor="pointer"));else if(e==n.totalImagesCount-1)o&&o[0]&&(i=(i=o[0].src).replace("next.","next_grey."),o[0].src=i,o[0].style.cursor="auto",n.totalImagesCount>1&&(i=(i=r[0].src).replace("previous_grey.","previous."),r[0].src=i,r[0].style.cursor="pointer"));else if(n.totalImagesCount>1){var i;if(r&&r[0])i=(i=r[0].src).replace("previous_grey.","previous."),r[0].src=i,r[0].style.cursor="pointer";if(o&&o[0])i=(i=o[0].src).replace("next_grey.","next."),o[0].src=i,o[0].style.cursor="pointer"}n._stwain._OnBitmapChanged(["0",n.cIndex.toString(),4,n.cIndex,n._UIView.sHowManyImages]),n._IfImageChanged},o.prototype.Rotate=function(e,t){void 0===e||void 0===t?alert("Not enough paramters"):(this._IfImageChanged=!0,this._stwain.Rotate(this.cIndex,e,t))},o.prototype.RotateEx=function(e,t,n){void 0===e||void 0===t||void 0===n?alert("Not enough paramters"):(this._IfImageChanged=!0,this._stwain.RotateEx(this.cIndex,e,t,n))},o.prototype.RotateLeft=function(){this._IfImageChanged=!0,this._stwain.RotateLeft(this.cIndex)},o.prototype.RotateAnyAngle=function(e){var n=this;if(Dynamsoft.Lib.hide("J_ImgSizeEditor"),!Dynamsoft.Lib.get("J_RotateAnyAngle")){t.one("body").append(['<div id="J_RotateAnyAngle" class="ds-dwt-imgSizeEditor" style="display:none; z-index: 99999;">',"<ul>",'<li><label for="J_Angle"><b>Angle :</b>','<input type="text" id="J_Angle" style="width:50%;" size="10"/></label></li>','<li><label for="J_Angle_InterpolationMethod"><b>Interpolation:</b>&nbsp;','<select size="1" id="J_Angle_InterpolationMethod"><option value = ""></option></select></li>','<li><label for="J_KeepSize"><b></b>','<input type="checkbox" id="J_KeepSize"/>Keep size</label></li>',"</ul>","<div>",'<input id="J_btnRotateAnyAngleOK" type="button" value="  OK  "/>','<span><input id= "J_btnCancelRotateAnyAngle" type="button" value="Cancel" /></span>',"</div>","</div>"].join(""))}var r=Dynamsoft.Lib.get("J_Angle_InterpolationMethod");r.options.length=0,r.options.add(new Option("NearestNeighbor",1)),r.options.add(new Option("Bilinear",2)),r.options.add(new Option("Bicubic",3)),Dynamsoft.Lib.get("J_btnRotateAnyAngleOK").onclick=function(){var e=Dynamsoft.Lib.get("J_Angle").value;if(Dynamsoft.Lib.get("J_Angle").className="",re=/^\d+$/,!re.test(e)||e<=0)return Dynamsoft.Lib.get("J_Angle").className+=" invalid",Dynamsoft.Lib.get("J_Angle").focus(),void alert("Error: The angle you entered is invalid.");var t=Dynamsoft.Lib.get("J_KeepSize").checked;n.RotateEx(e,t,Dynamsoft.Lib.get("J_Angle_InterpolationMethod").selectedIndex+1);0!=n._stwain.ErrorCode||Dynamsoft.Lib.hide("J_RotateAnyAngle")},Dynamsoft.Lib.get("J_btnCancelRotateAnyAngle").onclick=function(){Dynamsoft.Lib.hide("J_RotateAnyAngle")};var o=Dynamsoft.Lib.get("J_RotateAnyAngle");Dynamsoft.Lib.toggle("J_RotateAnyAngle");var i=e.y;i||(i=e.offsetTop+1);var a=e.x;a||(a=e.offsetLeft+1),o.style.top=i+e.offsetHeight+document.documentElement.scrollTop+"px",o.style.left=a+document.documentElement.scrollLeft+"px",Dynamsoft.Lib.get("J_Angle").value="45"},o.prototype.RotateRight=function(){this._IfImageChanged=!0,this._stwain.RotateRight(this.cIndex)},o.prototype.Deskew=function(){this.RotateEx(this._stwain.GetSkewAngle(this.cIndex),!0,1)},o.prototype.Flip=function(){this._IfImageChanged=!0,this._stwain.Flip(this.cIndex)},o.prototype.Mirror=function(){this._IfImageChanged=!0,this._stwain.Mirror(this.cIndex)},o.prototype.ChangeImageSize=function(e,t,n){this._IfImageChanged=!0,this._stwain.ChangeImageSize(this.cIndex,e,t,n)},o.prototype.ChangeImageSizeGetinput=function(e){var n=this;if(Dynamsoft.Lib.hide("J_RotateAnyAngle"),!Dynamsoft.Lib.get("J_ImgSizeEditor")){t.one("body").append(['<div id="J_ImgSizeEditor" class="ds-dwt-imgSizeEditor" style="display:none;z-index: 99999;">',"<ul>",'<li><label for="J_img_height"><b>New Height :</b>','<input type="text" id="J_img_height" style="width:50%;" size="10"/>pixel</label></li>','<li><label for="J_img_width"><b>New Width :</b>&nbsp;','<input type="text" id="J_img_width" style="width:50%;" size="10"/>pixel</label></li>',"<li>Interpolation method:",'<select size="1" id="J_InterpolationMethod"><option value = ""></option></select></li>',"</ul>","<div>",'<input id="J_btnChangeImageSizeOK" type="button" value="  OK  "/>','<span><input id= "J_btnCancelChange" type="button" value="Cancel" /></span>',"</div>","</div>"].join(""))}var r=Dynamsoft.Lib.get("J_InterpolationMethod");r.options.length=0,r.options.add(new Option("NearestNeighbor",1)),r.options.add(new Option("Bilinear",2)),r.options.add(new Option("Bicubic",3)),Dynamsoft.Lib.get("J_btnChangeImageSizeOK").onclick=function(){var e=Dynamsoft.Lib.get("J_img_width").value,t=Dynamsoft.Lib.get("J_img_height").value;if(Dynamsoft.Lib.get("J_img_width").className="",Dynamsoft.Lib.get("J_img_height").className="",re=/^\d+$/,!re.test(t)||t<=0)return Dynamsoft.Lib.get("J_img_height").className+=" invalid",Dynamsoft.Lib.get("J_img_height").focus(),void alert("Error: The height you entered is invalid.");if(!re.test(e)||e<=0)return Dynamsoft.Lib.get("J_img_width").className+=" invalid",Dynamsoft.Lib.get("J_img_width").focus(),void alert("Error: The width you entered is invalid.");n.ChangeImageSize(e,t,Dynamsoft.Lib.get("J_InterpolationMethod").selectedIndex+1);0!=n._stwain.ErrorCode||Dynamsoft.Lib.hide("J_ImgSizeEditor")},Dynamsoft.Lib.get("J_btnCancelChange").onclick=function(){Dynamsoft.Lib.hide("J_ImgSizeEditor")};var o=Dynamsoft.Lib.get("J_ImgSizeEditor");Dynamsoft.Lib.toggle("J_ImgSizeEditor");var i=e.y;i||(i=e.offsetTop+1);var a=e.x;return a||(a=e.offsetLeft+1),o.style.top=i+e.offsetHeight+document.documentElement.scrollTop+"px",o.style.left=a+document.documentElement.scrollLeft+"px",n.aryModelImageControl[n.cIndex].imageToShow?(Dynamsoft.Lib.get("J_img_width").value=n.aryModelImageControl[n.cIndex].imageToShow.width,Dynamsoft.Lib.get("J_img_height").value=n.aryModelImageControl[n.cIndex].imageToShow.height):(Dynamsoft.Lib.get("J_img_width").value=0,Dynamsoft.Lib.get("J_img_height").value=0),!1},o.prototype.Crop_btn=function(){var e=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_crop");if(e&&e[0]){if(-1!=e[0].src.indexOf("grey"))return;this.Crop()}},o.prototype.Crop=function(){var e=this.Left,t=this.Top,n=this.Right,o=this.Bottom;parseInt(e)-parseInt(n)!=0&&parseInt(t)-parseInt(o)!=0?(this._IfImageChanged=!0,this._stwain.Crop(this.cIndex,parseInt(e),parseInt(t),parseInt(n),parseInt(o)),this.__SetCropButtonGrey(!0)):r.output(this,"No area selected for cropping")},o.prototype.StrechMode=function(){this._UIView.SetIfFitWindowAndType(4),this.__SetZoomInButtonEnable(!0),this.__SetZoomOutButtonEnable(!0),this.__SetCropButtonGrey(!0)},o.prototype.FitsWindowSize=function(){this._UIView.SetIfFitWindowAndType(0),this.__SetZoomInButtonEnable(!0),this.__SetZoomOutButtonEnable(!0),this.__SetCropButtonGrey(!0)},o.prototype.FitsWindowWidth=function(e){this._UIView.SetIfFitWindowAndType(2),this.__SetZoomInButtonEnable(!0),this.__SetZoomOutButtonEnable(!0),this.__SetCropButtonGrey(!0)},o.prototype.FitsWindowHeight=function(e){this._UIView.SetIfFitWindowAndType(1),this.__SetZoomInButtonEnable(!0),this.__SetZoomOutButtonEnable(!0),this.__SetCropButtonGrey(!0)},o.prototype.ZoomIn=function(){this._UIView.ZoomIn()?(this.__SetZoomInButtonEnable(!0),this.__SetZoomOutButtonEnable(!0)):(this.__SetZoomInButtonEnable(!1),this.__SetZoomOutButtonEnable(!0)),this.__SetCropButtonGrey(!0)},o.prototype.ZoomOut=function(){this._UIView.ZoomOut()?(this.__SetZoomOutButtonEnable(!0),this.__SetZoomInButtonEnable(!0)):(this.__SetZoomOutButtonEnable(!1),this.__SetZoomInButtonEnable(!0)),this.__SetCropButtonGrey(!0)},o.prototype.OriginalSize=function(){this._UIView.SetZoom(1),this.__SetZoomInButtonEnable(!0),this.__SetZoomOutButtonEnable(!0),this.__SetCropButtonGrey(!0)},o.prototype.Hand_btn=function(){var e=EnumDWT_MouseShape.Hand;this._UIView.SetMouseShapeByIndex(this.cIndex,e),this.__EnableMouseShapButtons(e)},o.prototype.RectSelect_btn=function(){var e=EnumDWT_MouseShape.Crosshair;this._UIView.SetMouseShapeByIndex(this.cIndex,e),this.__EnableMouseShapButtons(e)},o.prototype.Zoom_btn=function(){var e=EnumDWT_MouseShape.Zoom;this._UIView.SetMouseShapeByIndex(this.cIndex,e),this.__EnableMouseShapButtons(e)},o.prototype.__EnableMouseShapButtons=function(e){var n=t.one(this.toolbar.self);if(n){var o=n.one(".Class_D_DWT_Editor_Buttons_hand"),i=n.one(".Class_D_DWT_Editor_Buttons_rectselect"),a=n.one(".Class_D_DWT_Editor_Buttons_zoom");r.removeClass(o.parent(),"ds-dwt-EditorButton-selected"),r.removeClass(i.parent(),"ds-dwt-EditorButton-selected"),r.removeClass(a.parent(),"ds-dwt-EditorButton-selected"),e==EnumDWT_MouseShape.Hand?r.addClass(o.parent(),"ds-dwt-EditorButton-selected"):e==EnumDWT_MouseShape.Crosshair?r.addClass(i.parent(),"ds-dwt-EditorButton-selected"):e==EnumDWT_MouseShape.Zoom&&r.addClass(a.parent(),"ds-dwt-EditorButton-selected")}},o.prototype.print=function(){this._UIView.PrintCurrent()},o.prototype.RestoreImage=function(){this.__RestoreImageInner(!0,-1)},o.prototype.__RestoreImageInner=function(n,r,o){var i=this;if(-1!=i.cIndex){var a=!0;if(1==i._IfImageChanged){var s=i._UIView.GetImageControl(i.cIndex);null!=s&&(s.SetCurrentIndex(i.cIndex),i.OnGetImageFromServerForEdit(s,i.aryModelImageControl[i.cIndex],i.cIndex,1,function(a,s,u){1==n&&(e.log("__RestoreImageInner: "+[s.imageIndex].join(",")),s.bOriginalImage=!0,a.GetBindIndex()==u&&i._UIView.AttachImagesForControl(a,s)),i._IfImageChanged=!1;var l=i.aryModelImageControl[u];null!=l&&(l.imageToShow=s.imageToShow,l.imageWidth=s.imageWidth,l.imageHeight=s.imageHeight,l.imageUrl=s.imageUrl),i._UIManager.getView().SetDataImageControl(u);var c=t.one(i.toolbar.self).one(".Class_D_DWT_Editor_Buttons_save"),d=t.one(i.toolbar.self).one(".Class_D_DWT_Editor_Buttons_restore");c&&c[0]&&(c[0].style.display="none",d[0].style.display="none"),o&&o(),-1==r&&i._stwain._OnBitmapChanged(["0",i.cIndex.toString(),4,i.cIndex,i._UIView.sHowManyImages])}),a=!1)}a&&o&&o()}else o&&o()},o.prototype.OnGetImageFromServerForEdit=function(e,t,n,r,o){var i,a,s=this;return o&&s.BaseUrl&&(e.ClearImage(),e.SetBindIndex(n),i=Funs2.getUrlByAct(s.BaseUrl,n,r),(a=new Image).src=i,a.onload=function(){e.tmpImage=!1,t.imageToShow=a,t.imageWidth=a.width,t.imageHeight=a.height,t.imageUrl=i,t.bIsDirty=!1,o(e,t,n),a.onerror=void 0,a.onload=void 0},a.onerror=function(t){var n=e.GetBindIndex(),o=s._stwain.HowManyImagesInBuffer;n>=0&&n<o?(i=Funs2.getImageUrl(s.BaseUrl,e.GetBindIndex(),r),a.src=i):(a.src="data:,",a.onload=void 0,a.onerror=void 0,a=null,e.tmpImage=!1)},e.tmpImage&&(e.tmpImage.src="data:,",e.tmpImage.onload=void 0),e.tmpImage=a),!0},o.prototype.ChangeSize=function(e,t){var n=this;e>=0&&(n.containerWidth=e),t>=0&&(n.containerHeight=t),n.width=n.containerWidth-2,n.width<0&&(n.width=0),n.height=n.containerHeight-2,n.height<0&&(n.height=0),n.UIEditor.css({width:n.width+"px",height:n.height+"px"})},o.prototype.SaveImage=function(){this.__SaveImageInner(!0)},o.prototype.__SaveImageInner=function(n,r){var o=this;if(-1!=o.cIndex){if(!o._IfImageChanged)return alert("You have not changed the current image"),void(r&&r());var i=!0;if(1==o._IfImageChanged){var a=o._UIView.GetImageControl(o.cIndex);null!=a&&(a.SetCurrentIndex(o.cIndex),o.OnGetImageFromServerForEdit(a,o.aryModelImageControl[o.cIndex],o.cIndex,2,function(i,a,s){1==n&&(e.log("__SaveImageInner: "+[a.imageIndex].join(",")),a.bOriginalImage=!0,i.GetBindIndex()==s&&o._UIView.AttachImagesForControl(i,a)),o._IfImageChanged=!1;var u=o.aryModelImageControl[s];null!=u&&(u.imageToShow=a.imageToShow,u.imageWidth=a.imageWidth,u.imageHeight=a.imageHeight,u.imageUrl=a.imageUrl),o._UIManager.getView().SetDataImageControl(s);var l=t.one(o.toolbar.self).one(".Class_D_DWT_Editor_Buttons_save"),c=t.one(o.toolbar.self).one(".Class_D_DWT_Editor_Buttons_restore");l&&l[0]&&(l[0].style.display="none",c[0].style.display="none"),r&&r()}),i=!1)}i&&r&&r()}else r&&r()},o.prototype.ShowDialogForSaveImage=function(e,t){var n=this;Dynamsoft.WebTwainEnv.ShowDialog(422,107,['<div id="J_waiting">','<P style="white-space:nowrap;">',"You have changed the image, do you want to keep the change(s)?","</P>",'<div style="width: 200px;white-space:nowrap;margin-left: auto;margin-right: auto;">','<input id="J_btnSave" style="width: 100px; height:30px; margin-right: 10px; margin-top: 10px;"  type="button" value="  OK  "/>','<input id= "J_btnCancel" style="width: 100px; height:30px;"  type="button" value="  NO  " />',"</div>","</div>"].join(""),!0),Dynamsoft.Lib.get("J_btnSave").onclick=function(){n.__SaveImageInner(!1,function(){Dynamsoft__OnclickCloseInstallEx(n._stwain._strDWTControlContainerID),Dynamsoft.Lib.bChangeImage=1,-1==e?n.__HideImageEditorInner():n.__goInner(e),t&&(document.body.style.overflow="")})},Dynamsoft.Lib.get("J_btnCancel").onclick=function(){n.__RestoreImageInner(!1,e,function(){Dynamsoft__OnclickCloseInstallEx(n._stwain._strDWTControlContainerID),Dynamsoft.Lib.bChangeImage=0,-1==e?n.__HideImageEditorInner():n.__goInner(e),t&&(document.body.style.overflow="")})}},o.prototype.__SetCropButtonGrey=function(e){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0;var n=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_crop");if(n&&n[0]){var r=n[0].src;r=r.replace("crop.","crop_grey."),n[0].src=r,n.style("cursor","auto")}if(e){var o=this._UIView.GetImageControl(this.cIndex);null!=o&&o.SetSelectedImageArea(0,0,0,0)}},o.prototype.__SetZoomInButtonEnable=function(e){var n=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_zoomin");if(n&&n[0]){var r=n[0].src;1==e?(r=r.replace("zoomin_grey.","zoomin."),n[0].src=r,n.style("cursor","pointer")):(r=r.replace("zoomin.","zoomin_grey."),n[0].src=r,n.style("cursor","auto"))}},o.prototype.__SetZoomOutButtonEnable=function(e){var n=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_zoomout");if(n&&n[0]){var r=n[0].src;1==e?(r=r.replace("zoomout_grey.","zoomout."),n[0].src=r,n.style("cursor","pointer")):(r=r.replace("zoomout.","zoomout_grey."),n[0].src=r,n.style("cursor","auto"))}},o.prototype.refresh=function(e){if(this.cIndex=e,this._UIView.SetDataImageControl(e),this._IfImageChanged){var n=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_save"),r=t.one(this.toolbar.self).one(".Class_D_DWT_Editor_Buttons_restore");n&&n[0]&&(n[0].style.display="",r[0].style.display="")}this.__SetCropButtonGrey(!0)},Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{},Dynamsoft.Lib.UI.ImageUIEditor=o}function o(e,t){var n,o=this,i=t||{};o._UIManager=e,o.aryModelImageControl=o.__NewAryModelImageControl(t.aryModelImageControl),o._UIView,o.iControlWidth=0,o.iControlHeight=0,o._stwain=t.stwain,o.BaseUrl=t.BaseUrl,o.cIndex=t.cIndex,o.totalImagesCount=o.aryModelImageControl.length,o._IfImageChanged=!1,r.init(o,i),(n=o.container).append('<div class="D_ImageUIEditor noPaddingnoMarginInside thinborder"></div>'),o.UIEditor=n.one(".D_ImageUIEditor"),o.bShow=!1,o.zoom=1,o.aspectRatio=1,o.__fitWindowType=0,o.toolbar={self:null,filled:!1,width:0,height:0},o.Left=0,o.Top=0,o.Right=0,o.Bottom=0,window.onresize=function(){o.ShowImageEditorEx(-1,-1,-1,-1)}}}(Dynamsoft.Lib),function(e){if(e.product.bChromeEdition){var t=e.DOM,n=function(e){return[e.httpUrl,"img?id=",e.clientId].join("")};r.prototype.getTwain=function(){return this._stwain},r.prototype.getView=function(){return this._UIView},r.prototype.OnReady=function(){return this.getView().BaseUrl=n(this._stwain),!0},r.prototype.count=function(){return this.getView().HowManyImagesInBuffer()},r.prototype.clear=function(){return this.getView().RemoveAllImages()},r.prototype.ChangeSize=function(e,t){return this.getView().ChangeImageViewSize(e,t)},r.prototype.GetCurrentImageIndex=function(){return this.getView().GetCurrentImageIndex()},r.prototype.GetSelectedImageIndex=function(e){var t=this.GetSelectedIndexes();return e>=0&&e<t.length?t[e]:-1},r.prototype.GetSelectedIndexes=function(){return this.getView().GetSelectedIndexes()},r.prototype.add=function(e,t,n){return this.getView().AddImage(e,t,n)},r.prototype.remove=function(e,t){return this.getView().RemoveImage(e,t)},r.prototype.MoveImage=function(e,t){return this.getView().MoveImage(e,t)},r.prototype.SwitchImage=function(e,t){return this.getView().SwitchImage(e,t)},r.prototype.SetViewMode=function(e,t){return this.getView().SetViewMode(e,t)},r.prototype.GetImageWidth=function(e){var t,n,r,o=1*e;return t=(n=this.getView().GetDataImageControlList()).length,o<0||o>t?0:(r=n[o])&&r.rawWidth?r.rawWidth:this._stwain.GetImageWidth(o)},r.prototype.get=function(e){var t,n,r=parseInt(e);return t=(n=this.getView().GetDataImageControlList()).length,!(r<0||r>t)&&n[r]},r.prototype.refresh=function(e,t,n,r){if(n){var o,i,a=1*e;if(o=(i=this.getView()).GetDataImageControlList().length,a<0||a>o)return!1;this._UIEditor&&this._UIEditor._UIView&&this._UIEditor.refresh(a),i.SetDataImageControl(a,r)}return!0},r.prototype.ShowImageEditorEx=function(e,n,r,o,i){var a,s,u,l=this.getView(),c=document;return s=c.createElement("div"),c.body.appendChild(s),u={Container:t.one(s),aryModelImageControl:l.GetDataImageControlList(),BaseUrl:l.BaseUrl,cIndex:l.cCurrentIndex,stwain:this.getTwain()},a=new Dynamsoft.Lib.UI.ImageUIEditor(this,u),this._UIEditor=a,a.bShow=!1,a.bShow=!0,a.ShowImageEditorEx(e,n,r,o,0)},r.prototype.refreshEditor=function(e,t){return this._UIEditor&&this._UIEditor.refresh(e),!0},r.prototype.GetSelectionImageBorderColor=function(){return this.__SelectionImageBorderColor},r.prototype.SetSelectionImageBorderColor=function(e){var t=e,n=this.getView();return this.__SelectionImageBorderColor=t,Dynamsoft.Lib.isNumber(t)&&(t=Dynamsoft.Lib.getColor(t)),n.SetSelectionImageBorderColor(t)},r.prototype.GetBackgroundColor=function(){return this.__BackgroundColor},r.prototype.SetBackgroundColor=function(e){var n,r,o=e,i=this.getView();return this.__BackgroundColor=o,Dynamsoft.Lib.isNumber(o)&&(o=Dynamsoft.Lib.getColor(o)),(n=t.one("#"+this._stwain._strDWTControlContainerID))&&(r=n.one(".ds-dwt-container-box"))&&r.style("background-color",o),i.SetBackgroundColor(o)},r.prototype.SetSelectionRectAspectRatio=function(e){var t=e,n=this.getView();return this.__Ratio=t,n.SetSelectionRectAspectRatio(t)},r.prototype.GetSelectionRectAspectRatio=function(){return this.__Ratio},Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{},Dynamsoft.Lib.UI.ImageUIManager=r}function r(e,t){var n=this;n._stwain=e,n.__SelectionImageBorderColor=8233678,n.__BackgroundColor=16777215,n.__BackgroundFillColor=16777215,n.__Ratio=0,t.OnTopImageInTheViewChanged=function(t){Dynamsoft.Lib.isFunction(e.__OnTopImageInTheViewChanged)&&e.__OnTopImageInTheViewChanged(t)},t.OnGetImageInfo=function(e){return{width:n.GetImageWidth(e),height:-1}},n._UIView=new Dynamsoft.Lib.UI.ImageUIView(t),n._UIEditor=!1}}(Dynamsoft.Lib),function(e,t){e.product.bChromeEdition&&(e.env.WSVersion="12.0.0",e.env.WSSession=(new Date).getTime(),e.getHttpUrl=function(e){return e.ssl?["https://",e.ip,":",e.port,"/"].join(""):["http://",e.ip,":",e.port,"/"].join("")},e.getWSUrl=function(e,t,n){return n?["wss://",e,":",t].join(""):["ws://",e,":",t].join("")},e.getWS=function(t,n,r){var o=e.getWSUrl(t,n,r),i=e.product.wsProtocol;return this.detect.OnCreatWS&&this.detect.OnCreatWS(o,i),"undefined"!=typeof MozWebSocket?i?new MozWebSocket(o,i):new MozWebSocket(o):i?new WebSocket(o,i):new WebSocket(o)},e._init=function(){var e=Dynamsoft.Lib,t=e.LS.item("D_port"),n=e.LS.item("D_ssl"),r=null;e.detect.urls.splice(0),e.detect.cUrlIndex=0,t&&n&&(r={port:t,ssl:"true"==n});var o,i=function(e){return!r||!(!e||e.port==r.port&&e.ssl==r.ssl)};if(1===e.detect.detectType)for(var a in null!==r&&r.ssl&&e.detect.urls.push(r),e.detect.ports)(o=e.detect.ports[a]).ssl&&i(o)&&e.detect.urls.push(o);else if(0===e.detect.detectType)for(var a in null===r||r.ssl||e.detect.urls.push(r),e.detect.ports)!1===(o=e.detect.ports[a]).ssl&&i(o)&&e.detect.urls.push(o);else for(var a in null!=r&&e.detect.urls.push(r),e.detect.ports)i(o=e.detect.ports[a])&&e.detect.urls.push(o);o=null},e._reconnect=function(){var t,n,r,o=Dynamsoft.Lib;if(o.detect.aryReconnectSTwains.length>0&&(r=o.detect.aryReconnectSTwains[0]),r&&!r.__bConnecting){r.__bConnecting=!0,t=r._ip,n=r._ssl?r._portSSL:r._port;try{var i=o.getWS(t,n,bSSl);i.onopen=function(){1==i.readyState?(r._objWS=i,r.bReady||r._OnReady(!0),r.__bConnecting=!1,e.detect.hideMask(),o.detect.bOK=!0):0==i.readyState?setTimeout(i.onopen,100):r.__bConnecting=!1},i.onclose=function(){i.onopen=null,r.__bConnecting=!1,r.bReady?(e.closeProgress("Reconnect"),e.detect.hideMask()):(r.__wsRetry++,r.__wsRetry<5?setTimeout(e._reconnect,1e3):(e.closeProgress("Reconnect"),e.Errors.Server_Restarted(r)))}}catch(t){e.log(t),r.__bConnecting=!1,r.bReady?e.detect.hideMask():(r.__wsRetry++,r.__wsRetry<5&&setTimeout(e._reconnect,1e3))}}},e.startWS=function(){var t,n=e.detect;if(e.product.bChromeEdition){if(n.bNoControlEvent||n.showMask(),n.OnDetectNext&&n.OnDetectNext(),0==n.tryTimes&&n.cUrlIndex>0&&n.arySTwains.length>0&&!n.bNoControlEvent){var r,o,i;if(n.hideMask(),e.isFunction(n.onNoControl))(o=(r=n.arySTwains[0])._width)<=0&&(o=270),(i=r._height)<=0&&(i=350),n.onNoControl(r._strDWTControlContainerID,o,i,r);n.bNoControlEvent=!0}if(n.cUrlIndex>=n.urls.length&&(n.cUrlIndex=0,n.tryTimes++),!(n.arySTwains.length>0))return n.hideMask(),void(n.bOK=!0);if((t=n.arySTwains[0]).bReady)return n.arySTwains.splice(0,1),void(n.arySTwains.length<=0?(n.hideMask(),n.bOK=!0):setTimeout(e.startWS,100));if(!t.__bConnecting){t.__bConnecting=!0;try{var a=n.urls[n.cUrlIndex],s=e.getWS(e.product.ip,a.port,a.ssl);e.log(["connecting ... [port:",a.port,"]"].join("")),s.onopen=function(){t.__bConnecting=!1,1==s.readyState?(t._objWS=s,t.bReady||(t._port=a.port,t._portSSL=a.port,t._ssl=a.ssl,t._OnReady()),n.arySTwains.splice(0,1),n.arySTwains.length<=0?(n.hideMask(),n.bOK=!0):setTimeout(e.startWS,100)):0==s.readyState&&setTimeout(s.onopen,100)},s.onclose=function(){s.onopen=null,t.__bConnecting=!1,t.bReady?n.hideMask():(n.cUrlIndex++,setTimeout(e.startWS,100))}}catch(r){e.log(r),t.__bConnecting=!1,t.bReady?n.hideMask():(n.cUrlIndex++,setTimeout(e.startWS,100))}}}else e.appendMessage("This browser is currently not supported. Please try Chrome or Firefox!")},e.startWSByIP=function(){var t,n=e.detect;if(e.product.bChromeEdition){if(n.bNoControlEvent||n.showMask(),!(n.arySTwainsByIP.length>0))return n.hideMask(),void(n.bOK=!0);if((t=n.arySTwainsByIP[0]).bReady)return n.arySTwainsByIP.splice(0,1),void(n.arySTwainsByIP.length<=0?(n.hideMask(),n.bOK=!0):setTimeout(e.startWSByIP,100));if(!t.__bConnecting){if(t.__wsRetry>0&&!n.bNoControlEvent){var r,i;if(n.hideMask(),e.isFunction(n.onNoControl))(r=t._width)<=0&&(r=270),(i=t._height)<=0&&(i=350),n.onNoControl(t._strDWTControlContainerID,r,i,t);n.bNoControlEvent=!0}t.__bConnecting=!0;try{var a,s;a=t._ssl?t._portSSL:t._port,s=e.getWS(t._ip,a,t._ssl),e.log(["connecting ... [port:",o.port,"]"].join("")),s.onopen=function(){t.__bConnecting=!1,1==s.readyState?(t._objWS=s,t.bReady||t._OnReady(),n.arySTwainsByIP.splice(0,1),n.arySTwainsByIP.length<=0?(n.hideMask(),n.bOK=!0):setTimeout(e.startWSByIP,100)):0==s.readyState&&setTimeout(s.onopen,100)},s.onclose=function(){s.onopen=null,t.__bConnecting=!1,t.bReady?n.hideMask():(t.__wsRetry++,setTimeout(e.startWSByIP,100))}}catch(r){e.log(r),t.__bConnecting=!1,t.bReady?n.hideMask():(t.__wsRetry++,setTimeout(e.startWSByIP,100))}}}else e.appendMessage("This browser is currently not supported. Please try Chrome or Firefox!")},e.html5.closeAll=function(){var t,n,r,o,i,a;for(e.dlgProgress=!1,e.detect.bOK=!1,e.detect.bFirst=!0,t=e.detect.arySTwains.length-1;t>=0;t--)if(r=e.detect.arySTwains[t]){for(o=r._strDWTControlContainerID,a=!1,n=0;n<Dynamsoft.WebTwainEnv.Containers.length;n++)if((i=Dynamsoft.WebTwainEnv.Containers[n])&&o==i.ContainerId){a=!0;break}a&&(r.__unload(),e.detect.arySTwains.splice(t,1))}},e.bio=!1,e.progressMessage="",e.dialogShowStatus=!1,e.needShowTwiceShowDialog=!1,e.dlgProgress=!1,e.cancelFrome=0,e.dlgRef=0,e.showProgress=function(n,r,o){var i=n;if(e.log("showProgress:"+r+",bCancel:"+o),0==e.cancelFrome&&1==i.__IfShowProgressBar||0!=e.cancelFrome&&1==i.__IfShowCancelDialogWhenImageTransfer){var a=t.one("#btnCancel");if(a[0].style.display=0==o?"none":"",0==e.dialogShowStatus){e.dlgProgress.showModal(),e.dialogShowStatus=!0;var s=t.one("#finalMessage"),u=t.one("#progressBar")[0],l=t.one("#status");s.html(""),l.html("0%"),e.env.bIE&&u.objProgressBar?u.objProgressBar.setValue(0):u.value=0}e.dlgRef++}},e.closeProgress=function(n){e.log("closeProgress:"+n);var r=t.one("#btnCancel");1==e.needShowTwiceShowDialog&&1==e.cancelFrome?r&&r.html("Cancel"):(r&&r.html("Cancel"),1==e.dialogShowStatus&&(e.dlgProgress.close(),e.dialogShowStatus=!1),e.needShowTwiceShowDialog=!1,e.cancelFrome=0),e.dlgRef--,e.dlgRef<=0&&(e.dlgRef=0)},e.html5.DynamicWebTwain=function(t){var n,r;for(r=0;r<e.detect.arySTwains.length;r++)if(e.detect.arySTwains[r]._strDWTControlContainerID==t.containerID)return!1;return n=new e.html5.STwain(t),e.detect.arySTwains.push(n),e.detect.bFirst&&e._init(),e.detect.bFirst=!1,n},e.html5.CreateDWTObject=function(t,n,r){var o,i,a,s;if(!(a=e.get(t)))return!1;for(s=0;s<e.detect.arySTwains.length;s++)if(e.detect.arySTwains[s]._strDWTControlContainerID==t)return!1;return o={containerID:t,width:300,height:300,onWSReady:r},a.style.width&&(o.width=a.style.width),a.style.height&&(o.height=a.style.height),n&&(o.customIP=!0,o.ip=n.ip,o.port=n.port,o.portSSL=n.portSSL),i=new e.html5.STwain(o),n?(e.detect.arySTwainsByIP.push(i),i):(e.detect.arySTwains.push(i),e.detect.bFirst&&e._init(),e.detect.bFirst=!1,i)},Dynamsoft.WebTwainEnv.RemoveAllAuthorizations=function(){var t,n=e.LS.item("D_port"),r="http://";return"true"==e.LS.item("D_ssl")&&(r="https://"),t=[r,e.product.ip,":",n,"/RemoveAllAuthorizations"].join(""),new KISSY.IO({type:"get",url:t,async:!0}),!0})}(Dynamsoft.Lib,KISSY),function(e,t){window.document;var n,r,o="This browser is currently not supported.";e.DynamicWebTwain=!1,e.__dwtEditionMain=function(t){e.product.bPluginEdition?(e.DynamicWebTwain=e.plugin.DynamicWebTwain,e.closeAll=e.plugin.closeAll,e.isFunction(t)&&t()):e.product.bActiveXEdition&&(e.DynamicWebTwain=e.ie.DynamicWebTwain,e.closeAll=e.ie.closeAll,e.isFunction(t)&&t())},e.__chromeEditionMain=function(t){e.log("Run DL.__chromeEditionMain() ..."),e.DynamicWebTwain=e.html5.DynamicWebTwain,e.closeAll=e.html5.closeAll,e.isFunction(t)&&t()},e.__innerInitEvents=function(e,t){var n=t||{};e.__OnAfterOperate=n.onAfterOperate||"",e.__OnBeforeOperate=n.onBeforeOperate||"",e.__OnOperateStatus=n.onOperateStatus||"",e.__OnBitmapChanged=n.onBitmapChanged||"",e.__OnGetFilePath=n.onGetFilePath||"",e.__OnImageAreaDeSelected=n.onImageAreaDeSelected||"",e.__OnImageAreaSelected=n.onImageAreaSelected||"",e.__OnMouseClick=n.onMouseClick||"",e.__OnMouseDoubleClick=n.onMouseDoubleClick||"",e.__OnMouseMove=n.onMouseMove||"",e.__OnMouseRightClick=n.onMouseRightClick||"",e.__OnPreAllTransfers=n.onPreAllTransfers||"",e.__OnPreTransfer=n.onPreTransfer||"",e.__OnPostLoad=n.onPostLoad||"",e.__OnPostTransfer=n.onPostTransfer||"",e.__OnPostAllTransfers=n.onPostAllTransfers||"",e.__OnSourceUIClose=n.onSourceUIClose||"",e.__OnTopImageInTheViewChanged=n.onTopImageInTheViewChanged||"",e.__OnTransferCancelled=n.onTransferCancelled||"",e.__OnTransferError=n.onTransferError||"",e.__OnInternetTransferPercentage=n.onInternetTransferPercentage||"",e.__OnInternetTransferPercentageEx=n.onInternetTransferPercentageEx||""},e.replaceControl=function(e,n){t.ContainerMap[e]=n},n=function(n,r,o,i){var a,s,u,l=window,c=navigator.userAgent.toLowerCase();if(i&&i._customIP&&"127.0.0.1"!==i._ip){if(e.isFunction(l.OnRemoteWebTwainNotFoundCallback)){var d=i._ssl?i._portSSL:i._port;OnRemoteWebTwainNotFoundCallback(e.product.name,i._ip,d,i._ssl)}}else if(e.env.bMac){if(KISSY.one("#"+n).before(e.install._strNonInstallDIV),(u=e.get(e.install._divDWTNonInstallContainerID))&&(u.style.width=r,u.style.height=o),e.show(e.install._divDWTNonInstallContainerID),e.hide(n),""!=e.install._divDWTemessageContainer&&e.hide(e.install._divDWTemessageContainer),e.isFunction(l.OnWebTwainNotFoundOnMacCallback)){var h=e.product.bChromeEdition?e.product.getChromeEditionPath():e.product.getPKGPath();OnWebTwainNotFoundOnMacCallback(e.product.name,h,e.product.bChromeEdition,e.env.bIE,e.env.bSafari,e.detect.ssl,e.env.strIEVersion)}}else if(e.env.bLinux)KISSY.one("#"+n).before(e.install._strNonInstallDIV),(u=e.get(e.install._divDWTNonInstallContainerID))&&(u.style.width=r,u.style.height=o),e.show(e.install._divDWTNonInstallContainerID),e.hide(n),""!=e.install._divDWTemessageContainer&&e.hide(e.install._divDWTemessageContainer),e.isFunction(l.OnWebTwainNotFoundOnLinuxCallback)&&(a=e.product.getLinuxHTML5DebPath(),s=e.product.getLinuxHTML5RpmPath(),OnWebTwainNotFoundOnLinuxCallback(e.product.name,a,s,e.product.bChromeEdition,e.env.bIE,e.env.bSafari,e.detect.ssl,e.env.strIEVersion));else if((c.match(/chrome\/([\d.]+)/)||c.match(/opera.([\d.]+)/)||c.match(/version\/([\d.]+).*safari/)||c.match(/firefox\/([\d.]+)/)||0==t.IfUseActiveXForIE10Plus||!t.ActiveXInstallWithCAB&&e.env.bIE)&&(KISSY.one("#"+n).before(e.install._strNonInstallDIV),(u=e.get(e.install._divDWTNonInstallContainerID))&&(u.style.width=r,u.style.height=o),e.show(e.install._divDWTNonInstallContainerID),e.hide(n),""!=e.install._divDWTemessageContainer&&e.hide(e.install._divDWTemessageContainer),e.isFunction(l.OnWebTwainNotFoundOnWindowsCallback))){h="";h=t.ActiveXInstallWithCAB?e.product.bChromeEdition?e.product.getChromeEditionPath():e.product.getMSIPath():e.product.bChromeEdition?e.product.getChromeEditionPath():e.env.bIE?e.env.bWin64?e.product.getActiveXCABx64Path():e.product.getActiveXCABx86Path():e.product.getMSIPath(),OnWebTwainNotFoundOnWindowsCallback(e.product.name,h,e.product.bChromeEdition,e.env.bIE,e.env.bSafari,e.detect.ssl,e.env.strIEVersion)}},r=function(t){navigator.userAgent.toLowerCase().match(/chrome\/([\d.]+)/)&&(KISSY.one("#"+t).before(e.install._strNonInstallDIV),e.show(e.install._divDWTNonInstallContainerID),e.hide(t),""!=e.install._divDWTemessageContainer&&e.hide(e.install._divDWTemessageContainer),e.isFunction(OnWebTwainOldPluginNotAllowedCallback)&&OnWebTwainOldPluginNotAllowedCallback(e.product.name))},Dynamsoft_OnClickInstallButton=function(){e.hide("dwt-btn-install"),e.hide("dwt-install-url-div")},e.detect.getVersionArray=function(t){var n=t.toLowerCase().replace(e.product.name.toLowerCase()+" ","");return n=n.replace("trial".toLowerCase(),""),(n=e.replaceAll(n,"[.]",",")).split(",")},e.detect.isDWTVersionLatest=function(n){if(e.isUndefined(n))return!1;var r,o,i=n.toString().toLowerCase(),a=e.detect.getVersionArray(i);r=e.env.bIE&&(e.product.bPluginEdition||e.product.bActiveXEdition)?t.ActiveXVersion:e.product.bPluginEdition?t.PluginVersion:t.ServerVersionInfo,o=(r=e.replaceAll(new String(r),"[.]",",")).split(","),index=a.length>o.length?a.length:o.length;for(var s=0;s<index;s++){if(null==a[s]&&(a[s]=0),null==o[s]&&(o[s]=0),parseInt(a[s])<parseInt(o[s]))return!1;if(parseInt(a[s])>parseInt(o[s]))return!0}return!0},e.detect._needUpgradeHtml5Server=function(n,r){if(!e.detect.bNeedUpgradeEvent&&!e.detect.isDWTVersionLatest(r.VersionInfo)){var o=window;if(e.detect.bNeedUpgradeEvent=!0,!t.UseDefaultInstallUI&&e.isFunction(t.OnWebTwainNeedUpgrade))return void t.OnWebTwainNeedUpgrade();if(r&&r._customIP&&"127.0.0.1"!==r._ip){if(e.isFunction(o.OnRemoteWebTwainNeedUpgradeCallback)){var i=r._ssl?r._portSSL:r._port;OnRemoteWebTwainNeedUpgradeCallback(e.product.name,r._ip,i,r._ssl)}return}if(KISSY.one("#"+n).before(e.install._strNonInstallDIV),e.show(e.install._divDWTNonInstallContainerID),e.hide(n),""!=e.install._divDWTemessageContainer&&e.hide(e.install._divDWTemessageContainer),e.isFunction(o.OnWebTwainNeedUpgradeCallback)){var a,s,u,l={};if(e.env.bWin)e.product.bChromeEdition?l.default=e.product.getChromeEditionPath():!t.ActiveXInstallWithCAB&&e.env.bIE?e.env.bWin64?l.default=e.product.getActiveXCABx64Path():l.default=e.product.getActiveXCABx86Path():l.default=e.product.getMSIPath(),a=EnumDWT_PlatformType.enumWindow;else if(e.env.bLinux)s=e.product.getLinuxHTML5DebPath(),u=e.product.getLinuxHTML5RpmPath(),l.default=s,l.deb=s,l.rpm=u,a=EnumDWT_PlatformType.enumLinux;else e.product.bChromeEdition?l.default=e.product.getChromeEditionPath():l.default=e.product.getPKGPath(),a=EnumDWT_PlatformType.enumMac;o.OnWebTwainNeedUpgradeCallback(e.product.name,l,e.product.bChromeEdition,a,e.env.bIE,e.env.bSafari,e.detect.ssl,e.env.strIEVersion)}}};var i={initGlobalConfig:function(n){var r=n||{};r.basePath&&(e.env.basePath=r.basePath),r.pathType&&(e.env.pathType=r.pathType),e.isUndefined(r.bDiscardBlankImage)||(e.config.bDiscardBlankImage=r.bDiscardBlankImage),r.msgPrefix&&(e.config.msgPrefix=r.msgPrefix),r.msgSuffix&&(e.config.msgSuffix=r.msgSuffix),r.detectType&&(e.detect.detectType=r.detectType),r.tryTimes&&(e.detect.tryTimes=r.tryTimes),r.onReady&&(t.OnWebTwainReady=r.onReady),r.onNotAllowedForChrome&&(e.detect.onNotAllowedForChrome=r.onNotAllowedForChrome),r.onNoControl&&(e.detect.onNoControl=r.onNoControl)},__onReadyEx:function(n){var r,o,a,s,u,l=t.Containers;if(l.length>0){if(Dynamsoft__OnclickCloseInstallEx(),e.isUndefined(n))for(o=0;o<l.length&&!(i.containerIsValid(l[o])&&(s=l[o].ContainerId,u=t.ContainerMap[s]));o++);else s=n._strDWTControlContainerID,u=n;if(u){if(e.product.bChromeEdition){u.LogLevel;-2207==u.ErrorCode&&(!t.UseDefaultInstallUI&&e.isFunction(t.OnWebTwainNeedUpgradeWebJavascript)?t.OnWebTwainNeedUpgradeWebJavascript(u.ErrorString):e.detect.bPromptJSOrServerOutdated||(alert(u.ErrorString+" Please contact the administrator or the developer of the website for more information."),e.detect.bPromptJSOrServerOutdated=!0))}e.detect._needUpgradeHtml5Server(s,u)}}if(e.product.bChromeEdition)for(o=0;o<l.length;o++)a=l[o].ContainerId,(r=t.ContainerMap[a])&&(i.SetDefaultValue(r),(r.Width<=0||r.Height<=0)&&(r.Width<=0&&(r.Width=270),r.Height<=0&&(r.Height=350)));l=null,e.isFunction(t.OnWebTwainReady)?t.OnWebTwainReady():e.isFunction(Dynamsoft_OnReady)&&Dynamsoft_OnReady()},SetDefaultValue:function(t){t.IfAllowLocalCache=!0,t.BrokerProcessType=1,t.IfShowFileDialog=!0,t.IfDisableSourceAfterAcquire=!0,(e.env.bMac||e.env.bLinux)&&(t.ImageCaptureDriverType=3)},containerIsValid:function(t){return!(!t||!t.ContainerId||""==t.ContainerId)&&!!e.get(t.ContainerId)},checkContainerForCreate:function(e){return!!i.containerIsValid(e)&&!t.ContainerMap[e.ContainerId]},startLinkWS:function(){e.detect.StartWSTimeoutId||0!=e.detect.arySTwains.length||(e.detect.StartWSTimeoutId=setTimeout(function(){e.detect.StartWSTimeoutId=!1,e.startWS()},100))},startLinkWSByIP:function(){e.detect.StartWSByIPTimeoutId||0!=e.detect.arySTwainsByIP.length||(e.detect.StartWSByIPTimeoutId=setTimeout(function(){e.detect.StartWSByIPTimeoutId=!1,e.startWSByIP()},100))}};e.detect.__WebTwainCommonMain=function(o,a){t.UseDefaultInstallUI?(o.onNotAllowedForChrome=r,o.onNoControl=n):(o.onNotAllowedForChrome=t.OnWebTwainOldPluginNotAllowed,o.onNoControl=t.OnWebTwainNotFound),i.initGlobalConfig(o),e.isFunction(a)&&a()},e.detect.__WebTwainMain=function(n,r){var o;o={containerID:n.ContainerId||"dwtcontrolContainer",width:n.Width,height:n.Height,HTTPPort:e.detect.ssl?443:80},e.detect.__WebTwainCommonMain(o,function(){var n,a,s,u;if(e.product.bChromeEdition)o.onWSReady=function(t){e.replaceControl(o.containerID,t),e.isFunction(r)&&r(t)},n=e.DynamicWebTwain(o);else{for(o.onPluginReady=function(){e.replaceControl(o.containerID,n.getInstance())},o.onPluginNotReady=function(){e.isFunction(Dynamsoft_OnNotReady)&&Dynamsoft_OnNotReady()},n=new e.DynamicWebTwain(o),s=0,a=(u=t.Containers).length-1;a>=0;a--)_c=u[a],i.containerIsValid(_c)&&s++;e.detect.arySTwains.length==s&&(e.detect._varSeed=setInterval(e.detect._controlDetect,200))}return n})},e.main=function(n,r){var o=function(){e.DynamicWebTwain?(e.WebTwain=e.DynamicWebTwain,e.product._strChromeEditionPath=e.product.getChromeEditionPath(),e.product._strMSIPath=e.product.getMSIPath(),e.product._strPKGPath=e.product.getPKGPath(),e.product.version=t.ServerVersionInfo,e.product.IEVersion=t.ActiveXVersion,e.isFunction(n)&&n(),e.product.bChromeEdition||(e.detect._varSeed=setInterval(e.detect._controlDetect,200))):e.log("Error: the Dynamic Web Twain install failed.")},i=function(){e.product.bChromeEdition?e.__chromeEditionMain(o):e.__dwtEditionMain(o)};e.config.usingMainMode=!0,t.UseDefaultInstallUI=!1,t.OnWebTwainOldPluginNotAllowed=r.onNotAllowedForChrome,t.OnWebTwainNotFound=r.onNoControl,KISSY.ready(function(t){KISSY.use(["io","json","node","dom","event","kg/bio/1.2/index"],function(t,n,o,a,s,u,l){KISSY.BIO=l,e.detect.__WebTwainCommonMain(r,i)})})},e.detect.__checkPluginMultiReady=function(){var n,r,o=t.Containers;for(n=0;n<o.length;n++)if(i.containerIsValid(o[n])&&(r=o[n].ContainerId,!t.ContainerMap[r]))return void setTimeout(e.detect.__checkPluginMultiReady,200);o=null,i.__onReadyEx()},t.Unload=function(){var n,r,o,i=t.Containers;if(e.closeAll&&e.closeAll(),i)if(e.product.bChromeEdition)for(o=t.ContainerMap,k=0;k<i.length;k++)(r=i[k].ContainerId)&&e.get(r)&&r in o&&(n=o[r])&&(n.__unload(),delete o[r]);else for(k=i.length-1;k>=0;k--)(n=document.getElementById(i[k].ContainerId))&&(n.innerHTML="");e.page.bUnload=!0,e.page.OnUnload&&e.page.OnUnload()},e.__innerLoad=function(){var n;e.page.bUnload=!1,n=e.product.bChromeEdition?function(){var n,r,o=t.Containers,a=!1;if(!e.config.usingMainMode)if(o&&0!==o.length){for(e.DynamicWebTwain=e.html5.DynamicWebTwain,e.closeAll=e.html5.closeAll,n=o.length-1;n>=0;n--)if(r=o[n],i.checkContainerForCreate(r)){a=r;break}if(a)for(i.startLinkWS(),n=0;n<o.length;n++)if(r=o[n],i.containerIsValid(r)){if(r==a){e.detect.__WebTwainMain(r,i.__onReadyEx);break}e.detect.__WebTwainMain(r)}}else e.log("DEnv.Containers does not set.")}:function(){if(!e.config.usingMainMode){e.__dwtEditionMain(function(){var n,r=t.Containers;if(!1!==r&&0!==r.length){for(n=0;n<r.length;n++)_c=r[n],i.checkContainerForCreate(_c)&&e.detect.__WebTwainMain(_c);setTimeout(e.detect.__checkPluginMultiReady,100)}else e.log("DEnv.Containers does not set.")})}},e.getScript("dynamsoft.webtwain.install.js",!1,n)},e.__innerCreateDWTObject=function(n,r,a,s){var u;if(!e.product.bChromeEdition)return e.isFunction(s)&&s(o),!1;if(t.Containers){var l,c=t.Containers;for(l=0;l<c.length;l++)if(c[l].ContainerId==n)return e.isFunction(s)&&s("Duplicate ID detected for creating Dynamic Web TWAIN objects, please check and modify."),!1}if(u=t.DynamicDWTMap[n])return e.isFunction(a)&&a(u),!0;e.getScript("dynamsoft.webtwain.install.js",!1,function(){r?i.startLinkWSByIP():i.startLinkWS(),e.html5.CreateDWTObject(n,r,function(r){Dynamsoft__OnclickCloseInstallEx(),t.DynamicContainers.push(n),t.DynamicDWTMap[n]=r,i.SetDefaultValue(r);r.LogLevel;-2207==r.ErrorCode&&(e.detect.bPromptJSOrServerOutdated||(alert(r.ErrorString+" Please contact the administrator or the developer of the website for more information."),e.detect.bPromptJSOrServerOutdated=!0)),e.detect._needUpgradeHtml5Server(n,r),e.isFunction(a)&&a(r)})})},t.Load=function(){KISSY.ready(function(t){KISSY.use(["io","json","node","dom","event","kg/bio/1.2/index"],function(t,n,r,o,i,a,s){KISSY.BIO=s,e.__innerLoad()})})},t.CreateDWTObject=function(t,r,i,a,s,u){var l,c,d,h,f=!1,g=!1;if(arguments.length<=3?(d=r,h=i):(g=r,l=i,c=a,d=s,h=u),!e.product.bChromeEdition)return e.isFunction(u)&&u(o),!1;e.detect.onNoControl||(e.detect.onNoControl=n),g&&l&&c&&l>0&&c>0&&(f={ip:g,port:l,portSSL:c}),KISSY.ready(function(n){KISSY.use(["io","json","node","dom","event","kg/bio/1.2/index"],function(n,r,o,i,a,s,u){KISSY.BIO=u,e.__innerCreateDWTObject(t,f,d,h)})})},t.DeleteDWTObject=function(n){var r,o=t.DynamicDWTMap;if(!e.product.bChromeEdition)return!1;if(o&&n in o){var i=o[n];i&&(delete o[n],i.__unload())}for(r=0;r<t.DynamicContainers.length;r++)if(t.DynamicContainers[r]==n){t.DynamicContainers.splice(r,1);break}return e.detect.hideMask(),!0},t.GetWebTwain=function(n){var r,o,a=n;if(r=t.Containers,!a&&r&&r.length>0)for(o=0;o<r.length;o++)if(i.containerIsValid(r[o])){a=r[o].ContainerId;break}if(r=t.DynamicContainers,!a&&r&&r.length>0&&(a=r[0]),r=null,a&&e.get(a)){var s=t.ContainerMap;if(s&&a in s)return s[a];if((s=t.DynamicDWTMap)&&a in s)return s[a]}return null},t.__checkConfigLoaded=function(){e.isUndefined(t.ProductKey)?setTimeout(t.__checkConfigLoaded,100):setTimeout(function(){e.getCss("reference/hint.css"),e.getCss("reference/html5_editor.css"),t.AutoLoad&&t.Load()},100)},t.CheckConfigLoaded=function(){var n=e.get("J_waiting");n&&n.parentNode.removeChild(n),t.__checkConfigLoaded()}}(Dynamsoft.Lib,Dynamsoft.WebTwainEnv),module.exports.Dynamsoft=Dynamsoft,module.exports.EnumDWT_PixelType=EnumDWT_PixelType;